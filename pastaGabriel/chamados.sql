-- MySQL dump 10.13  Distrib 5.6.43, for Linux (x86_64)
--
-- Host: localhost    Database: chamados
-- ------------------------------------------------------
-- Server version	5.6.43

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `categoria`
--

DROP TABLE IF EXISTS `categoria`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `categoria` (
  `ca_id` int(11) NOT NULL AUTO_INCREMENT,
  `ca_categoria` varchar(200) NOT NULL,
  PRIMARY KEY (`ca_id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `categoria`
--

LOCK TABLES `categoria` WRITE;
/*!40000 ALTER TABLE `categoria` DISABLE KEYS */;
/*!40000 ALTER TABLE `categoria` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `chamado`
--

DROP TABLE IF EXISTS `chamado`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `chamado` (
  `ch_id` int(11) NOT NULL AUTO_INCREMENT,
  `ch_titulo` varchar(200) NOT NULL,
  `ch_categoria` varchar(200) NOT NULL,
  `ch_conteudo` text NOT NULL,
  PRIMARY KEY (`ch_id`)
) ENGINE=InnoDB AUTO_INCREMENT=4 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `chamado`
--

LOCK TABLES `chamado` WRITE;
/*!40000 ALTER TABLE `chamado` DISABLE KEYS */;
INSERT INTO `chamado` VALUES (3,'teste','teste','teste');
/*!40000 ALTER TABLE `chamado` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `chamados`
--

DROP TABLE IF EXISTS `chamados`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `chamados` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `titulo` varchar(200) NOT NULL,
  `categoria` varchar(200) NOT NULL,
  `conteudo` text NOT NULL,
  `funcionario` varchar(20) DEFAULT NULL,
  `data` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=809 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `chamados`
--

LOCK TABLES `chamados` WRITE;
/*!40000 ALTER TABLE `chamados` DISABLE KEYS */;
INSERT INTO `chamados` VALUES (6,'Erro Hive','Erro Sql','Sempre que der erro de HIVE na instalaÃ§ao do sql, tentar instalar sql 2012',NULL,'0000-00-00 00:00:00'),(7,'Erro HRESULT','Erro Sql','Para resolver esse erro \r\n\r\n--- 1 passo ----------------------------------------------------\r\n\r\nprimeiro se deve instalar o vcredist(Microsoft Visual C++ Redistributable Package)\r\n\r\nErro no SQL 2008 baixar essas versoes\r\n\r\nMicrosoft Visual C++ 2008 Redistributable Package (x86)\r\nhttps://www.microsoft.com/en-us/download/details.aspx?id=29\r\n\r\nMicrosoft Visual C++ 2008 Redistributable Package (x64)\r\nhttps://www.microsoft.com/en-us/download/details.aspx?id=15336\r\n\r\n\r\nErro no SQL 2012 baixar essas versoes\r\n\r\nVisual C++ Redistributable Packages for Visual Studio 2013\r\nhttps://www.microsoft.com/en-us/download/details.aspx?id=40784&751be11f-ede8-5a0c-058c-2ee190a24fa6=True\r\n\r\n--- 2 passo ----------------------------------------------------\r\n\r\nAcessar  \r\n1 - painel de controle  \r\n2 - programas e recursos  \r\n3 - clicar em ativar ou desativer recursos\r\n4 - vai abrir uma janela \r\n5 - clique no + do NET Framework 3.5 que vai fazer aparecer 2 opÃ§oes \r\n6 - vc vai marcar as 2 opÃ§oes\r\n1 - HTTP do windowns Communication\r\n2 - Nao HTTP do windowns Communication\r\n\r\nMarque as 2 opÃ§oes e de ok\r\n\r\n(caso de algum erro acesse o Painel de controle >> Ferramentas Administrativas \r\nexecute como admin SERVIÃ‡OS \r\nprocure o serviÃ§o do Windowns Update\r\nde 2 clique, vai abrir um janela\r\naltere a opÃ§ao de desativado para automatico e de ok\r\nentao tente ativar novamente o NET Framework 3.5)\r\n\r\napos isso pode instalar novamente o sql',NULL,'0000-00-00 00:00:00'),(8,'Abrir Studio ou Configuration Manager ','SQL','ABRIR O EXECUTAR DO WINDOWS ( TECLA WIN + R )\r\n\r\nPARA ABRIR O Configuration Manager EXECUTAR COMANDO:\r\nSQL Server 2008: SQLServerManager10.msc \r\nSQL Server 2012: SQLServerManager11.msc \r\nSQL Server 2014: SQLServerManager12.msc \r\nSQL Server 2016: SQLServerManager13.msc \r\nSQL Server 2017: SQLServerManager14.msc \r\n\r\n\r\nPARA ABRIR O STUDIO EXECUTAR COMANDO:\r\nSSMS.exe ',NULL,'0000-00-00 00:00:00'),(24,'Eventos da folha','Folha','Cadastre na tabela os eventos de sua folha de pagamento para que o asseponto calcule\r\nextras, dias de salÃ¡rio e atrasos compatÃ­veis com sua folha de pagamento.\r\n1Âº clique no asseponto no menu tabelas, eventos;\r\n2Âº Clique em novo evento;\r\n3Âº Digite o cÃ³digo de evento compatÃ­vel com os eventos (verbas), de seu sistema de folha de\r\npagamento;\r\n4Âº Digite a descriÃ§Ã£o e clique em OK.O Evento estarÃ¡ cadastrado.\r\nSe desejar alterar o evento, clique sobre o mesmo e clique na opÃ§Ã£o altere a descriÃ§Ã£o\r\nou cÃ³digo e clique em OK.',NULL,'0000-00-00 00:00:00'),(26,'Motivos','Justificativas','Cadastre no asseponto os motivos pelo qual vocÃª deseja abonar um atraso ou uma falta, bem\r\ncomo incluir ou desconsiderar uma marcaÃ§Ã£o de ponto. Conforme instruÃ§Ã£o da portaria 1510.\r\n1Âº clique no asseponto no menu tabelas motivos de justificativas ;\r\n2Âº Clique em novo motivo;\r\n3Âº Digite a descriÃ§Ã£o e clique em OK.\r\n\r\nPara alterar clique duas vezes\r\n\r\nPara excluir selecione e clique X',NULL,'0000-00-00 00:00:00'),(27,'Cadastrar usuÃ¡rio RHJ','RHJ','Clique no botÃ£o M/OK\r\nCPF: 53688778626 	Senha: Deixe em Branco (caso apareÃ§a erro de senha coloque senha 123456)\r\nClique em M/OK\r\nNavegue com as setas ate USUARIO\r\nGerenciar usuÃ¡rios \r\nSelecione o funcionÃ¡rio \r\nVa na opÃ§Ã£o Privilegio utilizando seta p/ baixo e altere para Administrador utilizando a seta p/ direita\r\nTodos os funcionÃ¡rios que estiver como administrador Ã© obrigatÃ³rio preencher o campo CPF e SENHA \r\nAnotar o numero de ID e Senha\r\nEntÃ£o por final confirma no M/OK\r\nEntÃ£o toda vez que for acessar o Menu do relÃ³gio vai solicitar para administrador se identificar  \r\nPasse a biometria cadastrada no leito ou digite o numero de ID do cadastro do usuÃ¡rio\r\nVai um campo com o numero de id do funcionÃ¡rio, vc confirmando vai pedir a senha cadastrada.\r\nInsira a senha e confirme no M/OK\r\n',NULL,'0000-00-00 00:00:00'),(28,'Cargos ','Funcionarios','Cadastre no asseponto a tabela de cargos dos seus funcionÃ¡rios.\r\n1Âº Para cadastrar um cargo, devemos acessar o menu tabelas cargos;\r\n2Âº Clique em novo cargo, digite a descriÃ§Ã£o e ok.\r\n3Âº Para alterar selecione o cargo clique no Ã­cone edite e ok.\r\n4Âº Para excluir selecione o cargo, clique no Ã­cone confirme a exclusÃ£o;',NULL,'0000-00-00 00:00:00'),(29,'Framework erro H result','InstalaÃ§Ã£o','\r\n\r\nDigite no prompt e tecle Enter: net stop WuAuServ \r\n\r\nMantenho o prompt de comando aberto.\r\n\r\nAcesse a pasta do Windows por meio do Windows Explorer, ou, em Iniciar Â» Executar digite o comando %windir%.Localize a pasta SoftwareDistribution e a renomeie para SoftwareDistributionSemUso.\r\n\r\nAcesse novamente a tela do prompt de comando e execute: net start WuAuServ\r\n\r\nTente a instalaÃ§Ã£o do NET Framework novamente que agora deverÃ¡ ocorrer normalmente.\r\n\r\n',NULL,'0000-00-00 00:00:00'),(30,'Gertec ver IP','Relogios','GERTEC\r\nSeta para a \"DIREITA\" > SENHA : 000000 (seis VEZES O NÂ° zero) > Escolher opÃ§Ã£o 2 - REDE\r\n\r\nGERTEC D GERAÃ‡ÃƒO 2\r\n\r\nSeta para a \"DIREITA\" > SENHA : 000000 (seis VEZES O NÂ° zero) > Escolher opÃ§Ã£o 1 - REDE\r\n\r\n',NULL,'0000-00-00 00:00:00'),(31,'Banco de horas ','Conceitos','Banco de horas \r\n\r\nO Banco de horas Ã© o  controle que a empresa pode optar para que as horas extras sejam compensadas com os atrasos.\r\nÃ‰ como uma conta corrente de bancos, tudo que Ã© credito acumula para positivo tudo que Ã© debito Ã© como um saque que vocÃª faz na conta.Logo falando em apontamento de horas credito sÃ£o as extras, e dÃ©bitos os atrasos e faltas a compensaÃ§Ã£o de um com outro vai resultar em um saldo.\r\nEste saldo acumula , se positivo podemos dar folga se negativo ele trabalha mais para pagar as horas que deve.',NULL,'0000-00-00 00:00:00'),(32,'GERTEC BPD - CADASTRO DE BIOMETRIA','GERTEC','Pressione a seta para direita > senha: 000000 (seis vezes o nÂº zero) > Pressione a opÃ§Ã£o 4 - Biometria > Digite o PIS e pressione Enter > AparecerÃ¡ os dados do funcionÃ¡rio, se estiver correto pressione enter > Coloque a digital do funcionÃ¡rio, retire e coloque novamente conforme solicitado. AparecerÃ¡ uma mensagem de confirmaÃ§Ã£o.',NULL,'0000-00-00 00:00:00'),(33,'Banco de Horas - Pagar em folha','Banco de horas','Para pagar o banco de horas em folha, precisamos verificar 1 qual % que vamos enviar para pagar em folha.\r\nApos saber o % e ter cadastrado o evento em tabelas, eventos selecione o funcionÃ¡rio, na tela inicial selecione banco de horas selecione a data do saldo e acima lanÃ§ar saldo em folha.Selecione o evento , abaixo a quantidade de horas e ok.\r\n\r\nPara excluir na tela inicial banco de horas, selecione o lanÃ§amento e X para excluir.\r\n\r\nExclua tambÃ©m na opÃ§Ã£o funcionÃ¡rios, variÃ¡veis lancadas o evento de pagamento ou desconto.',NULL,'0000-00-00 00:00:00'),(34,'ATHOS - COMUNICAÃ‡ÃƒO','RELOGIO ATHOS','Tranferir para o computador do cliente \r\n\r\nS:SuporteASSEPONTO4PROGRAMAS RELOGIOSATHOS STAR REPWiziWIZ1x0SR_config_v3.0.2install\r\n\r\nExecutar o instalador, na sequencia execute na pasta \r\n\r\nC:Program Files (x86)WIZnetWIZ1x0SR_Configtool o aplicativo, clique em search ele vai exibir o relogio na rede coloque o ip desejado, mascara gateay , porta deve ser 02101 e clique em setting para salvar.\r\n\r\nDepois instale o sistema netcom transfira e execute apenas avancando.\r\n\r\nnetcom esta na pasta \r\n\r\nS:SuporteASSEPONTO4PROGRAMAS RELOGIOSATHOS STAR REP\nETcOM\r\n\r\n\r\ndepois transfira os arquivos de coletores asseponto , configure o ip e comunique \r\n\r\nSENHA FABRICA ACESSAR MENU\r\nPRESSIONE F4 SEGURE E QUANDO PEDIR SENHA DIGITE 0000',NULL,'0000-00-00 00:00:00'),(35,'ATHOS - CADASTRO DE BIOMETRIA','RELOGIO - ATHOS','8.3 Incluir / Excluir Biometrias\r\nPermite realizar o cadastro de biometrias dos usuÃ¡rios no StarRep. Essa funÃ§Ã£o Ã© habilitada\r\nsomente nos equipamentos dos modelos BioCode ou BioProxy.\r\nPara realizar o cadastro das biometrias, siga os seguintes passos:\r\nPressione e segure a tecla F3. SerÃ¡ solicitado a digitaÃ§Ã£o da senha para habilitar o menu.\r\nDigite a senha solicitada.\r\nLocalize o menu â€œINCLUIR BIOMETRIAâ€ e pressione\r\nâ€œENTâ€.\r\nSerÃ¡ solicitado que seja digitado o PIS. Digite o PIS com\r\n12 caracteres. De acordo com a portaria 1510, todos os\r\nnÃºmeros de PIS devem comeÃ§ar com â€œ0â€.\r\nSerÃ¡ exibido o nome do funcionÃ¡rio no display. Aguarde\r\no REP exibir a mensagem â€œAproxime Dedoâ€ e em\r\nseguida, coloque o dedo no sensor.\r\nAssim que o sensor apagar, retire o dedo e aguarde o\r\nStarRep emitir a mensagem â€œBIOMETRIA SALVAâ€ em\r\nseguida â€œAGUARDEâ€.\r\nApÃ³s o StarRep voltarÃ¡ ao Menu â€œINCLUIR BIOMETRIAâ€.\r\nSe a biometria digital for recusada, serÃ¡ exibida uma mensagem â€œERROâ€, e o StarRep voltarÃ¡\r\nao menu â€œINCLUIR BIOMETRIAâ€.',NULL,'0000-00-00 00:00:00'),(36,'ATHOS - EXCLUIR BIOMETRIA','RELOGIO - ATHOS','Para excluir a biometria, localize o menu â€œEXCLUIR\r\nBIOMETRIAâ€ e pressione â€œENTâ€.\r\nSerÃ¡ solicitado que seja digitado o PIS. Digite o PIS com\r\n12 caracteres. De acordo com a portaria 1510, todos os\r\nnÃºmeros de PIS devem comeÃ§ar com â€œ0â€.\r\nApÃ³s o procedimento, aguarde a mensagem\r\nâ€œBIOMETRIA DELETADAâ€.',NULL,'0000-00-00 00:00:00'),(37,'CONTROL ID IDCLASS - APAGAR ADMINISTRADOR','RELOGIO - CONTROL ID IDCLASS','remover administrador pelo teclado relogio\r\nclique no teclado, digite\r\n182377 depois confirmar\r\ndepois senha \r\n001818\r\nconfirmar \r\n\r\ndepois acessar > configuraÃ§Ãµes\r\napagar administradores',NULL,'0000-00-00 00:00:00'),(38,'CONTROL ID IDCLASS - CONFIGURAÃ‡ÃƒO','RELOGIO  - CONTROL ID IDCLASS','MENU>CONFIGURAÃ‡Ã•ES>CONFIGDEREDE\r\nCLICAR SOBRE IP, DIGITAR E FAZER O MESMO PARA MASCARA DE REDE E GATEWAY.\r\nPORTA: 443\r\nDEPOIS CLIQUE EM SALVAR\r\n',NULL,'0000-00-00 00:00:00'),(39,'CONTROL ID IDCLASS - CADASTRO DE BIOMETRIA','RELOGIO - CONTROL ID IDCLASS','MENU> USUÃRIOS > APÃ“S PESQUISAR, CLIQUE SOBRE O NOME > DEPOIS OPÃ‡ÃƒO DIGITAL PEÃ‡A PARA PRESSIONAR 3 X VEZES A MESMA BIOMETRIA > AGUARDA A MENSAGEM BIOMETRIA CADASTRADA COM SUCESSO.\r\n',NULL,'0000-00-00 00:00:00'),(40,'CONTROL ID IDCLASS - CADASTRO DE FUNCIONARIO (MANUAL)','RELOGIO - CONTROL ID IDCLASS','ACESSE O MENU > USUÃRIOS > NOVO > PREENCHA OS DADOS (NOME, PIS) > CADASTRE A BIOMETRIA > E DEPOIS Ã‰ SÃ“ SALVAR ',NULL,'0000-00-00 00:00:00'),(41,'CONTROL ID IDCLASS - ATUALIZAR DATA E HORA','RELOGIO - CONTROL ID IDCLASS','MENU> CONFIGURAÃ‡Ã•ES >DATA/HORA > BASTA CLICAR, ALTERAR E OK\r\n',NULL,'0000-00-00 00:00:00'),(42,'CONTROL ID IDCLASS - HORÃRIO DE VERÃƒO','RELOGIO - CONTROL ID IDCLASS','MENU > CONFIGURAÃ‡Ã•ES > HORARIO DE VERÃƒO > ALTERE A DATA DE INICIO E TERMINO\r\n',NULL,'0000-00-00 00:00:00'),(43,'CONTROL ID IDX - APAGAR ADMINISTRADOR','RELOGIO - CONTROL ID IDX','clique na tela inicial > digite 182377 ok > vai aparecer um codigo, ele digita o numero 1 mais este codigo > assim que abrir o menu ele vai ate configuraÃ§Ãµes e apagar administradores',NULL,'0000-00-00 00:00:00'),(44,'CONTROL ID IDX - CONFIGURAÃ‡ÃƒO','RELOGIO - CONTROL ID IDX','MENU > CONFIGURAÃ‡Ã•ES > CONFIGDEREDE > CLICAR SOBRE IP, DIGITAR E FAZER O MESMO PARA MASCARA DE REDE E GATEWAY > PORTA: 1818 > DEPOIS ABAIXO SALVAR\r\n',NULL,'0000-00-00 00:00:00'),(45,'CONTROL ID - TROCA DE BOBINA','RELOGIO - CONTROL ID','VÃDEO EXPLICATIVO, SEGUE LINK:\r\nhttps://www.youtube.com/watch?v=LiGv5iAr2wk',NULL,'0000-00-00 00:00:00'),(46,'BANCO DE HORAS - ZERAR SALDO','BANCO DE HORAS','Para zerar o banco de horas existem trÃªs opÃ§Ãµes.\r\nPodemos lanÃ§ar o saldo em folha.( pesquisar Banco de horas lanÃ§ar em folha).\r\n\r\nPodemos apagar todos os saldos.(o sistema ira deletar os cÃ¡lculos e apagar histÃ³rico)selecione os funcionÃ¡rios menu funcionÃ¡rios, banco de horas apagar todos os lanÃ§amentos para apagar do mÃªs e apagar lanÃ§amentos anteriores para apagar todo histÃ³rico. \r\n\r\nZerar mantendo histÃ³rico sem pagar em folha.\r\nSelecione na tela inicial banco de horas, selecione o dia depois  acima  lanÃ§amento avulso selecione se deseja lanÃ§ar debito ou credito.Se estiver negativo selecione credito e coloque-o valor de horas para zerar. Se credito e quiser zerar selecione negativo, defina a quantidade de horas.\r\n\r\nEntender que o debito zera o credito e o credito elimina o negativo.',NULL,'0000-00-00 00:00:00'),(47,'CONTROL ID IDX - CADASTRO DE BIOMETRIA','RELOGIO - CONTROL ID IDX','MENU> USUÃRIOS > APÃ“S PESQUISAR, CLIQUE SOBRE O NOME > DEPOIS OPÃ‡ÃƒO DIGITAL PEÃ‡A PARA PRESSIONAR 3 X VEZES A MESMA BIOMETRIA > AGUARDA A MENSAGEM BIOMETRIA CADASTRADA COM SUCESSO > SALVAR',NULL,'0000-00-00 00:00:00'),(48,'CONTROL ID IDX - CADASTRO DE FUNCIONARIO MANUAL','RELOGIO - CONTROL ID IDX','ACESSE O MENU > USUÃRIOS > NOVO > PREENCHA OS DADOS (NOME, PIS) > CADASTRE A BIOMETRIA > E DEPOIS Ã‰ SÃ“ SALVAR',NULL,'0000-00-00 00:00:00'),(49,'CONTROL ID IDX - ATUALIZAR DATA E HORA','RELOGIO - CONTROL ID IDX','MENU> CONFIGURAÃ‡Ã•ES >DATA/HORA > BASTA CLICAR, ALTERAR E OK',NULL,'0000-00-00 00:00:00'),(50,'CONTROL ID IDX - HORARIO DE VERÃƒO ','RELOGIO - CONTROL ID IDX','MENU > CONFIGURAÃ‡Ã•ES > HORARIO DE VERÃƒO > ALTERE A DATA DE INICIO E TERMINO',NULL,'0000-00-00 00:00:00'),(51,'DIMEP MINI PRINT - CONFIGURAÃ‡ÃƒO','RELOGIO - DIMEP MINI PRINT ','VERIFICAR O ENDEREÃ‡O IP > CLIQUE NO MENU DO RELOGIO > e>97>e > Em seguida pressione â€œ0â€, ate a opÃ§Ã£o configuraÃ§Ã£o tÃ©cnica e altere na sequencia:\r\nIP\r\nMascara de rede\r\nGateway \r\nO relÃ³gio vai reiniciar e exibir configuraÃ§Ã£o ok.\r\n',NULL,'0000-00-00 00:00:00'),(52,'DIMEP MINI PRINT - CADASTRO DE BIOMETRIA','RELOGIO - DIMEP MINI PRINT','Pressionar no REP E>91>E > Informe o supervisor cadastrado > depois a senha e o numero de crachÃ¡ > Depois E > O relÃ³gio ira solicitar o dedo da mÃ£o direita, pressione E e posicione o dedo trÃªs vezes > O relÃ³gio ira solicitar o dedo mÃ£o esquerda, pressione E e posicione o dedo trÃªs vezes > O REP ira exibir a mensagem de biometria cadastrada\r\n',NULL,'0000-00-00 00:00:00'),(53,'DIMEP MINI PRINT - EXCLUIR BIOMETRIA','RELOGIO - DIMEP MINI PRINT','FunÃ§Ã£o E>92>E > Digite supervisor, senha depois o cÃ³digo do crachÃ¡ que quer excluir > opÃ§Ã£o E ',NULL,'0000-00-00 00:00:00'),(54,'DIMEP MINI PRINT - ATUALIZAR DATA E HORA','RELOGIO - DIMEP MINI PRINT','FUNÃ‡ÃƒO e>97 > Depois 0, atÃ© data e hora, depois E > Digite a data e hora e depois E. \r\n',NULL,'0000-00-00 00:00:00'),(55,'DIMEP PRINT POINT 3 - CONFIGURAÃ‡ÃƒO','RELOGIO - DIMEP PRINT POINT 3','1Âº Exportar do relÃ³gio o arquivo chave atravÃ©s da USB\r\nEste arquivo deve estar na pasta com os executÃ¡veis e dlls atualizados da pasta Dimep printpoint III.\r\n\r\n\r\nPressione f1+45 > informe o supervisor e senha > OpÃ§Ã£o exportar RSA pressione enter e conecte o pen drive na usb de dados na parte de baixo do relÃ³gio > Depois copiar do pen drive para a pasta dos executÃ¡veis.\r\nPrintPoint III\r\n\r\nCONFIGURAR IP - MASCARA E GATEWAY\r\nF1 97 enter > f1 ate programaÃ§Ã£o tÃ©cnica > enter > supervisor > senha > configurar ip, mascara, gateway.\r\n \r\n',NULL,'0000-00-00 00:00:00'),(56,'GERTEC BPD - CONFIGURAÃ‡ÃƒO','RELOGIO - GERTEC BPD','Seta para a \"DIREITA\" > SENHA : 000000 (seis VEZES O NÂ° zero) > Escolher opÃ§Ã£o 1 - REDE > ENTER > ALTERA O IP, MASCARA E GATEWAY > OK',NULL,'0000-00-00 00:00:00'),(57,'GERTEC BPD - ATUALIZAR DATA E HORA','RELOGIO - GERTEC BPD','Seta para a \"DIREITA\" > SENHA : 000000 (seis VEZES O NÂ° zero) > Escolher opÃ§Ã£o DATA E HORA > ALTERA A DATA E HORA > CONFIRMA.\r\n',NULL,'0000-00-00 00:00:00'),(59,'GERTEC D - CONFIGURAÃ‡ÃƒO','RELOGIO - GERTEC D','Pressione a seta para direita > senha: 000000 (seis vezes o nÂº zero) > Pressione a opÃ§Ã£o 8 - Biometria > Digite o PIS e pressione Enter (PIS COM \"0\" NA FRENTE > AparecerÃ¡ os dados do funcionÃ¡rio, se estiver correto pressione enter > Coloque a digital do funcionÃ¡rio, retire e coloque novamente conforme solicitado. AparecerÃ¡ uma mensagem de confirmaÃ§Ã£o',NULL,'0000-00-00 00:00:00'),(60,'GERTEC D - CADASTRO DE BIOMETRIA ','RELOGIO - GERTEC D ','Pressione a seta para direita > senha: 000000 (seis vezes o nÂº zero) > Pressione a opÃ§Ã£o 8 - Biometria > Digite o PIS e pressione Enter (PIS COM \"0\" NA FRENTE > AparecerÃ¡ os dados do funcionÃ¡rio, se estiver correto pressione enter > Coloque a digital do funcionÃ¡rio, retire e coloque novamente conforme solicitado. AparecerÃ¡ uma mensagem de confirmaÃ§Ã£o',NULL,'0000-00-00 00:00:00'),(61,'GERTEC G3 - CONFIGURAÃ‡ÃƒO','RELOGIO - GERTEC G3 ','SETA PARA DIREITA > SENHA 1234 > OPÃ‡ÃƒO REDE > CONFIGURAÃ‡Ã•ES > DEFINA O IP, MASCARA E GATEWAY > VOLTE NO MENU PRINCIPAL E CLIQUE NA OPÃ‡ÃƒO SALVAR  ',NULL,'0000-00-00 00:00:00'),(62,'GERTEC G3 - GERAR PIN ','RELOGIO - GERTEC G3 ','SETA PARA DIREITA > SENHA 1234 > OPÃ‡ÃƒO REDE > PIN DE SEGURANÃ‡A > GERAR NOVO PIN > CONFIRMA',NULL,'0000-00-00 00:00:00'),(63,'GERTEC G3 - CADASTRO DE BIOMETRIA','RELOGIO - GERTEC G3 ','SETA PARA DIREITA > SENHA 1234 > INSIRA SEU CPF > OPÃ‡ÃƒO BIOMETRIA > INSIRA O PIS DO FUNCIONARIO > CONFIRMA OS DADOS ESTÃƒO CORRETOS > INSIRA A BIOMETRIA > CONFIRMA > SALVA ',NULL,'0000-00-00 00:00:00'),(64,'ZPM R100 - CONFIGURAÃ‡ÃƒO','RELOGIO - ZPM R100','Para visualizar IP  - \"MENU\" na lateral interior esquerda > opÃ§Ã£o \"ADMINISTRADOR\" > Senha: 111111 (seis vezes o nÂ° um ) > OpÃ§Ã£o \"REDE\" > OpÃ§Ã£o \"Ver configuraÃ§Ãµes\"',NULL,'0000-00-00 00:00:00'),(65,'ZPM R100 - CADASTRO DE BIOMETRIA','RELOGIO - ZPM R100','\"MENU\" na lateral interior esquerda > opÃ§Ã£o \"ADMINISTRADOR\" > Senha: 111111 (seis vezes o nÂ° um )> OpÃ§Ã£o cadastrar > OpÃ§Ã£o Biometria > Digite o PIS caso esteja correto pressione enter e siga instruÃ§Ãµes do relÃ³gio.',NULL,'0000-00-00 00:00:00'),(66,'IDDATA - CONFIGURAÃ‡ÃƒO','RELOGIO - IDDATA','BotÃ£o \"TECLADO\" parte superior DIREITA > BotÃ£o \"ADM\" > OpÃ§Ã£o \"TECLADO\"  > Senha: 123456 > opÃ§Ã£o \"CONFIGURAR\" > OpÃ§Ã£o \"configurar IDREP\" > OpÃ§Ã£o \"CONFIGURAR TCP/IP\" > CONFIGURA IP, MASCARA E GATEWAY > OK ',NULL,'0000-00-00 00:00:00'),(67,'IDDATA - CADASTRO DE BIOMETRIA','RELOGIO - IDDATA','BotÃ£o \"TECLADO\" parte superior DIREITA > BotÃ£o \"ADM\" > OpÃ§Ã£o \"TECLADO\"  > Senha: 123456 > opÃ§Ã£o dados do trabalhador > Pesquisar por PIS > Digite o PIS e pressione editar > OpÃ§Ã£o identificaÃ§Ã£o > OpÃ§Ã£o biometria > Siga as instruÃ§Ãµes do relÃ³gio > Pressione a opÃ§Ã£o voltar > opÃ§Ã£o salvar e confirme com SIM.',NULL,'0000-00-00 00:00:00'),(68,'Relogio Trix - ConfiguraÃ§Ã£o','Relogio Trix ','Pressione botÃ£o â€œM / OKâ€ > OpÃ§Ã£o 7 â€“ Com. > Para alterar basta usar as setas para acessar cada opÃ§Ã£o, altere e com as setas selecione a opÃ§Ã£o â€œM / OKâ€',NULL,'0000-00-00 00:00:00'),(69,'Relogio Trix - Cadastro de Biometria','Relogio Trix ','Pressione botÃ£o â€œM / OKâ€ > OpÃ§Ã£o 2 â€“ Ger. Usr. > Com as setas selecione o funcionÃ¡rio e pressione botÃ£o â€œM / OKâ€ > Com as setas selecione e opÃ§Ã£o â€œCadstr. Digâ€ >  Seguir instruÃ§Ãµes para cadastro da biometria (Pressione trÃªs vezes a mesma digital no sensor para o cadastro) , com as setas selecionar a opÃ§Ã£o â€œM / OKâ€.',NULL,'0000-00-00 00:00:00'),(70,'RELOGIO TRILOBIT - CONFIGURAÃ‡ÃƒO','RELOGIO TRILOBIT','Pressionar o F4 atÃ© pedir a senha > SENHA: 4 ULTIMOS digitos do nÃºmero de sÃ©rie do relÃ³gio > Pressionar F1 ou F2 atÃ© aparecer opÃ§Ã£o \"ENDEREÃ‡O IP\" > Clicar no ENTER > Clicar em \"CLR\" > ApÃ³s visualizaÃ§Ã£o \"SAIR E SALVAR\".\r\nNÂ° de sÃ©rie: nÂº na lateral do relÃ³gio.',NULL,'0000-00-00 00:00:00'),(71,'RELOGIO TRILOBIT - CADASTRO DE BIOMETRIA','RELOGIO TRILOBIT','Pressione o botÃ£o F4 atÃ© que solicite senha > Senha: (4 Ãºltimos digitos do nÂº de sÃ©rie na lateral do relÃ³gio) > pressione o botÃ£o F2 atÃ© aparecer a opÃ§Ã£o configurar BIOM e pressione enter para confirmar > Digite o nÂº de cÃ³digo/crachÃ¡, digite e pressione enter (sempre irÃ¡ conter 8 digitos, se seu nÂº contem 2 casas acrescente mais 6 zeros antes, o crachÃ¡ vocÃª pode verificar nas propriedades do funcionÃ¡rio no asseponto4)  > Siga procedimento do relÃ³gio > Pressione botÃ£o CLR > Pressione botÃ£o F2 atÃ© a opÃ§Ã£o salvar e sair.',NULL,'0000-00-00 00:00:00'),(72,'RELOGIO TOPDATA - CONFIGURAÃ‡ÃƒO','RELOGIO TOPDATA','menu, configuraÃ§Ãµes , rede , senha padrÃ£o\r\n123456.\r\nip inner rep\r\ndigitar , ip, mascara, gateway\r\n\r\nInformar estes dados no asseponto, porta Ã© 0',NULL,'0000-00-00 00:00:00'),(73,'RELOGIO TOPDATA - CADASTRO DE BIOMETRIA','RELOGIO TOPDATA','menu, usuÃ¡rios, cadastro biometrico, incluir biometria\r\ndigitar a senha, depois cpf que enviou pelo asseponto, clique em teclado\r\ndigite o pis, coloque a digital',NULL,'0000-00-00 00:00:00'),(74,'RELOGIO TOPDATA - EXCLUIR BIOMETRIA','RELOGIO TOPDATA','menu, usuÃ¡rios, cadastro biometrico, excluir biometria\r\ndigitar a senha, depois cpf que enviou pelo asseponto, clique em teclado\r\ndigite o pis, coloque a digital',NULL,'0000-00-00 00:00:00'),(75,'RELOGIO RW TECH - CONFIGURAÃ‡Ã•ES','RELOGIO RW TECH','Pressionar Menu > Informar um CPF > IdentificaÃ§Ã£o padrÃ£o do REP: 0 (zero) > Senha padrÃ£o do REP: 000 (trÃªs vezes o nÃºmero zero) > Seguir com as setas atÃ© OPÃ‡Ã•ES > Seguir atÃ© COMUNICAÃ‡ÃƒO > Acessar opÃ§Ã£o TCP/IP > Verificar/Alterar as opÃ§Ãµes ENDEREÃ‡O IP / MASCARA DE REDE / GATEWAY PADRÃƒO.',NULL,'0000-00-00 00:00:00'),(76,'RELOGIO RW TECH - CADASTRO DE BIOMETRIA','RELOGIO RW TECH','Pressionar Menu > Informar um CPF > IdentificaÃ§Ã£o padrÃ£o do REP: 0 (zero) > Senha padrÃ£o do REP: 000 (trÃªs vezes o nÃºmero zero) > Seguir com as setas atÃ© FUNCIONÃRIOS > OpÃ§Ã£o EDITAR > Informar o PIS do funcionÃ¡rio > Seguir com as setas atÃ© opÃ§Ã£o DIGITAL, pressionar ok E COM AS SETAS ATE SALVAR USUARIO',NULL,'0000-00-00 00:00:00'),(77,'RELOGIO RHJ - CONFIGURAÃ‡Ã•ES','RELOGIO RHJ','Clique no botÃ£o M/OK\r\nCPF: 53688778626 (ou qualquer cpf valido)  Senha: Deixe em Branco (caso apareÃ§a erro de senha coloque senha 123456)                 \r\nClique em M/OK\r\nNavegue com a seta da direita ate opÃ§Ã£o 3.Com  \r\nClique em M/OK\r\nUtilizando as setas para baixo e para cima vocÃª pode correr entre os campos e para esquerda apagar a numeraÃ§Ã£o\r\nConfigure o numero de IP, MASCARA, GATEWAY e deixe a senha em branco (se houver um asterisco, apague)\r\nPor ultimo vÃ¡ ate a opÃ§Ã£o de M/OK do visor \r\nClique em M/OK do teclado',NULL,'0000-00-00 00:00:00'),(78,'RELOGIO RHJ - CADASTRO DE BIOMETRIA','RELOGIO RHJ','RHJ\r\nAcesse o menu do relogio com USUARIO ADMINISTRADOR\r\nNavegue com as setas ate USUARIO\r\nGerenciar usuÃ¡rios\r\nSelecione o funcionÃ¡rio \r\n-> Va na opÃ§Ã£o Cadastrar biometria utilizando seta p/ baixo\r\nTalvez apareÃ§a alguma mensagem do tipo \"Deseja cadastra uma nova biometria ou apagar a anterior\"\r\nPode confirmar\r\nIrÃ¡ aparecer no visor 3 quadrados\r\nColoque o dedo para registra a biometria, retire o dedo, coloque novamente e siga esses passos ate preencher os 3 quadrados.\r\n-> EntÃ£o por final confirmar no M/OK',NULL,'0000-00-00 00:00:00'),(84,'Iniciar automaticamente o servico do sql','INICIAR SERVICO','Tutorial\r\n\r\nJogar arquivo \"iniciar SQL.bat\" na pasta do asseponto e criar um atalho\r\n*** botao direito >> criar atalho\r\nArquivo estao na pasta \"S:SuporteASSEPONTO4iniciar serviÃ§o sql automaticamente\"\r\n\r\n\r\nJogar atalho na pasta\r\n%appdata%microsoftwindowsstart menuprogramsstartup\r\n\r\nClicar com botao diteito no atalho\r\nIr em propriedades\r\nna aba atalho clicar em avanÃ§ado\r\nmarcar executar como administrador\r\nok\r\n\r\n\r\nOBS: Instancia tem que estar com nome \"ponto4\".\r\nCaso esteja com nome diferente clicar com botao direito no arquivo \"iniciar SQL\" e editar\r\nalterar onde esta como ponto4 para o nome da instancia.','Gabriel','2023-02-18 14:19:03'),(85,'hENRY - HABILITAR MARCAÃ‡ÃƒO TECLADO','RELOGIO','PARA HABILITAR A MARCAÃ‡ÃƒO PELO TECLADO , ACESSE O REP PELO NAVEGADOR  (VER ip).\r\naPOS LOGAR , EM CONFIGURAÃ‡Ã•ES CLIQUE EM HABILITAR TECLADO, E TIRE A OPÃ‡ÃƒO DE VERIFICAR DIGITAIS\r\nO COLABORADOR DEVE NO RELÃ“GIO UTILIZAR O NUMERO DE MATRICULA. ','MARCOS','2018-02-23 15:48:34'),(86,'CONTROL ID CLASS - APAGAR ADMINISTRADOR','RELOGIO','remover administrador pelo teclado relogio\r\nclique no teclado, digite\r\n182377 depois confirmar\r\ndepois senha \r\n001818\r\nconfirmar \r\n\r\ndepois acessar , configuraÃ§Ãµes\r\napagar administradores','MARCOS','2018-02-23 15:49:25'),(87,'CONTROL ID CLASS - DISPLAY NÃƒO FUNCIONA','RELOGIO','Desligue o RELÃ“GIO da tomada \r\npressione o botÃ£o vermelho (mantenha pressionado) e ligue na tomada ate aparecer +1, depois solte o botao vermelho , clique em +2,+3,+4, em seguida o display esta liberado.','MARCOS','2018-02-23 15:51:04'),(89,'GERTEC G3 - ERRO 45','RELOGIO','ERRO 45 AO COMUNICAR\r\n\r\nVERIFICAR TANTO A SENHA DO REP , E TAMBÃ‰M PIN','MARCOS','2018-02-23 15:55:16'),(90,'IMPRESSÃƒO SAI EM BRANCO','RELOGIO','INVERTER O LADO DA BOBINA','MARCOS','2018-02-23 15:56:05'),(91,'ERRO MRP','RELOGIO','QUALQUER RELÃ“GIO QUE APRESENTAR ESTE ERRO, DEVEMOS  REINICIAR E CASO NAO INICIE CORRETAMENTE PEDIR PARA ENTRAR EM CONTATO COM REVENDA/FABRICANTE INFORMANDO O ERRO','MARCOS','2018-02-23 15:57:09'),(94,'funcionario nao exibe no sistema','CADASTRO DE FUNCIONARIO','verificar se a data de ADMISSÃƒO esta no mesmo PERÃODO de apontamento\r\nverificar se o mesmo NÃƒO esta em FUNCIONÃRIOS inativos\r\nverificar se o mesmo nao esta em empresas FUNCIONÃRIOS EXCLUÃDOS','MARCOS','2018-02-23 17:31:21'),(96,'Erro de TimeOut','INICIAR SERVICO','temos 2 SOLUÃ‡Ã•ES\r\n \r\n1Â° -  desativar o pipes do sql \r\n\r\n\r\n\r\n2Â° -  desativar o firewall do antivirus ou liberar a porta DINÃ‚MICA e as portas PADRÃƒO do sql 1433, 1434.','Gabriel','2018-02-23 21:10:38'),(97,'DMZ','REDES','REGRA DMZ PASSO A PASSO \r\n1- COMUNICAR O RELOGIO NA REDE LOCAL \r\n(Ã© preciso configurar Gateway no relogio)\r\n2- ACESSAR O ROTEADOR DA REDE ONDE ESTA O RELOGIO \r\n(geralmente Ã© o Mondem da operadora de internet - VIVO, NET, OI, TIM...)\r\n3- IR NA OPÃ‡ÃƒO PORT FORWARDING E LIBERAR A PORTA DO RELOGIO EM TCP E UDP \r\n(alguns roteadores essas opÃ§oes pode estar como NAT podem estar no menu de firewall)\r\n4- IR NA OPÃ‡ÃƒO DMZ, HABILITAR E COLOCAR O IP DO RELOGIO\r\n5- ACESSAR O SITE WWW.MEUIP.COM \r\n6- COLOCAR O IP EXTERNO NO EXECUTÃVEL DO RELOGIO \r\n7- COMUNICAR O RELOGIO \r\n\r\nOBS Caso nao comunique realize um teste de porta no site http://testeportas.com.br/\r\ncolocando o numero de porta do relogio e testando. \r\ncaso esteja inacessivel, verifique as liberaÃ§oes feitas no roteador e se nao tem outro roteador depois do que vc configurou, Ã© possivel verificar usando o comando Tracert no CMD \r\nex: tracert 8.8.8.8 - ele vai traÃ§ar o caminho ate o ip da google, mostrando todos ips de rotedores que ele passa\r\nmuitas vezes vai ser preciso solicitar p operadora liberar a PORTA do relogio.','Gabriel','2018-02-26 16:17:20'),(98,'TESTE DE RELOGIO NA REDE','REDES','Apos testar 3 passos ligar para cliente e verificar se ele esta realmente fazendo corretamento os passos\r\n\r\n1 - VERIFICAR O NUMERO DE IP DA MAQUINA\r\n\r\n2 - TESTAR UM NUMERO DE IP DA MESMA REDE \r\nEXEMPLO: 192.168.1. = NUMERAÃ‡AO DA REDE\r\nA NUMERAÃ‡AO DO ULTIMO PONTO Ã‰ DA PC, ENTAO CADA PC TEM O SEU... \r\nSE O IP DA SUA MAQUINA FOR 192.168.1.21 \r\nPINGAR O IP 192.168.1.222 \r\n\r\n3 - SE O IP NAO ESTIVER RESPONDENDO, SOLICITE PARA O CLIENTE CONFIGURAR NO REP ESSE NUMERO\r\nCASO O IP ESTIVER RSPONDENDO TENTE OUTRO NUMERO ATE NAO RESPONDER \r\n\r\n\r\n______________________PROBLEMAS DE COMUNICAÃ‡AO___________________________________________________________________\r\n\r\nSE O IP ESTIVER RESPONDENDO E O RELOGIO NAO ESTIVER COMUNICANDO:\r\n\r\n1 - TENTE ACESSAR O RELOGIO PELO NAVAGADOR (CONTROL IDCLASS, RELOGIOS DA HENRY..) \r\n\r\nCASO TENHA ESSA OPÃ‡AO E VC CONSEGUIR ACESSAR, VERIFIQUE AS CONFIGURAÃ‡OES DO TERMINAL, SE TEM PROXY OU FIREWALL NA REDE\r\nNO CASO DE PROXY OU FIREWALL PEÃ‡A PARA O TI LIBERAR\r\n\r\nCASO NAO CONSIGA ACESSAR O RELOGIO POR OUTRO MEIO FORA O TERMINAL, SOLICITE PARA CLIENTE TROCAR O IP DO RELOGIO \r\nRESLIGAR E LIGAR RELOGIO\r\n\r\n___________________________________________________________________________________________________________________\r\n\r\nPROBLEMAS QUANDO IP NAO RESPONDE:\r\n\r\n1 - VERIFICAR SE ICONE DE REDE DO RELOGIO ESTA ATIVO (CASO RELOGIO NAO TENHA ICONE DE REDE VERIFICAR ENTRADA DO CABO DE REDE SE TEM UMA LUZ VERDE)\r\nCASO O ICONE NAO ESTEJA ATIVO VERIFICAR CABO DE REDE, TENTAR UTILIZAR OUTRO CABO, VERIFICA SE O ROTEADOR QUE O RELOGIO ESTA CONECTADO Ã‰ O MESMO QUE O PC COM ASSEPONTO\r\n\r\n2 - CASO ICONE ESTEJA ATIVO, UTILIZAR SCANNER DE REDE QUE ESTA NA PASTA \"S:SuporteASSEPONTO4FERRAMENTAS - SCANNER IP - JOIMEADVANCED IP SCANNER\"\r\nAPOS TRANSFERIR PROGRAMA \"Advanced IP Scanner 2.exe\" EXECUTE E CLIQUE EM INICIAR \r\nVERIFIQUE SE APARECE O NOME DO RELOGIO NA LISTA OU NUMERO DE MAC (NUMERO DE MAC VC PODE CONSULTAR NO ARQUIVO DE TEXTO NA MESMA PASTA DO PROGRAMA)\r\n\r\n3 - CASO VC LOCALIZE O RELOGIO CONFIGURE NO TERMINAL\r\nCASO NAO LOCALIZE VERIFIQUE SE O RELOGIO ESTA CONECTADO NO MESMO ROTEADOR DA MAQUINA QUE VC ESTA CONFIGURANDO O SISTEMA E RESLIGAR E LIGAR RELOGIO\r\nPOS ISSO REPETIR O SCAN NA REDE COM Advanced IP Scanner 2.exe\r\n\r\n4 - CASO NENHUM PROCEDIMENTO ACIMA NAO DE CERTO, SOLICIQUE PARA CLIENTE VERIFICA CONEXAO DO RELOGIO COM TI\r\n\r\n\r\nOBS: ao executar o scanner verificar qual faixa de ip esta no scanner, se Ã© a mesma do relogio\r\n\r\nApos testar 3 passos ligar para cliente e verificar se ele esta realmente fazendo corretamento os passos','Gabriel','2018-02-26 16:18:19'),(99,'erro instalar NETFRAMEWORK 4','ERRO SQL','Como resolver HRESULT 0xc8000222 de instalaÃ§Ã£o do .NET Framework 4:\r\n\r\nprocedimento 1\r\n1 - executar o arquivo \"Resolver Framework 4 - exec como adm.bat\" como adm na maquina do cliente\r\n2 - local do arquivo \"S:SuporteASSEPONTO4MANUAISSQL\"\r\n\r\n\r\nPROCEDIMENTO 2\r\n\r\n1. Abra o â€œcmdâ€ como administrador.\r\n\r\nClique no botÃ£o iniciar > Todos os programas > AcessÃ³rios > BotÃ£o direito em â€œPrompt de Comandoâ€ > Executar como Administrador.\r\n\r\n2. Digite: \"net stop wuauserv\" e tecle [ENTER]\r\n\r\n3. Abra o â€œWindows Explorerâ€ e entre na pasta Windows (C:Windows).  Encontre a pasta chamada â€œSoftwareDistributionâ€. Renomeia para â€œSoftwareDistribution_OLDâ€.\r\n\r\n4. Volte ao â€œPrompt de Comandoâ€ como administrador e digite: \"net start wuauserv\" e tecle [ENTER]\r\n\r\n5. Feche todas as janelas e inicie novamente a instalaÃ§Ã£o do .NET Framework','Gabriel','2018-02-26 16:24:07'),(100,'link de acesso','UTILIDADES','link de acesso remoto suporte\r\n\r\nhttps://secure.corporate.beanywhere.com/integration/integration2.php?uid=20ea03c4-63cc-11e2-b330-1231392ccdf2|2604\r\n\r\n\r\nLink de acesso remoto IMplantacao\r\n\r\nhttps://secure.corporate.beanywhere.com/integration/integration2.php?uid=20ea03c4-63cc-11e2-b330-1231392ccdf2|774\r\n\r\n\r\nlink de acesso assepontoweb\r\n\r\nhttp://www.asseponto.com.br/asseponto\r\nhttp://www.asseponto.com.br/painel/login\r\n','Gabriel','2018-02-26 20:51:17'),(103,'descompactar o sql','ERRO SQL','Procedimento para descompactar o sql\r\n\r\n1- mover o sql para pasta C:\\\r\n2- alterar o nome do sql para \"SQLEXPR_BR\"\r\n3- abrir o CMD como admin \r\n(clica no menu inicial >> digita \"cmd\" >> clica no cmd com botao direito >> vai em executar como admin) \r\n\r\n4- coloa o comando \"C:\\SQLEXPR_BR.EXE /x:c:\\sqlexprtmp\"\r\n5- de enter','Gabriel','2018-02-28 23:48:14'),(104,'registrar dll','UTILIDADES','Copie a dll para as pastas \r\nsystem32 (C:\\Windows\\System32) \r\ne \r\nSYSWOW64 (C:\\Windows\\SysWOW64)\r\n\r\ndepois vc deve abrir o CMD como adm\r\n\r\ndigite o comando regsvr32 NOME_da_dll.DLL\r\n\r\nonde esta NOME_DA_DLL.dll vc deve digitar o nome da dll que vc quer registrar.\r\nexemplo: REGSVR32 Kernel7x.dll','Gabriel','2018-02-28 23:56:26'),(105,'henry Prime - procedimentos','RELOGIO','HENRY \r\nHENRY R2 - CONFIG IP\r\nPressione botÃ£o central entre as setas > senha: 121314 > Pressione uma das setas (para cima ou para baixo) e procure a opÃ§Ã£o 2 - Conectitividade e pressione botÃ£o verde > Com setas procure opÃ§Ã£o 2 - TCP/IP e confirme com botÃ£o verde > Vai aparecer uma questÃ£o clica com botÃ£o verde > OpÃ§Ã£o 2 - IP\r\n\r\nHENRY R2 - CADASTRO BIO\r\n\r\nPressione botÃ£o central entre as setas > senha: 121314 > Pressione uma das setas (para cima ou para baixo) e procure a opÃ§Ã£o 3 - Biometria\r\n\r\nIMPORTAR FUNCIONARIO ATRAVES PEN DRIVE\r\n\r\nPressione botÃ£o central entre as setas > senha: 121314 > Pressione uma das setas (para cima ou para baixo) e procure a opÃ§Ã£o 2 - Conectitividade e pressione botÃ£o verde > Com setas procure opÃ§Ã£o 1 - USB e confirme com botÃ£o verde > Procure a opÃ§Ã£o 1 - ImportaÃ§Ã£o e pressione botÃ£o verde - opcao 3 colaboradores \r\n\r\n\r\nCONEXÃƒO SEGURA\r\n\r\nAcesse menu\r\n2 conectividade - opÃ§Ã£o 2 rede , opÃ§Ã£o 8 , ativa a conexÃ£o direta atÃ© aparecer o IP, digita o IP confirma e fecha no x\r\napos ja deve acessar via navegador\r\n\r\n','Gabriel','2018-03-02 15:40:01'),(106,'henry Prime - LOGIN WEB','RELOGIO','O usuÃ¡rio padrÃ£o para acesso VIA NAVEGADOR Ã‰ \r\nLOGIN: primmesf \r\nsenha: 121314.','Gabriel','2018-03-02 15:42:52'),(107,'henry Prime - EXECUTAVEL','RELOGIO','O HENRY PRIME USA O MESMO EXECUTÃVEL DO SUPERFACIL','Gabriel','2018-03-02 15:43:27'),(108,'henry ADV - PROCEDIMENTOS','RELOGIO','CONFIG DO TERMINAL ASSEPONTO\r\n\r\nNo terminal do asseponto Ã© preciso configurar o responsavel do relogio\r\nlogin:	teste fabrica\r\nsenha:	111111\r\nCPF: 	26583071363\r\n\r\ncaso precise configurar o responsavel no relogio Ã© preciso acessar o relogio pelo navegador com Login: rep  Senha: 123456\r\nacessar o menu de usuarios\r\ne criar um novo usuario com todos privilegios\r\n\r\n\r\nCONFIG IP\r\n\r\nPressione botÃ£o Menu > senha: 111111 Confirma no botao verde > CPF 265 ou (Verificar na parte de cima do relÃ³gio em uma plaqueta ou lateral) Confirma no botao verde > Preciona na tela na opÃ§ao 3.Comunic >\r\n1.Tcp/IP > Configurar IP > digita o ip e clica no confirmar > vai na opÃ§ao 2.Msc subrede > digita a mascara e confirma.\r\npronto esta configurado o ip\r\n\r\nâ€¢ Porta: 3000\r\n\r\nApos acessar o navegador, com ip do relogio, usuario: rep senha: 123456, em usuarios criar um usuario,definindo nome de login e uma senha com 6 digitos. Abaixo permitir todas as funÃ§Ãµes ao novo usuÃ¡rio.\r\n\r\nDepois definir este mesmo usuÃ¡rio em utilitarios, terminal no asseponto4 ou assepontoweb.\r\n\r\nCADASTRO BIOMITRIA\r\n\r\nPressione botÃ£o Menu > senha: 111111 Confirma no botao verde > CPF 265 ou (Verificar na parte de cima do relÃ³gio em uma plaqueta ou lateral) Confirma no botao verde > Preciona na tela na opÃ§ao 4.Cadastrar > Biometria > Incluir Bio > Digite o numero de matricula do funcionario > segue os passos do relogio para cadastrar a digital\r\n\r\n\r\nIMPORTAR FUNCIONARIO ATRAVES PEN DRIVE\r\n\r\nConecta o pendrive na USB de dados do relogio e segue esses passos\r\nPressione botÃ£o Menu > senha: 111111 Confirma no botao verde > CPF 265 ou (Verificar na parte de cima do relÃ³gio em uma plaqueta ou lateral) Confirma no botao verde > Preciona na tela na opÃ§ao 2.USB > 2.importar\r\n\r\n\r\nCadastra funcionario direto no relogio\r\n\r\nPressione botÃ£o Menu > senha: 111111 Confirma no botao verde > CPF 265 ou (Verificar na parte de cima do relÃ³gio em uma plaqueta ou lateral) Confirma no botao verde > Preciona na tela na opÃ§ao 4.Cadastrar > Add colaborador > preenche as informaÃ§oes do funcionario\r\n\r\n','Gabriel','2018-03-02 15:46:59'),(109,'henry ADV e Hexa B - problema comunicacao','RELOGIO','Para fazer o envio dos funcionarios Via rede nos relogios HEXA B e Advanced da henry pelo terminal o processo demoro muito o programa chega a travar e Ã© preciso esperar por muito tempo chando ser mais de 10 min envio de 50 funcionarios\r\n\r\nSoluÃ§ao para envio de funcionarios\r\npelo terminal Ã© preciso gerar o arquivo de exportaÃ§ao igual no procedimento cadastro dos funcionario por usb, apos gerar o arquivo de funcionarios >> abra o navegador e acesse o relogio pelo numero de ip >> entre com o usuario que ja foi cadastrado (caso tenha duvidas acessar o Manual para acessar rep pela web que esta na pasta do Manual) >> acessar o menu DADOS >> ImportaÃ§ao >> seleciona o arquivo gerado pelo terminal do asseponto >> espera o procedimento de importaÃ§ao\r\n\r\n\r\nSoluÃ§ao para ImportaÃ§ao de marcaÃ§oes\r\nAcessar o relogio pela web >> menu Eventos >> filtrar por data >> baixar arquivo\r\n\r\ndepois importar esse arquivo para o acesse ponto pelo menu apontamento >> importar marcaÃ§oes\r\n\r\nOBS: Ã‰ preciso configurar o asseponto para aceitar esse modelo diferente de arquivo afd seguindo o procedimento de Configurar ImportaÃ§ao por Pendrive (esta na pasta do Manual )','Gabriel','2018-03-02 15:48:17'),(110,'henry ADV e Hexa B - importacao afd','RELOGIO','Os relogios henry da linha hexa b e adv, nao gerao arquivo afd na porta fiscal\r\npara gerar arquivo de marcaÃ§oes \r\n-USB em exportaÃ§Ã£o >:> eventos  >> por data e confirmar\r\n\r\nno asseponto Ã© preciso configurar o arquivo de marcaÃ§oes\r\nmenu utilitarios >>  conf de arquivo de marcacao >> e preencher da seguinte forma\r\npis         - posicao 25 tamanho 11\r\ndia       - POSICAO 11 TAMANHO 2\r\nmes      - POSICAO 13 TAMANHO 2\r\nano     - POSICAO 15 TAMANHO 4\r\nhora  - POSICAO 19 TAMANHO 2\r\nmin      - POSICAO 21 TAMANHO 2\r\n\r\napos configurar pode importar normalmente o arquivo, \r\npelo menu apontamento >> importar marcaÃ§oes \r\n','Gabriel','2018-03-02 16:08:05'),(111,'henry compacto s - procedimentos','RELOGIO','CONFIG DO TERMINAL ASSEPONTO\r\n\r\nNo terminal do asseponto Ã© preciso configurar o responsavel do relogio\r\nlogin:	teste fabrica\r\nsenha:	111111\r\nCPF: 	26583071363\r\n\r\ncaso precise configurar o responsavel no relogio Ã© preciso acessar o relogio pelo navegador com Login: rep  Senha: 123456\r\nacessar o menu de usuarios\r\ne criar um novo usuario com todos privilegios\r\n\r\n\r\n-------------configuraÃ§ao do ip---------------------------\r\nno relogio de ponto vai ter uma etiqueta com o numero de ip que ja esta configurado no relogio\r\nÃ© preciso conectar ele diretamente na maquina entao acessando ele por navegador vc consegue alterar o ip do relogio\r\ne ja configurar o cadastrado do usario do relogio, caso cliente for utilizar relogio conectado na rede Ã© preciso configurar via navegador o ip da rede do cliente\r\n\r\nacessando o relogio pelo navegador com Login: rep  Senha: 123456\r\n\r\n\r\n\r\n-------------Cadastrar digital no relogio------------------------------------\r\n\r\nÃ‰ preciso cadastrar o cartao master do relogio acessando ele via navegador com usuario REP senha 123456\r\nno cadastro do usuario TESTE vai ter um campo para digitar o numero do cartao (o numero esta escrito no cartao)\r\napos salvar vc pode passar o cartao no relogio\r\n\r\nbotao direito navega ate cadastra de digital\r\n\r\nbotao esquerdo para entrar na opÃ§ao\r\n\r\nnavege ate codigo e entre nessa opÃ§ao\r\n\r\ncom a seta para esqueda vc vai poder mudar os ZEROS da tela para outros numeros e com o botao direito muda a casa do numero\r\n\r\nassim que que conseguir digitar todos os numero do cracha so ir com o botao direito na ultima casa\r\n\r\nentao vai solicitar para cadastrar a digital\r\n\r\napos cadastrar a digital vai parecer na tela se gostaria de incluir uma nova digital ou nao, so seleciona a opÃ§ao desejada e dar ok\r\n\r\n\r\n\r\ncaso tenha duvidas esse video explica como fazer o procedimento\r\nhttps://www.youtube.com/watch?v=Zw7nm-kdIYM\r\n','Gabriel','2018-03-02 16:11:20'),(112,'henry Hexa B - procedimentos','RELOGIO','CONFIG DO TERMINAL ASSEPONTO\r\n\r\nNo terminal do asseponto Ã© preciso configurar o responsavel do relogio\r\nlogin:	teste fabrica\r\nsenha:	111111\r\nCPF: 	26583071363\r\n\r\ncaso precise configurar o responsavel no relogio Ã© preciso acessar o relogio pelo navegador com Login: rep  Senha: 123456\r\nacessar o menu de usuarios\r\ne criar um novo usuario com todos privilegios\r\n\r\n\r\nâ€¢ Verificar ou alterar o IP: \r\nSeta para a esquerda > Senha: 111111 (botÃ£o \'sustenido\' = enter / botÃ£o \'asterisco\' = volta) > CPF: (Verificar na parte de cima do relÃ³gio em uma plaqueta) > 3 - ComunicaÃ§Ã£o > 1 - TcpIp > 1 - Configurar IP (Outras config. de rede: 2 â€“ MÃ¡scara / 3 - Gateway)\r\n\r\nâ€¢ Porta: 3000\r\n\r\nâ€¢ Envio via pendrive\r\nInserir o pen drive na porta dados na lateral do relÃ³gio > Seta para a esquerda > Senha: 111111 (botÃ£o \'sustenido\' = enter / botÃ£o \'asterisco\' = volta) > CPF: (Verificar na parte de cima do relÃ³gio em uma plaqueta ou utilizar o que cadastramos na web) > 2 â€“ USB > 2 â€“ Importar dados\r\n\r\nâ€¢ Cadastro de Biometria\r\n Seta para a esquerda > Senha: 111111 (botÃ£o \'sustenido\' = enter / botÃ£o \'asterisco\' = volta) > CPF: (Verificar na parte de cima do relÃ³gio em uma plaqueta ou utilizar o que cadastramos na web) > 4 â€“ Biometria > Inserir a matricula\r\n\r\nO nÂº de matricula Ã© o nÂº de crachÃ¡ cadastrado no sistema.\r\n\r\n\r\nOBS: Nao Ã© possivel comunicar com o rep se vc estiver conectado no relogio via Navegador, desconecte do navegador e se preciso reinicie o relogio.\r\nEsse relogio tem problemas de comunicaÃ§ao, entao no envio de funcionarios ou importaÃ§ao de marcaÃ§ao o executavel vai travar, so Ã© preciso esperar, pode demorar..\r\n','Gabriel','2018-03-02 16:12:10'),(113,'henry super facil - procedimentos','RELOGIO','HENRY \r\nHENRY R2 - CONFIG IP\r\nPressione botÃ£o central entre as setas > senha: 121314 > Pressione uma das setas (para cima ou para baixo) e procure a opÃ§Ã£o 2 - Conectitividade e pressione botÃ£o verde > Com setas procure opÃ§Ã£o 2 - TCP/IP e confirme com botÃ£o verde > Vai aparecer uma questÃ£o clica com botÃ£o verde > OpÃ§Ã£o 2 - IP\r\n\r\nHENRY R2 - CADASTRO BIO\r\n\r\nPressione botÃ£o central entre as setas > senha: 121314 > Pressione uma das setas (para cima ou para baixo) e procure a opÃ§Ã£o 3 - Biometria\r\n\r\nIMPORTAR FUNCIONARIO ATRAVES PEN DRIVE\r\n\r\nPressione botÃ£o central entre as setas > senha: 121314 > Pressione uma das setas (para cima ou para baixo) e procure a opÃ§Ã£o 2 - Conectitividade e pressione botÃ£o verde > Com setas procure opÃ§Ã£o 1 - USB e confirme com botÃ£o verde > Procure a opÃ§Ã£o 1 - ImportaÃ§Ã£o e pressione botÃ£o verde - opcao 3 colaboradores \r\n\r\n\r\nCONEXÃƒO SEGURA\r\n\r\nAcesse menu\r\n2 conectividade - opÃ§Ã£o 2 rede , opÃ§Ã£o 8 , ativa a conexÃ£o direta atÃ© aparecer o IP, digita o IP confirma e fecha no x\r\napos ja deve acessar via navegador\r\n\r\n','Gabriel','2018-03-02 16:13:04'),(114,'henry super facil - conexao segura','RELOGIO','Henry prisma super facil R02\r\n\r\nCaso dÃª erro ao comunicar com o rep no sistema, e ao tentar acessar pelo navegador apresente a mensagem de comunicaÃ§Ã£o direta ativa.\r\n\r\nmenu> coloque a senha 121314> opÃ§Ã£o 2 conectividade> opÃ§Ã£o 2 TCP/IP> opÃ§Ã£o 8 comunicaÃ§Ã£o direta> confirma no verde> vai aparecer o ip> aperta no \"X\" e confirma por 3x. \r\n\r\nFeito o procedimento tenta acessar no navegador novamente, se ainda estiver ativo repetir o procedimento no relogio.','Gabriel','2018-03-02 16:13:43'),(115,'henry ADV e Hexa B - erro 50','RELOGIO','verificar o numero de NSR do terminal','Gabriel','2018-03-02 16:14:58'),(116,'Madis -  executavel','RELOGIO','conseguimos fazer comunicacao com os relogios madis, verificar o modelo \r\nMD REP EVO = print point 3\r\nMD REP = Mini print\r\n\r\nseguir mesmos procedimentos desses reps dimep','Gabriel','2018-03-02 16:19:08'),(117,'Passfinger 2040 - procedimentos','RELOGIO','nao fazemos comunicaÃ§ao direta com esse relogio, so importamos afd\r\npara comunicar com rep usar programa da passfinger \"Bioconfigurador-rep\"\r\n\r\n--------------------------------------------------------------------------\r\nConfigurar IP no relogio\r\npara configurar o ip, no relogio acessa menu do relogio clicando no M/OK\r\nopÃ§ao 2.comunic\r\nopÃ§ao Rede\r\ndigirar IP, MASCARA, GATEWAY\r\nobs: porta 4370\r\n\r\n--------------------------------------------------------------------------\r\ncomo comunicar com rep Ã© preciso configurar senha \r\npara configurar a senha, no relogio acessa menu do relogio clicando no M/OK\r\nopÃ§ao 2.comunic\r\nopÃ§ao SeguranÃ§a\r\nopÃ§ao Senha de ComunicaÃ§ao\r\ndigite a senha e confirme\r\n\r\n--------------------------------------------------------------------------\r\ncadastrar biometria\r\nacessa o menu M/OK\r\n1.cadastros\r\ngerenciar \r\nselecione o funcionario\r\nva ate a opÃ§ao cad.digital\r\ncoloca a mesma digital 3 vezes e confirme no final\r\ne confirme novamente no cadastro do funcionario','Gabriel','2018-03-02 16:24:00'),(120,'Proveu Kurumin 3 - procedimentos','RELOGIO','OBSERVAÃ‡ÃƒO: CASO SISTEMA OPERACIONAL SEJA SUPERIOR A WINDOWS 7, DEVEMOS CLICAR NO ICONE DO CKREP, BOTÃƒO DIREITO DO MOUSE PROPRIEDADES,COMPATIBILIDADE DEVE SELECIONAR WINDOWS (XP) SERVICE PACK 3 , E COLOCAR PARA EXECUTAR COMO ADMINISTRADOR.\r\n\r\nCADASTRO DE RESPONSAVEL\r\nMENU >> RESPONSAVEIS >> INCLUIR RESPONSAVEL = CPF E SENHA DE ACESSO\r\nDEPOIS DE CADASTRAR DEFINIR O CPF E SENHA NO TERMINAL DO ASSEPONTO\r\n\r\n1Âº LOCALIZE O IP DO RELÃ“GIO \r\nPARA LOCALIZAR O IP DO RELÃ“GIO, EXECUTE O ARQUIVO GRP.EXE QUE ESTA NA PASTA DOS EXECUTÃVEIS DO RELÃ“GIO . O MESMO IRA LOCALIZAR O IP PARA UTILIZAR NO SISTEMA, SE DESEJAR ALTERAR CLIQUE DUAS VEZES SOBRE O MESMO.\r\n\r\n2Âº EMITA O RELATÃ“RIO DE INFORMAÃ‡Ã•ES.\r\n\r\nPRECISAMOS EMITIR O RELATÃ“RIO DE INFORMAÃ‡Ã•ES PARA CONFIRMAR O IP, VER SE A REDE ESTA ATIVA E OS RESPONSÃVEIS DE DEVEMOS DEFINIR NO EXECUTÃVEL DO RELÃ“GIO.\r\n\r\n\r\nPARA IMPRIMI-LO PRESSIONE A TECLA <MENU> E DIGITE A SENHA DE ACESSO AO MENU DO REP. SENHA PADRÃƒO FABRICA  100001 NAVEGUE NAS TECLAS <- OU -> ATÃ‰ ENCONTRAR A OPÃ‡ÃƒO \"REL. INFORMAÃ‡Ã•ES\", DEPOIS PRESSIONE <CONF> E AGUARDE SER IMPRESSO;\r\nNO ASSEPONTO UTILITÃRIOS TERMINAL, DEFINA NUMERO DE SERIE, EM HOST IP , PORTA PADRÃƒO 1818.\r\nCONFORME IMAGEM ABAIXO\r\n\r\n\r\nNA ABA EMPRESA INFORME OS DADOS DA EMPRESA\r\nNA ABA AUTENTICAÃ‡ÃƒO O RESPONSÃVEL QUE SAIU NO RELATÃ“RIO DE INFORMAÃ‡Ã•ES E A SENHA PADRÃƒO.\r\nNA SEQUENCIA PODE REALIZAR A COMUNICAÃ‡ÃƒO.\r\nSENHA PADRÃƒO PODE SER 10000001\r\n\r\n\r\n3 CADASTRAR BIOMETRIA\r\n\r\n1) PRESSIONE A TECLA <MENU>; \r\n2) DIGITE A SENHA DE ACESSO AO MENU; 100001 \r\n3) PRESSIONE A TECLA DE NAVEGAÃ‡ÃƒO PARA A ESQUERDA ATÃ‰ A OPÃ‡ÃƒO \"BIOCADASTRAMENTO\". \r\n4) PRESSIONE A TECLA <CONF>; \r\n5) A OPÃ‡ÃƒO \"INCLUIR DIGITAIS DO USUARIO\" SERÃ EXIBIDA NO DISPLAY, PRESSIONE NOVAMENTE A TECLA <CONF>; \r\n6) SERÃ EXIBIDA A MENSAGEM \"DIGITE O CRACHA DO USUARIO\". DIGITE O CRACHÃ DO USUÃRIO COM ATÃ‰ 12 DÃGITOS; \r\n7) EM SEGUIDA PRESSIONE A TECLA <CONF>; \r\n\r\n','Gabriel','2018-03-02 16:34:30'),(121,'Proveu Kurumin 2 - procedimentos','RELOGIO','OBSERVAÃ‡ÃƒO: CASO SISTEMA OPERACIONAL SEJA SUPERIOR A WINDOWS 7, DEVEMOS CLICAR NO ICONE DO CKREP, BOTÃƒO DIREITO DO MOUSE PROPRIEDADES,COMPATIBILIDADE DEVE SELECIONAR WINDOWS (XP) SERVICE PACK 3 , E COLOCAR PARA EXECUTAR COMO ADMINISTRADOR.\r\n\r\n\r\n1 verifique o Status de conexÃ£o cabo de rede numero de serie.\r\n\r\n1 RELATÃ“RIO DE INFORMAÃ‡Ã•ES REP\r\n \r\nO RelatÃ³rio de InformaÃ§Ãµes REP Ã© um relatÃ³rio que pode ser impresso na impressora do equipamento e disponibiliza as seguintes informaÃ§Ãµes: \r\nDados da empresa; dados do REP; status da MemÃ³ria de Registro de Ponto - MRP; status da MemÃ³ria de Trabalho - MT; status da bobina de pape; e status da comunicaÃ§Ã£o de rede. \r\n\r\nPara imprimi-lo pressione a tecla <Menu> e digite a senha de acesso ao menu do REP. SENHA PadrÃ£o Fabrica  100001 Navegue nas teclas <- ou -> atÃ© encontrar a opÃ§Ã£o \"Rel. InformaÃ§Ãµes\", depois pressione <CONF> e aguarde ser impresso;\r\n\r\nApÃ³s o relatÃ³rio transfira os arquivos da pasta do relÃ³gio da rede.\r\nObs: executar rep do kurumin como adm\r\nS:\\Suporte\\ASSEPONTO4\\COLETORES REPS PONTO4\\kurumim REP II \r\n\r\n2 CONFIGURANDO IP\r\n\r\n\r\nPressione a tecla <Menu> e digite a senha de acesso ao menu do REP. SENHA PadrÃ£o Fabrica  100001 Navegue nas teclas <- ou -> atÃ© encontrar a opÃ§Ã£o Configurar rede , opÃ§Ã£o 2\r\nInforme apenas IP, nÃ£o precisa configurar MASCARA E GATEWAY.\r\nA porta Interna do REP Ã© a 1818, porem precisamos informar o numero de serie e supervisor padrÃ£o 1001. \r\n\r\n3 CADASTRAR BIOMETRIA\r\n\r\n1) Pressione a tecla <MENU>; \r\n2) Digite a senha de acesso ao menu; \r\n3) Pressione a tecla de navegaÃ§Ã£o para a esquerda atÃ© a opÃ§Ã£o \"BioCadastramento\". \r\n4) Pressione a tecla <CONF>; \r\n5) A opÃ§Ã£o \"Incluir digitais do usuario\" serÃ¡ exibida no display, pressione novamente a tecla <CONF>; \r\n6) SerÃ¡ exibida a mensagem \"Digite o cracha do usuario\". Digite o crachÃ¡ do usuÃ¡rio com atÃ© 12 dÃ­gitos; \r\n7) Em seguida pressione a tecla <CONF>; \r\n\r\n\r\nPermite o envio atravÃ©s do pen drive \r\nDepois de gerar o arquivo.\r\n\r\nNo relÃ³gio acesse dados, digite a senha padrÃ£o 1001 e conecte o pen drive','Gabriel','2018-03-02 16:42:11'),(122,'RHJ - problemas de comunicacao','RELOGIO','Se o relogio estiver pingando e vc localizar o relogio no scanner\r\n\r\nsolicite para cliente apagar a senha que aparece nas CONFIGURAÃ‡Ã•ES de ip no equipamento\r\n\r\nacessa o menu do relogio\r\nNavegue com a seta da direita ate opÃ§Ã£o 3.Com  \r\nClique em M/OK\r\ndeixe a senha em branco (vai ter um asterisco, apague ele)\r\nPor ultimo vÃ¡ ate a opÃ§Ã£o de M/OK do visor \r\nClique em M/OK do teclado\r\nPronto,','Gabriel','2018-03-02 16:50:26'),(123,'SOLUCIONAR ERRO EXPRESS TOOLS 2005 SEM DESINSTALAR SQL','ERRO SQL','solution\r\n\r\nOpen Run Menu and type regedit.\r\nIniciar executar, digite regedit\r\nIt will open Registry Editor\r\nNow go to following location.\r\n(32Bit) HKEY_LOCAL_MACHINE > Software > Microsoft > Microsoft SQL Server > 90\r\n\r\neditar localizar digite:\r\nMicrosoft > Microsoft SQL Server > 90\r\n\r\napague a chave 90, depois clique no sql em executar novamente\r\n\r\nse for windows 64 bits localize \r\nMicrosoft SQL Server > 90\r\napague 90\r\n\r\n(64Bit) HKEY_LOCAL_MACHINE > Software > Wow6432Node > Microsoft > Microsoft SQL Server > 90\r\n\r\nRemove Registry Key 90.\r\n\r\nNow try to install SQL Server 2008 and it would work this time.\r\n\r\n','Gabriel','2018-03-02 16:53:13'),(124,'correcao erro 23 banco corrompido','ERRO SQL','### Tenta executar esse script direto no manager studio ###\r\n### Clicar com botao direito no banco >> ir em novo query\r\n### Troca ponto4 pelo nome do database. ###\r\n\r\nEXEC sp_resetstatus ponto4\r\nALTER DATABASE ponto4 SET EMERGENCY  \r\nDBCC checkdb (ponto4) \r\nALTER DATABASE ponto4 SET SINGLE_USER WITH ROLLBACK IMMEDIATE \r\nDBCC checkdb (ponto4, REPAIR_ALLOW_DATA_LOSS) \r\nALTER DATABASE ponto4 SET MULTI_USER\r\n\r\n','Gabriel','2018-03-02 16:53:38'),(125,'Comando para corrigir erro WMI ao executar o Configuration Manager','ERRO SQL','Executar o Prompt do dos como Administrador, e em seguida, executar os comandos abaixo\r\n\r\n1 - mofcomp %windir%\\system32\\wbem\\cimwin32.mof\r\n\r\n\r\n2 - Mofcomp \"C:\\Program Files\\Microsoft SQL Server\\100\\Shared\\sqlmgmproviderxpsp2up.mof\"\r\n\r\nou esse, pode variar de maquina e sistema operacional\r\n\r\nMofcomp \"C:\\Program Files (x86)\\Microsoft SQL Server\\100\\Shared\\sqlmgmproviderxpsp2up.mof\"\r\n\r\nLembrar sempre que o numero varia de acordo com a versÃ£o do SQL instalado\r\n\r\nMicrosoft SQL Server 2012 /  110 \r\nMicrosoft SQL Server 2008 R2 / 100 \r\nMicrosoft SQL Server 2008 / 100 \r\nMicrosoft SQL Server 2005 / 90 \r\n','Gabriel','2018-03-02 16:54:17'),(126,'falha de reiniciar na instalacao do sql','ERRO SQL','\r\nClique em Iniciar e selecione Executar. \r\nA caixa de diÃ¡logo Executar. No campo Select, digite regedit.\r\nNavegue atÃ© a seguinte chave do Registro: \r\nHKEY_LOCAL_MACHINE \\ SYSTEM \\ CurrentControlSet \\ Control \\ Session Manager \\\r\nA direita, clique com o botÃ£o PendingFileRenameOperations e selecione Excluir.\r\nRepita os passos para as seguintes chaves: \r\nHKEY_LOCAL_MACHINE \\ SYSTEM \\ ControlSet001 \\ Control \\ Session Manager \\ \r\nHKEY_LOCAL_MACHINE \\ SYSTEM \\ ControlSet002 \\ Control \\ Session Manager \\\r\nFeche o registro do Windows e no sql executar novamente.\r\nContinue com a instalaÃ§Ã£o.\r\n\r\n\r\n','Gabriel','2018-03-02 16:55:26'),(127,'comando para iniciar servico do sql pelo cmd','ERRO SQL','net start \"SQL Server (ponto4)\"','Gabriel','2018-03-02 16:56:03'),(128,'manuais do treinamento','TREINAMENTO','vc pode localizar todos manuais do treinamento na pasta \r\n\r\nS:\\Suporte\\ASSEPONTO4\\MANUAIS\\Treinamento','Gabriel','2018-03-02 16:58:03'),(129,'erro length - exportacao usb','RELOGIO','em qualquer relogio se aparecer esse erro LENGTH  ao tentar gerar um arquivo de exportacao Ã© pq esta faltando informaÃ§oes no terminal do rep\r\npode ser useario e senha ou ate mesmo Ã© preciso colocar um numero de ip FICTÃCIO.\r\n\r\napos preencher todas INFORMAÃ‡Ã•ES gere novamente o arquivo','Gabriel','2018-03-02 17:18:15'),(130,'Relogio Trilobit - Link rep1000','RELOGIO','http://www.trilobit.com.br/downloads/setup_rep1000_gerenciador.zip','NatÃ¡lia Palma','2018-03-02 20:31:00'),(131,'monstro','PARAMETROS DO SISTEMA','PRINT \'Gerando dados de Parametros\'\r\n\r\nDELETE FROM Parametros\r\nGO\r\nIF EXISTS(SELECT * FROM\r\nsys.tables AS tbl\r\nINNER JOIN sys.all_columns AS clmns ON clmns.object_id=tbl.object_id\r\nWHERE tbl.name=\'Parametros\' AND is_identity = 1) \r\n   SET IDENTITY_INSERT Parametros ON\r\nGO\r\nALTER TABLE Parametros DISABLE TRIGGER ALL\r\nGO\r\n\r\n\r\nINSERT INTO Parametros \r\n\r\n(PAR_IND,PAR_GRUPO,PAR_DESCRICAO,PAR_COD_FAIXA_EXT_MENSAL,PAR_MINDDSR,PAR_MINDDSR_DIAS,PAR_MINNOT,\r\nPAR_EVENTONOT1,PAR_EVENTOTRAB,PAR_EVENTODSR, PAR_EVENTOATR,PAR_EVENTOFALTAS,PAR_EVENTODDSR,PAR_EVENTOFERIAS,PAR_TIPOCOMPENSACAO,\r\n\r\nPAR_BCO_TIPO,PAR_BCO_LIMITE_EXT,PAR_BCO_LIMITE_EXTN,PAR_BCO_LIMITE_ATR,PAR_BCO_MAX_EXT,PAR_BCO_MAX_EXTN,PAR_BCO_MAX_ATR,PAR_BCO_NAOLANCARFALTAS,PAR_BCO_NAOLANCAREXTRAF,PAR_BCO_PCENTO_EXT,PAR_BCO_PCENTO_EXTN,PAR_BCO_PCENTO_EXTF,PAR_BCO_PCENTO_EXTNF,\r\n\r\nPAR_TIPOLANCAMENTOFALTAS,PAR_HORASFIXASLANCAR,\r\nPAR_PAGAR_DSR_EM_FERIADOS,PAR_FERIADO_PAGAR_EXTFER,PAR_FERIADO_PAGAR_EXT,PAR_UMAMARCACAOCOMOATRASO,PAR_GERARVARDEMITIDOS,PAR_FIXOLANCARDSR,PAR_EXTALEMEXTN,PAR_VALOR_DSR_FERIADO,\r\nPAR_MODO_CALCULO_DDSR,PAR_CALCULO_DDSR_EM_DIAS, PAR_EXTRAS_FAIXA,PAR_EXTRASF_FAIXA,\r\n\r\nPAR_PAGAR_NOTURNO_INTERVALO,PAR_TIPO_LANCAMENTO_TRAB,PAR_TIPO_FAIXA_EXTRA,PAR_MRC_DESCONS_FORA_FAIXA,PAR_MRC_AUTOMATICA, PAR_EMP_USAR_EMP_GRUPO) \r\n\r\nVALUES (\r\n\'5\',\'1\',\'SINDICATO\',NULL, \'0:00\',\'1\',\'01/01/1900\', \'6\',\'9\',\'10\',\'2\',\'3\',\'5\',\'19\',\'N\',\'N\',\'0:00\',\'0:00\',\'0:00\',\'0:00\',\'0:00\',\'0:00\',\r\n0,0,\'0\',\'0\',\'0\',\'0\',\'D\',\'0:00\',1,1,0,0,1,0,0,\'07:20\',\'1\',\'1\', \'1\',\'2\',0,\'M\',\'D\',NULL,NULL, 0)\r\n\r\nGO\r\n\r\nUPDATE Expedientes SET INT_MINEXT1 = \'0:10\', INT_MINEXT2 = \'0:10\', INT_MINEXT3 = \'0:10\', INT_MINEXT4 = \'0:10\',\r\nINT_MINATR1 = \'0:10\', INT_MINATR2 = \'0:10\', INT_MINATR3 = \'0:10\', INT_MINATR4 = \'0:10\'\r\n\r\nUPDATE Expedientes SET INT_COMPENSARINTERVALO = 3 WHERE\r\nINT_HV IS NULL AND INT_PERIODO_UNICO = 0 AND INT_INTERVALO_AUTO = 0\r\n\r\nUPDATE Funcionarios SET FUNC_TABPARAM = 5\r\n\r\ndeclare @TEMPO smalldatetime = \'03:00:00\',\r\n		@i int = 1\r\n\r\nwhile (exists(select INT_IND from Expedientes where INT_IND >= @i))\r\nbegin\r\n	if (exists(select INT_IND from Expedientes where INT_IND = @i and INT_TIPOTEMPO = \'F\'))\r\n	begin\r\n\r\n\r\ndeclare	@HORA1 smalldatetime = (select case when INT_HORA1 = \'1900-01-01 00:00:00\' then \'1900-02-01 00:00:00\' else INT_HORA1 end from Expedientes where INT_IND = @i),\r\n				@HORA2 smalldatetime = (select case when INT_HORA2 = \'1900-01-01 00:00:00\' then \'1900-02-01 00:00:00\' else INT_HORA2 end from Expedientes where INT_IND = @i),\r\n				@HORA3 smalldatetime = (select case when INT_HORA3 = \'1900-01-01 00:00:00\' then \'1900-02-01 00:00:00\' else INT_HORA3 end from Expedientes where INT_IND = @i),\r\n				@HORA4 smalldatetime = (select case when INT_HORA4 = \'1900-01-01 00:00:00\' then \'1900-02-01 00:00:00\' else INT_HORA4 end from Expedientes where INT_IND = @i),\r\n				@FAIXA11 smalldatetime,	@FAIXA12 smalldatetime,	@FAIXA21 smalldatetime,	@FAIXA22 smalldatetime,	\r\n				@FAIXA31 smalldatetime,	@FAIXA32 smalldatetime,	@FAIXA41 smalldatetime,	@FAIXA42 smalldatetime\r\n\r\n		set @FAIXA11 = @HORA1 - @TEMPO\r\n		set @FAIXA12 = @HORA1 + @TEMPO\r\n		set @FAIXA21 = @HORA2 - @TEMPO\r\n		set @FAIXA22 = @HORA2 + @TEMPO\r\n		set @FAIXA31 = @HORA3 - @TEMPO\r\n		set @FAIXA32 = @HORA3 + @TEMPO\r\n		set @FAIXA41 = @HORA4 - @TEMPO\r\n		set @FAIXA42 = @HORA4 + @TEMPO + @TEMPO\r\n\r\n		UPDATE Expedientes\r\n		set INT_FAIXA11 = CONVERT(SMALLDATETIME, @FAIXA11),\r\n			INT_FAIXA12 = CONVERT(SMALLDATETIME, @FAIXA12),\r\n			INT_FAIXA21 = CONVERT(SMALLDATETIME, @FAIXA21),\r\n			INT_FAIXA22 = CONVERT(SMALLDATETIME, @FAIXA22),\r\n			INT_FAIXA31 = CONVERT(SMALLDATETIME, @FAIXA31),\r\n			INT_FAIXA32 = CONVERT(SMALLDATETIME, @FAIXA32),\r\n			INT_FAIXA41 = CONVERT(SMALLDATETIME, @FAIXA41),\r\n			INT_FAIXA42 = CONVERT(SMALLDATETIME, @FAIXA42)\r\n		where INT_TIPOTEMPO = \'F\'\r\n		AND INT_IND = @i\r\n\r\n		set @i = @i + 1\r\n	end\r\n	else\r\n	begin\r\n		set @i = @i + 1\r\n	end\r\nend','Gabriel','2018-03-02 20:55:22'),(132,'erro netframework 3.5','ERRO SQL','Para resolver esse problema\r\n\r\nexecute o arquivo \"ativar netfremework 3.5 - exec como adm.bat\" como admin na maquina do cliente\r\nvc pode achar esse arquivo nesse local \"S:\\Suporte\\ASSEPONTO4\\MANUAIS\\SQL\"        na sua maquina\r\nSe o sistema pedir para reinicar digite \"N\" \r\ntente instalar o sql\r\ncaso de erro no sql reinicie o computador\r\n\r\ncaso nao de certo\r\n\r\nAcesse o Painel de controle >> Ferramentas Administrativas \r\nexecute como admin SERVIÃ‡OS \r\nprocure o serviÃ§o do Windowns Update\r\nde 2 clique, vai abrir um janela\r\naltere a opÃ§ao de desativado para automatico e de ok\r\ne execute novamente o \"ativar netfremework 3.5 - exec como adm.bat\" como admin\r\n\r\napos isso pode instalar novamente o sql','Gabriel','2018-03-05 23:19:43'),(133,'Problemas para iniciar instalacao do sql','ERRO SQL','se vc estiver com problemas para executar o instalador do sql \r\ndescompacte o instalado \r\ne instale o sql depois\r\n\r\n','Gabriel','2018-03-07 21:05:06'),(134,'Erros para iniciar sql','ERRO SQL','Codigo de cada erro ao iniciar o sql\r\n\r\nlink de acesso: https://technet.microsoft.com/pt-br/library/ms365392(v=sql.105).aspx\r\n\r\n\r\nInterpretando o cÃ³digo de erro\r\nO cÃ³digo de erro subjacente, <x>, Ã©, normalmente, aquele retornado pela camada de rede do Windows ou por uma chamada de interface SSPI (Security Support Provider Interface). No caso de cÃ³digos de erro de rede do Windows, executar o comando net helpmsg pode ajudar a interpretar o cÃ³digo. CÃ³digos de erro de SSPI nÃ£o tÃ£o fÃ¡ceis de decifrar. Talvez seja preciso pesquisar a Base de Dados de Conhecimento da Microsoft ou, se o SDK do sistema operacional estiver instalado, examinar o arquivo WinError.h.\r\nInterpretando o cÃ³digo de status do erro de protocolo\r\nOs estados de erro de protocolo do SQL Server sÃ£o listados na tabela a seguir. Observe que a maioria dos estados de erro indica uma condiÃ§Ã£o de erro interno, mas o valor especÃ­fico informa mais especificamente a Ã¡rea de protocolo em particular em que recai o erro. Por exemplo, se o valor estiver entre 7 e 30 (0x0A e 0x1 E), o erro se origina de processamento de TCP/IP. Os cÃ³digos de status na mensagem de erro sÃ£o apresentados em formato hexadecimal. A tabela a seguir fornece o equivalente decimal, a tÃ­tulo de esclarecimento.\r\nIntervalo de cÃ³digos de status em formato hexadecimal\r\nIntervalo de cÃ³digos de status em formato decimal\r\nÃrea de protocolo\r\n0x03\r\n3\r\nMemÃ³ria compartilhada\r\n0x07-0x1E\r\n7-30\r\nTCP/IP\r\n0x1F-0x23\r\n31-35\r\nConexÃ£o de administrador dedicada (DAC)\r\n0x35\r\n53\r\nPipes nomeados\r\n0x36\r\n54\r\nAdaptador de interface virtual (VIA)\r\n0x38\r\n56\r\nSSL (Secure Sockets Layer)\r\n0x40-0x4F\r\n64-79\r\nMemÃ³ria compartilhada\r\n0x50-0x5F\r\n80-95\r\nPipes nomeados\r\n0x60-0x6F\r\n96-111\r\nVIA\r\n0x70-0x7F\r\n112-127\r\nHTTP\r\n0x80-0x8F\r\n128-143\r\nSSL\r\n0x90-0x9F\r\n144-159\r\nGeral\r\nA tabela a seguir lista alguns cÃ³digos de erro comuns.\r\nCÃ³digo de status\r\nDescriÃ§Ã£o\r\n0x03\r\nErro ao iniciar suporte Ã  memÃ³ria compartilhada\r\n0x04\r\nTodos os protocolos desabilitados\r\n0x0A\r\nImpossÃ­vel inicializar o ouvinte de TCP/IP\r\n0x1C\r\nServidor configurado para escutar em um endereÃ§o de IP especÃ­fico em um ambiente de cluster\r\n0x1E\r\nEndereÃ§o de IP duplicado detectado na rede\r\n0x35\r\nErro ao iniciar suporte a pipe nomeado\r\n0x36\r\nErro ao iniciar suporte a VIA\r\n0x38\r\nErro ao obter ou usar o certificado para SSL\r\n0x3A\r\nImpossÃ­vel inicializar os ouvintes de comunicaÃ§Ã£o\r\n0x40\r\nImpossÃ­vel inicializar o ouvinte de MemÃ³ria Compartilhada\r\n0x50\r\nImpossÃ­vel inicializar o ouvinte de Pipe Nomeado\r\n0x60\r\nImpossÃ­vel inicializar o ouvinte de VIA\r\n0x70\r\nImpossÃ­vel inicializar o ouvinte de HTTP\r\n0x80\r\nImpossÃ­vel inicializar o suporte a SSL\r\nExemplos\r\nSegue um exemplo de um erro tÃ­pico que ocorre durante a inicializaÃ§Ã£o: \"Falha de inicializaÃ§Ã£o de TDSSNIClient com erro 0x80092004, cÃ³digo de status 0x38\".\r\nO valor 0x80092004 Ã© um cÃ³digo de erro de SSPI que converte para CRYPT_E_NOT_FOUND. 0x38 Ã© um cÃ³digo de erro interno que significa que a camada de comunicaÃ§Ãµes do SQL Server nÃ£o conseguiu inicializar o ouvinte. Este erro foi gerado pelo SSL porque ele nÃ£o conseguiu localizar o certificado.\r\nErros retornados quando todos os protocolos estÃ£o desabilitados\r\nPodem ocorrer os seguintes erros quando todos os protocolos estiverem desabilitados:\r\n\"Erro: 17182, Severidade: 16, Estado: 1.\"\r\n\"Falha de inicializaÃ§Ã£o de TDSSNIClient com erro 0xd, cÃ³digo de status 0x4.\"\r\n\"Erro: 17182, Severidade: 16, Estado: 1.\"\r\n\"Falha de inicializaÃ§Ã£o de TDSSNIClient com erro 0xd, cÃ³digo de status 0x1.\"\r\n\"Erro: 17826, Severidade: 18, Estado: 3.\"\r\n\"ImpossÃ­vel iniciar a biblioteca de rede devido a um erro interno na biblioteca. Para determinar a causa, consulte os erros imediatamente anteriores a esse no log de erros.\"\r\n\"Erro: 17120, Severidade: 16, Estado: 1.\"\r\n\"O SQL Server nÃ£o conseguiu gerar o thread FRunCM. Verifique o log de erros do SQL Server e os logs de eventos do Windows para obter informaÃ§Ãµes sobre possÃ­veis problemas relacionados.\"','Gabriel','2018-03-12 17:06:55'),(135,'restaurar sql - erro iniciar sql','ERRO SQL','Esse procedimento vai  restaurar o sql\r\n\r\n1 - DESCOMPACTE o sql \r\n2 - abra o cmd como adm\r\n3 - execute o comando \"cd C:\\sqlexprtmp\"\r\n4 - EXECUTE O COMANDO \"Setup.exe /q /ACTION=Repair /INSTANCENAME=ponto4\"\r\n\r\nobs: vc pode alterar de \"ponto4\" para o nome da instancia ','Gabriel','2018-03-12 17:35:23'),(136,'SOLUCIONAR ERRO EXPRESS TOOLS sql 2005 SEM DESINSTALAR SQL','ERRO SQL','na maquina do cliente abre o executar \"win + R\"\r\ndigite regedit\r\n\r\nvai abrir o registro do win\r\n\r\nentre na pasta MICROSOFT SQL SERVER seguindo o caminho a baixo\r\n\r\nHKEY_LOCAL_MACHINE > Software > Microsoft > Microsoft SQL Server > 90\r\n\r\napague a pasta 90, depois clique no sql em executar novamente\r\n\r\nse for windows 64 bits localize \r\nMicrosoft SQL Server > 90\r\napague 90\r\n\r\nHKEY_LOCAL_MACHINE > Software > Wow6432Node > Microsoft > Microsoft SQL Server > 90\r\n\r\nAPAGUE A PASTA 90, DEPOIS CLIQUE NO SQL EM EXECUTAR NOVAMENTE\r\n\r\n','Gabriel','2018-03-13 22:58:28'),(138,'portas dos relogios','RELOGIO','Athos StarRep	 		Porta: 2101\r\nControlIDX 	 		Porta: 1818\r\nControlIDClass 			Porta: 443\r\nFamilia Dimep    		Porta: 3000\r\nElgin-ZPM	 		Porta: 5000\r\nFamilia Gertec 	 		Porta: 5290\r\nFamilia Henry 	 		Porta: 3000\r\nIddata 		 		Porta: 7000\r\nProveu-Kurumim Rep NT/ Rep II  	Porta: 1818\r\nRHJ 		 		Porta: 4370\r\nTopData-InnerRepPlus 		Porta: 0\r\nTrilobit 			Porta: 19001\r\nTrix â€“ REP100/200		Porta: 4370\r\nTrix â€“ XREP520 			Porta: Vazia\r\n','aline carvalho','2018-03-14 18:10:23'),(139,'InclusÃ£o de marcaÃ§Ã£o','ROTINAS DE TRATAMENTO','Seleciona o dia > BOTÃƒO direito > INCLUSÃƒO de marcaÃ§Ãµes > coloca o HORÃRIO que deseja e o motivo','aline carvalho','2018-03-14 18:21:26'),(140,'Justificar','ROTINAS DE TRATAMENTO','seleciona o dia > BOTÃƒO direito> justificar > coloca a descriÃ§Ã£o (motivo) > seleciona o tempo a ser justificado > ok','aline carvalho','2018-03-14 18:24:36'),(141,'Relogio RHJ - cadastro de adm','RELOGIO','CADASTRAR ADMINISTRADOR PELO ASSEPONTO\r\n\r\nSeleciona o funcionario >> menu funcionario >> registro eletronico >> aba documentos >> digita o cpf do funcionario\r\nacessa o terminal >> seleciona o relogio >> seleciona o funcionario >> clica com botao direito no nome dele >> clica na opÃ§ao \"Definir como Administrador\"\r\nentao envia o funcionario para o relogio\r\ndepois \r\n\r\nVai ate o Relogio\r\nClique no botÃ£o M/OK\r\nCPF: 53688778626 (pode ser quaquer cpf valido)	Senha: Deixe em Branco (caso apareÃ§a erro de senha coloque senha 123456)\r\nClique em M/OK\r\nNavegue com as setas ate USUARIO\r\nGerenciar usuÃ¡rios \r\nSelecione o funcionÃ¡rio que foi enviado como admin \r\nNavegue com a seta para baixo ate a opÃ§ao de M/Ok e confirme\r\n\r\npronto admin cadastrado\r\n\r\n______________________________________________________________________________________________\r\n\r\nCADASTRAR ADMINISTRADOR PELO RELOGIO\r\n\r\nClique no botÃ£o M/OK\r\nCPF: 53688778626 	Senha: Deixe em Branco (caso apareÃ§a erro de senha coloque senha 123456)\r\nClique em M/OK\r\nNavegue com as setas ate USUARIO\r\nGerenciar usuÃ¡rios \r\nSelecione o funcionÃ¡rio \r\nVa na opÃ§Ã£o Privilegio utilizando seta p/ baixo e altere para Administrador utilizando a seta p/ direita\r\nTodos os funcionÃ¡rios que estiver como administrador Ã© obrigatÃ³rio preencher o campo CPF e SENHA \r\nAnotar o numero de ID e Senha\r\nEntÃ£o por final confirma no M/OK\r\nEntÃ£o toda vez que for acessar o Menu do relÃ³gio vai solicitar para administrador se identificar  \r\nPasse a biometria cadastrada no leito ou digite o numero de ID do cadastro do usuÃ¡rio\r\nVai um campo com o numero de id do funcionÃ¡rio, vc confirmando vai pedir a senha cadastrada.\r\nInsira a senha e confirme no M/OK','Gabriel','2018-03-14 20:33:25'),(142,'Cadastrar novo funcionario','ROTINAS DE TRATAMENTO','vai no menu funcionario, novo;\r\n  preenche os dados em todas as abas;\r\n  GERAL, APONTAMENTO, HORARIOS, CRACHAS E TERMINAL;\r\n  em Geral vai preencher os dados do funcionario;\r\n  em Apontamento vc vai seleciona a tabela de paramentros (Sindicato), e o valor do DSR de 7:20;\r\n  Em horarios, vai selecionar os horarios fixos do funcionario;\r\n  em principal( que Ã© usado de segunda a Sexta), no sabado e domingo ( caso haja expediente nesses dias);\r\n  vai em Crachas e clica em associar cracha ;\r\n  define um numero para o funcionario (pode ser aleatorio caso nao tenha cartao de cracha) depois vai coloca no campo inicio a data de admissao;\r\n  vai em Terminal e clica em definir terminal, seleciona o relogio e clica em ok\r\n  depois pode concluir o cadastro no sistema.\r\n  e sera necessario enviar o cadastro para o relogio de ponto.','aline carvalho','2018-03-15 17:20:10'),(144,'Erro WMI ao executar o Configuration Manager','ERRO SQL','Executar o Prompt do dos como Administrador, e em seguida, executar os comandos abaixo\r\n\r\n1 - mofcomp %windir%\\system32\\wbem\\cimwin32.mof\r\n\r\n\r\n2 - Mofcomp \"C:\\Program Files\\Microsoft SQL Server\\100\\Shared\\sqlmgmproviderxpsp2up.mof\"\r\n\r\nou esse, pode variar de maquina e sistema operacional\r\n\r\nMofcomp \"C:\\Program Files (x86)\\Microsoft SQL Server\\100\\Shared\\sqlmgmproviderxpsp2up.mof\"\r\n\r\nLembrar sempre que o numero varia de acordo com a versÃ£o do SQL instalado\r\n\r\nMicrosoft SQL Server 2012 /  110 \r\nMicrosoft SQL Server 2008 R2 / 100 \r\nMicrosoft SQL Server 2008 / 100 \r\nMicrosoft SQL Server 2005 / 90 \r\n','Gabriel','2018-03-19 16:39:01'),(146,'Definir expediente alternativo','ROTINAS DE TRATAMENTO','fOLGA: seleciona o dia/ botao direito / definir expediente alternativo/ e marca a opÃ§Ã£o folga.\r\n\r\nhORARIO:  seleciona o dia/ botao direito / definir expediente alternativo/seleciona o horario e a definiÃ§Ã£o do dia\r\n','ALINE CARVALHO','2018-03-22 22:15:29'),(147,'Desconsiderar marcarÃ§Ãµes','ROTINAS DE TRATAMENTO','seleciona o dia/ botao direito/ desconsiderar marcaÃ§Ãµes/ seleciona a marcaÃ§Ã£o que deseja desconsiderar e inclui o motivo','ALINE CARVALHO','2018-03-22 22:16:54'),(148,'eaccessviolation in module - ERRO ao abrir ponto','CRIAR ESTACAO','quando der erro eaccessviolation in module ao iniciar o asseponto4\r\nvc deve configurar nas propriedade do executavel modulo de compatibilidade \r\nmarcando essa opÃ§ao e deixando para executar como win xp\r\n\r\napos da ok, o sistema vai  iniciar normalmente\r\n\r\n','Gabriel','2018-03-23 18:05:43'),(150,'erro instalacao sql - Nome do parÃ¢metro: SQLWriter','ERRO SQL','se acontecer esse erro instalar o sql 2012\r\n\r\nerro: \r\nCannot find service {0}.\r\nNome do parÃ¢metro: SQLWriter\r\n','Gabriel','2018-03-28 20:37:59'),(151,'int32','RELOGIO','Erro \"VALOR ERA MUITO GRANDE OU MUITO PEQUENO PARA INT32\" no RELÃ“GIO control id ao tentar enviar o FUNCIONÃRIO.\r\n\r\ntrocar a numeraÃ§Ã£o que esta sendo definida no crachÃ¡ dentro do cadastro do FUNCIONÃRIO, sempre utilizar o s: ou o w: em ultima opÃ§Ã£o o a:','NatÃ¡lia Palma','2018-03-29 16:01:08'),(152,'dimep - PRINT POINT iii- Configurar RSA','RELOGIO','1Âº Exportar do relÃ³gio o arquivo chave rsa atravÃ©s da USB.\r\nEste arquivo deve estar na pasta com os executÃ¡veis e dlls atualizados da pasta Dimep printpoint III.\r\nPressione f1+45 depois informe o supervisor e senha\r\nOpÃ§Ã£o exportar RSA pressione enter e conecte o pen drive na usb de dados na parte de baixo do relÃ³gio.\r\nDepois copiar do pen drive para a pasta dos executÃ¡veis.\r\n','ALINE CARVALHO','2018-04-03 16:05:13'),(153,'Verificar VALIDADE DO NÂº DE PIS','UTILIDADES','Para verificar a validade do pis, acesse o link:\r\n\r\nhttp://www.evalido.com.br/Pis.aspx\r\n','marcelo','2018-04-03 21:37:29'),(154,'LINK DE ACESSO REMOTO AO SUPORTE','UTILIDADES','Acesso remoto SUPORTE\r\nhttps://secure.corporate.beanywhere.com/integration/integration2.php?uid=20ea03c4-63cc-11e2-b330-1231392ccdf2|2604','MARCELO','2018-04-03 21:38:46'),(155,'LINK DE ACESSO REMOTO Ã IMPLANTAÃ‡ÃƒO','UTILIDADES','Acesso remoto IMPLANTAÃ‡ÃƒO\r\nhttps://secure.corporate.beanywhere.com/integration/integration2.php?uid=20ea03c4-63cc-11e2-b330-1231392ccdf2|774','MARCELO','2018-04-03 21:39:16'),(156,'Link de download net framework 4','UTILIDADES','http://www.microsoft.com/pt-br/download/details.aspx?id=17851','marcelo','2018-04-03 21:43:03'),(157,'Link de download SQL EXPRESS 2014','UTILIDADES','https://www.microsoft.com/pt-br/download/details.aspx?id=42299','marcelo','2018-04-03 21:44:07'),(158,'Link de download SQL EXPRESS 2012','UTILIDADES','https://www.microsoft.com/pt-BR/download/details.aspx?id=43351','marcelo','2018-04-03 21:44:19'),(159,'Link de download SQL EXPRESS 2008','UTILIDADES','http://www.microsoft.com/pt-br/download/details.aspx?id=30438','marcelo','2018-04-03 21:44:30'),(160,'ativar usuÃ¡rio administrador no windows','UTILIDADES','executar o comando no prompt de comando:\r\n\r\nnet user administrador /active:yes','MARCELO','2018-04-03 21:47:57'),(161,'DESBLOQUEAR CONTROL iD (REP BLOQUEADO)','RELOGIO','acessar o painel da fabricante\r\nhttp://painel.controlid.com.br/Login.aspx\r\n\r\nlogin: suporte@assecont.com.br\r\nSenha: 1234','MARCELO','2018-04-03 23:01:06'),(162,'video de instruÃ§Ãµes: troca de bobina CONTROL iD - id class','RELOGIO','https://www.youtube.com/watch?v=yK8gox0DeiQ','MARCELO','2018-04-03 23:02:52'),(163,'zpm r100 - alterar configuraÃ§Ãµes','RELOGIO','Para alterar IP  - \"MENU\" na lateral interior esquerda > opÃ§Ã£o \"ADMINISTRADOR\" > Senha: 111111 (seis vezes o nÂ° um ) > OpÃ§Ã£o \"REDE\" > OpÃ§Ã£o \"ConfiguraÃ§Ãµes de rede\"','marcelo','2018-04-03 23:09:38'),(164,'gertec d - excluir colaborador no relÃ³gio','RELOGIO','Pressione a seta para direita > senha: 000000 (seis vezes o nÂº zero) > Pressione a opÃ§Ã£o 6 - EXCLUI EMPREGADO > Digite o PIS e pressione Enter (PIS COM \"0\" NA FRENTE > ENTER','marcelo','2018-04-03 23:14:36'),(165,'id data - CartÃ£o Prox','RELOGIO','BotÃ£o \"TECLADO\" parte superior DIREITA > BotÃ£o \"ADM\" > OpÃ§Ã£o \"TECLADO\"  > Senha: 123456 > opÃ§Ã£o dados do trabalhador > Pesquisar por PIS > Digite o PIS e pressione editar > OpÃ§Ã£o identificaÃ§Ã£o > CARTÃƒO PROX > solicite ao funcionÃ¡rio para aproximar o cartÃ£o do lado esquerdo do relÃ³gio ao lado da bobina > voltar > salvar.','marcelo','2018-04-03 23:29:04'),(166,'id data - CartÃ£o Prox','RELOGIO','BotÃ£o \"TECLADO\" parte superior DIREITA > BotÃ£o \"ADM\" > OpÃ§Ã£o \"TECLADO\"  > Senha: 123456 > opÃ§Ã£o dados do trabalhador > Pesquisar por PIS > Digite o PIS e pressione editar > OpÃ§Ã£o identificaÃ§Ã£o > CARTÃƒO BARRAS > solicite ao funcionÃ¡rio para passar o cartÃ£o na fenda do lado direito prÃ³ximo ao numero de serie do equipamento > voltar > salvar.','marcelo','2018-04-03 23:29:40'),(167,'id data - CODIGO E SENHA','RELOGIO','BotÃ£o \"TECLADO\" parte superior DIREITA > BotÃ£o \"ADM\" > OpÃ§Ã£o \"TECLADO\"  > Senha: 123456 > opÃ§Ã£o dados do trabalhador > Pesquisar por PIS > Digite o PIS e pressione editar > OpÃ§Ã£o identificaÃ§Ã£o > CODIGO > Clique na opÃ§Ã£o e digite um cÃ³digo (SerÃ¡ usado no caso do funcionÃ¡rio nÃ£o estiver com o cartÃ£o ou com a digital prejudicada) \r\nSenha: Clique e defina a senha que serÃ¡ exigida apÃ³s o funcionÃ¡rio digitar o cÃ³digo.\r\n','marcelo','2018-04-03 23:30:59'),(168,'control idx e idclass - envio funcionario via pen drive','RELOGIO','O empregador deve estar cadastrado, cadastre diretamente no REP pressionando botÃ£o Menu > Empresa > informe os dados abaixo e pressione OK. ApÃ³s esse procedimento colocar pen drive na USB DADOS acesse no relÃ³gio Menu > Pen drive > Receber UsuÃ¡rios','MARCELO','2018-04-03 23:39:51'),(169,'zpm r100 - envio de funcionario via pen drive','RELOGIO','','','2018-04-03 23:40:22'),(170,'zpm r100 - envio de funcionario via pen drive','RELOGIO','\"MENU\" na lateral interior esquerda > opÃ§Ã£o \"ADMINISTRADOR\" > Senha: 111111 (seis vezes o nÂ° um ) > Coloca o pen drive na porta frontal prÃ³ximo ao visor','marcelo','2018-04-03 23:41:24'),(171,'gertec d - cadastro de funcionario via pen drive','RELOGIO','Inserir pen drive na usb dados lateral > No relÃ³gio pressione seta para a \"DIREITA\" > SENHA : 000000 (seis VEZES O NÂ° zero) > Escolher opÃ§Ã£o 4 entra, depois opÃ§Ã£o 1 cadastro e entra.','marcelo','2018-04-03 23:45:46'),(172,'gertec g3 - cadastro de funcionario via pen drive','RELOGIO','seta > senha 1234 > entra > OpÃ§Ã£o USB usuario, insira o pen drive na porta USB USUARIO\r\nvai enviar empregador depois empregados ','marcelo','2018-04-03 23:47:02'),(173,'id data - enviar funcionario via pen drive','RELOGIO','IDDATA\r\nBotÃ£o \"TECLADO\" parte superior DIREITA > BotÃ£o \"ADM\" > OpÃ§Ã£o \"TECLADO\"  > Senha: 123456 > opÃ§Ã£o \"USB Dados\" > OpÃ§Ã£o \"Importar usuÃ¡rios\"','MARCELO','2018-04-03 23:53:53'),(174,'cadastrar nÂºs de crachÃ¡ igual o do registro','RELOGIO','menÃº UtilitÃ¡rios > Suporte > colar o cÃ³digo: \r\n\r\n INSERT INTO Crachas (CRA_FUNC,CRA_NUMERO,CRA_DATAINICIAL,CRA_DATAFINAL) \r\nSELECT FUNC_IND, FUNC_REG, \'27/7/2011\', NULL FROM Funcionarios WHERE FUNC_DT_DEM IS NULL\r\n\r\nexecutar script','marcelo','2018-04-03 23:57:33'),(175,'alterar todos expedientes para \"compensaÃ§Ã£o de intervalo\"','RELOGIO','menÃº UtilitÃ¡rios > Suporte > colar o cÃ³digo: \r\n\r\nUPDATE Expedientes SET INT_COMPENSARINTERVALO = 1\r\n\r\nexecutar script','marcelo','2018-04-03 23:58:53'),(176,'Comando para habilitar DNS no endereÃ§o IP do terminal','RELOGIO','menÃº UtilitÃ¡rios > Suporte > colar o cÃ³digo: \r\n\r\nALTER TABLE Terminais ALTER COLUMN TRM_IP NCHAR(150)\r\n\r\n(No comando acima, o numero entre parenteses representa a quantidade de caracteres, caso seja necessÃ¡rio, aumente o mesmo)\r\n\r\nexecutar script','marcelo','2018-04-03 23:59:43'),(177,'alterar expedientes de Compensar Intervalo para PrÃ©-Assinalado','RELOGIO','menÃº UtilitÃ¡rios > Suporte > colar o cÃ³digo: \r\n\r\nUPDATE Expedientes SET INT_INTERVALO_AUTO = 1, INT_COMPENSARINTERVALO = 0 WHERE INT_COMPENSARINTERVALO = 1\r\n\r\nexecutar script','marcelo','2018-04-04 00:00:34'),(178,'definir expediente principal aos finais de semana','RELOGIO','menÃº UtilitÃ¡rios > Suporte > colar o cÃ³digo: \r\n\r\nINSERT INTO Hora (HR_FUNC, HR_TIPO, HR_DATAINICIAL, HR_HORARIO) \r\n    SELECT b.HR_FUNC, 1, b.HR_DATAINICIAL, b.HR_HORARIO FROM Hora b WHERE b.HR_TIPO = 0 AND \r\n    NOT EXISTS(SELECT * FROM Hora c WHERE c.HR_FUNC = b.HR_FUNC AND c.HR_TIPO = 1 AND c.HR_DATAINICIAL = b.HR_DATAINICIAL)\r\n\r\nINSERT INTO Hora (HR_FUNC, HR_TIPO, HR_DATAINICIAL, HR_HORARIO) \r\n    SELECT b.HR_FUNC, 7, b.HR_DATAINICIAL, b.HR_HORARIO FROM Hora b WHERE b.HR_TIPO = 0 AND \r\n    NOT EXISTS(SELECT * FROM Hora c WHERE c.HR_FUNC = b.HR_FUNC AND c.HR_TIPO = 7 AND c.HR_DATAINICIAL = b.HR_DATAINICIAL)    \r\n\r\nexecutar script','marcelo','2018-04-04 00:01:35'),(179,'alterar Tolerancias extras e atrasos para 00:10','RELOGIO','menu utilitarios > suporte\r\n\r\nUPDATE Expedientes SET INT_MINEXT1 = \'0:10\', INT_MINEXT2 = \'0:10\', INT_MINEXT3 = \'0:10\', INT_MINEXT4 = \'0:10\',\r\n INT_MINATR1 = \'0:10\', INT_MINATR2 = \'0:10\', INT_MINATR3 = \'0:10\', INT_MINATR4 = \'0:10\'\r\n\r\nexecutar script','marcelo','2018-04-04 00:04:36'),(180,'','','','','2018-04-04 16:40:14'),(181,'Erro ao anexao banco no sql','ERRO SQL','quando der erro geralmente codigo 5 ao anexar banco\r\nÃ© preciso liberar acesso das pasta do sql.\r\ndeixa privilegio de todos na pasta do sql\r\n\r\nacessando as propriedades da pasta aba de seguranca\r\nnessa aba vc pdoe adicionar privilegios total para todos.\r\n\r\nhttps://www.youtube.com/watch?v=-FTG3n1HDTU\r\n\r\napos isso vc pode anexar o banco','Gabriel','2018-04-04 20:35:08'),(182,'comando para reprocessar tabelas do pronto','UTILIDADES','executar esse comando no studio ou suporte no asseponto4\r\n\r\nUPDATE [BD]\r\n   SET [BD_VERSAO_TBL] = 150\r\n      ,[BD_VERSAO_STP] = 300\r\nGO','Gabriel','2018-04-04 21:52:32'),(183,'comunicacao direta - relogio','RELOGIO','para fazer conexao direta acesse a pasta \r\n\"S:\\Suporte\\ASSEPONTO4\\MANUAIS\\REP\\ComunicaÃ§ao direta com relogio\"\r\n\r\ntransfira os arquivos relogio.vbs e internet.vbs para maquina do cliente\r\n\r\nexecute relogio.vbs para comunicar com relogio de ponto\r\ndeixar ip do relogio 192.168.10.3 ou maior\r\n\r\nexecutar internet.vbs para voltar a maquina ao normal\r\n\r\n\r\nobs: para poder fazer comunicacao direta com os relogio Ã© preciso configurar a placa de rede da maquina manualmente, esses scripts ja estao fazendo essa configuracao, se acontecer de nao funcionar segue os passos para configurar manualmente a placa de rede\r\n\r\nhttps://www.youtube.com/watch?v=9FOWXJuuWnM\r\n\r\nlembrando que o ip da rede precisa sempre ser diferente do ip que o cliente utiliza para acessar a internet \r\n','Gabriel','2018-04-05 17:03:54'),(184,'Gerar arquivos AFDT e ACJEF','UTILIDADES','Ir nos eventos da folha e preencher o campo \"Percentual de AcrÃ©scimo %\" das horas extra 100, 50 e 70.\r\n\r\nEm UtilitÃ¡rios> ConfiguraÃ§Ã£o Arquivo de MarcaÃ§Ãµes, preencher o nÃºmero de sÃ©rie do REP.\r\n\r\nEm Apontamento> Arquivos da Portiaria 1510 e gerar os arquivos.\r\n\r\nOBS: O CNPJ tem que estar preenchido nas propriedades da empresa ou do departamento. Caso o cliente queria o arquivo sÃ³ de um dos departamentos, selcionar o departamento (que tambÃ©m tem que estar com o CNPJ preenchido) e gerar o arquivo.','Alessandro sena','2018-04-19 15:09:16'),(186,'Backup pelo ponto4','UTILIDADES','Criar uma pasta na unidade C: ou documentos > Menu utilitÃ¡rios > Backup > Marca a opÃ§Ã£o \"Nesta MÃ¡quina\" > Selecione o Local > Selecione a Pasta criada na unidade C: ou documentos > Realizar Backup. ','Marina','2018-04-26 15:34:03'),(187,'Id class - SessÃ£o Invalida','RELOGIO','caso acesse via navegador e exiba a mensagem sessao invalida\r\n\r\npegar os arquivos na pasta S:\\Suporte\\ASSEPONTO4\\COLETORES REPS PONTO4\\Control ID\\Control ID - IDClass\\atualizar firmware \r\ncopiar ao pen drive,  conectar no relogio , apos  acessar menu, configuracoes, mais, em sobre selecione update , depois o rep reinicia  e esta ok','marcos','2018-04-26 16:03:39'),(188,'Anti virus criar regras','UTILIDADES','LINKS PARA CRIAR REGRAS E EXCESSOES DE BLOQUEIO , ACESSO A PASTAS  DIVERSOS ANTI VÃRUS\r\n\r\nAVIRA    -  -   --  https://www.youtube.com/watch?v=lI_FPLPCBqQ  \r\n\r\nKARPESKY - --- -- https://www.youtube.com/watch?v=ZZAo8-v4r5Y\r\n\r\nAVAST -------- https://www.youtube.com/watch?v=qktyexcCHvw \r\n\r\nNORTON  ------- https://www.youtube.com/watch?v=Hznen9Cou4Q\r\n\r\nPANDA --------https://www.youtube.com/watch?v=SKxIHEpmEe8\r\n\r\nAVG -----------https://www.youtube.com/watch?v=cGgrV62pOTY\r\n\r\n','marcos','2018-04-26 18:03:32'),(189,'Anti virus criar regras','UTILIDADES','LINKS PARA CRIAR REGRAS E EXCESSOES DE BLOQUEIO , ACESSO A PASTAS  DIVERSOS ANTI VÃRUS\r\n\r\nAVIRA    -  -   --  https://www.youtube.com/watch?v=lI_FPLPCBqQ  \r\n\r\nKARPESKY - --- -- https://www.youtube.com/watch?v=ZZAo8-v4r5Y\r\n\r\nAVAST -------- https://www.youtube.com/watch?v=qktyexcCHvw \r\n\r\nNORTON  ------- https://www.youtube.com/watch?v=Hznen9Cou4Q\r\n\r\nPANDA --------https://www.youtube.com/watch?v=SKxIHEpmEe8\r\n\r\nAVG -----------https://www.youtube.com/watch?v=cGgrV62pOTY\r\n\r\n\r\nCOPIAR O LINK E COLAR NO NAVEGADOR , NAO PASSAR AO CLIENTE , VER O VIDEO E CASO ELE NAO TENHA TI REALIZAR O PROCEDIMENTO.\r\n','marcos','2018-04-26 18:04:36'),(190,'ImportaÃ§Ã£o de marcaÃ§Ãµes via rede','ROTINAS DE TRATAMENTO','Menu utilitÃ¡rios> Terminal> Seleciona o relÃ³gio> ManutenÃ§Ã£o> ImportaÃ§Ã£o de marcaÃ§Ãµes> Terminal selecionado.','Marina','2018-05-02 16:00:54'),(191,'dEFINIR DIA DE TRABALHO COMO EXTRA DIFERENTE DE 100% OU EXTRA DA SEMANA','RELOGIO','1Âº cRIAR faixa de cÃ¡lculo:\r\n- MenÃº tabelas > faixa de cÃ¡lculo > Nova faixa:\r\ndescriÃ§Ã£o - extra de \"diadasemana\" - \"porcentagem\" (Ex.: extra de sÃ¡bado - 70%)\r\nfaixa 999 - 0 - evento da porcentagem (ex.: 999 - 0 - extras 70%)\r\n\r\n2Âº criar um expediente sÃ³ de extra para este dia, nomear ele como \"extra \'dia da semana\" (ex.: extra sÃ¡bado) e na aba \"horas extras\", preencher os campos \"faixa de horas extras\" e \"faixas de horas extras em folga/feriado\" com a faixa que vocÃª criou.\r\n\r\nobs.: estas extras nÃ£o constarÃ£o na coluna extra f, pois nÃ£o se trata de extra 100%','MARCELO','2018-05-03 18:03:05'),(192,'','','','','2018-05-04 22:36:36'),(193,'Control id IDx e idclass - Procedimentos','RELOGIO','Configurar IP\r\nMenu > ConfiguraÃ§Ãµes > ConfigRede > Clicar sobre IP, digitar e fazer o mesmo para mascara de rede e gateway > Salvar\r\n\r\nBiometria\r\nMenu > UsuÃ¡rios > buscar por PIS ou nome > Clique sobre o nome >  OpÃ§Ã£o Digital > siga instruÃ§Ã£o','Gabriel','2018-05-07 20:40:24'),(194,'Henry ADV - Videos','RELOGIO','Configurando Henry Prisma SF ADV via TCP-IP (rede)\r\nhttps://www.youtube.com/watch?v=UhV2HbgaNS0\r\n\r\nCadastrar digital Prisma SF ADV\r\nhttps://www.youtube.com/watch?v=k7AHybijf7A\r\n\r\nCadastrar funcionarios Prisma SF ADV\r\nhttps://www.youtube.com/watch?v=WXdRsQGY5WA\r\n\r\nComunicando Henry Prisma ADV por pen drive\r\nhttps://www.youtube.com/watch?v=nSeEzIEs_l0\r\n\r\nRelogio Hexa ADV\r\nhttps://www.youtube.com/watch?v=tdsOIcrgpNw\r\n','Gabriel','2018-05-10 17:05:29'),(195,'Link de videos','RELOGIO','		RELOGIO CONTROL ID ID CLASS\r\n\r\nTROCA DE BOBINA\r\nhttps://www.youtube.com/watch?v=yK8gox0DeiQ\r\n\r\nCONFIGURAÃ‡ÃƒO DO RELOGIO \r\nhttps://www.youtube.com/watch?v=zYKtgKfL9_A\r\n\r\nCADASTRO DE BIOMETRIA\r\nhttps://www.youtube.com/watch?v=efMrVP4OHfY\r\n\r\nHORARIO DE VERÃƒO\r\nhttps://www.youtube.com/watch?v=6pbHgcQ_Xb4\r\n\r\n\r\n		RELOGIO CONTROL ID IDX\r\n\r\nTROCA DE BOBINA\r\nhttps://www.youtube.com/watch?v=ThdLHXTNoqU\r\n\r\nCONFIGURAÃ‡ÃƒO DO RELOGIO \r\n\r\nCADASTRO DE BIOMETRIA\r\nhttps://www.youtube.com/watch?v=FIK4uKM2f0w\r\n\r\nAJUSTAR DATA E HORA E HORARIO DE VERÃƒO\r\nhttps://www.youtube.com/watch?v=zNJsQFnEHbU\r\n\r\n\r\n		RELOGIO GERTEC MARQUE PONTO BPD\r\n\r\nTROCA DE BOBINA\r\nhttps://www.youtube.com/watch?v=igL2W2Ijr8M\r\n\r\nCONFIGURAÃ‡ÃƒO DO RELOGIO \r\nhttps://www.youtube.com/watch?v=491jaJxzWV0\r\n\r\n\r\n		RELOGIO IDDATA\r\n\r\nTROCA DE BOBINA\r\nhttps://www.youtube.com/watch?v=pXvAVjcQ_nY\r\n\r\nCONFIGURAÃ‡ÃƒO DO RELOGIO \r\nhttps://www.youtube.com/watch?v=tPvK6RvroNk\r\n\r\nCADASTRO DE BIOMETRIA\r\nhttps://www.youtube.com/watch?v=PakBRuzdGwU\r\n\r\n\r\n		RELOGIO KURUMIN\r\n\r\nTROCA DE BOBINA\r\nhttps://www.youtube.com/watch?v=bzNdUwYFSEA\r\n\r\nCADASTRO DE BIOMETRIA\r\nhttps://www.youtube.com/watch?v=jAZVVUGBsN8\r\n\r\nAJUSTAR DATA E HORA\r\nhttps://www.youtube.com/watch?v=pTPWQfjwwa0\r\n\r\nRELOGIO TOPDATA\r\nhttps://www.youtube.com/watch?v=UOFn5E-Tmz4\r\n\r\n\r\n		HENRY HEXA B\r\nHexa - Estabelecendo comunicaÃ§Ã£o TCPIP e configurando-o via webserver\r\nhttps://www.youtube.com/watch?v=sQjsqvhNwwY\r\n\r\nConectar Cabo de rede e trocar IP\r\nhttps://www.youtube.com/watch?v=k9kaMNaIGDI\r\n\r\nComo Trocar Bobina RelÃ³gio de Ponto Hexa Henry\r\nhttps://www.youtube.com/watch?v=EukimD8z9Tc\r\n\r\nCADASTRO DE BIOMETRIA HEXA HENRY\r\nhttps://www.youtube.com/watch?v=zemn0OLGOxc\r\n\r\nHORÃRIO DE VERÃƒO HEXA HENRY\r\nhttps://youtu.be/eIjxQGCGlGg\r\n\r\n\r\n		HENRY PRIMAS SUPER FACIL\r\nTrocando Bobina do Relogio de Ponto Henry Prisma Super Facil\r\nhttps://www.youtube.com/watch?v=1AzG5TgOi0U\r\n\r\nConfigurar IP Prisma Super FÃ¡cil\r\nhttps://youtu.be/8JWLLsyahJs\r\n\r\nPrisma SF - Ativando/Desativando comunicaÃ§Ã£o direta\r\nhttps://youtu.be/eKjqtq_PiFk\r\n\r\nCADASTRO DE BIOMETRIA PRISMA HENRY\r\nhttps://youtu.be/QGnYyVinBSk\r\n\r\nPrimme SF Acesso - Explicando o menu tÃ©cnico\r\nhttps://youtu.be/_P0129UUz_s\r\n\r\n\r\n		HENRY ADVANCED\r\nConfigurando Henry Prisma SF ADV via TCP-IP (rede)\r\nhttps://www.youtube.com/watch?v=UhV2HbgaNS0\r\n\r\nCadastrar digital Prisma SF ADV\r\nhttps://www.youtube.com/watch?v=k7AHybijf7A\r\n\r\nCadastrar funcionarios Prisma SF ADV\r\nhttps://www.youtube.com/watch?v=WXdRsQGY5WA\r\n\r\nComunicando Henry Prisma ADV por pen drive\r\nhttps://www.youtube.com/watch?v=nSeEzIEs_l0\r\n\r\nTrocando Bobina do Relogio de Ponto Henry Prisma Super Facil\r\nhttps://www.youtube.com/watch?v=1AzG5TgOi0U\r\n\r\n\r\n		HENRY PONTO E\r\nPonto E - Primeiro acesso e configuraÃ§Ã£o do cartÃ£o de acesso ao menu\r\nhttps://www.youtube.com/watch?v=btwc_89olWM\r\n\r\nHenry Ponto E - Cadastrando digital com biometria Swipe\r\nhttps://youtu.be/Zw7nm-kdIYM\r\n\r\nCompacto S - Troca da bobina\r\nhttps://www.youtube.com/watch?v=qjGFC1E3k2o\r\n\r\n\r\n		HENRY ORION 6\r\nOrion 6 - ExplicaÃ§Ã£o do Menu tecnico\r\nhttps://youtu.be/YLO-ZQ4-gv4\r\n\r\nIncluindo digital no Orion 6\r\nhttps://www.youtube.com/watch?v=eItT-Pj2Gzg\r\n\r\nExcluindo Digital no Orion 6\r\nhttps://www.youtube.com/watch?v=aG3yPHsQsVM\r\n\r\nTrocando bobina no REP ORION 6\r\nhttps://youtu.be/mt_oRdAd4g8\r\n			\r\n\r\n		ZPM ELGIN R100\r\nTroca Papel REP ZPM\r\nhttps://youtu.be/TyZBe2mEGdw\r\n\r\nCadastro Digital ZPM\r\nhttps://youtu.be/E9F7H7aNy8Y\r\n\r\n\r\n		ZPM BOLINHA\r\nREP ECO ZPM - DemonstraÃ§Ã£o\r\nhttps://youtu.be/6EMxHb7HXag\r\n\r\n\r\n		TRIX R100\r\nTrocando Bobina do Relogio de Ponto Trix bio rep 100\r\nhttps://youtu.be/GqjIlvigNdk\r\n\r\n\r\n		RELOGIO RHJ\r\nAdicionar UsuÃ¡rios no RHJ BIOPRINTPROX\r\nhttps://www.youtube.com/watch?v=G5vs_od5420\r\n\r\nRHJ (BIOPRINTPROX) TROCAR BOBINA\r\nhttps://youtu.be/-6PYxGTSejA\r\n\r\n\r\n		DIMEP PRINTPOINT II\r\nCadastro de biometria PrintPoint II\r\nhttps://youtu.be/f-9sdW9gFkw\r\n\r\nTroca bobina relogio\r\nhttps://youtu.be/-XO4W1AFuvA\r\n\r\n\r\n		DIMEP PRINTPOINT III\r\nCadastrar Pessoas no PrintPoint III\r\nhttps://youtu.be/kaBeVoFWj2A\r\n\r\nExportaÃ§Ã£o de chave RSA do RelÃ³gio de Ponto PrintPoint III\r\nhttps://youtu.be/Bwr6GXEui98\r\n\r\n\r\n\r\n\r\n','Gabriel','2018-05-10 22:37:18'),(196,'HENRY ADVANCED - CONEXAO SEGURA','UTILIDADES','HENRY ADVANCED\r\n\r\nCaso dÃª erro ao comunicar com o rep no sistema, e ao tentar acessar pelo navegador apresente a mensagem de comunicaÃ§Ã£o direta ativa.\r\n\r\nmenu do relogio > ComunicaÃ§Ã£o >TCP/IP> AvanÃ§ado> conexao segura > Desativar opÃ§Ã£o\r\n\r\nFeito o procedimento tente acessar no navegador novamente, se ainda estiver ativo repetir o procedimento no relogio.','Camila diniz','2018-05-16 22:00:08'),(197,'Iniciar automaticamente o serviÃ§o do sql','ERRO SQL','Tutorial\r\n\r\nJogar o arquivo \"iniciar SQL.bat\" na pasta do asseponto e criar um atalho, botao direito > criar atalho\r\nArquivos estao na pasta \"S:\\Suporte\\ASSEPONTO4\\iniciar serviÃ§o sql automaticamente\"\r\n\r\n\r\nJogar atalho na pasta\r\n%appdata%\\microsoft\\windows\\start menu\\programs\\startup\r\n\r\nClicar com botao diteito no atalho> Ir em propriedades> na aba atalho clicar em avanÃ§ado> marcar executar como administrador>ok\r\n\r\n\r\nOBS: Instancia tem que estar com nome \"ponto4\".\r\nCaso esteja com nome diferente clicar com botao direito no arquivo \"iniciar SQL\" e editar\r\nalterar onde esta como ponto4 para o nome da instancia.','Alessandro sena','2018-05-29 15:16:31'),(199,'INICIar instancia do sql com problemas','ERRO SQL','Nos casos que a instancia do sql nÃ£o inicia, siga os passos abaixo\r\n\r\nInicie como adm o SQL SERVER CONFIGURATION MANAGER\r\n \r\nAcesse as PROPRIEDADES da instancia\r\n \r\nMarque a opÃ§ao ESTA CONTA: \r\nEm nome da conta digite o usuario administrador da maquina ou em procurar selecione o usuario\r\nEm senha digite a senha do usuario administrador da maquina \r\n \r\n\r\nApÃ³s esse procedimento de ok e inicie a instancia normalmente\r\n\r\nOBS: se nao tiver usuario administrador na maquina vc pode ativar o administrador E ALTERAR A SENHA com o comando abaixo, \r\nnet user administrador /active:yes\r\nnet user Administrador 123\r\n\r\na senha que vai ficar configurada Ã© 123','Gabriel','2018-06-08 23:52:21'),(200,'treinamento pelo smartphone','TREINAMENTO','Ã‰ POSSÃVEL ativar o ÃUDIO dentro da sala de treinamento pelo Smartphone (ios ou android)\r\nVÃ ate a loja de aplicativos do seu smartphone e digite: join-me\r\nselecione o aplicativo e instale, apos instalar abra e coloque \"participar de uma REUNIÃƒO\" vai solicitar o CÃ“DIGO da REUNIÃƒO VOCÃŠ deve colocar o numero \"423-119-831\" e clique em  \"entre\" , coloque o nome e clique em \" solicitar de novo depois.\r\nDepois que entrar na sala clique no BOTÃƒO vermelho do auto falante na parte inferior da tela e aceite as PERMISSÃ•ES do aplicativo, com isso o ÃUDIO sera ativado e ouvira as orientaÃ§Ãµes do treinamento pelo smartphone.\r\n\r\nQualquer duvida estou a disposiÃ§Ã£o!','Aline Carvalho','2018-06-18 22:13:45'),(201,'Iddata - reiniciar rep','RELOGIO','BotÃ£o \"TECLADO\" parte superior DIREITA > BotÃ£o \"ADM\" > OpÃ§Ã£o \"TECLADO\"  > Senha: 123456 >  CONFIGREP > REINICIAR REP','Gabriel','2018-06-26 16:48:12'),(202,'instalar sp1 win7','ERRO SQL','https://www.microsoft.com/pt-BR/download/details.aspx?id=5842\r\n\r\ninstalar \r\n	\r\nwindows6.1-KB976932-X86.exe\r\n\r\nou\r\n\r\n	\r\nwindows6.1-KB976932-X64.exe','Gabriel','2018-06-28 20:27:43'),(203,'Google Drive','UTILIDADES','179.176.9.247\r\n https://drive.google.com/open?id=1HXWTCY1_gT0cTFhbTUh_J2rP_Fz8kFv9\r\nhttps://drive.google.com/open?id=1SFzbsREHB7ZM4ORqzw4g6Y-bJfj1gfJ7\r\nse precisa mudar algo la o email Ã© assecontecnologia@gmail.com\r\nsenha Assecont1973','marcos','2018-06-29 20:30:42'),(204,'Exportar funcionÃ¡rio para pendrive','RELOGIO','menu utilitÃ¡rios> terminal> seleciona o relÃ³gio> seleciona o nome do funcionÃ¡rio> menu funcionÃ¡rio> arquivo de exportaÃ§Ã£o usb> enviar funcionÃ¡rios selecionados> menu funcionÃ¡rio> abrir pasta de configuraÃ§Ã£o do terminal> copia  o arquivo da pasta e joga no pendrive.','marina','2018-07-05 17:03:01'),(205,'erro log de eventos INICIAR SERVIÃ‡O SQL','ERRO SQL','PARA RESOLVER O ERRO AO INICIAR O SERVIÃ‡O DO SQL\r\n\r\nABRA O CMD COMO ADMIN\r\n\r\nEXECUTAR COMANDO PARA ABRIR O Configuration Manager DE ACORDO COM A VERSAO:\r\nSQL Server 2008: SQLServerManager10.msc \r\nSQL Server 2012: SQLServerManager11.msc \r\nSQL Server 2014: SQLServerManager12.msc \r\nSQL Server 2016: SQLServerManager13.msc \r\nSQL Server 2017: SQLServerManager14.msc\r\n\r\nTRANSFERIR OS ARQUIVOS DA PASTA \"S:\\Suporte\\ASSEPONTO4\\CorreÃ§Ã£o erro de inicializaÃ§Ã£o do SQL\" PARA PASTA DATA DO SQL\r\n\r\nTENTE INICIAR O SERVIÃ‡O DO SQL \r\n\r\n\r\nCASO NAO FUNCIONE \r\n\r\nABRA O CMD COMO ADMIN\r\n\r\nEXECUTE OS COMANDOS:\r\nnet user administrador /active:yes\r\nnet user Administrador 123\r\n\r\nEXECUTAR COMANDO PARA ABRIR O CONFIGURATION MANAGER DE ACORDO COM A VERSAO\r\nVAI NOS SERVIÃ‡OS DO SQL\r\nENTRE NAS PROPRIEDADES DO SERVIÃ‡O\r\nMARQUE A OPÃ‡AO DE LOGIN \"ESTA CONTA\"\r\nEM NOME DA CONTA DIGITE: ADMINISTRADOR\r\nSENHA: 123\r\nDIGITE NOVAMENTE A SENHA E DE OK\r\n\r\nPROVAVELMENTE VAI DAR ALGUM ERRO, CANCELE E FECHE O CONFIGURATION MANAGER E DEPOIS ABRA NOVAMENTE PELO CMD\r\nENTRE NOVAMENTE NAS PROPRIEDADES DO SERVIÃ‡O DO SQL\r\n\r\nDIGITE SOMENTE A SENHA NOVAMENTE E CONFIRME\r\nAPOS ESSE PROCESSO INICIE O SERVIÃ‡O DO SQL\r\n\r\n\r\nCASO NAO FUNCIONE \r\nDESABILITE:\r\nPIPES NOMEADOS \r\nTCP/IP\r\nVIA\r\n\r\nHABILITE:\r\nMEMORIA COMPARTILHADA\r\n\r\nE INICIE O SERVIÃ‡O\r\n\r\n\r\nCASO NAO DE CERTO\r\n\r\nINSTALE NOVAMENTE O SQL','Gabriel','2018-07-05 23:15:12'),(206,'control id erro de empregador nÃ£o cadastrado','RELOGIO','ERRO NO ENVIO DO COMANDO\r\n192.168.0.150 13/07 10:52 A CONEXÃƒO SUBJACENTE ESTAVA FECHADA: UMA CONEXÃƒO QUE DEVERIA SER MANTIDA ATIVA FOI FECHADA PELO SERVIDOR.\r\n\r\nao apresentar este erro no sistema, enviar o empregador para o relÃ³gio. ','marina','2018-07-13 17:09:53'),(207,'Erro Nem TODOS OS PRIVILEGIOS OU GRUPOS MENCIONADOS ESTAO ATRIBUIDOS','ERRO SQL','QUANDO ACONTECER ESSE ERRO VC DEVE INSTALAR O SQL NO USUARIO ADMINISTRADOR DA MAQUINA\r\n\r\nENTÃƒO ATIVE ELE PELO CMD','Gabriel','2018-07-16 16:46:30'),(208,'Pen drive kurumin','RELOGIO','pen drive kurumin max 3\r\n\r\nAtravÃ©s da Senha PadrÃ£o\r\n1) Plugue o pen drive na porta â€œDADOSâ€;\r\n2) Pressione a tecla <DADOS>;\r\n3) Digite a senha de acesso ao menu dados;\r\n4) SerÃ¡ exibida a mensagem â€œInforme o CPFâ€, digite o seu CPF e pressione <CONF>;\r\n5) SerÃ¡ exibida a mensagem â€œATUALIZAR REPâ€, pressione <CONF>;\r\n6) Aguarde a atualizaÃ§Ã£o e ao final serÃ¡ apresentada a mensagem â€œATUALIZADO COM SUCESSOâ€;\r\n7) Remova o pen drive. ','marcos','2018-07-23 23:14:59'),(209,'RW TECH','RELOGIO','Comunicamos somente com o relogio pointline Bioprox-C\r\nexemplo de numero de serie \r\n0004300 401 0005900\r\n\r\no numero do meio dele Ã© sempre 401, 402, 403\r\n\r\n','Gabriel','2018-07-27 17:15:51'),(210,'ERRO WMI AO INICIAR INSTALAÃ‡ÃƒO DO SQL','ERRO SQL','AO INICIAR INSTALAÃ‡ÃƒO DO SQL E APRESENTAR O ERRO \"WMI\" EXECUTe UM Dos SEGUINTES SCRIPTS localizados na pasta  S:\\SUPORTE\\ASSEPONTO4\\MANUAIS\\SQL\\ERROS SQL\r\n\r\n- Erro VMI - Executar como ADM\r\n\r\n- ERRO - VMI 2 - EXECUTAR COMO ADM\r\n\r\n- bat corrigir erro WMI na instalaÃ§Ã£o do SQL\r\n\r\n\r\n','Steffany','2018-07-27 20:03:31'),(215,'RHJ - RESETAR ADM SEM CONFIG o IP','RELOGIO','Caso vc nÃ£o consiga configurar um ip para o relÃ³gio e nÃ£o tiver a senha de acesso do menu.\r\nFazer conexÃ£o direta com rep por cabo cross (pode ser um cabo normal de rede tbm)\r\nConfigurar sua maquina no ip 192.168.12.2\r\nPorque o ip padrÃ£o do relÃ³gio Ã© 192.168.12.100 ou 192.168.12.201\r\n\r\nAssim vc pode APAGAR O ADM pelo Gerenciador RHJ e acessar o menu do relogio','Gabriel','2018-07-31 20:06:31'),(216,'Erro 38 Ao Anexar o banco ','ERRO SQL','PARA RESOLVER ESSE PROBLEMA\r\n\r\nEXCLUA O ARQUIVO LOG.MDf\r\n\r\nexecute o comando no studio:\r\n\r\nEXEC sp_attach_single_file_db \r\n    @dbname = \'AdventureWorksLT2008\',\r\n    @physname = \'C:\\Program Files\\Microsoft SQL Server\\MSSQL11.SQLEXPRESS\\MSSQL\\DAT\\AdventureWorksLT2008_Data.mdf\'\r\n\r\n\r\n### Onde:\r\n### @dbname â€“ Nome do Banco de Dados\r\n### @physname â€“ DiretÃ³rio onde esta armazenado o arquivo mdf.','Gabriel','2018-07-31 20:59:18'),(217,'Comando para Criar arquivo de log LDF','ERRO SQL','EXEC sp_attach_single_file_db \r\n    @dbname = \'AdventureWorksLT2008\',\r\n    @physname = \'C:\\Program Files (x86)\\Microsoft SQL Server\\MSSQL11.SQLEXPRESS\\MSSQL\\DAT\\AdventureWorksLT2008_Data.mdf\'\r\n\r\n### Onde:\r\n### @dbname â€“ Nome do Banco de Dados\r\n### @physname â€“ DiretÃ³rio onde esta armazenado o arquivo mdf.','Gabriel','2018-07-31 21:00:24'),(218,'Henry POnto E - IP','RELOGIO','localizar ip\r\nip padrao 192.168.1.200\r\n\r\nConecte o rep na rede, na sequencia utilize o ipscan \r\npara localizar o relogio na rede com o nome de rep.\r\n\r\nApos siga o manual PARA configurar rep pela rede. \r\n\"S:\\Suporte\\ASSEPONTO4\\MANUAIS\\REP\\Henry\\Henry - E\"\r\n\r\n\r\n\r\npara cadastrar digital seguir video\r\nhttps://youtu.be/Zw7nm-kdIYM','Gabriel','2018-08-01 23:14:03'),(219,'Henry POnto E ADV - IP','RELOGIO','-------------configuraÃ§ao do ip---------------------------\r\nno relogio de ponto vai ter uma etiqueta com o numero de ip que ja esta configurado no relogio\r\nÃ© preciso conectar ele diretamente na maquina entao acessando ele por navegador vc consegue alterar o ip do relogio\r\ne ja configurar o cadastrado do usario do relogio, caso cliente for utilizar relogio conectado na rede Ã© preciso configurar via navegador o ip da rede do cliente\r\n\r\nacessando o relogio pelo navegador com Login: rep  Senha: 123456\r\n\r\nno terminal do asseponto Ã© preciso configurar o responsavel do relogio[\r\npara configurar o responsavel Ã© precisa acessar o relogio pelo navegador com Login: rep  Senha: 123456\r\nem usario Ã© preciso alterar o cadastro do usuario teste de fabrica para somente teste\r\napos salvar preenche as informaÃ§oes do usuario teste\r\n\r\nlogin:	teste\r\nsenha:	111111\r\nCPF: 	26571383063\r\n\r\n\r\n\r\n-------------Cadastrar digital no relogio------------------------------------\r\n\r\nÃ‰ preciso cadastrar o cartao master do relogio acessando ele via navegador com usuario REP senha 123456\r\nno cadastro do usuario TESTE vai ter um campo para digitar o numero do cartao (o numero esta escrito no cartao)\r\napos salvar vc pode passar o cartao no relogio\r\n\r\nbotao direito navega ate cadastra de digital\r\n\r\nbotao esquerdo para entrar na opÃ§ao\r\n\r\nnavege ate codigo e entre nessa opÃ§ao\r\n\r\ncom a seta para esqueda vc vai poder mudar os ZEROS da tela para outros numeros e com o botao direito muda a casa do numero\r\n\r\nassim que que conseguir digitar todos os numero do cracha so ir com o botao direito na ultima casa\r\n\r\nentao vai solicitar para cadastrar a digital\r\n\r\napos cadastrar a digital vai parecer na tela se gostaria de incluir uma nova digital ou nao, so seleciona a opÃ§ao desejada e dar ok\r\n\r\n\r\n\r\ncaso tenha duvidas esse video explica como fazer o procedimento\r\nhttps://www.youtube.com/watch?v=Zw7nm-kdIYM\r\n','Gabriel','2018-08-01 23:16:22'),(220,'TRIX REP520 CADASTRO DE BIOMETRIA','CADASTRO DE FUNCIONARIO','APÃ“S O ENVIO DO FUNCIONÃRIO PARA O REP, VÃ ATÃ‰ o REP digite a matricula + <#>, o display exibirÃ¡ a mensagem\r\nâ€œCOLOQUE O DEDO E AGUARDEâ€, entÃ£o coloque o dedo no sensor\r\ne aguarde a mensagem â€œCADASTRADO COM SUCESSOâ€. ','CAMILA DINIZ','2018-08-02 20:56:56'),(221,'Iddata - Suporte','RELOGIO','ASSISTÃŠNCIA TÃ‰CNICA ESPECIALIZADA E MANUTENÃ‡Ã•ES\r\nwww.gigadata.com.br\r\n\r\nTELEFONE: (41)  3023-5676\r\n \r\n\r\nINFORMAÃ‡Ã•ES: GIGADATA@GIGADATA.COM.BR','Gabriel','2018-08-29 22:06:53'),(222,'Assefin - Problemas do Win 7','UTILIDADES','https://atendimento.tecnospeed.com.br/hc/pt-br/articles/360006620194-Erro-de-suporte-a-canal-seguro\r\n\r\nseguir passos do link','Gabriel','2018-08-30 16:40:55'),(223,'MUDAR SENHA WEB ID CLASS','RELOGIO','FAZER O SEGUINTE PROCEDIMENTO DIRETO NO RELÃ“GIO:\r\n\r\nmenu > configuraÃ§Ãµes > mais > alterar senha web','CAMILA DINIZ','2018-08-30 22:37:28'),(224,'Erro instalcao - ServiÃ§os de Mecanismo de Banco de Dados * ReplicaÃ§Ã£o do SQL','ERRO SQL','Esse erro pode acontecer quando o sql nao consegue criar um usuario com o nome da instancia, \r\nNecessario instalar o sql configurando o mecanismo do banco de dados com um usario administrador\r\n\r\nna instalacao do sql, apos colocar o nome da instancia\r\nna tela de configuracao do servidor\r\n\r\naltere o usuario do \"DATABASE ENGINE\" para o administrador\r\ndigite a senha do usuario\r\ninstale normalmente o sql','Gabriel','2018-08-30 22:40:58'),(225,'Erro na instalacao - ServiÃ§os de Mecanismo de Banco de Dados * ReplicaÃ§Ã£o do SQL','ERRO SQL','Esse erro pode acontecer quando o sql nao consegue criar um usuario com o nome da instancia, \r\nNecessario instalar o sql configurando o mecanismo do banco de dados com um usario administrador\r\n\r\nna instalacao do sql, apos colocar o nome da instancia\r\nna tela de configuracao do servidor\r\n\r\naltere o usuario do \"DATABASE ENGINE\" para o administrador\r\ndigite a senha do usuario\r\ninstale normalmente o sql','Gabriel','2018-08-30 22:41:16'),(226,'ConfiguraÃ§Ã£o Dixi','RELOGIO','ConfiguraÃ§Ã£o dixi \r\n\r\nExecutÃ¡vel e configuraÃ§Ã£o do terminal no asseponto: USAR O DO HENRY ADVANCED\r\n\r\nlOGIN WEB PADRÃƒO: TESTE FABRICA SENHA: 111111\r\nlOGIN adm padrÃ£o: admin senha: 999999','Alessandro Sena','2018-09-06 17:57:40'),(227,'Erro ao acessar area do colaborador - assepontoweb','UTILIDADES','erro na pagina ao acessar a ÃREA do colaborador fazer o seguinte procedimento\r\n\r\n- acessar o sistema como gestor \r\n- acessar esse link http://www.asseponto.com.br/asseponto/updatefunc.aspx \r\n- ira aparecer um BOTÃƒO \"atualizar FUNCIONÃRIOS\" clique nesse BOTÃƒO e depois acesse a acesse a ÃREA do colaborador com o login do FUNCIONÃRIO.\r\n\r\n','steffany','2018-09-06 22:27:32'),(228,'RHJ -  ERRO -2','RELOGIO','Esse erro pode acontece quando alguma informacao no cadastro do funcionario esta errada ou ja esta cadastrada no relogio\r\ncomo pis, cracha ou ID\r\n\r\nÃ‰ precisao rever essas informaÃ§oes e enviar o funcionario novamente\r\n\r\n\r\nOBS: unica forma de mudar o id Ã© cadastrar o funcionario novamente no ponto','Gabriel','2018-09-10 15:40:28'),(229,'Senha web - rep trix 520','RELOGIO','Login: root\r\nsenha: dbps','NatÃ¡lia Palma','2018-09-11 17:19:29'),(230,'RHJ - NAO acessa o menu com adm','RELOGIO','Caso o cliente estiver tentando acessar o menu com o adm e estiver marcando o ponto\r\nÃ© pq ele nao esta clicando no M/OK\r\nsolicita para ele clicar no \r\nM/ok\r\ndigitar o id \r\nclica no M/OK\r\nDIGITAR a senha\r\nCLICA NO M/OK\r\n\r\nporem se o cliente demorar muito o relogio volta na tela inicial, entao nao pode demorar para fazer esse procedimento','Gabriel','2018-09-12 17:51:49'),(231,'RHJ - NAO acessa menu com CPF e senha em branco ou 123456','RELOGIO','no caso do cliente nao conseguir acessar o relogio com cpf e senha\r\nenviei um usuario administrador para o relogio \r\napos enviar o usuario acesse o menu do relogio com ID e senha\r\n\r\n\r\nobs: ate o  momento (12/09/18) nosso executavel do rhj nao esta enviando o primeiro usuario adm, entao Ã© preciso enviar pelo gerenciador do RHJ\r\npara informaÃ§oes sobre como utilizar o gerenciador consulte o manual na pasta de manuais\r\n','Gabriel','2018-09-12 17:59:48'),(232,'RHJ - cliente esqueceu a senha do adm e nao consegue acessar o menu','RELOGIO','Caso o cliente nao consegue acessar o menu pq esqueceu as informaÃ§oes de id e senha do usuario adm\r\nenvie outro usuario adm para o relogio e acesse o menu','Gabriel','2018-09-12 18:01:35'),(233,'RHJ -  Acessar Menu','RELOGIO','Quando o cliente clica no botao M/OK na tela inicial do relogio\r\n\r\nse aparecer para colocar o CPF e senha, quer dizer que nao tem adm cadastrado no relogio\r\n\r\nse aparecer para admin se identificar quer dizer que tem um administrador cadastrado no relogio\r\nentao o cliente pode acessar o relogio com iD e senha ou biometria\r\n','Gabriel','2018-09-12 19:16:17'),(234,'RHJ - problemas com BIOMETRIA','RELOGIO','No relogio rhj nao Ã© possivel cadastrar biometria sem administrador cadastrado no relogio\r\nentao vc deve cadastrar o adm antes das biometrias\r\n\r\nem muitos casos a biometria nao funciona, entao Ã© preciso cadastrar outra ou marca o ponto o ponto com id e senha','Gabriel','2018-09-13 17:58:50'),(235,'Configurar ip do relogio na rede','REDES','1 - VERIFICAR O NUMERO DE IP DA MAQUINA\r\n\r\n2 - TESTAR UM NUMERO DE IP DA MESMA REDE \r\nEXEMPLO: 192.168.1. = NUMERAÃ‡AO DA REDE\r\nA NUMERAÃ‡AO DO ULTIMO PONTO Ã‰ DA PC, ENTAO CADA PC TEM O SEU... \r\nSE O IP DA SUA MAQUINA FOR 192.168.1.21 \r\nPINGAR O IP 192.168.1.222 \r\n\r\n3 - SE O IP NAO ESTIVER RESPONDENDO, SOLICITE PARA O CLIENTE CONFIGURAR NO REP ESSE NUMERO\r\n\r\nCASO O IP ESTIVER RSPONDENDO TENTE OUTRO NUMERO ATE NAO RESPONDER e SOLICITE PARA O CLIENTE CONFIGURAR NO REP ESSE NUMERO','Gabriel','2018-09-14 20:17:33'),(236,'IP pinga E O RELOGIO NAO COMUNICA','REDES','______________________PROBLEMAS DE COMUNICAÃ‡AO___________________________________________________________________\r\n\r\nSE O IP ESTIVER RESPONDENDO E O RELOGIO NAO ESTIVER COMUNICANDO:\r\n\r\n1 - TENTE ACESSAR O RELOGIO PELO NAVAGADOR (CONTROL IDCLASS, RELOGIOS DA HENRY..) \r\n\r\nCASO TENHA ESSA OPÃ‡AO E VC CONSEGUIR ACESSAR, VERIFIQUE AS CONFIGURAÃ‡OES DO TERMINAL, SE TEM PROXY OU FIREWALL NA REDE\r\nNO CASO DE PROXY OU FIREWALL PEÃ‡A PARA O TI LIBERAR\r\n\r\nCASO NAO CONSIGA ACESSAR O RELOGIO POR OUTRO MEIO FORA O TERMINAL, SOLICITE PARA CLIENTE TROCAR O IP DO RELOGIO \r\nRESLIGAR E LIGAR RELOGIO\r\n\r\n\r\nOBS: AO EXECUTAR O SCANNER VERIFICAR QUAL FAIXA DE IP ESTA NO SCANNER, SE Ã‰ A MESMA DO RELOGIO\r\n\r\n','Gabriel','2018-09-14 20:19:28'),(237,'PROBLEMAS QUANDO IP NAO RESPONDE','REDES','PROBLEMAS QUANDO IP NAO RESPONDE:\r\n\r\n1 - VERIFICAR SE ICONE DE REDE DO RELOGIO ESTA ATIVO (CASO RELOGIO NAO TENHA ICONE DE REDE VERIFICAR ENTRADA DO CABO DE REDE SE TEM UMA LUZ VERDE)\r\nCASO O ICONE NAO ESTEJA ATIVO VERIFICAR CABO DE REDE, TENTAR UTILIZAR OUTRO CABO, VERIFICA SE O ROTEADOR QUE O RELOGIO ESTA CONECTADO Ã‰ O MESMO QUE O PC COM ASSEPONTO\r\n\r\n2 - CASO ICONE ESTEJA ATIVO, UTILIZAR SCANNER DE REDE QUE ESTA NA PASTA \"S:SUPORTEASSEPONTO4FERRAMENTAS - SCANNER IP - JOIMEADVANCED IP SCANNER\"\r\nAPOS TRANSFERIR PROGRAMA \"ADVANCED IP SCANNER 2.EXE\" EXECUTE E CLIQUE EM INICIAR \r\nVERIFIQUE SE APARECE O NOME DO RELOGIO NA LISTA OU NUMERO DE MAC (NUMERO DE MAC VC PODE CONSULTAR NO ARQUIVO DE TEXTO NA MESMA PASTA DO PROGRAMA)\r\n\r\n3 - CASO VC LOCALIZE O RELOGIO CONFIGURE NO TERMINAL\r\nCASO NAO LOCALIZE VERIFIQUE SE O RELOGIO ESTA CONECTADO NO MESMO ROTEADOR DA MAQUINA QUE VC ESTA CONFIGURANDO O SISTEMA E RESLIGAR E LIGAR RELOGIO\r\nPOS ISSO REPETIR O SCAN NA REDE COM ADVANCED IP SCANNER 2.EXE\r\n\r\n4 - CASO NENHUM PROCEDIMENTO ACIMA NAO DE CERTO, SOLICIQUE PARA CLIENTE VERIFICA CONEXAO DO RELOGIO COM TI\r\n\r\n\r\nOBS: AO EXECUTAR O SCANNER VERIFICAR QUAL FAIXA DE IP ESTA NO SCANNER, SE Ã‰ A MESMA DO RELOGIO','Gabriel','2018-09-14 20:21:10'),(238,'Ativar Windows UPDATE','UTILIDADES','Caso o instalador do sql apresente erro devido ao windows update estar desativado (quando windows pirata Ã© instalado o update Ã© desativado para evitar atualizaÃ§Ãµes de seguranÃ§a), segue o passo de ativaÃ§Ã£o do update.\r\n\r\nClique com a tecla do Windows +R.>\r\n\r\n>Digite services.msc e clique em OK.>\r\n\r\n>Procure por \"windows update\" (esta por ordem alfabÃ©tica, por tanto Ã© a Ãºltima opÃ§Ã£o).>\r\n\r\n>Clique duas vezes>\r\n\r\n>Tipo de inicializaÃ§Ã£o coloque automÃ¡tico>\r\n\r\n>solicitar ao cliente que reinicie o computador.\r\n\r\nSe ainda sim nÃ£o for, faÃ§a os passos a seguir:\r\n\r\nExecutar o prompt de comando como admin>\r\n\r\n> digiteos cÃ³digos a seguir:\r\n\r\nNET START WUAUSERV\r\nNET START BITS\r\nNET START CRYPTSVC\r\nNET START TRUSTEDINSTALLER\r\n\r\n(Todos os comandos devem apresentar a mensagem que foram iniciados com Ãªxito).','Alessandro Sena','2018-09-17 16:38:36'),(239,'Erro BOOLEAN','RELOGIO','para resolver esse erro, apague todos arquivos da pasta e transfira novamente','Gabriel','2018-09-17 22:37:46'),(240,'erro - api-ms-win-crt-runtime','ERRO SQL','registrar a dll API-MS-WIN-CRT-RUNTIME na maquina do cliente\r\n\r\nCOPIE A DLL PARA AS PASTAS \r\nSYSTEM32 (C:\\WINDOWS\\SYSTEM32) \r\nE \r\nSYSWOW64 (C:\\WINDOWS\\SYSWOW64)\r\n\r\nDEPOIS VC DEVE ABRIR O CMD COMO ADM\r\n\r\nDIGITE O COMANDO REGSVR32 NOME_DA_DLL.DLL\r\n\r\nONDE ESTA NOME_DA_DLL.DLL VC DEVE DIGITAR O NOME DA DLL QUE VC QUER REGISTRAR.\r\nEXEMPLO: REGSVR32 api-ms-win-core-localization-l1-2-0.dll\r\n\r\nlocal das dll:\r\n\"S:\\Suporte\\ASSEPONTO4\\INSTALADORES SQL\\ARQUIVOS AVULSOS\\ \"  api-ms-win-core-localization-l1-2-0 (64-Bit)  ou (32-BIT) ','Gabriel','2018-09-18 18:09:06'),(241,'Control ID CLASS - Alterar porta','RELOGIO','MENU>CONFIGURAÃ‡Ã•ES>CONFIG DE REDE\r\nCLICAR PORTA e altera para o valor\r\nexemplo: 1818\r\n\r\nDEPOIS CLIQUE EM SALVAR','Gabriel','2018-09-19 15:50:22'),(242,'Control ID CLASS - problema de comunicacao','RELOGIO','em algumas redes esta com problemas de comunicacao com relogio control id class\r\n\r\nsiga esse procedimento quando estiver acessando o relogio via navegador e nao consiga comunicar pelo programa\r\n\r\npara resolver podemos fazer os testes\r\n\r\n1 - testar comunicacao com programa repidclass_config.exe (que esta na pasta do control id class)\r\n2 - SOLICITAR PARA TI FAZER LIBERACAO DE PORTAS NO FIREWALL DA MAQUINA E REDE, liberar proxy, REVER RESTRIÃ‡OIES DE USARIOS OU PROGRAMAS QUE PODEM ESTAR BLOQUEANDO COMUNICACAO\r\n3 - alterar porta do relogio\r\n4 - alterar senha web\r\n5 - acessar outra maquina para testar COMUNICAÃ‡ÃƒO\r\n6 - acessar usuario administrador do WINDOWS\r\n7 - SOLICITAR PARA TI FAZER LIBERACAO DE PORTAS no firewall da maquina e rede, LIBERAR PROXY, REVER RESTRIÃ‡OIES DE USARIOS ou programas que podem estar bloqueando comunicacao\r\n\r\n','Gabriel','2018-09-19 15:57:52'),(243,'Control ID CLASS - invalid session','RELOGIO','quando acontecer esse erro desligue e ligue o relogio','Gabriel','2018-09-19 17:41:22'),(244,'achar senha login no database control','ASSEFIN','use databasecontrol\r\nSELECT [USER_EMAIL]\r\n      ,[USER_NOME]\r\n      ,[USER_ULTIMO_ACESSO]\r\n      ,[USER_PWD]\r\n      ,[USER_DESLIGAMENTO]\r\n FROM [databasecontrol].[dbo].[Users]\r\n where [USER_EMAIL] = \'email de login\'','Gabriel','2018-09-19 20:28:34'),(245,'alterar tributacao no banco de dados do cliente','ASSEFIN','UPDATE [nome do banco].[dbo].[Produtos]\r\n   SET [PRO_CFOP]=5102\r\n      ,[PRO_ICMS_CST] = 41\r\n      ,[PRO_ICMS_CSOSN]= 400\r\n      ,[PRO_PIS_CST]=\'08\'\r\n      ,[PRO_PIS_TIPO_CALCULO]=2\r\n      ,PRO_IPI_CST = \'53\'\r\n      ,[PRO_IPI_CODIGO_ENQUADRAMENTO] = 999\r\n      ,PRO_IPI_CLASSE_ENQUADRAMENTO = \'\'\r\n      ,[PRO_COFINS_CST] =\'08\'\r\n      ,[PRO_COFINS_TIPO_CALCULO] = 2\r\nGO','Gabriel','2018-09-19 20:29:11'),(246,'corrigir problema da danfe','ASSEFIN','para resolver essa questao Ã© preciso alterar as informaÃ§oes do XML na tabela: NOTAS, coluna: [NOT_XML]\r\npegue o xml na pasta do monitor e copÃ­e o conteudo, depois execute o comando no sql studio\r\n\r\nUPDATE [Notas]\r\n   SET NOT_XML = \'INFORMAÃ‡OES DENTRO DO XML\'\r\n WHERE NOT_NUMERO  = \'Numero da Nota\'\r\nGO\r\n','Gabriel','2018-09-19 20:29:36'),(247,'Control ID CLASS - alterar login web','RELOGIO','para alterar login web direto no relogio \r\n\r\nMenu >> configuraÃ§oes >> mais >> login web\r\n\r\nobs: na maioria dos casos os cliente diigitao errado ou com letras maiusculas, para nao acontecer esses problemas solicite para colocar \r\nlogin:  1 \r\nsenha: 1','Gabriel','2018-09-20 16:46:56'),(248,' \'BOOLEAN ASSEPONTOREP.MARCACOES.INTERPRETARREGISTROAFD(SYSTEM.STRING, MARCACAO BYREF)','RELOGIO','PARA RESOLVER ESSE ERRO, APAGUE TODOS ARQUIVOS DA PASTA E TRANSFIRA NOVAMENTE\r\n','Gabriel','2018-09-20 16:56:41'),(249,'BOOLEAN ASSEPONTOREP.MARCACOES.INTERPRETARREGISTROAFD(SYSTEM.STRING, MARCACAO BYREF)','RELOGIO','PARA RESOLVER ESSE ERRO, APAGUE TODOS ARQUIVOS DA PASTA E TRANSFIRA NOVAMENTE\r\n','Gabriel','2018-09-20 16:56:53'),(250,'Cadastro de funcionÃ¡rio no Asseponto4','CADASTRO DE FUNCIONARIO','para cadastrar um novo funcionÃ¡rio > clique na guia \"FuncionÃ¡rio\" > Novo\r\n\r\n1- Geral > preencher com os dados do funcionÃ¡rio\r\n2- Apontamento > Tabela de parÃ¢metros: SINDICATO > Valor do DSR: 07:20\r\nDSR: descanso semanal remunerado (todo funcionÃ¡rios tem por lei um DSR por semana)\r\n3- HorÃ¡rio > definir horÃ¡rio > sim > selecionar data inicial e HORÃRIO > ok\r\n4- CrachÃ¡s > associar crachÃ¡ > digita o nÃºmero do registro (localizado na aba \"geral\" > insira data de inÃ­cio (01/01/2000 ou DATA DE ADMISSÃƒO) > ok\r\n5- Terminal > definir terminal > clica na opÃ§Ã£o do relÃ³gio > ok > ok\r\n\r\n6- enviar o cadastro do funcionÃ¡rio para o terminal (relÃ³gio de ponto)\r\nUtilitÃ¡rios > Terminal > seleciona o Ã­cone do relÃ³gio > selecionar funcionÃ¡rio desejado > botÃ£o direito do mouse > Enviar funcionÃ¡rio para terminal selecionado\r\n7- cadastrar a biometria do funcionÃ¡rio no relÃ³gio','Adriane','2018-09-20 23:00:42'),(251,'Relatorio de diferenca de horas trabalhadas de um dia para outro','RELATORIOS','--GRUPOQUEBRA#0#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\n--LARGURA#300,40,200,80,80,120,120,120,120,100#\r\nDECLARE @DATAINICIAL SMALLDATETIME = %DATAINICIAL%,\r\n        @DATAFINAL SMALLDATETIME = %DATAFINAL%,\r\n        @DEPSELECIONADOIND INT = %DEPSELECIONADOIND%                   \r\nselect DISTINCT  EMP_NOME as Empresa, FUNC_REG as Registro, FUNC_NOME as Nome,\r\ncase when (select isnull(APO_MARCACAO1,0) from aponta where APO_MARCACAO1 is not null and (CAL_EXTRA > 0 or CAL_EXTRAn > 0 or CAL_EXTRAF >\r\n0 or CAL_EXTRANF > 0 or cal_atrb > 0) and FUNC_IND = APO_FUNC and\r\ncal_data = CONVERT(VARCHAR(30), APO_DATA - 1,103)) > 0 then cal_data end as De,\r\ncase when (select isnull(APO_MARCACAO1,0) from aponta where APO_MARCACAO1 is not null and (CAL_EXTRA > 0 or CAL_EXTRAn > 0 or CAL_EXTRAF >\r\n0 or CAL_EXTRANF > 0 or cal_atrb > 0) and FUNC_IND = APO_FUNC and\r\ncal_data = CONVERT(VARCHAR(30), APO_DATA - 1,103)) > 0 then CONVERT(VARCHAR(30), APO_DATA + 1,103) end Para,\r\n\r\nConvert(char(5), DateAdd(minute, DATEDIFF(minute,case when APO_MARCACAO8 is not null then APO_MARCACAO8 when APO_MARCACAO6 is not null then\r\nAPO_MARCACAO6 when APO_MARCACAO4 is not null then APO_MARCACAO4 when APO_MARCACAO2 is not null and APO_MARCACAO3 is null then APO_MARCACAO2\r\nend,\r\n(select APO_MARCACAO1 from aponta where APO_MARCACAO1 is not null and FUNC_IND = APO_FUNC and cal_data = CONVERT(VARCHAR(30), APO_DATA -\r\n1,103)))   \r\n, 0), 108) as Diferenca\r\n           \r\nfrom Funcionarios\r\ninner join Empresas  on EMP_IND = FUNC_EMPRESA\r\ninner join calculo  on cal_func = FUNC_IND         \r\nleft join aponta on  FUNC_IND = APO_FUNC and cal_data = apo_data                                                  \r\n\r\nwhere dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1 and (aPO_MARCACAO4 is not null or aPO_MARCACAO6 is not null or\r\naPO_MARCACAO8 is not null or aPO_MARCACAO2 is not null)and APO_MARCACAO1 is not null and cal_data >= @DATAINICIAL and cal_data <=\r\n@DATAFINAL and (CAL_EXTRA > 0 or CAL_EXTRAn > 0 or CAL_EXTRAF > 0 or CAL_EXTRANF >0 or cal_atrb > 0)\r\norder by EMP_NOME, FUNC_NOME asc','Gabriel','2018-09-20 23:54:15'),(252,'Relatorio de marcacoes, extras, desconto, noturno, saldo, dsr, feriado, folga','RELATORIOS','--GRUPOQUEBRA#1#\r\n--ORIENTACAO#paisagem#\r\n--LARGURA#70,250,180,140,50,45,50,45,50,50,45,60,50,50,50#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#1#\r\ndeclare @datainicial  nvarchar(50)                            \r\ndeclare @datafinal  nvarchar(50)\r\ndeclare @periodo nvarchar(50)\r\nset @datainicial =  %DATAINICIAL%\r\nset @datafinal = %DATAFINAL%                                \r\nset @periodo = \' APONTAMENTO: \'\r\nset @periodo +=  @datainicial\r\nset @periodo += \' - \'\r\nset @periodo += @datafinal\r\n                                                 \r\nSELECT dbo.fn_getdate(CAL_DATA) AS \'Data\', RTRIM(Func_nome)  +                       \r\n\' \' +  RTRIM(@periodo) + \'\' AS \'Desc\',emp_nome DEP,\r\n(CASE WHEN (SELECT TOP 1 dbo.fn_periodo_esta_contido(AFA_DATA1 ,AFA_DATA2,CAL_DATA, CAL_DATA)\r\nFROM Afastamentos WHERE AFA_FUNC = FUNC_IND order by\r\ndbo.fn_periodo_esta_contido(AFA_DATA1 ,AFA_DATA2,CAL_DATA, CAL_DATA) desc) = 1 THEN \'Afastado\' ELSE\r\n(CASE APO_H WHEN -990 THEN \'FOLGA\' WHEN -994 then \'FERIADO\' WHEN -999 THEN \'DSR\' else (case when apo_Hv > 0 then\r\ndbo.fn_gettimefull(apo_Hv) else\r\ndbo.fn_expediente_dia(func_ind,CAL_DATA) end) END) END) AS \'Expediente\',\r\ndbo.fn_gettimefull(APO_MARCACAO1) AS \'Entrada1\',\r\ndbo.fn_gettimefull(APO_MARCACAO2) AS \'Saida1\',                  \r\ndbo.fn_gettimefull(APO_MARCACAO3) AS \'Entrada2\',                                                           \r\ndbo.fn_gettimefull(APO_MARCACAO4) AS \'Saida2\',\r\ndbo.fn_gettimefull(APO_MARCACAO5) AS \'Entrada3\',\r\ndbo.fn_gettimefull(APO_MARCACAO6) AS \'Saida3\',\r\nCASE WHEN CAL_FALTAHORA > 0 THEN \'\' else dbo.fn_gettime5nullzero(CAL_DESCONTO) end AS Desconto,\r\nISNULL(dbo.fn_gettime5nullzero(CAL_EXTRA + CAL_EXTRAn), \'\') AS \'HE\',\r\n\r\nISNULL(dbo.fn_gettime5nullzero(CAL_EXTRAF + CAL_EXTRANF), \'\') AS \'HE Foga/Feriados\',\r\n\r\n\r\nCASE WHEN CAL_NOTURNO > 0 THEN dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_NOTURNO))) ELSE \'\' END as \'Noturno\',\r\n\r\n\r\ndbo.fn_get_banco_saldo_totalizado_dia(func_ind,CAL_DATA) AS \'Saldo\'\r\n\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\ninner join empresas on func_empresa = emp_ind\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL and cal_data >= @datainicial and CAL_DATA <= @datafinal            \r\ngroup by FUNC_NOME, CAL_DATA, CAL_TRAB,CAL_ATRB,FUNC_IND,apo_Hv,CAL_ABONO,CAL_DESCONTO,APO_H,CAL_EXTRA, \r\nCAL_EXTRAn,CAL_NOTURNO,CAL_FALTAHORA, emp_nome,\r\nAPO_MARCACAO1,APO_MARCACAO2,APO_MARCACAO3,APO_MARCACAO4,APO_MARCACAO5,APO_MARCACAO6,dbo.fn_get_banco_saldo_totalizado_dia\r\n(func_ind,CAL_DATA),CAL_EXTRAF, CAL_EXTRANF\r\nOrder By emp_nome, FUNC_NOME, CAL_DATA','Gabriel','2018-09-20 23:54:39'),(253,'Nome, Cargo, AdmissÃ£o e Horario','RELATORIOS','--LARGURA#200,200,150,200#\r\nSELECT FUNC_NOME, CAR_DESCRICAO, FUNC_DT_ADM, (SELECT TOP 1 INT_DESCRICAO FROM Hora INNER JOIN Expedientes ON INT_IND = HR_HORARIO WHERE \r\nHR_FUNC = FUNC_IND AND HR_TIPO = 0\r\nORDER BY HR_DATAINICIAL DESC) AS HORAIO\r\nFROM Funcionarios\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nWHERE FUNC_DT_DEM IS NULL AND FUNC_MARCADO_EXCLUSAO = 0\r\nORDER BY FUNC_NOME','Gabriel','2018-09-20 23:55:21'),(255,'folha potensa','RELATORIOS','--LARGURA#50,200,60,65,100,200,140,120,45,40,45,45,45,45,45,45,45,45,45,45,45,80#\r\n--DECLARE @DATAINICIO SMALLDATETIME = %DATAINICIAL%\r\n\r\nDECLARE @DATAINICIO SMALLDATETIME = \'01/09/2018\'\r\n\r\nSELECT DISTINCT FUNC_REG AS COD,FUNC_NOME \'FUNCIONARIO\',FUNC_DT_ADM AS ADM,FUNC_DT_DEM As DEM,CAR_DESCRICAO as CARGO, EMP_Nome UNIDADE, \r\n(select top 1 INt_DESCRICAO  from Expedientes INNER JOIN Hora ON HR_FUNC = FUNC_INd                  \r\nwhere HR_FUNC = FUNC_INd and INT_INd = HR_HORARIO and  HR_TIPO = 0 order by INt_DESCRICAO ASC) \'H1\',      \r\n(select top 1 INt_DESCRICAO  from Expedientes INNER JOIN Hora ON HR_FUNC = FUNC_INd              \r\nwhere HR_FUNC = FUNC_INd and INT_INd = HR_HORARIO and  HR_TIPO = 7 order by INt_DESCRICAO ASC) \'H2\',\r\n\r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_ATRB)))), \'\') AS \'CARGAH\',\r\n                                                                                                               \r\nSUM(CASE WHEN CAL_TRAB > \'6:00\' THEN 1 ELSE 0 END) as \'DIAS VR\',      \r\n\r\nSUM(CASE WHEN CAL_TRAB > 0 THEN 1 ELSE 0 END) as \'D TRAB\',\r\n\r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_TRAB)))), \'\') AS \'H Trab\',  \r\n\r\nSUM(case when CAL_ABONO > 0  THEN 1 ELSE 0 END) as AbonoD,\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_ABONO))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= @DATAINICIO AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103)\r\nand CAL_ABONO > 0),\'\') as AbonoH,\r\n\r\nSUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 ELSE 0 END) as FaltasD,\r\n\r\nSUM(CASE WHEN CAL_DDSR > 0 THEN 1 ELSE 0 END) as DDSR,\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_FALTAHORA))) FROM CALCULO                                   \r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= @DATAINICIO AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103)\r\nand CAL_FALTAHORA > 0 ),\'\') as \'FaltaH\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DESCONTO - CAL_FALTAHORA))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= @DATAINICIO AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103)\r\nAND CAL_DESCONTO - CAL_FALTAHORA > 0 ),\'\') as Atrasos,\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_NOTURNO))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= @DATAINICIO AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and (DATEPART(weekday,\r\nCAL_DATA) = 1 or DATEPART(weekday, CAL_DATA) = 7) AND CAL_NOTURNO > 0 ),\'\')  as Noturno,\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRA + CAL_EXTRAn))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= @DATAINICIO AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103)\r\nand CAL_EXTRA + CAL_EXTRAn > 0),\'\') as \'Extras\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRAF + CAL_EXTRANF))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= @DATAINICIO AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and\r\nCAL_EXTRAF + CAL_EXTRANF > 0),\'\') as \'ExtraF\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nleft JOIN Cargos ON CAR_IND = FUNC_CARGO\r\n\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1 AND FUNC_MARCADO_EXCLUSAO = 0\r\nAND CAL_DATA >= @DATAINICIO AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103)\r\n\r\ngroup by FUNC_NOME,EMP_Nome,FUNC_IND,func_reg,FUNC_DT_ADM,FUNC_DT_DEM,CAR_DESCRICAO\r\nOrder By EMP_Nome, FUNC_NOME','Gabriel','2018-09-20 23:56:02'),(256,'RelatÃ³rio Nome, Setor, Admissao, DemissÃ£o, func inativos','RELATORIOS','SELECT FUNC_NOME AS NOME, EMP_NOME AS EMPRESA, FUNC_DT_ADM AS ADMISSAO, FUNC_DT_DEM AS DEMISSAO FROM FUNCIONARIOS\r\nINNER JOIN EMPRESAS ON  FUNC_EMPRESA = EMP_IND\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nwhere dbo.fn_departamentopertencente(FUNC_EMPRESA,\r\n%DEPSELECIONADOIND%) = 1 and FUNC_DT_DEM is not null\r\nORDER BY FUNC_NOME','Gabriel','2018-09-20 23:56:30'),(257,'Relatorio de MarcaÃ§oes por cargo','RELATORIOS','--LARGURA#80,200,140,45,40,45,50,60,60,45,60,60,60,60,60,60,80#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#2#                                                                                                                            \r\nSELECT dbo.fn_getdate(CAL_DATA) AS \'Data\', FUNC_NOME \'Nome\',CAR_DESCRICAO as CARGO         \r\ndbo.fn_gettimefull(APO_MARCACAO1) AS \'Entrada1\',\r\ndbo.fn_gettimefull(APO_MARCACAO2) AS \'Saida1\',\r\ndbo.fn_gettimefull(APO_MARCACAO3) AS \'Entrada2\',                                         \r\ndbo.fn_gettimefull(APO_MARCACAO4) AS \'Saida2\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL and CAL_ATRB > 0\r\nAND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%         \r\ngroup by FUNC_NOME, CAL_DATA, FUNC_IND,APO_MARCACAO1,APO_MARCACAO2,APO_MARCACAO3,APO_MARCACAO4,\r\nOrder By CAR_DESCRICAO,FUNC_NOME, CAL_DATA','Gabriel','2018-09-20 23:59:13'),(258,'Hotas Diurnas e Noturnas na semaa e final de semana Totais- Potensa','RELATORIOS','--LARGURA#200,200,50,50,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45#\r\n--GRUPONREGISTROS#0#       \r\n--COLUNAGRUPO#0#\r\n\r\nSELECT DISTINCT EMP_Nome Empresa,FUNC_NOME \'Nome\',\r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_TRAB)))), \'\') AS \'H Trab\', \r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_ATRB)))), \'\') AS \'CargaH\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_TRAB > 0 THEN 1 ELSE 0 END) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and (DATEPART(weekday,\r\nCAL_DATA) = 2 or DATEPART(weekday, CAL_DATA) = 3 or DATEPART(weekday, CAL_DATA) = 4 or DATEPART(weekday, CAL_DATA) =\r\n5 or DATEPART(weekday, CAL_DATA) = 6) and CAL_ABONO > 0),\'\') as \'D TRAB SEG/SEXTA\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_TRAB > 0 THEN 1 ELSE 0 END) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and\r\n(DATEPART(weekday,CAL_DATA) = 1 or DATEPART(weekday, CAL_DATA) = 7) and CAL_ABONO > 0),\'\') as \'D TRAB SAB/DOM\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_ATRB > 0 THEN 1 ELSE 0 END) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and (DATEPART(weekday,\r\nCAL_DATA) = 2 or DATEPART(weekday, CAL_DATA) = 3 or DATEPART(weekday, CAL_DATA) = 4 or DATEPART(weekday, CAL_DATA) =\r\n5 or DATEPART(weekday, CAL_DATA) = 6) and CAL_ABONO > 0),\'\') as \'D ATRAB SEG/SEXTA\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_ATRB > 0 THEN 1 ELSE 0 END) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and\r\n(DATEPART(weekday,CAL_DATA) = 1 or DATEPART(weekday, CAL_DATA) = 7) and CAL_ABONO > 0),\'\') as \'D ATRAB SAB/DOM\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 ELSE 0 END) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and (DATEPART(weekday,\r\nCAL_DATA) = 2 or DATEPART(weekday, CAL_DATA) = 3 or DATEPART(weekday, CAL_DATA) = 4 or DATEPART(weekday, CAL_DATA) =\r\n5 or DATEPART(weekday, CAL_DATA) = 6) AND CAL_FALTAHORA > 0 ),\'\') as \'FaltasD SEG/SEXTA\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 ELSE 0 END) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and\r\n(DATEPART(weekday,CAL_DATA) = 1 or DATEPART(weekday, CAL_DATA) = 7) AND CAL_FALTAHORA > 0 ),\'\') as \'FaltasD SAB/DOM\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_FALTAHORA))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and (DATEPART(weekday,\r\nCAL_DATA) = 2 or DATEPART(weekday, CAL_DATA) = 3 or DATEPART(weekday, CAL_DATA) = 4 or DATEPART(weekday, CAL_DATA) =\r\n5 or DATEPART(weekday, CAL_DATA) = 6) AND CAL_FALTAHORA > 0 ),\'\') as \'FaltasH  SEG/SEXTA\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_FALTAHORA))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and\r\n(DATEPART(weekday,CAL_DATA) = 1 or DATEPART(weekday, CAL_DATA) = 7) AND CAL_FALTAHORA > 0 ),\'\') as \'FaltasH SAB/DOM\',\r\n\r\nISNULL((SELECT SUM(case when CAL_ABONO > 0  THEN 1 ELSE 0 END) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and (DATEPART(weekday,\r\nCAL_DATA) = 2 or DATEPART(weekday, CAL_DATA) = 3 or DATEPART(weekday, CAL_DATA) = 4 or DATEPART(weekday, CAL_DATA) =\r\n5 or DATEPART(weekday, CAL_DATA) = 6) and CAL_ABONO > 0),\'\') as \'ABONO SEG/SEXTA\',\r\n\r\nISNULL((SELECT SUM(case when CAL_ABONO > 0  THEN 1 ELSE 0 END) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and\r\n(DATEPART(weekday,CAL_DATA) = 1 or DATEPART(weekday, CAL_DATA) = 7) and CAL_ABONO > 0),\'\') as \'ABONO SAB/DOM\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DESCONTO - CAL_FALTAHORA))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and (DATEPART(weekday,\r\nCAL_DATA) = 2 or DATEPART(weekday, CAL_DATA) = 3 or DATEPART(weekday, CAL_DATA) = 4 or DATEPART(weekday, CAL_DATA) =\r\n5 or DATEPART(weekday, CAL_DATA) = 6) AND CAL_DESCONTO - CAL_FALTAHORA > 0 ),\'\') as \'Atrasos  SEG/SEXTA\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DESCONTO - CAL_FALTAHORA))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and\r\n(DATEPART(weekday,CAL_DATA) = 1 or DATEPART(weekday, CAL_DATA) = 7) AND CAL_DESCONTO - CAL_FALTAHORA > 0 ),\'\') as \'Atrasos SAB/DOM\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRA + CAL_EXTRAn))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and (DATEPART(weekday,\r\nCAL_DATA) = 2 or DATEPART(weekday, CAL_DATA) = 3 or DATEPART(weekday, CAL_DATA) = 4 or DATEPART(weekday, CAL_DATA) =\r\n5 or DATEPART(weekday, CAL_DATA) = 6) and CAL_EXTRA + CAL_EXTRAn > 0),\'\') as \'Extras SEG/SEXTA\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRA + CAL_EXTRAn))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and\r\n(DATEPART(weekday,CAL_DATA) = 1 or DATEPART(weekday, CAL_DATA) = 7) and CAL_EXTRA + CAL_EXTRAn > 0),\'\') as \'Extras SAB/DOM\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRAF + CAL_EXTRAnF))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and (DATEPART(weekday,\r\nCAL_DATA) = 2 or DATEPART(weekday, CAL_DATA) = 3 or DATEPART(weekday, CAL_DATA) = 4 or DATEPART(weekday, CAL_DATA) =\r\n5 or DATEPART(weekday, CAL_DATA) = 6) and CAL_EXTRAF + CAL_EXTRAnF > 0),\'\') as \'ExtrasF SEG/SEXTA\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRAF + CAL_EXTRAnF))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and\r\n(DATEPART(weekday,CAL_DATA) = 1 or DATEPART(weekday, CAL_DATA) = 7) and CAL_EXTRAF + CAL_EXTRAnF > 0),\'\') as \'Extras SAB/DOM\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_NOTURNO))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and (DATEPART(weekday,\r\nCAL_DATA) = 2 or DATEPART(weekday, CAL_DATA) = 3 or DATEPART(weekday, CAL_DATA) = 4 or DATEPART(weekday, CAL_DATA) =\r\n5 or DATEPART(weekday, CAL_DATA) = 6) AND CAL_NOTURNO > 0 ),\'\')  as \'Noturno  SEG/SEXTA\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_NOTURNO))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and\r\n(DATEPART(weekday,CAL_DATA) = 1 or DATEPART(weekday, CAL_DATA) = 7) AND CAL_NOTURNO > 0 ),\'\') as \'Noturno SAB/DOM\',              \r\n \r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRA))) as EXTRAS,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRAn))) as EXTRASN,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRAF)))  as EXTRASF,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRAnF)))  as EXTRASNF,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DESCONTO - CAL_FALTAHORA))) as ATRASOS,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_FALTAHORA))) as FALTASHORAS,\r\nSUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 ELSE 0 END) FALTASDIAS,                    \r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_ABONO))) ABONOS,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_Noturno))) NOTURNOS,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DSR))) DSR,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DDSR))) DDSR\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nleft JOIN Cargos ON CAR_IND = FUNC_CARGO\r\n\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103)\r\n\r\ngroup by FUNC_NOME,EMP_Nome,FUNC_IND\r\nOrder By EMP_Nome, FUNC_NOME','Gabriel','2018-09-20 23:59:29'),(259,'erro para instalar netframework 4.6.1','RELOGIO','caso vc esteja configurando um relogio com os EXECUTÃVEIS da web em uma maquina win 7 e solicitar para instalar o netframework 4.6.1\r\n\r\ninstale o netfrmawork 4.6.1\r\nhttps://www.microsoft.com/pt-br/download/details.aspx?id=49981\r\n\r\ncaso nao consiga instalar por causa da versao do win 7 instale a atualizacao sp1\r\nHTTPS://WWW.MICROSOFT.COM/PT-BR/DOWNLOAD/DETAILS.ASPX?ID=5842\r\n\r\nINSTALAR \r\n	\r\nWINDOWS6.1-KB976932-X86.EXE\r\nOU\r\nWINDOWS6.1-KB976932-X64.EXE\r\n\r\n\r\napos esse processo instale o netframework','Gabriel','2018-09-21 16:45:53'),(260,'erro netframework 4.6.1','RELOGIO','CASO VC ESTEJA CONFIGURANDO UM RELOGIO COM OS EXECUTÃVEIS DA WEB EM UMA MAQUINA WIN 7 E SOLICITAR PARA INSTALAR O NETFRAMEWORK 4.6.1\r\n\r\nINSTALE O NETFRMAWORK 4.6.1\r\nHTTPS://WWW.MICROSOFT.COM/PT-BR/DOWNLOAD/DETAILS.ASPX?ID=49981\r\n\r\nCASO NAO CONSIGA INSTALAR POR CAUSA DA VERSAO DO WIN 7 INSTALE A ATUALIZACAO SP1\r\nHTTPS://WWW.MICROSOFT.COM/PT-BR/DOWNLOAD/DETAILS.ASPX?ID=5842\r\n\r\nINSTALAR \r\n	\r\nWINDOWS6.1-KB976932-X86.EXE\r\nOU\r\nWINDOWS6.1-KB976932-X64.EXE\r\n\r\n\r\nAPOS ESSE PROCESSO INSTALE O NETFRAMEWORK\r\n\r\nobs: esse erro acontece pq para instalar o netframework 4.6.1 o win 7 precisa estar atualizado no min com o pack de ATUALIZAÃ‡Ã•ES sp1\r\ncaso nao estiver nao vai instalar','','2018-09-21 16:49:06'),(261,'Erro Certificado win 7','ASSEFIN','https://atendimento.tecnospeed.com.br/hc/pt-br/articles/360006620194-Erro-de-suporte-a-canal-seguro\r\n\r\nacessar site e seguir passos','Gabriel','2018-09-24 22:57:29'),(262,'Assefin - Erro do certificado no win7','ASSEFIN','Passo 1\r\n \r\nVÃ¡ atÃ© o Painel de Controle do Windows.\r\nEscolha a OpÃ§Ã£o \"OpÃ§Ãµes da Internet\";  \r\nVÃ¡ atÃ© a aba â€œAvanÃ§adasâ€;\r\nno bloco â€œConfiguraÃ§Ãµesâ€, vÃ¡ atÃ© as Ãºltimas opÃ§Ãµes;\r\nMarque: NÃ£o salvar pÃ¡ginas criptografadas em disco; \r\nMarque: Usar SSL 3.0;  \r\nDesmarque: Usar SSL 2.0;  \r\nMarque: Usar TLS 1.0;  \r\nDesmarque: Usar TLS 1.1; \r\nMarque: Usar TLS 1.2;      \r\n\r\nPasso 2\r\n \r\nFaÃ§a o download das novas cadeias certificadoras e instale\r\n\r\nAutoridade Certificadora Raiz Brasileira v5\r\nhttp://acraiz.icpbrasil.gov.br/ICP-Brasilv5.crt\r\n\r\nAutoridade Certificadora SERPRO v4\r\nhttp://acraiz.icpbrasil.gov.br/credenciadas/SERPRO/v5/p/Autoridade_Certificadora_Serpro_v4.crt\r\n\r\nAutoridade Certificadora do SERPRO Final SSL\r\nhttp://acraiz.icpbrasil.gov.br/credenciadas/SERPRO/v5/Autoridade_Certificadora_do_Serpro_Final_SSL.crt\r\n\r\nCADEIAS v5\r\nhttps://atendimento.tecnospeed.com.br/hc/pt-br/article_attachments/360008504113/Cadeias.zip\r\n\r\nna instalacao\r\nSelecione a opÃ§Ã£o \" Colocar todos os certificados no repositÃ³rio a seguir \", clique em Procurar. Em seguida, escolha a pasta \" Autoridade de CertificaÃ§Ã£o Raiz ConfiÃ¡vel\" e clique em AvanÃ§ar.\r\n\r\ninstalar netframework 4.6.1\r\n\r\nfonte: \"https://atendimento.tecnospeed.com.br/hc/pt-br/articles/360006620194-Erro-de-suporte-a-canal-seguro\"\r\nobs: somente a palavra erro COMEÃ‡A com letra maiuscula \r\n','Gabriel','2018-09-24 23:10:46'),(263,'Atualizacao Win 7 SP 2','ERRO SQL','For x64 systems (477 MB)\r\nhttp://download.windowsupdate.com/d/msdownload/update/software/updt/2016/05/windows6.1-kb3125574-v4-x64_2dafb1d203c8964239af3048b5dd4b1264cd93b9.msu\r\n\r\n\r\nFor x32 systems (316 MB)\r\n\r\nhttp://download.windowsupdate.com/d/msdownload/update/software/updt/2016/05/windows6.1-kb3125574-v4-x86_ba1ff5537312561795cc04db0b02fbb0a74b2cbd.msu\r\n\r\nsegue link para instalacao ','Gabriel','2018-09-25 16:56:30'),(264,'topdata inner rep - configuracao de porta','RELOGIO','Acessar menu >> configuraÃ§Ã£o >>  rede >> digita a senha do relogio (padrao 123456) >> modo de config >>  marca a opÃ§ao computador inicia a conexao >> salva \r\n\r\nporta padrao 0\r\n\r\n\r\n\r\ncaso nao funcione vc pode configurar para inner rep iniciar conexao\r\n\r\nACESSAR MENU >> CONFIGURAÃ‡ÃƒO >>  REDE >> DIGITA A SENHA DO RELOGIO (PADRAO 123456) >> MODO DE CONFIG >> INNER REP INICIAR CONEXAO >>  digita o ip do seu pc e uma porta para o relogio >> salva\r\n\r\n\r\natt','Gabriel','2018-09-25 20:11:35'),(265,'Apagar marcaÃ§Ãµes','COMANDOS','DELETE TODAS MARCACOES DE UM FUNCIONARIO NO DIA SELECIONADO\r\n\r\nDELETE FROM TODAS MARCACOES WHERE dbo.fn_departamentopertencente((SELECT FUNC_EMPRESA \r\nFROM Funcionarios WHERE FUNC_IND = MRC_FUNC), %DEPSELECIONADOIND%) = 1 AND  Convert(Date, MRC_DATAHORA) >= \'07/06/2018\' and MRC_FUNC = %FUNCIONARIO%\r\n\r\n////////////////////////////////////////////////////////////////////////////////////////////////////\r\n\r\nDELETE A MARCACAO ESPECIFICA DE UM FUNCIONARIO \r\n\r\nDELETE FROM MARCACOES WHERE dbo.fn_departamentopertencente((SELECT FUNC_EMPRESA \r\nFROM Funcionarios WHERE FUNC_IND = MRC_FUNC), %DEPSELECIONADOIND%) = 1 AND  MRC_DATAHORA = \'28/05/2018 09:00\' and MRC_FUNC = %FUNCIONARIO%\r\n\r\n////////////////////////////////////////////////////////////////////////////////////////////////////\r\n\r\nDELETE TODAS MARCACOES DE UM FUNCIONARIO NO PERIODO SELECIONADO\r\n\r\nDELETE FROM MARCACOES WHERE dbo.fn_departamentopertencente((SELECT FUNC_EMPRESA \r\nFROM Funcionarios WHERE FUNC_IND = MRC_FUNC), %DEPSELECIONADOIND%) = 1 AND  Convert(Date, MRC_DATAHORA) >= %DATAINICIAL% AND Convert(Date, MRC_DATAHORA) <= %DATAFINAL% and MRC_FUNC = %FUNCIONARIO%\r\n\r\n\r\n','Gabriel','2018-09-25 23:39:20'),(266,'apagar horarios associados','COMANDOS','DELETE FROM Hora from funcionarios','Gabriel','2018-09-25 23:41:55'),(267,'MARCAR COMO APONTADO TODOS DE UMA VEZ','COMANDOS','UPDATE Calculo SET CAL_APONTADO = 1 WHERE CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL% and dbo.fn_departamentopertencente((SELECT FUNC_EMPRESA FROM Funcionarios WHERE FUNC_IND = CAL_FUNC), %DEPSELECIONADOIND%) = 1','Gabriel','2018-09-25 23:42:35'),(268,'Apagar marcaÃ§oes incluidas','COMANDOS','DELETE FROM MARCACOES WHERE dbo.fn_departamentopertencente((SELECT FUNC_EMPRESA FROM Funcionarios WHERE FUNC_IND = MRC_FUNC), %DEPSELECIONADOIND%) = 1 AND MRC_DATAHORA >= %DATAINICIAL% AND MRC_DATAHORA <= %DATAFINAL% AND MRC_pis is null\r\n\r\n---------------------------------\r\n\r\nDELETE FROM MARCACOES WHERE dbo.fn_departamentopertencente((SELECT FUNC_EMPRESA FROM Funcionarios WHERE FUNC_IND = MRC_FUNC), %DEPSELECIONADOIND%) = 1 AND MRC_DATAHORA >= \'11/11/2017\' AND MRC_DATAHORA <= \'30/04/2018\' AND MRC_pis is null','Gabriel','2018-09-25 23:42:51'),(269,'Crachas com o numero de registro e departamento','COMANDOS','INSERT INTO Crachas (CRA_FUNC,CRA_NUMERO,CRA_DATAINICIAL,CRA_DATAFINAL) \r\nSELECT FUNC_IND, FUNC_REG, \'27/7/2011\', NULL FROM Funcionarios WHERE FUNC_DT_DEM IS NULL and dbo.fn_departamentopertencente(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1\r\n\r\n----------------------------------------------------------------------\r\nsomente funcionarios sem cracha\r\n\r\nINSERT INTO Crachas (CRA_FUNC,CRA_NUMERO,CRA_DATAINICIAL,CRA_DATAFINAL) \r\nSELECT FUNC_IND, FUNC_REG, \'27/7/2011\', NULL FROM Funcionarios left join crachas on cra_func = func_ind WHERE FUNC_DT_DEM IS NULL and dbo.fn_departamentopertencente(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1 and cra_func is null','Gabriel','2018-09-25 23:43:12'),(270,'comando para corrigir marcaÃ§oes que some','COMANDOS','delete from marcacoes where not exists(select * from funcionarios where func_ind = mrc_func)','Gabriel','2018-09-25 23:43:31'),(271,'reindexar sql some marcaÃ§Ã£o','COMANDOS','Antes subistituir Ponto4 pelo nome do banco do cliente \r\n___________\r\n_________________________________\r\n\r\n\r\nDECLARE @Database VARCHAR(255)  \r\nDECLARE @Table VARCHAR(255)  \r\nDECLARE @cmd NVARCHAR(500)  \r\nDECLARE @fillfactor INT\r\n \r\nSET @Database = \'Ponto4\'\r\n \r\nSET @fillfactor = 90\r\n \r\n   SET @cmd = \'DECLARE TableCursor CURSOR FOR SELECT \'\'[\'\' + table_catalog + \'\'].[\'\' + table_schema + \'\'].[\'\' +\r\n  table_name + \'\']\'\' as tableName FROM [\' + @Database + \'].INFORMATION_SCHEMA.TABLES\r\n  WHERE table_type = \'\'BASE TABLE\'\'\'  \r\n \r\n   -- create table cursor  \r\n   EXEC (@cmd)  \r\n   OPEN TableCursor  \r\n \r\n   FETCH NEXT FROM TableCursor INTO @Table  \r\n   WHILE @@FETCH_STATUS = 0  \r\n   BEGIN  \r\n \r\n       IF (@@MICROSOFTVERSION / POWER(2, 24) >= 9)\r\n       BEGIN\r\n               PRINT @TABLE\r\n           SET @cmd = \'ALTER INDEX ALL ON \' + @Table + \' REBUILD WITH (FILLFACTOR = \' + CONVERT(VARCHAR(3),@fillfactor) + \')\'\r\n           EXEC (@cmd)\r\n       END\r\n       ELSE\r\n       BEGIN\r\n               PRINT @TABLE\r\n          DBCC DBREINDEX(@Table,\' \',@fillfactor)  \r\n       END\r\n \r\n       FETCH NEXT FROM TableCursor INTO @Table  \r\n   END  \r\n \r\n   CLOSE TableCursor  \r\n   DEALLOCATE TableCursor  \r\n \r\n','Gabriel','2018-09-25 23:44:15'),(272,'Desassociar Expedientes','COMANDOS','-- todos funcionario\r\nDelete from hora\r\n\r\n-- Departamento Selecionado\r\nDelete from hora WHERE dbo.fn_departamentopertencente((SELECT FUNC_EMPRESA FROM Funcionarios WHERE FUNC_IND = hr_func), %DEPSELECIONADOIND%) = 1 \r\n\r\n-- funcionario selecionado\r\nDelete from hora where hr_func = %FUNCIONARIO% ','Gabriel','2018-09-25 23:44:30'),(273,'APAGAR TERMINAL FUNCIONARIOS','COMANDOS','delete from TerminaisFuncionarios WHERE dbo.fn_departamentopertencente((SELECT FUNC_EMPRESA FROM Funcionarios WHERE FUNC_IND = TRMF_FUNC), %DEPSELECIONADOIND%) = 1 ','Gabriel','2018-09-25 23:44:45'),(274,'Tolerancia POR MARCAÃ‡OES extras 5 minutos','COMANDOS','UPDATE Expedientes SET INT_MINEXT1 = \'0:05\', INT_MINEXT2 = \'0:05\', INT_MINEXT3 = \'0:05\', INT_MINEXT4 = \'0:05\'\r\n','Gabriel','2018-09-25 23:45:08'),(275,'reconsiderar banco de horas','COMANDOS','DELETE FROM BcoHorasDesconsiderados WHERE BCOD_DATA >= \'01/02/2018\' and dbo.fn_departamentopertencente((SELECT FUNC_EMPRESA FROM Funcionarios WHERE FUNC_IND = BCOD_FUNC), %DEPSELECIONADOIND%) = 1','Gabriel','2018-09-26 00:07:51'),(276,'DESMARCAR COMO APONTADO TODOS DE UMA VEZ','COMANDOS','UPDATE Calculo SET CAL_APONTADO = 0 WHERE CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL% and dbo.fn_departamentopertencente((SELECT FUNC_EMPRESA FROM Funcionarios WHERE FUNC_IND = CAL_FUNC), %DEPSELECIONADOIND%) = 1','Gabriel','2018-09-26 00:08:24'),(277,'Desmarcar Banco de Horas de Todos','COMANDOS','UPDATE Funcionarios SET FUNC_BCOHORAS = 0 WHERE dbo.fn_departamentopertencente((SELECT FUNC_EMPRESA FROM Funcionarios WHERE FUNC_IND = CAL_FUNC), %DEPSELECIONADOIND%) = 1','Gabriel','2018-09-26 00:08:46'),(278,'Deletar marcaÃ§oes em um dia','COMANDOS','\r\n-------Deletar em um dia--------\r\n\r\nDELETE FROM Marcacoes\r\nWHERE MRC_PIS = \'12345678912\' AND (MRC_DATAAP = \'22/03/2018\')\r\nGO\r\n\r\n-------Deletar em mais de um dia--------\r\n\r\nDELETE FROM Marcacoes\r\nWHERE MRC_PIS = \'12345678912\' AND (MRC_DATAAP = \'22/03/2018\' OR MRC_DATAAP = \'23/03/2018\')\r\nGO\r\n\r\n------Deletar marcaÃ§oes especÃ­ficas------\r\n\r\nDELETE FROM Marcacoes\r\nWHERE MRC_PIS = \'12345678912\' AND (MRC_DATAHORA= \'22/03/2018 08:00:00\')\r\nGO\r\n','Gabriel','2018-09-26 00:08:59'),(279,'Deletar MarcaÃ§Ãµes por departamento e no apontamento aberto','COMANDOS','DELETE FROM MARCACOES \r\nWHERE dbo.fn_departamentopertencente((SELECT FUNC_EMPRESA FROM Funcionarios WHERE FUNC_IND = MRC_FUNC), %DEPSELECIONADOIND%)\r\n = 1 AND MRC_DATAHORA >= %DATAINICIAL% AND MRC_DATAHORA <= %DATADINAL% \r\n\r\nDELETE FROM Aponta WHERE \r\nfn_departamentopertencente((SELECT FUNC_EMPRESA FROM Funcionarios WHERE FUNC_IND = APO_FUNC), %DEPSELECIONADOIND%)\r\n = 1 AND APO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL%\r\n\r\nDELETE FROM PreAponta WHERE \r\nfn_departamentopertencente((SELECT FUNC_EMPRESA FROM Funcionarios WHERE FUNC_IND = PAPO_FUNC), %DEPSELECIONADOIND%)\r\n = 1 AND PAPO_DATA >= %DATAINICIAL% AND PAPO_DATA <= %DATAFINAL%\r\n','Gabriel','2018-09-26 00:09:17'),(280,'Tolerancia Diaria Extra e Atraso 10 min','COMANDOS','Aplicar so nos expediente com tolerancia diaria ativa\r\nUPDATE Expedientes SET INT_MINATR_DIARIA = \'0:10\' \r\nWHERE INT_MINEXT_DIARIA = \'0:10\' INT_TOLERANCIA_DIARIA = 1\r\n\r\n\r\nou para poder aplicar em todos\r\n\r\nUPDATE Expedientes SET INT_MINATR_DIARIA = \'0:10\', INT_MINEXT_DIARIA = \'0:10\', INT_TOLERANCIA_DIARIA = 1','Gabriel','2018-09-26 00:09:48'),(281,'Mudar nome rep','COMANDOS','update terminais set trm_fabricante = \'PrintPointIII\' where trm_fabricante = \'Dimep\'','Gabriel','2018-09-26 00:10:11'),(282,'deletar horario definido em um dia da semana','COMANDOS','delete from hora where HR_TIPO = 1','Gabriel','2018-09-26 00:10:26'),(283,'APAGANDO MARCAÃ‡Ã•ES FANTASMA','COMANDOS','\r\n\r\n1 \r\ndelete from preaponta where papo_func = %FUNCIONARIO% and papo_data >= %DATAINICIAL% AND PAPO_DATA <= %DATAFINAL%\r\n\r\n\r\n2\r\n\r\nDELETE FROM APONTA WHERE apo_func = %FUNCIONARIO% and apo_data >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL%\r\n\r\ndepois reprocessa e veja se esta ok','Gabriel','2018-09-26 00:10:44'),(284,'Definir todos funcionarios para um terminal','COMANDOS','INSERT INTO TerminaisFuncionarios (TRMF_TERMINAL, TRMF_FUNC) \r\n(select (SELECT top 1 TRM_ind FROM Terminais where TRM_DESCRICAO = \'Nome do rep\'), func_ind FROM Funcionarios )','Gabriel','2018-09-26 00:11:05'),(285,'MONSTRO','COMANDOS','PRINT \'Gerando dados de Parametros\'\r\n\r\nDELETE FROM Parametros\r\nGO\r\nIF EXISTS(SELECT * FROM\r\nsys.tables AS tbl\r\nINNER JOIN sys.all_columns AS clmns ON clmns.object_id=tbl.object_id\r\nWHERE tbl.name=\'Parametros\' AND is_identity = 1) \r\n   SET IDENTITY_INSERT Parametros ON\r\nGO\r\nALTER TABLE Parametros DISABLE TRIGGER ALL\r\nGO\r\n\r\n\r\nINSERT INTO Parametros \r\n\r\n(PAR_IND,PAR_GRUPO,PAR_DESCRICAO,PAR_COD_FAIXA_EXT_MENSAL,PAR_MINDDSR,PAR_MINDDSR_DIAS,PAR_MINNOT,\r\nPAR_EVENTONOT1,PAR_EVENTOTRAB,PAR_EVENTODSR, PAR_EVENTOATR,PAR_EVENTOFALTAS,PAR_EVENTODDSR,PAR_EVENTOFERIAS,PAR_TIPOCOMPENSACAO,\r\n\r\nPAR_BCO_TIPO,PAR_BCO_LIMITE_EXT,PAR_BCO_LIMITE_EXTN,PAR_BCO_LIMITE_ATR,PAR_BCO_MAX_EXT,PAR_BCO_MAX_EXTN,PAR_BCO_MAX_ATR,PAR_BCO_NAOLANCARFALTAS,PAR_BCO_NAOLANCAREXTRAF,PAR_BCO_PCENTO_EXT,PAR_BCO_PCENTO_EXTN,PAR_BCO_PCENTO_EXTF,PAR_BCO_PCENTO_EXTNF,\r\n\r\nPAR_TIPOLANCAMENTOFALTAS,PAR_HORASFIXASLANCAR,\r\nPAR_PAGAR_DSR_EM_FERIADOS,PAR_FERIADO_PAGAR_EXTFER,PAR_FERIADO_PAGAR_EXT,PAR_UMAMARCACAOCOMOATRASO,PAR_GERARVARDEMITIDOS,PAR_FIXOLANCARDSR,PAR_EXTALEMEXTN,PAR_VALOR_DSR_FERIADO,\r\nPAR_MODO_CALCULO_DDSR,PAR_CALCULO_DDSR_EM_DIAS, PAR_EXTRAS_FAIXA,PAR_EXTRASF_FAIXA,\r\n\r\nPAR_PAGAR_NOTURNO_INTERVALO,PAR_TIPO_LANCAMENTO_TRAB,PAR_TIPO_FAIXA_EXTRA,PAR_MRC_DESCONS_FORA_FAIXA,PAR_MRC_AUTOMATICA, PAR_EMP_USAR_EMP_GRUPO) \r\n\r\nVALUES (\r\n\'5\',\'1\',\'SINDICATO\',NULL, \'0:00\',\'1\',\'01/01/1900\', \'6\',\'9\',\'10\',\'2\',\'3\',\'5\',\'19\',\'N\',\'N\',\'0:00\',\'0:00\',\'0:00\',\'0:00\',\'0:00\',\'0:00\',\r\n0,0,\'0\',\'0\',\'0\',\'0\',\'D\',\'0:00\',1,1,0,0,1,0,0,\'07:20\',\'1\',\'1\', \'1\',\'2\',0,\'M\',\'D\',NULL,NULL, 0)\r\n\r\nGO\r\n\r\nUPDATE Expedientes SET INT_MINEXT1 = \'0:10\', INT_MINEXT2 = \'0:10\', INT_MINEXT3 = \'0:10\', INT_MINEXT4 = \'0:10\',\r\nINT_MINATR1 = \'0:10\', INT_MINATR2 = \'0:10\', INT_MINATR3 = \'0:10\', INT_MINATR4 = \'0:10\'\r\n\r\nUPDATE Expedientes SET INT_COMPENSARINTERVALO = 3 WHERE\r\nINT_HV IS NULL AND INT_PERIODO_UNICO = 0 AND INT_INTERVALO_AUTO = 0\r\n\r\nUPDATE Funcionarios SET FUNC_TABPARAM = 5\r\n\r\ndeclare @TEMPO smalldatetime = \'03:00:00\',\r\n		@i int = 1\r\n\r\nwhile (exists(select INT_IND from Expedientes where INT_IND >= @i))\r\nbegin\r\n	if (exists(select INT_IND from Expedientes where INT_IND = @i and INT_TIPOTEMPO = \'F\'))\r\n	begin\r\n\r\n\r\ndeclare	@HORA1 smalldatetime = (select case when INT_HORA1 = \'1900-01-01 00:00:00\' then \'1900-02-01 00:00:00\' else INT_HORA1 end from Expedientes where INT_IND = @i),\r\n				@HORA2 smalldatetime = (select case when INT_HORA2 = \'1900-01-01 00:00:00\' then \'1900-02-01 00:00:00\' else INT_HORA2 end from Expedientes where INT_IND = @i),\r\n				@HORA3 smalldatetime = (select case when INT_HORA3 = \'1900-01-01 00:00:00\' then \'1900-02-01 00:00:00\' else INT_HORA3 end from Expedientes where INT_IND = @i),\r\n				@HORA4 smalldatetime = (select case when INT_HORA4 = \'1900-01-01 00:00:00\' then \'1900-02-01 00:00:00\' else INT_HORA4 end from Expedientes where INT_IND = @i),\r\n				@FAIXA11 smalldatetime,	@FAIXA12 smalldatetime,	@FAIXA21 smalldatetime,	@FAIXA22 smalldatetime,	\r\n				@FAIXA31 smalldatetime,	@FAIXA32 smalldatetime,	@FAIXA41 smalldatetime,	@FAIXA42 smalldatetime\r\n\r\n		set @FAIXA11 = @HORA1 - @TEMPO - @TEMPO\r\n		set @FAIXA12 = @HORA1 + @TEMPO\r\n		set @FAIXA21 = @HORA2 - @TEMPO\r\n		set @FAIXA22 = @HORA2 + @TEMPO\r\n		set @FAIXA31 = @HORA3 - @TEMPO\r\n		set @FAIXA32 = @HORA3 + @TEMPO\r\n		set @FAIXA41 = @HORA4 - @TEMPO\r\n		set @FAIXA42 = @HORA4 + @TEMPO + @TEMPO\r\n\r\n		UPDATE Expedientes\r\n		set INT_FAIXA11 = CONVERT(SMALLDATETIME, @FAIXA11),\r\n			INT_FAIXA12 = CONVERT(SMALLDATETIME, @FAIXA12),\r\n			INT_FAIXA21 = CONVERT(SMALLDATETIME, @FAIXA21),\r\n			INT_FAIXA22 = CONVERT(SMALLDATETIME, @FAIXA22),\r\n			INT_FAIXA31 = CONVERT(SMALLDATETIME, @FAIXA31),\r\n			INT_FAIXA32 = CONVERT(SMALLDATETIME, @FAIXA32),\r\n			INT_FAIXA41 = CONVERT(SMALLDATETIME, @FAIXA41),\r\n			INT_FAIXA42 = CONVERT(SMALLDATETIME, @FAIXA42)\r\n		where INT_TIPOTEMPO = \'F\'\r\n		AND INT_IND = @i\r\n\r\n		set @i = @i + 1\r\n	end\r\n	else\r\n	begin\r\n		set @i = @i + 1\r\n	end\r\nend','Gabriel','2018-09-26 00:11:23'),(286,'Comando para nao apareecer funcionario excluido e demitido','COMANDOS','FUNC_DT_DEM IS NULL AND FUNC_MARCADO_EXCLUSAO = 0','Gabriel','2018-09-26 00:11:45'),(287,'Desassociar um expediente especifico','COMANDOS','DELETE FROM Hora WHERE HR_HORARIO IN (SELECT INT_IND FROM Expedientes WHERE INT_COD = ????)\r\n\r\n\r\ntroca o ???? pelo codigo do expediente','Gabriel','2018-09-26 00:11:59'),(288,'Apagarr Crachas por Departameto','COMANDOS','DELETE FROM CRACHAS WHERE dbo.fn_departamentopertencente((SELECT FUNC_EMPRESA FROM Funcionarios WHERE FUNC_IND = CRA_FUNC), %DEPSELECIONADOIND%) = 1\r\n\r\nUPDATE Funcionarios SET FUNC_REG = FUNC_IND WHERE dbo.fn_departamentopertencente(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1','Gabriel','2018-09-26 00:12:11'),(289,'Reconstruir Indice da Tabelas','COMANDOS','DECLARE @Database VARCHAR(255)  \r\nDECLARE @Table VARCHAR(255)  \r\nDECLARE @cmd NVARCHAR(500)  \r\nDECLARE @fillfactor INT\r\n\r\nSET @Database = \'Ponto4\'\r\n\r\nSET @fillfactor = 90\r\n\r\n   SET @cmd = \'DECLARE TableCursor CURSOR FOR SELECT \'\'[\'\' + table_catalog + \'\'].[\'\' + table_schema + \'\'].[\'\' +\r\n  table_name + \'\']\'\' as tableName FROM [\' + @Database + \'].INFORMATION_SCHEMA.TABLES\r\n  WHERE table_type = \'\'BASE TABLE\'\'\'  \r\n\r\n   -- create table cursor  \r\n   EXEC (@cmd)  \r\n   OPEN TableCursor  \r\n\r\n   FETCH NEXT FROM TableCursor INTO @Table  \r\n   WHILE @@FETCH_STATUS = 0  \r\n   BEGIN  \r\n\r\n       IF (@@MICROSOFTVERSION / POWER(2, 24) >= 9)\r\n       BEGIN\r\n               PRINT @TABLE\r\n           SET @cmd = \'ALTER INDEX ALL ON \' + @Table + \' REBUILD WITH (FILLFACTOR = \' + CONVERT(VARCHAR(3),@fillfactor) + \')\'\r\n           EXEC (@cmd)\r\n       END\r\n       ELSE\r\n       BEGIN\r\n               PRINT @TABLE\r\n          DBCC DBREINDEX(@Table,\' \',@fillfactor)  \r\n       END\r\n\r\n       FETCH NEXT FROM TableCursor INTO @Table  \r\n   END  \r\n\r\n   CLOSE TableCursor  \r\n   DEALLOCATE TableCursor  \r\n','Gabriel','2018-09-26 00:12:25'),(290,'Apagar calculo apos demissao','COMANDOS','delete from Aponta where exists(select * from Funcionarios where FUNC_IND = APO_FUNC and FUNC_DT_DEM is not null and APO_DATA > \r\nFUNC_DT_DEM)','Gabriel','2018-09-26 00:12:38'),(291,'Erro quando nao exibe horario associado no dia','COMANDOS','Quando nao exibir o horario no dia\r\n\r\nmarcar como apontado\r\ndepois desmarcar como apontado e processar','Gabriel','2018-09-26 00:13:00'),(292,'APAGAR LIXO CALCULO DEPTO SELECIONADO','COMANDOS','DELETE FROM PreAponta WHERE PAPO_FUNC IN (SELECT FUNC_IND FROM Funcionarios WHERE dbo.fn_departamentopertencente(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1) and PAPO_DATA >= %DATAINICIAL% AND PAPO_DATA <= %DATAFINAL%','Gabriel','2018-09-26 00:13:12'),(293,'LIXO CALCULOADCIONAL NOTURNO','COMANDOS',' DELETE FROM PreAponta WHERE PAPO_FUNC = %FUNCIONARIO% and PAPO_DATA >= %DATAINICIAL% AND PAPO_DATA <= %DATAFINAL%','Gabriel','2018-09-26 00:13:25'),(294,'Comando para alterar crachÃ¡ em proximidade','COMANDOS','UPDATE Crachas SET CRA_NUMERO_HEXA = 1','Gabriel','2018-09-26 00:13:37'),(295,'Comando para habilitar DNS no endereÃ§o IP do terminal','COMANDOS','ALTER TABLE Terminais ALTER COLUMN TRM_IP NCHAR(150)\r\n\r\nNo comando acima, o numero entre parenteses representa a quantidade de caracteres, caso seja necessario, aumente o mesmo','Gabriel','2018-09-26 00:13:50'),(296,'apagar extras uma data em diante','COMANDOS','delete from marcacoes where mrc_datahora >= \'06/10/2015\' ','Gabriel','2018-09-26 00:14:05'),(297,'AUMENTAR CAMPO EMAIL','COMANDOS','UTILITARIOS \r\n\r\nSUPORTE \r\n\r\nEXECUTAR UM DE CADA VEZ\r\n\r\n\r\nALTER TABLE usuarios ALTER COLUMN USU_EMAIL_REMETENTE NVARCHAR(100)\r\n\r\nALTER TABLE usuarios ALTER COLUMN USU_EMAIL_HOST NVARCHAR(100)\r\n\r\n \r\n\r\n','Gabriel','2018-09-26 00:14:42'),(298,'Apagar escalas associadas','COMANDOS','delete from horaescala','Gabriel','2018-09-26 00:14:53'),(299,'RESTAURAR BANCO CORROMPIDO','COMANDOS','EXEC sp_resetstatus Ponto4\r\nALTER DATABASE Ponto4 SET EMERGENCY  \r\nDBCC checkdb (Ponto4) \r\nALTER DATABASE Ponto4 SET SINGLE_USER WITH ROLLBACK IMMEDIATE \r\nDBCC checkdb (Ponto4, REPAIR_ALLOW_DATA_LOSS) \r\nALTER DATABASE Ponto4 SET MULTI_USER\r\n','Gabriel','2018-09-26 00:15:07'),(300,'Apagar Apont do Mes e da empresa - depto selecionado','COMANDOS','DELETE FROM Aponta WHERE dbo.fn_departamentopertencente((SELECT FUNC_EMPRESA FROM Funcionarios WHERE FUNC_IND = APO_FUNC), %DEPSELECIONADOIND%) = 1 AND APO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL%\r\nDELETE FROM Calculo WHERE dbo.fn_departamentopertencente((SELECT FUNC_EMPRESA FROM Funcionarios WHERE FUNC_IND = CAL_FUNC), %DEPSELECIONADOIND%) = 1 AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%\r\nDELETE FROM PreAponta WHERE dbo.fn_departamentopertencente((SELECT FUNC_EMPRESA FROM Funcionarios WHERE FUNC_IND = PAPO_FUNC), %DEPSELECIONADOIND%) = 1 AND PAPO_DATA >= %DATAINICIAL% AND PAPO_DATA <= %DATAFINAL%\r\n\r\nDELETE FROM BcoHoras WHERE dbo.fn_departamentopertencente((SELECT FUNC_EMPRESA FROM Funcionarios WHERE FUNC_IND = BCO_FUNC), %DEPSELECIONADOIND%) = 1 AND BCO_DATA >= %DATAINICIAL% AND BCO_DATA <= %DATAFINAL% AND BCO_STATUS <> 0','Gabriel','2018-09-26 00:15:22'),(301,'Apagar Apont do Mes e da empresa Incluindo marcaÃ§Ãµes - Empresa - depto selecionado','COMANDOS','DELETE FROM Aponta WHERE dbo.fn_departamentopertencente((SELECT FUNC_EMPRESA FROM Funcionarios WHERE FUNC_IND = APO_FUNC), %DEPSELECIONADOIND%) = 1 AND APO_DATA >= \'30/05/2014\' AND APO_DATA <= \'02/06/2014\'\r\nDELETE FROM Calculo WHERE dbo.fn_departamentopertencente((SELECT FUNC_EMPRESA FROM Funcionarios WHERE FUNC_IND = CAL_FUNC), %DEPSELECIONADOIND%) = 1 AND CAL_DATA >= \'30/05/2014\' AND CAL_DATA <= \'02/06/2014\'\r\nDELETE FROM PreAponta WHERE dbo.fn_departamentopertencente((SELECT FUNC_EMPRESA FROM Funcionarios WHERE FUNC_IND = PAPO_FUNC), %DEPSELECIONADOIND%) = 1 AND PAPO_DATA >= \'30/05/2014\' AND PAPO_DATA <= \'02/06/2014\'\r\nDELETE FROM Marcacoes WHERE dbo.fn_departamentopertencente((SELECT FUNC_EMPRESA FROM Funcionarios WHERE FUNC_IND = MRC_FUNC), %DEPSELECIONADOIND%) = 1 AND MRC_DATAHORA >= \'30/05/2014\' AND MRC_DATAHORA <= \'02/06/2014\' AND (MRC_PIS IS NOT NULL OR MRC_CRACHA IS NOT NULL)\r\n\r\n\r\n','Gabriel','2018-09-26 00:15:38'),(302,'Tolerancia extras e atrasos 10 minutos','COMANDOS','UPDATE Expedientes SET INT_MINEXT1 = \'0:10\', INT_MINEXT2 = \'0:10\', INT_MINEXT3 = \'0:10\', INT_MINEXT4 = \'0:10\',\r\n INT_MINATR1 = \'0:10\', INT_MINATR2 = \'0:10\', INT_MINATR3 = \'0:10\', INT_MINATR4 = \'0:10\'','Gabriel','2018-09-26 00:16:25'),(303,'Deletar expedientes dos funcionÃ¡rios de um mesmo cÃ³digo','COMANDOS','DELETE FROM Hora WHERE  HR_HORARIO  = (SELECT INT_IND FROM Expedientes WHERE INT_COD = ???)\r\n\r\n\r\n***OBS: TROCAR O ??? PELO NUMERO DO CÃ“DIGO DO EXPEDIENTE','Gabriel','2018-09-26 00:16:36'),(304,'Exclusao Terminal','COMANDOS','DELETE FROM TerminaisFuncionarios WHERE TRMF_FUNC IN (SELECT FUNC_IND FROM Funcionarios WHERE dbo.fn_departamentopertencente(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1)','Gabriel','2018-09-26 00:16:53'),(305,'definir expediente principal aos finais de semana','COMANDOS','INSERT INTO Hora (HR_FUNC, HR_TIPO, HR_DATAINICIAL, HR_HORARIO) \r\n    SELECT b.HR_FUNC, 1, b.HR_DATAINICIAL, b.HR_HORARIO FROM Hora b WHERE b.HR_TIPO = 0 AND \r\n    NOT EXISTS(SELECT * FROM Hora c WHERE c.HR_FUNC = b.HR_FUNC AND c.HR_TIPO = 1 AND c.HR_DATAINICIAL = b.HR_DATAINICIAL)\r\n\r\nINSERT INTO Hora (HR_FUNC, HR_TIPO, HR_DATAINICIAL, HR_HORARIO) \r\n    SELECT b.HR_FUNC, 7, b.HR_DATAINICIAL, b.HR_HORARIO FROM Hora b WHERE b.HR_TIPO = 0 AND \r\n    NOT EXISTS(SELECT * FROM Hora c WHERE c.HR_FUNC = b.HR_FUNC AND c.HR_TIPO = 7 AND c.HR_DATAINICIAL = b.HR_DATAINICIAL)    ','Gabriel','2018-09-26 00:17:03'),(306,'Apagar Hora de Func com cargo especifico','COMANDOS','DELETE FROM Hora WHERE HR_FUNC IN (SELECT FUNC_IND FROM Funcionarios WHERE FUNC_CARGO IN (SELECT CAR_IND FROM Cargos WHERE CAR_DESCRICAO like \'%Vendedor%\'))','Gabriel','2018-09-26 00:17:15'),(307,'Comando para aparecer primeiro func da lista tela principal','COMANDOS','UPDATE Funcionarios SET FUNC_NOME = RTRIM(LTRIM(FUNC_NOME))','Gabriel','2018-09-26 00:17:30'),(308,'Apagar justificativas de um certo periodo, para todos os funcionarios','COMANDOS','DELETE FROM justificativas WHERE JUS_DATA > \'%DATAINICIAL%\' AND JUS_DATA < \'%DATAFINAL%\'','Gabriel','2018-09-26 00:17:42'),(309,'Apagar justificativas em determinadas datas','COMANDOS','DELETE FROM justificativas WHERE JUS_DATA > \'07/12/2013\' AND JUS_DATA < \'15/12/2013\'','Gabriel','2018-09-26 00:17:57'),(310,'criar icones varios banco de dados','COMANDOS','\"C:\\Arquivos de programas\\Assecont\\Assefin 2.0\\assefin.exe\" /Servidor:server\\assefin /Database:assefin /User:sa /Password:1973\"','Gabriel','2018-09-26 00:18:33'),(311,'Retirar Extras do Calculo','COMANDOS','DELETE FROM PreAponta WHERE PAPO_FUNC = %FUNCSELECIONADO% AND PAPO_DATA >= %DATAINICIAL% AND PAPO_DATA <= %DATAFINAL%','Gabriel','2018-09-26 00:18:47'),(312,'deletar expedientes  altermativos finais de semana','COMANDOS','delete from hora where hr_tipo = 1 or hr_tipo = 7\r\n\r\n\r\n0 = principal\r\n\r\nDELETE FROM HMovel WHERE DAYOFWEEK(day, HRM_DATA) = 1 OR DAYOFWEEK(day, HRM_DATA) = 7','Gabriel','2018-09-26 00:19:12'),(313,'deletar expedientes final semana','COMANDOS','delete from hora where hr_tipo = 1 or hr_tipo = 7\r\n\r\n0 = principal','Gabriel','2018-09-26 00:19:25'),(314,'Associar expediente principal em dias especificos da semana','COMANDOS','DECLARE @SEMANA INT\r\nSET @SEMANA = 7 -- 0 = principal, 1=domingo, 2=segunda, 3=terÃ§a,4=quarta,5=quinta,6=sexta,7 = sÃ¡bado\r\n\r\nINSERT INTO Hora (HR_FUNC, HR_TIPO, HR_DATAINICIAL, HR_HORARIO) \r\n    SELECT b.HR_FUNC, @SEMANA, b.HR_DATAINICIAL, b.HR_HORARIO FROM Hora b WHERE b.HR_TIPO = 0 AND \r\n    NOT EXISTS(SELECT * FROM Hora c WHERE c.HR_FUNC = b.HR_FUNC AND c.HR_TIPO = @SEMANA AND c.HR_DATAINICIAL = b.HR_DATAINICIAL)  ','Gabriel','2018-09-26 00:19:37'),(315,'DELETAR LIXO DE CALCULO','COMANDOS','DELETE FROM PREAPONTA  WHERE PAPO_FUNC = (SELECT FUNC_IND FROM FUNCIONARIOS WHERE FUNC_REG = \'REGISTRO\') AND PAPO_DATA >= %DATAINICIAL% AND \r\nPAPO_DATA <= %DATAFINAL%','Gabriel','2018-09-26 00:19:49'),(316,'APAGAR APONTAMENTOS MES','COMANDOS','DELETE FROM Calculo WHERE CAL_FUNC = %FUNCIONARIO% AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%\r\nDELETE FROM Aponta WHERE APO_FUNC = %FUNCIONARIO% AND APO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL%\r\nDELETE FROM PreAponta WHERE PAPO_FUNC = %FUNCIONARIO% AND PAPO_DATA >= %DATAINICIAL% AND PAPO_DATA <= %DATAFINAL%\r\n','Gabriel','2018-09-26 00:20:20'),(317,'DELETAR MARCA FUNC','COMANDOS','DELETE FROM MARCACOES WHERE MRC_FUNC =%FUNCIONARIO% AND MRC_DATAHORA>=%DATAINICIAL% AND MRC_DATAHORA<=%DATAFINAL%','Gabriel','2018-09-26 00:20:47'),(318,'ordenar lista de funcionarios por nome','COMANDOS','UPDATE Funcionarios SET FUNC_NOME = RTRIM(LTRIM(FUNC_NOME))\r\n','Gabriel','2018-09-26 00:21:05'),(319,'Justificativas MÃ©dicas','COMANDOS','-- Trocar o termo \'Justificativa MÃ©dica\' pelo termo exato do motivo\r\n\r\nEXEC    [dbo].[rst_relatorios_justificativas]\r\n        @P_DATAINICIAL = %DATAINICIAL%,\r\n        @P_DATAFINAL = %DATAFINAL%,\r\n        @p_depto = %DEPSELECIONADOIND%,\r\n        @P_MOTIVO = N\'Justificativa MÃ©dica\'','Gabriel','2018-09-26 00:21:20'),(320,'Pis - Remover Pontos','COMANDOS','UPDATE Funcionarios SET FUNC_PIS = REPLACE(FUNC_PIS, \'.\', \'\')','Gabriel','2018-09-26 15:26:43'),(321,'feriados moveis 2012','COMANDOS','SET DATEFORMAT DMY\r\nSET NOCOUNT ON\r\n\r\nPRINT \'Gerando dados de Feriados\'\r\n\r\nDELETE FROM Feriados\r\nGO\r\nIF EXISTS(SELECT * FROM\r\nsys.tables AS tbl\r\nINNER JOIN sys.all_columns AS clmns ON clmns.object_id=tbl.object_id\r\nWHERE tbl.name=\'Feriados\' AND is_identity = 1) \r\n   SET IDENTITY_INSERT Feriados ON\r\nGO\r\nALTER TABLE Feriados DISABLE TRIGGER ALL\r\nGO\r\n\r\nINSERT INTO Feriados (FER_IND,FER_GRUPO,FER_MES,FER_DIA,FER_DATA,FER_DESCRICAO,FER_EMPRESA) VALUES (1,1,1,1,NULL,\'ConfraterizaÃ§Ã£o Universal\',NULL)\r\nINSERT INTO Feriados (FER_IND,FER_GRUPO,FER_MES,FER_DIA,FER_DATA,FER_DESCRICAO,FER_EMPRESA) VALUES (5,1,4,21,NULL,\'Tiradentes\',NULL)\r\nINSERT INTO Feriados (FER_IND,FER_GRUPO,FER_MES,FER_DIA,FER_DATA,FER_DESCRICAO,FER_EMPRESA) VALUES (6,1,5,1,NULL,\'Dia do Trabalho\',NULL)\r\nINSERT INTO Feriados (FER_IND,FER_GRUPO,FER_MES,FER_DIA,FER_DATA,FER_DESCRICAO,FER_EMPRESA) VALUES (9,1,9,7,NULL,\'IndependÃªncia\',NULL)\r\nINSERT INTO Feriados (FER_IND,FER_GRUPO,FER_MES,FER_DIA,FER_DATA,FER_DESCRICAO,FER_EMPRESA) VALUES (10,1,10,12,NULL,\'Nossa Sra. Aparecida\',NULL)\r\nINSERT INTO Feriados (FER_IND,FER_GRUPO,FER_MES,FER_DIA,FER_DATA,FER_DESCRICAO,FER_EMPRESA) VALUES (11,1,11,2,NULL,\'Finados\',NULL)\r\nINSERT INTO Feriados (FER_IND,FER_GRUPO,FER_MES,FER_DIA,FER_DATA,FER_DESCRICAO,FER_EMPRESA) VALUES (12,1,11,15,NULL,\'ProclamaÃ§Ã£o da RepÃºblica\',NULL)\r\nINSERT INTO Feriados (FER_IND,FER_GRUPO,FER_MES,FER_DIA,FER_DATA,FER_DESCRICAO,FER_EMPRESA) VALUES (13,1,12,25,NULL,\'Natal\',NULL)\r\nINSERT INTO Feriados (FER_IND,FER_GRUPO,FER_MES,FER_DIA,FER_DATA,FER_DESCRICAO,FER_EMPRESA) VALUES (14,1,NULL,NULL,\'21/02/2012\',\'Carnaval\',NULL)\r\nINSERT INTO Feriados (FER_IND,FER_GRUPO,FER_MES,FER_DIA,FER_DATA,FER_DESCRICAO,FER_EMPRESA) VALUES (15,1,NULL,NULL,\'06/02/2012\',\'PaixÃ£o\',NULL)\r\nINSERT INTO Feriados (FER_IND,FER_GRUPO,FER_MES,FER_DIA,FER_DATA,FER_DESCRICAO,FER_EMPRESA) VALUES (16,1,NULL,NULL,\'08/04/2012\',\'PÃ¡scoa\',NULL)\r\nINSERT INTO Feriados (FER_IND,FER_GRUPO,FER_MES,FER_DIA,FER_DATA,FER_DESCRICAO,FER_EMPRESA) VALUES (17,1,NULL,NULL,\'07/06/2012\',\'Corpus Cristhi\',NULL)\r\nGO\r\n\r\nIF EXISTS(SELECT * FROM\r\nsys.tables AS tbl\r\nINNER JOIN sys.all_columns AS clmns ON clmns.object_id=tbl.object_id\r\nWHERE tbl.name=\'Feriados\' AND is_identity = 1) \r\n   SET IDENTITY_INSERT Feriados OFF\r\nGO\r\nALTER TABLE Feriados ENABLE TRIGGER ALL\r\nGO','Gabriel','2018-09-26 15:28:59'),(322,'Solucao Takeda','COMANDOS','ALTER TABLE PreAponta DROP CONSTRAINT DF_PreAponta_PAPO_INTERVALO_NOTURNO\r\nALTER TABLE PreAponta DROP CONSTRAINT DF_PreAponta_PAPO_INTERVALO_EXTRAN\r\nALTER TABLE PreAponta ADD  CONSTRAINT [DF_PreAponta_PAPO_INTERVALO_EXTRAN]  DEFAULT ((0)) FOR [PAPO_INTERVALO_EXTRAN]\r\nALTER TABLE PreAponta ADD  CONSTRAINT [DF_PreAponta_PAPO_INTERVALO_NOTURNO]  DEFAULT ((0)) FOR [PAPO_INTERVALO_NOTURNO]','Gabriel','2018-09-26 15:29:24'),(323,'Expedientes em Horario Movel, respeitar a tab de parametro','COMANDOS','UPDATE HMovel SET HRM_TIPOEXTRA = \'P\' WHERE ISNULL(HRM_TIPOEXTRA, \'\') = \'\' AND dbo.fn_data_eh_feriado(HRM_FUNC, HRM_DATA) = 1','Gabriel','2018-09-26 15:29:46'),(324,'EXPEDIENTES SUMONT','COMANDOS','UPDATE Expedientes SET INT_HORA1 = DATEADD(year, -100, INT_HORA1) WHERE INT_HORA1 >= \'1/1/2000\'\r\nUPDATE Expedientes SET INT_HORA2 = DATEADD(year, -100, INT_HORA2) WHERE INT_HORA2 >= \'1/1/2000\'\r\nUPDATE Expedientes SET INT_HORA3 = DATEADD(year, -100, INT_HORA3) WHERE INT_HORA3 >= \'1/1/2000\'\r\nUPDATE Expedientes SET INT_HORA4 = DATEADD(year, -100, INT_HORA4) WHERE INT_HORA4 >= \'1/1/2000\'\r\n\r\nUPDATE Expedientes SET INT_FAIXA11 = DATEADD(year, -100, INT_FAIXA11) WHERE INT_FAIXA11 >= \'1/1/2000\'\r\nUPDATE Expedientes SET INT_FAIXA12 = DATEADD(year, -100, INT_FAIXA12) WHERE INT_FAIXA12 >= \'1/1/2000\'\r\n\r\nUPDATE Expedientes SET INT_FAIXA21 = DATEADD(year, -100, INT_FAIXA21) WHERE INT_FAIXA21 >= \'1/1/2000\'\r\nUPDATE Expedientes SET INT_FAIXA22 = DATEADD(year, -100, INT_FAIXA22) WHERE INT_FAIXA22 >= \'1/1/2000\'\r\n\r\nUPDATE Expedientes SET INT_FAIXA31 = DATEADD(year, -100, INT_FAIXA31) WHERE INT_FAIXA31 >= \'1/1/2000\'\r\nUPDATE Expedientes SET INT_FAIXA32 = DATEADD(year, -100, INT_FAIXA32) WHERE INT_FAIXA32 >= \'1/1/2000\'\r\n\r\nUPDATE Expedientes SET INT_FAIXA41 = DATEADD(year, -100, INT_FAIXA41) WHERE INT_FAIXA41 >= \'1/1/2000\'\r\nUPDATE Expedientes SET INT_FAIXA42 = DATEADD(year, -100, INT_FAIXA42) WHERE INT_FAIXA42 >= \'1/1/2000\'\r\n','Gabriel','2018-09-26 15:30:11'),(325,'Inserir motivos','COMANDOS','PRINT \'Gerando dados de Motivos\'\r\n\r\nDELETE FROM Motivos\r\nGO\r\nIF EXISTS(SELECT * FROM\r\nsys.tables AS tbl\r\nINNER JOIN sys.all_columns AS clmns ON clmns.object_id=tbl.object_id\r\nWHERE tbl.name=\'Motivos\' AND is_identity = 1) \r\n   SET IDENTITY_INSERT Motivos ON\r\nGO\r\nALTER TABLE Motivos DISABLE TRIGGER ALL\r\nGO\r\n\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'1\',\'1\',\'Abonado\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'2\',\'1\',\'Atestado MÃ©dico\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'3\',\'1\',\'Atestado Ã“bito\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'4\',\'1\',\'Atestado ReclusÃ£o\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'5\',\'1\',\'Atraso\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'6\',\'1\',\'Atraso Onibus\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'7\',\'1\',\'Aux - DoenÃ§a - ApÃ³s 15 dias\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'8\',\'1\',\'Aviso PrÃ©vio\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'9\',\'1\',\'Chegou Atrasado\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'10\',\'1\',\'CrachÃ¡ Extraviado\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'11\',\'1\',\'Dia Compensado\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'12\',\'1\',\'Dia de Pagamento\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'13\',\'1\',\'Em Curso\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'14\',\'1\',\'Esqueceu de Marcar\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'15\',\'1\',\'Fazendo Exame MÃ©dico\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'16\',\'1\',\'FÃ©rias\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'17\',\'1\',\'Festa Final de Ano\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'19\',\'1\',\'JustiÃ§a Eleitoral\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'20\',\'1\',\'DoaÃ§Ã£o de Sangue\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'21\',\'1\',\'Justificativa\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'22\',\'1\',\'Autorizado pela Diretoria\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'23\',\'1\',\'LicenÃ§a Casamento\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'24\',\'1\',\'LicenÃ§a Paternidade\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'25\',\'1\',\'LicenÃ§a MAternidade\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'26\',\'1\',\'Horario Incluido Conf Contrato Trabalho\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'27\',\'1\',\'Hora Extra nÃ£o Autorizada\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'28\',\'1\',\'Pagou Hora\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'29\',\'1\',\'Saiu mais cedo\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'30\',\'1\',\'Vestibular\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'31\',\'1\',\'Erro na leitura Digital\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'32\',\'1\',\'Alistamento Militar\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'33\',\'1\',\'AmamentaÃ§Ã£o\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'34\',\'1\',\'Atestado Odontologico\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'35\',\'1\',\'Abonado nÃ£o influencia\')\r\nINSERT INTO Motivos (MOT_IND,MOT_GRUPO,MOT_DESCRICAO) VALUES (\'36\',\'1\',\'Abnonado fÃ©rias nÃ£o Influencia\')\r\nGO\r\n\r\nIF EXISTS(SELECT * FROM\r\nsys.tables AS tbl\r\nINNER JOIN sys.all_columns AS clmns ON clmns.object_id=tbl.object_id\r\nWHERE tbl.name=\'Motivos\' AND is_identity = 1) \r\n   SET IDENTITY_INSERT Motivos OFF\r\nGO\r\nALTER TABLE Motivos ENABLE TRIGGER ALL\r\nGO\r\n\r\nSET DATEFORMAT DMY\r\nSET NOCOUNT ON','Gabriel','2018-09-26 15:30:37'),(326,'colocar todos os horarios compensando o intervalo','COMANDOS','comando para colocar todos os horarios com compensaÃ§Ã£o no intervalo, ponto 4:\r\n\r\nUPDATE Expedientes SET INT_COMPENSARINTERVALO = 1','Gabriel','2018-09-26 15:30:54'),(327,'Preencher com zeros esquerda no pis do cara','COMANDOS','UPDATE Funcionarios SET FUNC_PIS = dbo.fn_rpadch(RTRIM(FUNC_PIS), 12, \'0\') WHERE LEN(FUNC_PIS) < 12','Gabriel','2018-09-26 15:31:29'),(328,'Compensar Intervalo para PrÃ©-Assinalado','COMANDOS','UPDATE Expedientes SET INT_INTERVALO_AUTO = 1, INT_COMPENSARINTERVALO = 0 WHERE INT_COMPENSARINTERVALO = 1','Gabriel','2018-09-26 15:31:42'),(329,'marcar intervalo automatico','COMANDOS','UPDATE EXPEDIENTES SET INT_INTERVALO_AUTO = 1','Gabriel','2018-09-26 15:32:13'),(330,'banco e marcaÃ§oes','RELATORIOS','--TITULO#RELATÃ“RIO DE PONTO DIÃRIO#\r\n--SUBTITULO#%DEPSELECIONADONOME% - %DATASELECIONADA%\r\n--ORIENTACAO#paisagem#\r\n--LARGURA#100,250,50,50,50,50,50,50,50,50,50,90,50#\r\nDECLARE @DATA SMALLDATETIME\r\nSET @DATA = \'20/09/2016\',\r\nSELECT FUNC_REG AS \'REGISTRO\', FUNC_NOME AS \'NOME\',\r\n(CASE WHEN (SELECT dbo.fn_faltou(Calculo.CAL_FALTAHORA) FROM Calculo\r\nWHERE CAL_FUNC = FUNC_IND AND CAL_DATA = @DATA) = 1 THEN \'FALTA\' ELSE (\r\nCASE (SELECT APO_H FROM Aponta WHERE APO_FUNC = FUNC_IND AND APO_DATA = @DATA)\r\nWHEN -990 THEN \'FOLGA\'\r\nWHEN -996 THEN \'FÃ‰RIAS\'\r\nWHEN -998 THEN \'AFASTADO\'\r\nELSE\r\nISNULL((SELECT dbo.fn_gettimefull(Aponta.APO_MARCACAO1) FROM Aponta\r\nWHERE APO_FUNC = FUNC_IND AND APO_DATA = @DATA AND APO_OCORRENCIA1 =\r\n\'O\'), \'\') END) END) AS \'1Âª\',\r\nISNULL((SELECT dbo.fn_gettimefull(Aponta.APO_MARCACAO2) FROM Aponta\r\nWHERE APO_FUNC = FUNC_IND AND APO_DATA = @DATA AND APO_OCORRENCIA2 =\r\n\'O\'), \'\') AS \'2Âª\',\r\nISNULL((SELECT dbo.fn_gettimefull(Aponta.APO_MARCACAO3) FROM Aponta\r\nWHERE APO_FUNC = FUNC_IND AND APO_DATA = @DATA AND APO_OCORRENCIA3 =\r\n\'O\'), \'\') AS \'3Âª\',\r\nISNULL((SELECT dbo.fn_gettimefull(Aponta.APO_MARCACAO4) FROM Aponta\r\nWHERE APO_FUNC = FUNC_IND AND APO_DATA = @DATA AND APO_OCORRENCIA4 =\r\n\'O\'), \'\') AS \'4Âª\',\r\nISNULL((SELECT dbo.fn_gettimefull(Aponta.APO_MARCACAO1) FROM Aponta\r\nWHERE APO_FUNC = FUNC_IND AND APO_DATA = @DATA AND APO_OCORRENCIA1 =\r\n\'I\'), \'\') AS \'1Âª dig\',\r\nISNULL((SELECT dbo.fn_gettimefull(Aponta.APO_MARCACAO2) FROM Aponta\r\nWHERE APO_FUNC = FUNC_IND AND APO_DATA = @DATA AND APO_OCORRENCIA2 =\r\n\'I\'), \'\') AS \'2Âª dig\',\r\nISNULL((SELECT dbo.fn_gettimefull(Aponta.APO_MARCACAO3) FROM Aponta\r\nWHERE APO_FUNC = FUNC_IND AND APO_DATA = @DATA AND APO_OCORRENCIA3 =\r\n\'I\'), \'\') AS \'3Âª dig\',\r\nISNULL((SELECT dbo.fn_gettimefull(Aponta.APO_MARCACAO4) FROM Aponta\r\nWHERE APO_FUNC = FUNC_IND AND APO_DATA = @DATA AND APO_OCORRENCIA4 =\r\n\'I\'), \'\') AS \'4Âª dig\',\r\nISNULL((SELECT dbo.fn_gettimefull(CAL_TRAB) FROM Calculo WHERE\r\nCAL_FUNC = FUNC_IND AND CAL_DATA = @DATA), \'\') AS \'TOTAL HORAS\',\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras WHERE BCO_FUNC = FUNC_IND AND BCO_DATA <=\r\n@DATA), \'\') AS \'SALDO BANCO\',\r\nISNULL((SELECT dbo.fn_gettimefull(APO_MARCACAO3 - APO_MARCACAO2) FROM\r\nAponta WHERE APO_FUNC = FUNC_IND AND APO_DATA = @DATA), \'\') AS\r\n\'BREAK\'\r\nFROM Funcionarios\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA , %DEPSELECIONADOIND%)\r\n= 1 AND\r\nEXISTS(SELECT * FROM Aponta WHERE APO_FUNC = FUNC_IND AND APO_DATA =\r\n@DATA)\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 15:36:42'),(331,'Comando para nao apareecer funcionario excluido e demitido','RELATORIOS','FUNC_DT_DEM IS NULL AND FUNC_MARCADO_EXCLUSAO = 0','Gabriel','2018-09-26 15:54:16'),(332,'FuncionÃ¡rio, dia da semana e expediente configurado','RELATORIOS','--COLUNAGRUPO#0#\r\n--LARGURA#200,80,80,180#\r\nSELECT FUNC_NOME AS Nome , APO_DATA AS Data, case DATEPART(weekday, APO_DATA) when 1 then \'DOMINGO\' WHEN 2 then \'SEGUNDA\'\r\nWHEN 3 then \'TERÃ‡A\' WHEN 4 then \'QUARTA\' WHEN 5 then \'QUINTA\' WHEN 6 then \'SEXTA\'\r\nWHEN 7 then \'SABADO\' ELSE \'\' END AS Semana, case when apo_Hv > 0 then dbo.fn_gettimefull(apo_Hv) else dbo.fn_expediente_dia\r\n(func_ind,CAL_DATA) end AS Expediente\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nINNER JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\n\r\nWHERE APO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL%\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL and\r\ndbo.fn_departamentopertencente( FUNC_EMPRESA,%DEPSELECIONADOIND%) = 1\r\nORDER BY FUNC_NOME,APO_DATA','Gabriel','2018-09-26 15:54:32'),(333,'Funcionario, pis, cracha ativos','RELATORIOS','select func_reg, func_nome , func_pis from funcionarios where func_dt_dem is null order by func_nome','Gabriel','2018-09-26 15:54:44'),(334,'Funcionario,pis,cracha inativos','RELATORIOS','select func_reg, func_nome , func_pis from funcionarios where func_dt_dem is not null order by func_nome','Gabriel','2018-09-26 15:54:57'),(335,'Funcionarios que trabalharam','RELATORIOS','SELECT FUNC_NOME AS NOME, FUNC_REG AS REGISTRO, CAR_DESCRICAO as CARGO, EMP_NOME AS EMPRESA\r\nFROM FUNCIONARIOS\r\nINNER JOIN EMPRESAS ON  FUNC_EMPRESA = EMP_IND\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nwhere dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) = 1\r\nAND EXISTS(SELECT * FROM Marcacoes WHERE MRC_FUNC = FUNC_IND AND MRC_DATAHORA >= %DATAINICIAL% AND MRC_DATAHORA <= %DATAFINAL%)\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 15:55:11'),(336,'funcionarios sem cracha','RELATORIOS','SELECT func_nome, cra_numero FROM Funcionarios WHERE NOT EXISTS(SELECT * FROM Crachas WHERE CRA_FUNC = FUNC_IND)','Gabriel','2018-09-26 15:55:27'),(337,'Funcionarios sem Expediente Associados','RELATORIOS','--LARGURA#100,250,100#\r\nSELECT DISTINCT emp_nome, FUNC_NOME AS Nome\r\nFROM FUNCionarios\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA \r\nleft JOIN Hora ON HR_FUNC = FUNC_INd AND HR_TIPO = 0   \r\nleft JOIN Expedientes ON INT_INd = HR_HORARIO\r\nWHERE FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL and INt_COD is null\r\nAND dbo.fn_departamentopertencente( FUNC_EMPRESA,%DEPSELECIONADOIND%) = 1\r\nORDER BY emp_nome, FUNC_NOME     ','Gabriel','2018-09-26 15:55:44'),(338,'HORAS NOTURNAS TRABALHADAS - Valor Total, por perÃ­odo e funcionÃ¡rio selecionado','RELATORIOS','--LARGURA#250,200,100,150# --TITULO#RelatÃ³rio de Horas Noturnas Trabalhadas#\r\n--COLUNAGRUPO#0#\r\n\r\ndeclare @datainicial nvarchar(30)\r\ndeclare @datafinal nvarchar(30)\r\ndeclare @periodo nvarchar(50)\r\n\r\nset @datainicial = \'01/01/2000\'\r\nset @datafinal = \'31/07/2017\'\r\nset @periodo = \'PERIODO \'\r\nset @periodo += @datainicial\r\nset @periodo += \' ATÃ‰ \'\r\nset @periodo += @datafinal\r\n\r\nSELECT DISTINCT @periodo,FUNC_NOME as Nome, CAR_DESCRICAO as Cargo,(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute\r\n(CAL_TRABN))) from calculo where CAL_DATA >= @datainicial AND CAL_DATA <= @datafinal and FUNC_IND = CAL_FUNC) as \'Trabalhado Noturno\'\r\n\r\nFROM calculo\r\n\r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\n\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO WHERE CAL_NOTURNO > 0 AND CAL_DATA >= @datainicial AND CAL_DATA <= @datafinal AND FUNC_IND =\r\n%FUNCIONARIO%\r\n\r\nGROUP BY FUNC_NOME,CAL_TRABN, CAR_DESCRICAO, CAL_DATA, FUNC_IND\r\n\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 16:24:28'),(339,'HORAS NOTURNAS TRABALHADAS - Valor Total, por perÃ­odo','RELATORIOS','--LARGURA#250,200,100,150# --TITULO#RelatÃ³rio de Horas Noturnas Trabalhadas#\r\n--COLUNAGRUPO#0#\r\n\r\ndeclare @datainicial nvarchar(30)\r\ndeclare @datafinal nvarchar(30)\r\ndeclare @periodo nvarchar(50)\r\nset @datainicial = \'01012000\'\r\nset @datafinal = \'31072017\'\r\nset @periodo = \'PERIODO \'\r\nset @periodo += @datainicial\r\nset @periodo += \' ATÃ‰ \'\r\nset @periodo += @datafinal\r\n\r\nSELECT DISTINCT @periodo,FUNC_NOME as Nome, CAR_DESCRICAO as Cargo,(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute\r\n(CAL_TRABN)))\r\n\r\nfrom calculo\r\n\r\nwhere CAL_DATA = @datainicial AND CAL_DATA = @datafinal and FUNC_IND = CAL_FUNC) as \'Trabalhado Noturno\'\r\n\r\nFROM calculo\r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO WHERE CAL_NOTURNO  0 AND CAL_DATA = @datainicial AND CAL_DATA = @datafinal\r\n\r\nGROUP BY FUNC_NOME,CAL_TRABN, CAR_DESCRICAO, CAL_DATA, FUNC_IND\r\n\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 16:24:42'),(340,'Hotas Diurnas e Noturnas na semaa e final de semana Totais- Potensa','RELATORIOS','--LARGURA#200,200,50,50,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45#\r\n--GRUPONREGISTROS#0#       \r\n--COLUNAGRUPO#0#\r\n\r\nSELECT DISTINCT EMP_Nome Empresa,FUNC_NOME \'Nome\',\r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_TRAB)))), \'\') AS \'H Trab\', \r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_ATRB)))), \'\') AS \'CargaH\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_TRAB > 0 THEN 1 ELSE 0 END) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and (DATEPART(weekday,\r\nCAL_DATA) = 2 or DATEPART(weekday, CAL_DATA) = 3 or DATEPART(weekday, CAL_DATA) = 4 or DATEPART(weekday, CAL_DATA) =\r\n5 or DATEPART(weekday, CAL_DATA) = 6) and CAL_ABONO > 0),\'\') as \'D TRAB SEG/SEXTA\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_TRAB > 0 THEN 1 ELSE 0 END) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and\r\n(DATEPART(weekday,CAL_DATA) = 1 or DATEPART(weekday, CAL_DATA) = 7) and CAL_ABONO > 0),\'\') as \'D TRAB SAB/DOM\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_ATRB > 0 THEN 1 ELSE 0 END) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and (DATEPART(weekday,\r\nCAL_DATA) = 2 or DATEPART(weekday, CAL_DATA) = 3 or DATEPART(weekday, CAL_DATA) = 4 or DATEPART(weekday, CAL_DATA) =\r\n5 or DATEPART(weekday, CAL_DATA) = 6) and CAL_ABONO > 0),\'\') as \'D ATRAB SEG/SEXTA\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_ATRB > 0 THEN 1 ELSE 0 END) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and\r\n(DATEPART(weekday,CAL_DATA) = 1 or DATEPART(weekday, CAL_DATA) = 7) and CAL_ABONO > 0),\'\') as \'D ATRAB SAB/DOM\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 ELSE 0 END) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and (DATEPART(weekday,\r\nCAL_DATA) = 2 or DATEPART(weekday, CAL_DATA) = 3 or DATEPART(weekday, CAL_DATA) = 4 or DATEPART(weekday, CAL_DATA) =\r\n5 or DATEPART(weekday, CAL_DATA) = 6) AND CAL_FALTAHORA > 0 ),\'\') as \'FaltasD SEG/SEXTA\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 ELSE 0 END) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and\r\n(DATEPART(weekday,CAL_DATA) = 1 or DATEPART(weekday, CAL_DATA) = 7) AND CAL_FALTAHORA > 0 ),\'\') as \'FaltasD SAB/DOM\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_FALTAHORA))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and (DATEPART(weekday,\r\nCAL_DATA) = 2 or DATEPART(weekday, CAL_DATA) = 3 or DATEPART(weekday, CAL_DATA) = 4 or DATEPART(weekday, CAL_DATA) =\r\n5 or DATEPART(weekday, CAL_DATA) = 6) AND CAL_FALTAHORA > 0 ),\'\') as \'FaltasH  SEG/SEXTA\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_FALTAHORA))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and\r\n(DATEPART(weekday,CAL_DATA) = 1 or DATEPART(weekday, CAL_DATA) = 7) AND CAL_FALTAHORA > 0 ),\'\') as \'FaltasH SAB/DOM\',\r\n\r\nISNULL((SELECT SUM(case when CAL_ABONO > 0  THEN 1 ELSE 0 END) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and (DATEPART(weekday,\r\nCAL_DATA) = 2 or DATEPART(weekday, CAL_DATA) = 3 or DATEPART(weekday, CAL_DATA) = 4 or DATEPART(weekday, CAL_DATA) =\r\n5 or DATEPART(weekday, CAL_DATA) = 6) and CAL_ABONO > 0),\'\') as \'ABONO SEG/SEXTA\',\r\n\r\nISNULL((SELECT SUM(case when CAL_ABONO > 0  THEN 1 ELSE 0 END) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and\r\n(DATEPART(weekday,CAL_DATA) = 1 or DATEPART(weekday, CAL_DATA) = 7) and CAL_ABONO > 0),\'\') as \'ABONO SAB/DOM\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DESCONTO - CAL_FALTAHORA))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and (DATEPART(weekday,\r\nCAL_DATA) = 2 or DATEPART(weekday, CAL_DATA) = 3 or DATEPART(weekday, CAL_DATA) = 4 or DATEPART(weekday, CAL_DATA) =\r\n5 or DATEPART(weekday, CAL_DATA) = 6) AND CAL_DESCONTO - CAL_FALTAHORA > 0 ),\'\') as \'Atrasos  SEG/SEXTA\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DESCONTO - CAL_FALTAHORA))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and\r\n(DATEPART(weekday,CAL_DATA) = 1 or DATEPART(weekday, CAL_DATA) = 7) AND CAL_DESCONTO - CAL_FALTAHORA > 0 ),\'\') as \'Atrasos SAB/DOM\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRA + CAL_EXTRAn))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and (DATEPART(weekday,\r\nCAL_DATA) = 2 or DATEPART(weekday, CAL_DATA) = 3 or DATEPART(weekday, CAL_DATA) = 4 or DATEPART(weekday, CAL_DATA) =\r\n5 or DATEPART(weekday, CAL_DATA) = 6) and CAL_EXTRA + CAL_EXTRAn > 0),\'\') as \'Extras SEG/SEXTA\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRA + CAL_EXTRAn))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and\r\n(DATEPART(weekday,CAL_DATA) = 1 or DATEPART(weekday, CAL_DATA) = 7) and CAL_EXTRA + CAL_EXTRAn > 0),\'\') as \'Extras SAB/DOM\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRAF + CAL_EXTRAnF))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and (DATEPART(weekday,\r\nCAL_DATA) = 2 or DATEPART(weekday, CAL_DATA) = 3 or DATEPART(weekday, CAL_DATA) = 4 or DATEPART(weekday, CAL_DATA) =\r\n5 or DATEPART(weekday, CAL_DATA) = 6) and CAL_EXTRAF + CAL_EXTRAnF > 0),\'\') as \'ExtrasF SEG/SEXTA\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRAF + CAL_EXTRAnF))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and\r\n(DATEPART(weekday,CAL_DATA) = 1 or DATEPART(weekday, CAL_DATA) = 7) and CAL_EXTRAF + CAL_EXTRAnF > 0),\'\') as \'Extras SAB/DOM\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_NOTURNO))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and (DATEPART(weekday,\r\nCAL_DATA) = 2 or DATEPART(weekday, CAL_DATA) = 3 or DATEPART(weekday, CAL_DATA) = 4 or DATEPART(weekday, CAL_DATA) =\r\n5 or DATEPART(weekday, CAL_DATA) = 6) AND CAL_NOTURNO > 0 ),\'\')  as \'Noturno  SEG/SEXTA\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_NOTURNO))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and\r\n(DATEPART(weekday,CAL_DATA) = 1 or DATEPART(weekday, CAL_DATA) = 7) AND CAL_NOTURNO > 0 ),\'\') as \'Noturno SAB/DOM\',              \r\n \r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRA))) as EXTRAS,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRAn))) as EXTRASN,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRAF)))  as EXTRASF,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRAnF)))  as EXTRASNF,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DESCONTO - CAL_FALTAHORA))) as ATRASOS,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_FALTAHORA))) as FALTASHORAS,\r\nSUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 ELSE 0 END) FALTASDIAS,                    \r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_ABONO))) ABONOS,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_Noturno))) NOTURNOS,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DSR))) DSR,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DDSR))) DDSR\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nleft JOIN Cargos ON CAR_IND = FUNC_CARGO\r\n\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103)\r\n\r\ngroup by FUNC_NOME,EMP_Nome,FUNC_IND\r\nOrder By EMP_Nome, FUNC_NOME','Gabriel','2018-09-26 16:25:03'),(341,'Hotas Diurnas e Noturnas trab mensais - Potensa','RELATORIOS','--ORIENTACAO#paisagem#\r\n--GRUPOQUEBRA#0#     \r\n--COLUNAGRUPO#0#\r\n--LARGURA#200,200,80,80,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40#\r\nDECLARE @INICIO SMALLDATETIME = %DATAINICIAL%\r\nDECLARE @FINAL SMALLDATETIME = %DATAFINAL%\r\n\r\nSELECT EMP_NOME EMPRESA, FUNC_NOME as NOME, (select FUNC_DT_ADM from funcionarios where FUNC_IND = CAL_FUNC ) ADMISAO,\r\n(select FUNC_DT_DEM from funcionarios where FUNC_IND = CAL_FUNC) DEMISSAO,\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and cal_data = @INICIO ) as \'1D\',\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and cal_data = @INICIO ) as \'1N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA >= @INICIO and (DATEPART(day,CAL_DATA) = 2) and CAL_DATA not in\r\n(select top 1 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL)) as \'2D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA >= @INICIO and (DATEPART(day, CAL_DATA) = 2) and CAL_DATA not in\r\n(select top 1 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL)) as \'2N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 3) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'3D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 3) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'3N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 4) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'4D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 4) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'4N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 5) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'5D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 5) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'5N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 6) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'6D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 6) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'6N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 7) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'7D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 7) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'7N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 8) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'8D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 8) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'8N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 9) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'9D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 9) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'9N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 10) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'10D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 10) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'10N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 11) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'11D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 11) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'11N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 12) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'12D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 12) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'12N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 13) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'13D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 13) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'13N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 14) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'14D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 14) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'14N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 15) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'15D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 15) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'15N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 16) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'16D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 16) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'16N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 17) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'17D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 17) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'17N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 18) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'18D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 18) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'18N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 19) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'19D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 19) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'19N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 20) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'20D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 20) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'20N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 21) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'21D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 21) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'21N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 22) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'22D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 22) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'22N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 23) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'23D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 23) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'23N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 24) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'24D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 24) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'24N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 25) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'25D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 25) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'25N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 26) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'26D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 26) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'26N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 27) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'27D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 27) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'27N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 28) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'28D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 28) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'28N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 29) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'29D\',\r\n                                                                                              \r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 29) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'29N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 30) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'30D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and CAL_DATA > @INICIO and (DATEPART(day, CAL_DATA) = 30) and CAL_DATA not in\r\n(select top 2 cal_data from calculo where CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL) ) as \'30N\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and cal_data = @FINAL ) as \'31D\',\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' else dbo.fn_gettimefull(CAL_TRABN) end\r\nfrom calculo where FUNC_IND = CAL_FUNC and cal_data = @FINAL ) as \'31N\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1 and\r\nCAL_DATA >= @INICIO AND CAL_DATA <= @FINAL\r\nGROUP BY EMP_NOME, FUNC_NOME,FUNC_IND,CAL_FUNC\r\nORDER BY EMP_NOME, FUNC_NOME','Gabriel','2018-09-26 16:25:18'),(342,'IMPLANTACAO NAO AGENDADAS','RELATORIOS','/****** RELATORIO DE IMPLANTAÃ‡OES NAO AGENDADAS ******/\r\nSELECT convert(char(10),IM_INICIO,103)  \'INICIO DA IMPLANTACAO\'\r\n      ,STAT_NOME \'STATUS\'\r\n      ,[CAD_RAZAOSOCIAL] \'RAZAO SOCIAL\'\r\n      ,case when [CAD_CNPJ] IS not null then [CAD_CNPJ] when [CAD_CPF] IS not null then [CAD_CPF] ELSE \'\' end CNPJ\r\n      ,[CAD_CONTATO] CONTATO\r\n      ,CAD_UF ESTADO\r\n      ,[CAD_TELEFONE1_DDD] DDD\r\n      ,[CAD_TELEFONE1] TELEFONE\r\n      ,[CAD_TELEFONE2_DDD] DDD2\r\n      ,[CAD_TELEFONE2] TELEFONE2\r\n      ,[CAD_TELEFONE3_DDD] DDD3\r\n      ,[CAD_TELEFONE3] TELEFONE3\r\n      ,[CAD_CELULAR_DDD] DDD\r\n      ,[CAD_CELULAR] CELULAR\r\n      ,case when [_CAD_ENT_TELEFONE1] IS not null then [_CAD_ENT_TELEFONE1] else [_CAD_ENT_TELEFONE2] end \'OUTROS CONTATOS\'\r\n      ,[CAD_EMAIL] EMAIL\r\n      ,[CAD_EMAIL2] EMAIL2\r\n      ,[CAD_EMAIL3] EMAIL3\r\n      ,[CAD_OBS] OBS\r\n  FROM [assecont1].[dbo].[AssepontoClientes]\r\n  INNER JOIN AssepontoImplantacoes ON IM_CLIENTE = CAD_IND\r\n  INNER JOIN AssepontoImplantacoesStatus ON [IM_ANDAMENTO] = STAT_IND\r\n  WHERE  IM_FINALIZADO_POR IS NULL AND IM_INICIO >= \'01/01/2016\' AND \r\n  [IM_AGENDADO_POR] IS NULL AND [IM_ANDAMENTO] <> 7 AND [IM_ANDAMENTO] <> 8','Gabriel','2018-09-26 16:25:33'),(343,'IMPLANTACAO NAO FINALIZADAS','RELATORIOS','SELECT convert(char(10),IM_INICIO,103)  \'INICIO DA IMPLANTACAO\'\r\n      ,STAT_NOME \'STATUS\'\r\n      ,[CAD_RAZAOSOCIAL] \'RAZAO SOCIAL\'\r\n      ,case when [CAD_CNPJ] IS not null then [CAD_CNPJ] when [CAD_CPF] IS not null then [CAD_CPF] ELSE \'\' end CNPJ\r\n      ,[CAD_CONTATO] CONTATO\r\n      ,CAD_UF ESTADO\r\n      ,[CAD_TELEFONE1_DDD] DDD\r\n      ,[CAD_TELEFONE1] TELEFONE\r\n      ,[CAD_TELEFONE2_DDD] DDD2\r\n      ,[CAD_TELEFONE2] TELEFONE2\r\n      ,[CAD_TELEFONE3_DDD] DDD3\r\n      ,[CAD_TELEFONE3] TELEFONE3\r\n      ,[CAD_CELULAR_DDD] DDD\r\n      ,[CAD_CELULAR] CELULAR\r\n      ,case when [_CAD_ENT_TELEFONE1] IS not null then [_CAD_ENT_TELEFONE1] else [_CAD_ENT_TELEFONE2] end \'OUTROS CONTATOS\'\r\n      ,[CAD_EMAIL] EMAIL\r\n      ,[CAD_EMAIL2] EMAIL2\r\n      ,[CAD_EMAIL3] EMAIL3\r\n      ,[CAD_OBS] OBS\r\n  FROM [assecont1].[dbo].[AssepontoClientes]\r\n  INNER JOIN AssepontoImplantacoes ON IM_CLIENTE = CAD_IND\r\n  INNER JOIN AssepontoImplantacoesStatus ON [IM_ANDAMENTO] = STAT_IND\r\n  WHERE IM_FINALIZADO_POR IS NULL AND  IM_INICIO >= \'01/01/2016\' AND [IM_ANDAMENTO] <> 7 AND [IM_ANDAMENTO] <> 8','Gabriel','2018-09-26 16:25:46'),(344,'Nome, Cargo, AdmissÃ£o e Horario','RELATORIOS','--LARGURA#200,200,150,200#\r\nSELECT FUNC_NOME, CAR_DESCRICAO, FUNC_DT_ADM, (SELECT TOP 1 INT_DESCRICAO FROM Hora INNER JOIN Expedientes ON INT_IND = HR_HORARIO WHERE \r\nHR_FUNC = FUNC_IND AND HR_TIPO = 0\r\nORDER BY HR_DATAINICIAL DESC) AS HORAIO\r\nFROM Funcionarios\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nWHERE FUNC_DT_DEM IS NULL AND FUNC_MARCADO_EXCLUSAO = 0\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 16:25:58'),(345,'REG, NOME, EMPRESA,EXTRAS, FALTAS , ATRASOS, NOTURNOS POR FUNCIONARIO E TOTALIZADO','RELATORIOS','--ORIENTACAO#paisagem#\r\n--LARGURA#60,150,200,100,80,80,80,80,80,80,80#\r\nSELECT FUNC_REG AS Registro, FUNC_NOME AS Nome,\r\nCAR_DESCRICAO AS CARGO, EMP_NOME AS Setor,\r\n\r\nSUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 ELSE 0 END) as Faltas,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DESCONTO\r\n- CAL_FALTAHORA))) as Atrasos,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute\r\n(CAL_NOTURNO))) as Noturno,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRA)))\r\nas \'Extras Diurnas\',\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute\r\n(CAL_EXTRAn))) as \'Extra Noturna%\'\r\nFROM Funcionarios\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nINNER JOIN Calculo ON CAL_FUNC = FUNC_IND\r\nLEFT JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nWHERE (CAL_NOTURNO > 0 OR CAL_EXTRA > 0 OR CAL_EXTRAN > 0 OR\r\nCAL_DESCONTO > 0) AND\r\nCAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%                           \r\nGROUP BY FUNC_REG, FUNC_NOME, CAR_DESCRICAO, EMP_NOME \r\nORDER BY  EMP_NOME, FUNC_NOME','Gabriel','2018-09-26 16:26:11'),(346,'RELAOTIRO DE BANCO DE HORAS E ADICIONAL NOTURNO','RELATORIOS','--COLUNAGRUPO#1#\r\n--LARGURA#220,220,80,80,80,80#                                                           \r\nSELECT distinct FUNC_NOME AS NOME, EMP_NOME AS EMPRESA,\r\n                  \r\nCASE WHEN CAL_NOTURNO > 0 THEN dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_NOTURNO))) ELSE \'\' END as \'ADICIONAL NOTURNO\', \r\n                                             \r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute                               \r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA AND\r\nSUBSTRING(BCO_VALOR, 1, 1) <> \'-\') AS CREDITO,\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA\r\nAND SUBSTRING(BCO_VALOR, 1, 1) = \'-\') AS DEBITO,\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras WHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA), \'\') AS SALDO\r\n\r\nFROM FUNCIONARIOS\r\nINNER JOIN EMPRESAS ON  FUNC_EMPRESA = EMP_IND\r\nINNER JOIN calculo ON FUNC_IND = CAL_FUNC              \r\nwhere dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) = 1 AND FUNC_DT_DEM IS NULL\r\nand FUNC_MARCADO_EXCLUSAO = 0 AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%\r\nGROUP BY FUNC_NOME, EMP_NOME, CAL_NOTURNO, FUNC_IND, CAL_DATA    \r\nORDER BY EMP_NOME, FUNC_NOME','Gabriel','2018-09-26 16:26:22'),(347,'RelatÃ³rio  APONTAMENTO por dia das marcaÃ§Ã£o, ferias, afastamento, DSR,  atraso, extras, normais e o total ','RELATORIOS','--LARGURA# 40,280,60,60,60,60,60,60,60,60,60,60,60,60,60#\r\n  \r\nDECLARE @DATA SMALLDATETIME\r\nSET @DATA = \'09/02/2014\'\r\n\r\nSELECT FUNC_REG AS Registro, \'001\' + FUNC_NOME AS Nome,\r\ndbo.fn_gettimefull(APO_MARCACAO1) AS \'Entrada1\',\r\ndbo.fn_gettimefull(APO_MARCACAO2) AS \'Saida1\',\r\ndbo.fn_gettimefull(APO_MARCACAO3) AS \'Entrada2\',\r\ndbo.fn_gettimefull(APO_MARCACAO4) AS \'Saida2\',\r\ndbo.fn_gettime5nullzero(CAL_TRAB) AS Normais,\r\n(CASE WHEN\r\n(SELECT TOP 1 dbo.fn_periodo_esta_contido(FER_DATA1, FER_DATA2,\r\nCAL_DATA, CAL_DATA)\r\nFROM FERIAS WHERE FER_FUNC = FUNC_IND) = 1 THEN \'Ferias\' ELSE\r\n(CASE WHEN (SELECT TOP 1 dbo.fn_periodo_esta_contido(AFA_DATA1,\r\nAFA_DATA2,\r\nCAL_DATA, CAL_DATA)\r\nFROM Afastamentos WHERE AFA_FUNC = FUNC_IND) = 1 THEN \'Afastado\'\r\nELSE\r\n    (CASE WHEN CAL_DESCONTO > 0 THEN dbo.fn_gettime5nullzero\r\n(CAL_DESCONTO) ELSE\r\n        (CASE APO_H WHEN -990 THEN \'FOLGA\' WHEN -999 THEN \'DSR\' END)\r\n    END ) END) END) AS \'Faltas\',\r\ndbo.fn_gettime5nullzero(CAL_EXTRA) As Extras,\r\ndbo.fn_gettime5nullzero(CAL_ATRB) AS Cargas\r\nFROM Calculo\r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nWHERE APO_DATA = @DATA\r\nUNION\r\nSELECT \' \', \' Total \' AS Nome,\r\nCONVERT(VARCHAR,COUNT(FUNC_IND)),\'\',\'\',\'\',\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute\r\n(CAL_TRAB))),\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute\r\n(CAL_DESCONTO))) AS \'Faltas\',\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute\r\n(CAL_EXTRA))),\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute\r\n(CAL_ATRB)))\r\nFROM Calculo\r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nWHERE CAL_DATA = @DATA\r\nUNION\r\nSELECT \' \', \'Sistema Asseponto4 - Emitido em \' + dbo.fn_getdatetime\r\n(GETDATE()) AS Nome,\'\',\'\',\'\',\'\', \'\',\'\',\'\',\'\'\r\nFROM Calculo\r\nUNION\r\nSELECT \' \', \'Periodo \' + + dbo.fn_getdate\r\n(@DATA) AS Nome,\'\',\'\',\'\',\'\', \'\',\'\',\'\',\'\'\r\nFROM Calculo\r\nORDER BY Nome','Gabriel','2018-09-26 16:26:36'),(348,'RelatÃ³rio  Banco de horas detalhado','RELATORIOS','--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\n--LARGURA#100,100,100,100,100#\r\nEXEC rst_banco_horas_detalhado\r\n@P_GRUPO = %GRUPO%,\r\n@P_DATAINICIAL = %DATAINICIAL%,\r\n@P_DATAFINAL = %DATAFINAL%\r\n','Gabriel','2018-09-26 16:26:50'),(349,'RelatÃ³rio  bcototal nome reg departamento cargo','RELATORIOS','EXEC rst_banco_horas_totalizado\r\n@P_GRUPO = %GRUPO%,\r\n@P_DATAINICIAL = \'Data Inicial do periodo\',\r\n@P_DATAFINAL = \'Data Final do periodo\',\r\n@P_TIPO_EXIBICAO_FUNCIONARIO = 1','Gabriel','2018-09-26 16:33:01'),(350,'RelatÃ³rio adcional Noturno detalhado','RELATORIOS','CREATE TABLE #dbtFuncionarios (\r\n    FUNC INT\r\n    ) ON [PRIMARY]\r\nINSERT INTO #dbtFuncionarios\r\nSELECT FUNC_IND FROM Funcionarios WHERE\r\ndbo.fn_departamentopertencente(FUNC_EMPRESA,  %DEPSELECIONADOIND%) = 1\r\nEXEC rst_relatorio_apontamento_detalhes \r\n@P_DEPARTAMENTO = %DEPSELECIONADOIND%,\r\n@P_TRAB = 0,\r\n@P_ATRB = 0,\r\n@P_EXTRA = 0,\r\n@P_EXTRAN = 0,\r\n@P_EXTRAF = 0,\r\n@P_EXTRANF = 0,\r\n@P_DESCONTO =0,\r\n@P_FALTAHORA = 0,\r\n@P_FALTADIA =0,\r\n@P_ABONO = 0,\r\n@P_NOTURNO = 1,\r\n@P_DSR = 0,\r\n@P_DDSR = 0,\r\n@P_DATAINICIAL = %DATAINICIAL%,\r\n@P_DATAFINAL = %DATAFINAL%,\r\n@P_EXIBIR_CARGO = 1\r\nDROP TABLE #dbtFuncionarios','Gabriel','2018-09-26 16:33:22'),(351,'RelatÃ³rio Afastamentos por departamento (NÃ£o Engloba FÃ©rias)','RELATORIOS','--LARGURA#200,200, 80, 80#\r\nSELECT FUNC_NOME AS NOME, AFA_DESCRICAO_ESPELHO AS MOTIVO, AFA_DATA1\r\nAS INICIO, AFA_DATA2 AS FINAL FROM\r\nFuncionarios INNER JOIN\r\nAfastamentos ON AFA_FUNC = FUNC_IND WHERE AFA_DATA1 >= \'01/01/2010\' AND\r\ndbo.fn_departamentopertencente(FUNC_EMPRESA,\r\n%DEPSELECIONADOIND%) = 1 ORDER BY FUNC_NOME','Gabriel','2018-09-26 16:35:23'),(352,'RelatÃ³rio Afastamentos por departamento','RELATORIOS','--LARGURA#200,200, 80, 80#\r\nSELECT FUNC_NOME AS NOME, AFA_DESCRICAO_ESPELHO AS MOTIVO, AFA_DATA1\r\nAS INICIO, AFA_DATA2 AS FINAL FROM\r\nFuncionarios INNER JOIN\r\nAfastamentos ON AFA_FUNC = FUNC_IND WHERE dbo.fn_funcionario_afastado\r\n(FUNC_IND, \'01/01/2010\') = 1 AND\r\ndbo.fn_departamentopertencente(FUNC_EMPRESA,\r\n%DEPSELECIONADOIND%) = 1 ORDER BY FUNC_NOME','Gabriel','2018-09-26 16:35:40'),(353,'Relatorio AFD','RELATORIOS','--TITULO#RelatÃ³rio AFD#\r\n--LARGURA#300,300#\r\ndeclare @nsr varchar(10) = \'0000000003\'\r\nSELECT (@nsr + replace(convert(char(10),MRC_DATAHORA,103),\'/\',\'\') +  replace(convert(char(5),MRC_DATAHORA,114),\':\',\'\') + \'0\' + MRC_PIS) \r\nAFD, isnull(Func_nome, \'\')  Nome   \r\nFROM Marcacoes\r\nleft JOIN Funcionarios ON MRC_FUNC = FUNC_IND and MRC_PIS = func_pis    \r\nWHERE MRC_DATAHORA >= %DATAINICIAL% AND MRC_DATAHORA <= %DATAFINAL%\r\nAND FUNC_DT_DEM IS NULL and FUNC_MARCADO_EXCLUSAO = 0 and MRC_PIS is Not null        \r\nORDER BY Func_nome,MRC_DATAHORA','Gabriel','2018-09-26 16:35:54'),(354,'RelatÃ³rio Banco de Horas por Descricao e por Data','RELATORIOS','--%DATAINICIAL% = Data inicial do apontamento aberto\r\n--%DATAFINAL% = Data final do apontamento aberto\r\n--ou, trocar\r\n--%DATAINICIAL% pela data inicial pretendida. Ex: \'01/06/2011\'\r\n--%DATAFINAL% pela data final pretendida. Ex: \'30/06/2011\'\r\n--Obs. incluindo as aspas da data\r\nSELECT FUNC_NOME AS NOME, BCO_DATA AS DATA, BCO_VALOR AS VALOR,\r\nBCO_DESCRICAO AS DESCRICAO\r\nFROM BCOHORAS\r\nINNER JOIN FUNCIONARIOS ON FUNC_IND = BCO_FUNC\r\nWHERE BCO_DESCRICAO LIKE \'%COMPEN%\'\r\nAND BCO_DATA >= %DATAINICIAL% AND BCO_DATA <= %DATAFINAL%\r\nORDER BY FUNC_NOME, BCO_DATA\r\n ','Gabriel','2018-09-26 16:36:11'),(355,'RelatÃ³rio Banco de Horas totalizado Nome Cargo Departamento Cred Deb e Saldo final','RELATORIOS','--LARGURA#100,100,100,100,100#\r\nEXEC rst_banco_horas_totalizado\r\n@P_GRUPO = %GRUPO%,\r\n@P_TIPO_EXIBICAO_FUNCIONARIO = 1','Gabriel','2018-09-26 16:36:26'),(356,'Relatorio Banco de Horas-Extra','RELATORIOS','SELECT FUNC_NOME, (SELECT ISNULL(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR)), \'0\')\r\nFROM BcoHoras WHERE BCO_FUNC = FUNC_IND\r\nAND BCO_DATA >= %DATAINICIAL% AND BCO_DATA <= %DATAFINAL%) as Banco,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRA) +\r\ndbo.fn_smalldatetimetominute(CAL_EXTRAN) +\r\ndbo.fn_smalldatetimetominute(CAL_EXTRANF)))\r\nas Extra\r\n        FROM Calculo\r\n        INNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\n        WHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,\r\n%DEPSELECIONADOIND%) =1\r\n        AND FUNC_MARCADO_EXCLUSAO = 0\r\n        AND FUNC_DT_DEM IS NULL    AND CAL_DATA >= %DATAINICIAL%\r\n        AND CAL_DATA <= %DATAFINAL%\r\n        GROUP BY FUNC_NOME, FUNC_IND','Gabriel','2018-09-26 16:36:51'),(357,'relatÃ³rio com o Total de Extras do Intervalo por Periodo ','RELATORIOS','SET DATEFORMAT DMY;\r\n\r\nCREATE TABLE #TIME(\r\nIND INT PRIMARY KEY IDENTITY,\r\nFUNC INT,\r\nMES INT,\r\nANO INT, \r\nEXTRAINT INT,\r\nEXTRA NVARCHAR(10)\r\n);\r\n\r\n\r\nDECLARE @F INT,\r\n		@DATAINICIAL DATETIME = %DATAINICIAL%,\r\n		@DATAFINAL DATETIME = %DATAFINAL%\r\n		\r\nSET @F = (SELECT TOP 1 FUNC_IND \r\n		  FROM Funcionarios \r\n		  WHERE EXISTS(SELECT * FROM Aponta\r\n					   WHERE FUNC_IND = APO_FUNC AND \r\n							 APO_H1 IS NOT NULL AND\r\n							 APO_MARCACAO1 IS NOT NULL) AND \r\n		  FUNC_DT_DEM IS NULL AND \r\n		  (FUNC_MARCADO_EXCLUSAO = 0 OR \r\n		   FUNC_MARCADO_EXCLUSAO IS NULL) \r\n		  ORDER BY FUNC_IND ASC)\r\n\r\nWHILE EXISTS(SELECT * FROM Funcionarios WHERE \r\n				EXISTS(SELECT * FROM Aponta WHERE FUNC_IND = APO_FUNC AND APO_H1 IS NOT NULL AND APO_MARCACAO1 IS NOT NULL) AND \r\n				FUNC_DT_DEM IS NULL AND (FUNC_MARCADO_EXCLUSAO = 0 OR FUNC_MARCADO_EXCLUSAO IS NULL) AND FUNC_IND >= @F)\r\nBEGIN\r\n\r\n	IF EXISTS(SELECT APO_IND FROM APONTA\r\n				INNER JOIN FUNCIONARIOS ON FUNC_IND = APO_FUNC\r\n				INNER JOIN EXPEDIENTES ON APO_H = INT_IND\r\n				WHERE FUNC_DT_DEM IS NULL AND \r\n				APO_H2 IS NOT NULL AND APO_H3 IS NOT NULL AND APO_HV IS NULL AND \r\n				APO_MARCACAO2 IS NOT NULL AND APO_MARCACAO3 IS NOT NULL AND INT_PERIODO_UNICO = 0 AND\r\n				APO_DATA >= @DATAINICIAL AND APO_DATA <= @DATAFINAL AND\r\n				APO_FUNC = @F)\r\n	BEGIN\r\n		INSERT INTO #TIME (FUNC, MES, ANO, EXTRAINT)\r\n		SELECT B.FUNC_IND, \r\n			   AB.MES,\r\n			   AB.ANO,\r\n			   AB.EXTRASINT\r\n		FROM APONTA A\r\n		INNER JOIN FUNCIONARIOS B ON B.FUNC_IND = A.APO_FUNC\r\n		INNER JOIN EXPEDIENTES C ON A.APO_H = C.INT_IND\r\n		CROSS APPLY(\r\n			SELECT \r\n				(CASE \r\n					WHEN C.INT_COMPENSARINTERVALO = 1\r\n					THEN (CASE \r\n							  WHEN DATEDIFF(MINUTE, D.APO_H2, D.APO_H3) > DATEDIFF(MINUTE, D.APO_MARCACAO2, D.APO_MARCACAO3)\r\n							  THEN DATEDIFF(MINUTE, D.APO_H2, D.APO_H3) - DATEDIFF(MINUTE, D.APO_MARCACAO2, D.APO_MARCACAO3)\r\n							  ELSE 0\r\n						  END)\r\n					ELSE (CASE \r\n							  WHEN DATEDIFF(MINUTE, D.APO_H2, D.APO_MARCACAO2) < 0 \r\n							  THEN 0 \r\n							  ELSE DATEDIFF(MINUTE, D.APO_H2, D.APO_MARCACAO2)\r\n						  END) +\r\n						 (CASE \r\n							  WHEN DATEDIFF(MINUTE, D.APO_MARCACAO3, D.APO_H3) < 0\r\n							  THEN 0\r\n							  ELSE DATEDIFF(MINUTE, D.APO_MARCACAO3, D.APO_H3)\r\n						  END)\r\n				END) AS EXTRASINT,\r\n				DATEPART(MONTH, D.APO_DATA) AS MES,\r\n				DATEPART(YEAR, D.APO_DATA) AS ANO \r\n			FROM Aponta D \r\n			WHERE D.APO_IND = A.APO_IND\r\n		) AB\r\n		WHERE \r\n		FUNC_DT_DEM IS NULL AND \r\n		APO_H2 IS NOT NULL AND APO_H3 IS NOT NULL AND APO_HV IS NULL AND \r\n		APO_MARCACAO2 IS NOT NULL AND APO_MARCACAO3 IS NOT NULL AND INT_PERIODO_UNICO = 0 AND\r\n		APO_DATA >= @DATAINICIAL AND APO_DATA <= @DATAFINAL AND\r\n		APO_FUNC = @F\r\n	END\r\n	SET @F = @F + 1\r\nEND\r\n\r\n		  \r\nSELECT FUNC_NOME AS NOME,((CASE WHEN LEN(MES) = 1\r\n							    THEN \'0\' + CONVERT(VARCHAR(2), MES)\r\n							    ELSE CONVERT(VARCHAR(2), MES)\r\n					       END) + \'/\' + CONVERT(VARCHAR(4), ANO)) AS PERIODO, \r\n	   DBO.fn_minutetohourlong(SUM(EXTRAINT)) AS EXTRAS FROM #TIME\r\nINNER JOIN Funcionarios ON FUNC = FUNC_IND\r\nGROUP BY FUNC_NOME, MES, ANO\r\nORDER BY FUNC_NOME\r\n\r\nDROP TABLE #TIME','Gabriel','2018-09-26 16:37:08'),(358,'RELATORIO converte valores de credito em extras - 4all','RELATORIOS','--LARGURA# 280,150,70,80,60,60,60,60,60,60,60,60,60,60,60,60,60,70,80,120#\r\n--COLUNAGRUPO#1#\r\ndeclare @HE datetime = \'02:00\'\r\nSELECT FUNC_NOME AS Nome, EMP_NOME As EMPRESA,\r\ndbo.fn_getdate(CAL_DATA) AS \'Data\',\r\n(SELECT CASE DATEPART(w, CAL_DATA) WHEN 1 THEN \'Domingo\' WHEN 2 THEN \'Segunda-feira\' WHEN 3 THEN \'TerÃ§a-feira\'\r\nWHEN 4 THEN \'Quarta-feira\' WHEN 5 THEN \'Quinta-feira\' WHEN 6 THEN \'Sexta-feira\' WHEN 7 THEN \'SÃ¡bado\' END) AS \'DIA DA SEMANA\',\r\ndbo.fn_gettimefull(APO_MARCACAO1) AS \'Entrada1\',\r\ndbo.fn_gettimefull(APO_MARCACAO2) AS \'Saida1\',\r\ndbo.fn_gettimefull(APO_MARCACAO3) AS \'Entrada2\',\r\ndbo.fn_gettimefull(APO_MARCACAO4) AS \'Saida2\',\r\ndbo.fn_gettimefull(APO_MARCACAO5) AS \'Entrada3\',\r\ndbo.fn_gettimefull(APO_MARCACAO6) AS \'Saida3\',\r\ndbo.fn_gettimefull(APO_MARCACAO7) AS \'Entrada4\',\r\ndbo.fn_gettimefull(APO_MARCACAO8) AS \'Saida4\',\r\ndbo.fn_gettime5nullzero(CAL_TRAB) AS Realizado,\r\n\r\ndbo.fn_minutetohourlong((CASE WHEN BCO_status in (3,4) THEN (dbo.fn_hourlongtominute(BCO_VALOR)/2)\r\nELSE \'\' end) + (CASE WHEN BCO_status in (1,2) THEN (dbo.fn_hourlongtominute(BCO_VALOR)) ELSE \'\' end)) as EXTRAS,\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA AND\r\nSUBSTRING(BCO_VALOR, 1, 1) <> \'-\') AS CREDITO,\r\n\r\n(CASE WHEN (SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA AND\r\nSUBSTRING(BCO_VALOR, 1, 1) <> \'-\') < @HE and BCO_status in (1) THEN CONVERT(VARCHAR(5),(BCO_VALOR),108)\r\nWHEN (SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA AND\r\nSUBSTRING(BCO_VALOR, 1, 1) <> \'-\') >= @HE and BCO_status in (1) THEN \'2:00\' ELSE \'\' end) as \'Extra 50%\',\r\n\r\nCASE WHEN (SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA AND\r\nSUBSTRING(BCO_VALOR, 1, 1) <> \'-\') > @HE and BCO_status in (1) THEN CONVERT(VARCHAR(5), CAST((BCO_VALOR - @HE) AS TIME(0)),108)\r\nELSE \'\' end as \'Extra 75%\',\r\n\r\n(select CONVERT(VARCHAR(5),(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(BCO_VALOR)/2)))),108) from BcoHoras WHERE BCO_FUNC = FUNC_IND\r\nand BCO_DATA = CAL_DATA and BCO_status in (3))  \'Extra 100%\',\r\n\r\n(CASE WHEN CAL_TRABN > 0 and CAL_TRABN < @HE and DATEPART(w, CAL_DATA) in (1,7) then dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute\r\n(CAL_TRABN)*60/52.5))) WHEN CAL_TRABN <= 0 THEN \'\'\r\nWHEN CAL_TRABN > 0 and DATEPART(w, CAL_DATA) in (2,3,4,5,6) then dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute\r\n(CAL_TRABN)*60/52.5))) ELSE \'2:17\' end) as  \'Adicional 60% Noturna\',\r\n\r\ncase when BCO_status in (2,4) then (select CONVERT(VARCHAR(5),(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(BCO_VALOR)/2)))),108)                                                                                    \r\nfrom BcoHoras WHERE BCO_FUNC = FUNC_IND and BCO_DATA = CAL_DATA and BCO_status in (2,4) ) else \'\' end \'Extra 100% Noturna\'\r\n\r\nFROM Calculo\r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nINNER JOIN BcoHoras on BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA\r\nINNER JOIN EMPRESAS ON  FUNC_EMPRESA = EMP_IND\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA, %DEPSELECIONADOIND%) =1\r\nAND FUNC_DT_DEM IS NULL and FUNC_MARCADO_EXCLUSAO = 0 AND CAL_DATA >= %DATAINICIAL%\r\nAND CAL_DATA <= %DATAFINAL% and (APO_MARCACAO1 IS not NULL OR APO_MARCACAO2 IS not NULL OR\r\nAPO_MARCACAO3 IS not NULL OR APO_MARCACAO4 IS not NULL)                        \r\n                                                 \r\ngroup by EMP_NOME, FUNC_NOME, CAL_DATA, FUNC_IND, CAL_TRAB, BCO_status, BCO_VALOR, CAL_NOTURNO, APO_MARCACAO1, APO_MARCACAO2,\r\nCAL_ABONO,CAL_TRABN, APO_MARCACAO3, APO_MARCACAO4, APO_MARCACAO5, APO_MARCACAO6, APO_MARCACAO7, APO_MARCACAO8\r\norder by EMP_NOME, FUNC_NOME, CAL_DATA','Gabriel','2018-09-26 16:37:27'),(359,'RELATORIO DE ABSSENTEISMOS TOTALIZADO','RELATORIOS','--LARGURA#200,140,45,40,45,50,60,60,45,60,60,60,60,60,60,80#\r\nSELECT FUNC_NOME \'Nome\',\r\n(SELECT sum(CASE WHEN CAL_FALTAHORA > 0 THEN 1 ELSE \'\' END) from Calculo where FUNC_IND = CAL_FUNC and\r\nCAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%) AS Faltas,\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(dbo.fn_gettime(CAL_DESCONTO)))) from Calculo where FUNC_IND = CAL_FUNC and      \r\n  \r\nCAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL% AND CAL_FALTAHORA <= 0) AS DESCONTO               \r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC  \r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND CAL_ATRB > 0\r\nAND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL% and (CAL_FALTAHORA > 0 OR CAL_DESCONTO > 0)\r\ngroup by FUNC_NOME, FUNC_IND\r\nOrder By FUNC_NOME','Gabriel','2018-09-26 16:37:42'),(360,'Relatorio de Adcional noturno  organizado por departamento','RELATORIOS','--GRUPONREGISTROS#0# \r\n--COLUNAGRUPO#0#\r\n--LARGURA#300,300#\r\nSELECT EMP_NOME, FUNC_NOME as Nome,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_NOTURNO))) as Noturno\r\nFROM Funcionarios\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nINNER JOIN Calculo ON CAL_FUNC = FUNC_IND\r\nWHERE CAL_NOTURNO > 0      \r\nAND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%\r\nAND dbo.fn_departamentopertencente(FUNC_EMPRESA,\r\n%DEPSELECIONADOIND%) = 1\r\nGROUP BY FUNC_NOME, EMP_NOME','Gabriel','2018-09-26 16:37:54'),(361,'Relatorio de almoÃ§o menor 30min ou maior que 2h e total de horas trabaladas no primeiro periodo ','RELATORIOS','--LARGURA#80,200,50,50,50,50,70,70,70,80,80#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#1#                                                                                                                            \r\nSELECT dbo.fn_getdate(CAL_DATA) AS \'Data\', FUNC_NOME \'Nome\',\r\ndbo.fn_gettimefull(APO_MARCACAO1) AS \'Entrada\',\r\ndbo.fn_gettimefull(APO_MARCACAO2) AS \'Saida A\',\r\ndbo.fn_gettimefull(APO_MARCACAO3) AS \'Retorno A\',                                                                     \r\ndbo.fn_gettimefull(APO_MARCACAO4) AS \'Saida\',\r\n                                                                   \r\nISNULL(dbo.fn_gettime5nullzero(CAL_ATRB), \'\') AS \'A Trabalhar\',\r\n\r\nISNULL(dbo.fn_gettime5nullzero(CAL_TRAB + CAL_EXTRA + CAL_EXTRAN + CAL_EXTRAF + CAL_EXTRANF), \'\') AS \'Trabalhadas\',\r\n\r\nISNULL(dbo.fn_gettime5nullzero(APO_MARCACAO2 - APO_MARCACAO1), \'\') \'Horario Manha\',\r\n\r\nISNULL(dbo.fn_gettime5nullzero(APO_MARCACAO4 - APO_MARCACAO3), \'\') \'Horario Tarde\',\r\n\r\nISNULL(dbo.fn_gettime5nullzero(APO_MARCACAO3 - APO_MARCACAO2), \'\') \'Horario AlmoÃ§o\' \r\n\r\nFROM Funcionarios                                                                      \r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL% and\r\n((APO_MARCACAO2 - APO_MARCACAO1) > \'6:00\' or (APO_MARCACAO4 - APO_MARCACAO3) > \'6:00\' or (APO_MARCACAO3 - APO_MARCACAO2) > \'2:00\' \r\nor (APO_MARCACAO3 - APO_MARCACAO2) < \'0:30\')\r\ngroup by FUNC_NOME, CAL_DATA, CAL_TRAB,CAL_ATRB,FUNC_IND,CAL_EXTRAF, CAL_EXTRANF,CAL_EXTRA,\r\nCAL_EXTRAn,APO_MARCACAO1,APO_MARCACAO2,APO_MARCACAO3,APO_MARCACAO4\r\nOrder By FUNC_NOME, CAL_DATA','Gabriel','2018-09-26 16:38:07'),(362,'Relatorio de Atraso na Entrada, Saida e Descontos','RELATORIOS','--COLUNAGRUPO#0#\r\n--LARGURA#220, 100, 100, 100, 100#\r\nSELECT FUNC_NOME AS NOME, CAL_DATA AS DATA,\r\n\r\nISNULL((SELECT dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(PAPO_ATRASO1_FIM - PAPO_ATRASO1_INICIO)\r\n) )) FROM\r\nPreAponta WHERE PAPO_FUNC = FUNC_IND AND PAPO_ATRASO1_FIM IS NOT NULL\r\nAND PAPO_DATA = CAL_DATA), \'\') AS \'Atrasos na entrada\',\r\n\r\nISNULL((SELECT dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(PAPO_ATRASO4_FIM -\r\nPAPO_ATRASO4_INICIO)))) FROM\r\nPreAponta WHERE PAPO_FUNC = FUNC_IND AND PAPO_DATA = CAL_DATA), \'\') AS \'SaÃ­da atecipadas\',\r\n                                                             \r\ndbo.fn_gettime5nullzero(CAL_DESCONTO) as \'Descontos\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON CAL_FUNC = FUNC_IND\r\nWHERE CAL_DESCONTO > 0 and FUNC_DT_DEM IS NULL and FUNC_MARCADO_EXCLUSAO = 0 and \r\ndbo.fn_departamentopertencente\r\n(FUNC_EMPRESA,\r\n%DEPSELECIONADOIND%) = 1 and CAL_DATA >= %DATAINICIAL%\r\nAND CAL_DATA <= %DATAFINAL%\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 16:38:20'),(363,'Relatorio de atrasos, faltas','RELATORIOS','--LARGURA#80,200,140,45,40,45,50,60,60,45,60,60,60,60,60,60,80#                                                                                                                          \r\nSELECT dbo.fn_getdate(CAL_DATA) AS \'Data\', FUNC_NOME \'Nome\',\r\nCASE WHEN CAL_FALTAHORA > 0 THEN \'FALTA\' ELSE \'\' END AS Faltas  \r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND CAL_ATRB > 0\r\nAND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%         \r\ngroup by FUNC_NOME, CAL_DATA, CAL_ATRB,FUNC_IND,CAL_DESCONTO,CAL_FALTAHORA\r\nOrder By FUNC_NOME, CAL_DATA','Gabriel','2018-09-26 16:38:32'),(364,'Relatorio de Atrb, Trab, Credito, Debito e Saldo detalhado','RELATORIOS','--LARGURA#200,80,200,80,80,80,80,80,80#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\nSELECT DISTINCT EMP_Nome, dbo.fn_getdate(CAL_DATA) AS \'Data\', FUNC_NOME \'Nome\',\r\nISNULL(dbo.fn_gettime5nullzero(CAL_ATRB), \'\') AS \'A Trabalhar\',\r\nISNULL(dbo.fn_gettime5nullzero(CAL_TRAB), \'\') AS \'Trabalhadas\', \r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA AND\r\nSUBSTRING(BCO_VALOR, 1, 1) <> \'-\') AS CREDITO,\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA\r\nAND SUBSTRING(BCO_VALOR, 1, 1) = \'-\') AS DEBITO,\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras WHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA), \'\') AS \'SALDO DIA\',\r\n\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras WHERE BCO_FUNC = FUNC_IND), \'\') AS \'SALDO TOTAL\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\n\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL and CAL_ATRB > 0 \r\nAND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%\r\n\r\ngroup by FUNC_NOME, CAL_DATA, CAL_TRAB,CAL_ATRB,EMP_Nome,FUNC_IND                                    \r\n \r\nOrder By EMP_Nome, FUNC_NOME','Gabriel','2018-09-26 16:39:02'),(365,'Relatorio de Banco de horas creditos maiores que 0200','RELATORIOS','SELECT FUNC_NOME, CONVERT(DATE, BCO_DATA) AS DATA, dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR))) AS VALOR\r\nFROM BcoHoras\r\nINNER JOIN Funcionarios ON FUNC_IND = BCO_FUNC\r\nWHERE BCO_DATA >= \'01/01/2016\' AND BCO_DATA <= \'31/1/2016\' AND dbo.fn_hourlongtominute(BCO_VALOR) >= 120\r\nGROUP BY FUNC_NOME, BCO_DATA','Gabriel','2018-09-26 16:39:13'),(366,'Relatorio de Banco de horas total','RELATORIOS','--GRUPOQUEBRA#0#\r\n--LARGURA#200,200,50,50,50,50,50,50,50#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\nSELECT DISTINCT EMP_Nome Empresa, FUNC_NOME \'Nome\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR)))\r\nFROM BcoHoras WHERE BCO_FUNC = FUNC_IND  AND BCO_DATA <= %DATAFINAL% and [BCO_STATUS] <> 0 ), \'\') AS \'Saldo\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR)))\r\nFROM BcoHoras WHERE BCO_FUNC = FUNC_IND  AND BCO_DATA <= %DATAFINAL% and [BCO_STATUS] = 0 ), \'\') AS \'Aliquota\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR)))\r\nFROM BcoHoras WHERE BCO_FUNC = FUNC_IND  AND BCO_DATA <= %DATAFINAL% ), \'\') AS \'Saldo Total\'\r\n                                              \r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC                                                      \r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nleft join BcoHoras on  BCO_FUNC = FUNC_IND and CAL_DATA = BCO_DATA                                                                         \r\n           \r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%\r\n\r\ngroup by FUNC_NOME,EMP_Nome,FUNC_IND                                  \r\n                                                                            \r\nOrder By EMP_Nome, FUNC_NOME','Gabriel','2018-09-26 16:39:24'),(367,'Relatorio de Banco de horas, lanÃ§amento no banco de creditos e debitos separados','RELATORIOS','--ORIENTACAO#paisagem#\r\n--COLUNAGRUPO#\r\n--LARGURA#40,80,200,150,50,65,50,70,60,60,60,60#\r\nselect DISTINCT  YEAR(%DATAINICIAL%) ANO,\r\nDATENAME(mm, %DATAINICIAL%) MES, FUNC_NOME \'Nome\', EMP_Nome SETOR,          \r\n\r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_ATRB)))), \'\') AS ATRAB,\r\n\r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_ATRB + CAL_DSR)))), \'\') AS \'TOTAL ATRAB\',\r\n                                                         \r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_TRAB)))), \'\') AS TRAB,\r\n\r\n\r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_TRAB + CAL_DSR)))), \'\') AS \'TOTAL TRAB\',\r\n\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DSR))) as Dsr,\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRA + CAL_EXTRAN ))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_EXTRA + CAL_EXTRAN >0 and CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL% ),\'\') as \'HE60\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRAF + CAL_EXTRANF ))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC and CAL_EXTRAf + CAL_EXTRANF >0 AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL% ),\'\') as \'HE100\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR)))\r\nFROM BcoHoras WHERE BCO_FUNC = FUNC_IND and BCO_DESCRICAO = \'Extra Diurna AutomÃ¡tica\' AND BCO_DATA >= %DATAINICIAL% and BCO_DATA <= \r\n%DATAFINAL% ), \'\') AS \'BH60 Diurnas\' ,\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR)))\r\nFROM BcoHoras WHERE BCO_FUNC = FUNC_IND  and BCO_DESCRICAO = \'Extra Noturna AutomÃ¡tica\' AND BCO_DATA >= %DATAINICIAL% and BCO_DATA <= \r\n%DATAFINAL% ), \'\') AS \'BH60 Noturnas\'   ,    \r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR)))\r\nFROM BcoHoras WHERE BCO_FUNC = FUNC_IND  and BCO_DESCRICAO = \'Extra em Feriado/Folga AutomÃ¡tica\' AND BCO_DATA >= %DATAINICIAL% and BCO_DATA \r\n<= \r\n%DATAFINAL% ), \'\') AS \'BH100 Diurnas\',       \r\n                                                                                   \r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR)))\r\nFROM BcoHoras WHERE BCO_FUNC = FUNC_IND  and BCO_DESCRICAO = \'Extra Noturna em Feriado/Folga AutomÃ¡tica\' AND BCO_DATA >= %DATAINICIAL% and \r\nBCO_DATA \r\n<= \r\n%DATAFINAL% ), \'\') AS \'BH100 Noturnas\',       \r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR)))\r\nFROM BcoHoras WHERE BCO_FUNC = FUNC_IND and BCO_DATA <= %DATAFINAL% ), \'\') as \'Saldo BH\' \r\n\r\nFROM Calculo\r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,\r\n%DEPSELECIONADOIND%) =1 AND FUNC_MARCADO_EXCLUSAO = 0\r\nAND FUNC_DT_DEM IS NULL AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%\r\nGROUP BY FUNC_NOME, FUNC_IND, EMP_Nome\r\norder by EMP_Nome,  FUNC_NOME','Gabriel','2018-09-26 16:39:38'),(368,'Relatorio de Banco, credito debito- informando periodo','RELATORIOS','--LARGURA#250,180,200,80,80,80,80,80,80#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#                                               \r\ndeclare @data smalldatetime\r\ndeclare @datainicial smalldatetime          \r\ndeclare @datafinal nvarchar(30)  \r\ndeclare @periodo nvarchar(50)\r\nset @datainicial =  %DATAINICIAL%      \r\nset @datafinal = %DATAFINAL% \r\nset @periodo = \'PERIODO \'\r\nset @periodo +=  @datainicial\r\nset @periodo += \' ATÃ‰ \'\r\nset @periodo += @datafinal\r\n\r\nSELECT DISTINCT @periodo, EMP_Nome, FUNC_NOME \'Nome\',\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA >= @datainicial AND BCO_DATA <= %DATAFINAL%\r\n AND SUBSTRING(BCO_VALOR, 1, 1) <> \'-\') AS CREDITO,\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR))) FROM BcoHoras                                                     \r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA >= %DATAINICIAL% AND BCO_DATA <= %DATAFINAL%   \r\nAND SUBSTRING(BCO_VALOR, 1, 1) = \'-\') AS DEBITO,\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras WHERE BCO_FUNC = FUNC_IND and BCO_DATA >= @datainicial AND BCO_DATA <= %DATAFINAL% ), \'\') AS \'SALDO MES\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras WHERE BCO_FUNC = FUNC_IND AND BCO_DATA <= %DATAFINAL% ), \'\') AS \'SALDO ATUAL\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nINNER join BcoHoras on  BCO_FUNC = FUNC_IND and CAL_DATA = BCO_DATA\r\n           \r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL\r\nAND CAL_DATA >= @datainicial AND CAL_DATA <= %DATAFINAL%\r\n\r\ngroup by FUNC_NOME, CAL_DATA,EMP_Nome,FUNC_IND\r\n                                                                            \r\nOrder By EMP_Nome, FUNC_NOME','Gabriel','2018-09-26 16:39:48'),(369,'Relatorio de Banco, credito semestral - informando periodo','RELATORIOS','--LARGURA#250,180,200,80,80,80,80,80,80#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#                                               \r\ndeclare @data smalldatetime\r\ndeclare @datainicial smalldatetime          \r\ndeclare @datafinal nvarchar(30)  \r\ndeclare @periodo nvarchar(50)\r\nset @data = %DATAINICIAL%\r\nset @datainicial =  DateAdd(Month, -6,  @data)       \r\nset @datafinal = %DATAFINAL% \r\nset @periodo = \'PERIODO \'\r\nset @periodo +=  CONVERT(nvarchar(10),@datainicial , 103) \r\nset @periodo += \' ATÃ‰ \'\r\nset @periodo += @datafinal\r\n\r\nSELECT DISTINCT @periodo, EMP_Nome, FUNC_NOME \'Nome\',\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA >= @datainicial AND BCO_DATA <= %DATAFINAL%\r\n AND SUBSTRING(BCO_VALOR, 1, 1) <> \'-\') AS CREDITO,\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras WHERE BCO_FUNC = FUNC_IND and BCO_DATA >= @datainicial AND BCO_DATA <= %DATAFINAL% ), \'\') AS \'SALDO PERIODO\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras WHERE BCO_FUNC = FUNC_IND), \'\') AS \'SALDO TOTAL\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nINNER join BcoHoras on  BCO_FUNC = FUNC_IND and CAL_DATA = BCO_DATA\r\n           \r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL\r\nAND CAL_DATA >= @datainicial AND CAL_DATA <= %DATAFINAL%\r\n\r\ngroup by FUNC_NOME, CAL_DATA,EMP_Nome,FUNC_IND\r\n                                                                            \r\nOrder By EMP_Nome, FUNC_NOME','Gabriel','2018-09-26 16:39:57'),(370,'Relatorio de Credito e Saldo Positivos','RELATORIOS','--COLUNAGRUPO#2#\r\n--LARGURA# 280,250,150,80#\r\nselect distinct FUNC_NOME As NOME, CAR_DESCRICAO as CARGO, EMP_NOME AS EMPRESA,\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute (BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND \r\nSUBSTRING(BCO_VALOR, 1, 1) <> \'-\' and \r\nBCO_DATA >= %DATAINICIAL% AND BCO_DATA <= %DATAFINAL%\r\n/*BCO_DATA >= \'01/01/2017\' AND BCO_DATA <= \'31/1/2017\'*/) AS CREDITO,\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute (BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND) AS \'SALDO TOTAL\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN BcoHoras ON BCO_FUNC = FUNC_IND\r\nINNER JOIN EMPRESAS ON  FUNC_EMPRESA = EMP_IND                      \r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO                                              \r\n--WHERE BCO_DATA >= \'01/01/2017\' AND BCO_DATA <= \'31/1/2017\' and \r\nWHERE BCO_DATA >= %DATAINICIAL% AND BCO_DATA <= %DATAFINAL% AND\r\nFUNC_DT_DEM IS NULL and FUNC_MARCADO_EXCLUSAO = 0  and\r\ndbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) = 1 and \r\nSUBSTRING((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute (BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND),1,1) <> \'-\'\r\nGROUP BY FUNC_NOME, EMP_NOME, CAR_DESCRICAO, BCO_VALOR, FUNC_IND','Gabriel','2018-09-26 16:40:10'),(371,'Relatorio de Credito, Debito, Saldo, Adicional noturno e Variaveis lancadas','RELATORIOS','--LARGURA#40,60,200,120,80,80,80,80,80,80#\r\n--GRUPONREGISTROS#0#\r\nCREATE TABLE #dbtVariaveis (\r\n           [VAR_FUNC] [int] NOT NULL ,\r\n           [VAR_EVENTO] [int] NULL ,\r\n           [VAR_VALOR] [money],\r\n           [VAR_HORAS] [char] (10),\r\n                [VAR_DIAS] [int],\r\n           [VAR_EMPCODFOLHA] [char] (10),\r\n           [VAR_FALTADATA] SMALLDATETIME DEFAULT 0,\r\n                [VAR_ORDEM] [TINYINT] DEFAULT 0                             \r\n           ) ON [PRIMARY]\r\n\r\nexec rst_variaveis @P_DATAINICIAL = %DATAINICIAL%, @P_DATAFINAL = %DATAFINAL%, @P_DEPTO = 1, @P_CRIARTMP = 0\r\n\r\ndeclare @datainicial smalldatetime = %DATAINICIAL%\r\ndeclare @datafinal smalldatetime =  %DATAFINAL%\r\nSELECT DISTINCT  YEAR(%DATAINICIAL%) ANO,\r\nDATENAME(mm, %DATAINICIAL%) MES, FUNC_NOME \'Nome\', EMP_Nome Empresa,\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(VAR_HORAS))) from #dbtVariaveis where VAR_EVENTO = 22 and VAR_FUNC = FUNC_IND) \r\nas \'Extras 60%\',\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(VAR_HORAS))) from #dbtVariaveis where VAR_EVENTO = 8 and VAR_FUNC = FUNC_IND) \r\nas \'Extra 100%\',\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(VAR_HORAS))) from #dbtVariaveis where VAR_EVENTO = 6 and VAR_FUNC = FUNC_IND) \r\n as Noturno,\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA >= %DATAINICIAL% AND BCO_DATA <= %DATAFINAL%\r\nAND SUBSTRING(BCO_VALOR, 1, 1) <> \'-\') AS CREDITO,\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR))) FROM BcoHoras   \r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA >= %DATAINICIAL% AND BCO_DATA <= %DATAFINAL%   \r\nAND SUBSTRING(BCO_VALOR, 1, 1) = \'-\') AS DEBITO,\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras WHERE BCO_FUNC = FUNC_IND  AND BCO_DATA <= %DATAFINAL% ), \'\') AS \'SALDO MES\'\r\n                  \r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nleft JOIN #dbtVariaveis ON VAR_FUNC = FUNC_IND\r\nleft join BcoHoras on  BCO_FUNC = FUNC_IND and CAL_DATA = BCO_DATA                                                                         \r\n           \r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL\r\nAND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%\r\n\r\ngroup by FUNC_NOME,EMP_Nome,FUNC_IND                                              \r\n                                                                            \r\nOrder By EMP_Nome, FUNC_NOME   \r\n\r\nDROP TABLE #dbtVariaveis','Gabriel','2018-09-26 16:40:22'),(372,'Relatorio de Credito, Debitos, Saldo Detalhado','RELATORIOS','--LARGURA#80,80,50,50,50,80,50,50,60,50,60#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\nSELECT FUNC_NOME NOME, CAL_DATA AS DATA,\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA AND\r\nSUBSTRING(BCO_VALOR, 1, 1) <> \'-\') AS CREDITO,\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA\r\nAND SUBSTRING(BCO_VALOR, 1, 1) = \'-\') AS DEBITO,\r\n\r\ndbo.fn_get_banco_saldo_totalizado_dia(func_ind,CAL_DATA) AS \'SALDO\'\r\n\r\nFROM Calculo    \r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_DT_DEM IS NULL and FUNC_MARCADO_EXCLUSAO = 0 AND CAL_DATA >= %DATAINICIAL%\r\nAND CAL_DATA <= %DATAFINAL% and ISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras WHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA), \'\') > \'0\'\r\nGROUP BY FUNC_NOME, FUNC_IND, CAL_DATA\r\norder by FUNC_NOME, CAL_DATA','Gabriel','2018-09-26 16:40:33'),(373,'Relatorio de credito, debitos, saldo, Extras e adicional detalhado','RELATORIOS','--LARGURA#80,200,140,45,40,45,50,60,60,45,60,60,60,60,60,60,80#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#1#                                                                                                                            \r\nSELECT dbo.fn_getdate(CAL_DATA) AS \'Data\', FUNC_NOME \'Nome\',                                                     \r\n                                                                                            \r\nISNULL(dbo.fn_gettime5nullzero(CAL_EXTRA + CAL_EXTRAn), \'\') AS \'Extras 60%\',\r\n\r\nISNULL(dbo.fn_gettime5nullzero(CAL_EXTRAF + CAL_EXTRANF), \'\') AS \'Extras 100%\', \r\n\r\nCASE WHEN CAL_NOTURNO > 0 THEN dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_NOTURNO))) ELSE \'\' END as \'Noturno\', \r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute                                          \r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA AND\r\nSUBSTRING(BCO_VALOR, 1, 1) <> \'-\') AS CREDITO,\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA\r\nAND SUBSTRING(BCO_VALOR, 1, 1) = \'-\') AS DEBITO,\r\n\r\ndbo.fn_get_banco_saldo_totalizado_dia(func_ind,CAL_DATA) AS \'SALDO DIA\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL and CAL_ATRB > 0\r\nAND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%         \r\ngroup by FUNC_NOME, CAL_DATA, CAL_TRAB,CAL_ATRB,FUNC_IND,CAL_EXTRAF, CAL_EXTRANF,CAL_EXTRA,apo_Hv,\r\nCAL_EXTRAn, dbo.fn_get_banco_saldo_totalizado_dia(func_ind,CAL_DATA) \r\nOrder By FUNC_NOME, CAL_DATA','Gabriel','2018-09-26 16:40:48'),(374,'Relatorio de Creditos, Debitos, Saldo, Adicional Not, atra, trab ','RELATORIOS','--LARGURA#60,200,55,45,40,45,40,45,50,60,60,45,60,60,60,60,60,60,80#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#1#                                                                                                                            \r\nSELECT RTRIM(FUNC_NOME) + \' - Cargo: \' + RTRIM(CAR_DESCRICAO) + \' - Pis: \' + RTRIM(func_pis) + \' - Admissao: \' + RTRIM(CONVERT(nvarchar\r\n(10), \r\nFUNC_DT_ADM, 103)) AS \'Nome\', dbo.fn_getdate(CAL_DATA) AS \'Data\',\r\ncase DATEPART(weekday, CAL_DATA) when 1 then \'DOMINGO\' WHEN 2 then \'SEGUNDA\'\r\nWHEN 3 then \'TERÃ‡A\' WHEN 4 then \'QUARTA\' WHEN 5 then \'QUINTA\' WHEN 6 then \'SEXTA\'\r\nWHEN 7 then \'SABADO\' ELSE \'\' END AS \'-\',                 \r\ndbo.fn_gettimefull(APO_MARCACAO1) AS \'Entrada1\',\r\ndbo.fn_gettimefull(APO_MARCACAO2) AS \'Saida1\',    \r\ndbo.fn_gettimefull(APO_MARCACAO3) AS \'Entrada2\',                                         \r\ndbo.fn_gettimefull(APO_MARCACAO4) AS \'Saida2\',\r\ndbo.fn_gettimefull(APO_MARCACAO5) AS \'Entrada3\',\r\ndbo.fn_gettimefull(APO_MARCACAO6) AS \'Saida3\',\r\nISNULL(dbo.fn_gettime5nullzero(CAL_ATRB), \'\') AS \'Atbr\',\r\nISNULL(dbo.fn_gettime5nullzero(CAL_TRAB), \'\') AS \'Trab\',\r\n\r\nISNULL(dbo.fn_gettime5nullzero(CAL_EXTRA + CAL_EXTRAn + CAL_EXTRAF + CAL_EXTRANF), \'\') AS \'Extras\',\r\n\r\nCASE WHEN CAL_NOTURNO > 0 THEN dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_NOTURNO))) ELSE \'\' END as \'NOT\', \r\n      \r\n(CASE WHEN APO_DSR = 0 THEN \'\' ELSE \'DSR\' END) DSR,\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA AND\r\nSUBSTRING(BCO_VALOR, 1, 1) <> \'-\') AS CREDITO,\r\n                                                                                             \r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA\r\nAND SUBSTRING(BCO_VALOR, 1, 1) = \'-\') AS DEBITO,\r\n\r\ndbo.fn_get_banco_saldo_totalizado_dia(func_ind,CAL_DATA) AS \'SALDO\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO                                                    \r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1 \r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL and CAL_ATRB > 0          \r\nAND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%         \r\ngroup by FUNC_NOME, CAL_DATA, CAL_TRAB,CAL_ATRB,FUNC_IND,CAL_EXTRAF, CAL_EXTRANF,CAL_EXTRA,apo_Hv,\r\nCAL_EXTRAn,APO_MARCACAO1,APO_MARCACAO2,APO_MARCACAO3,APO_MARCACAO5,APO_MARCACAO6,APO_MARCACAO4,CAL_DESCONTO,CAL_FALTAHORA, \r\ndbo.fn_get_banco_saldo_totalizado_dia(func_ind,CAL_DATA),APO_DSR,CAR_DESCRICAO,func_pis, FUNC_DT_ADM,CAL_NOTURNO      \r\nOrder By FUNC_NOME, CAL_DATA','Gabriel','2018-09-26 16:40:58'),(375,'Relatorio de Debito, credito e saldo do banco, total do mes','RELATORIOS','--LARGURA#200,200,80,80,80,80,80,80#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#                                               \r\nSELECT DISTINCT EMP_Nome, FUNC_NOME \'Nome\',\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA >= %DATAINICIAL% AND BCO_DATA <= %DATAFINAL%\r\n AND SUBSTRING(BCO_VALOR, 1, 1) <> \'-\') AS CREDITO,\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR))) FROM BcoHoras                                                     \r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA >= %DATAINICIAL% AND BCO_DATA <= %DATAFINAL%   \r\nAND SUBSTRING(BCO_VALOR, 1, 1) = \'-\') AS DEBITO,\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras WHERE BCO_FUNC = FUNC_IND  AND BCO_DATA >= %DATAINICIAL% AND BCO_DATA <= %DATAFINAL% ), \'\') AS \'SALDO MES\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras WHERE BCO_FUNC = FUNC_IND), \'\') AS \'SALDO TOTAL\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nleft join BcoHoras on  BCO_FUNC = FUNC_IND and CAL_DATA = BCO_DATA                                                                         \r\n           \r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL\r\nAND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%\r\n\r\ngroup by FUNC_NOME, CAL_DATA,EMP_Nome,FUNC_IND                                    \r\n                                                                            \r\nOrder By EMP_Nome, FUNC_NOME','Gabriel','2018-09-26 16:41:10'),(376,'Relatorio de Debito, credito, saldo do banco, extras, adicional, total do mes','RELATORIOS','--LARGURA#200,200,80,80,80,80,80,80#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#                                               \r\nSELECT DISTINCT EMP_Nome, FUNC_NOME \'Nome\',           \r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRA + CAL_EXTRAn))) as \'Extras 60%\',\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRAF + CAL_EXTRANF))) as \'Extra 100%\',\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_NOTURNO))) as Noturno,\r\n                                                            \r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA >= %DATAINICIAL% AND BCO_DATA <= %DATAFINAL%\r\nAND SUBSTRING(BCO_VALOR, 1, 1) <> \'-\') AS CREDITO,\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR))) FROM BcoHoras   \r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA >= %DATAINICIAL% AND BCO_DATA <= %DATAFINAL%   \r\nAND SUBSTRING(BCO_VALOR, 1, 1) = \'-\') AS DEBITO,\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR)))\r\nFROM BcoHoras WHERE BCO_FUNC = FUNC_IND  AND BCO_DATA <= %DATAFINAL% ), \'\') AS \'SALDO MES\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nleft join BcoHoras on  BCO_FUNC = FUNC_IND and CAL_DATA = BCO_DATA                                                                         \r\n           \r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL\r\nAND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%\r\n\r\ngroup by FUNC_NOME,EMP_Nome,FUNC_IND                                   \r\n                                                                            \r\nOrder By EMP_Nome, FUNC_NOME','Gabriel','2018-09-26 16:41:22'),(377,'Relatorio de Descontos, Faltas, Debitos, falta no banco, abono e justificativa','RELATORIOS','--GRUPOQUEBRA#0#                                                               \r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\n--LARGURA#200,80,200,45,40,45,50,50,50,150#\r\nSELECT EMP_NOME,  dbo.fn_getdate(CAL_DATA) AS \'Data\', FUNC_NOME \'Nome\',\r\nCASE WHEN CAL_FALTAHORA > 0 THEN \'FALTA\' ELSE \'\' END AS Faltas ,\r\nisnull(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute\r\n(CAL_FALTAHORA))),\'\') as \'Faltas Hora\',\r\nisnull(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DESCONTO\r\n- CAL_FALTAHORA))),\'\') as Desconto,\r\n(select dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute (BCO_VALOR))) from BcoHoras where BCO_STATUS = 10 and BCO_FUNC = FUNC_IND and \r\nBCO_DATA = cal_data) as \'Falta BH\',\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute                                                                                 \r\n                                 \r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA\r\nAND SUBSTRING(BCO_VALOR, 1, 1) = \'-\') AS DEBITO,\r\n\r\ndbo.fn_gettime5nullzero(CAL_ABONO) AS \'ABONADO\',\r\nCASE WHEN CAL_ABONO > 0 THEN (SELECT JUS_DESCRICAO FROM justificativas\r\nWHERE JUS_FUNC = CAL_FUNC\r\nAND JUS_DATA = CAL_DATA) ELSE \'\' END  AS MOTIVO                             \r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nINNER JOIN EMPRESAS ON  FUNC_EMPRESA = EMP_IND\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND CAL_ATRB > 0 and CAL_ATRB <> CAL_TRAB \r\nAND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%                                                           \r\ngroup by EMP_NOME, FUNC_NOME, CAL_DATA, CAL_ATRB,FUNC_IND,CAL_DESCONTO,CAL_FALTAHORA,CAL_ABONO, CAL_FUNC\r\nOrder By EMP_NOME, FUNC_NOME, CAL_DATA','Gabriel','2018-09-26 16:41:34'),(378,'Relatorio de diferenca de horas trabalhadas de um dia para outro','RELATORIOS','--GRUPOQUEBRA#0#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\n--LARGURA#300,40,200,80,80,120,120,120,120,100#\r\nDECLARE @DATAINICIAL SMALLDATETIME = %DATAINICIAL%,\r\n        @DATAFINAL SMALLDATETIME = %DATAFINAL%,\r\n        @DEPSELECIONADOIND INT = %DEPSELECIONADOIND%                   \r\nselect DISTINCT  EMP_NOME as Empresa, FUNC_REG as Registro, FUNC_NOME as Nome,\r\ncase when (select isnull(APO_MARCACAO1,0) from aponta where APO_MARCACAO1 is not null and (CAL_EXTRA > 0 or CAL_EXTRAn > 0 or CAL_EXTRAF >\r\n0 or CAL_EXTRANF > 0 or cal_atrb > 0) and FUNC_IND = APO_FUNC and\r\ncal_data = CONVERT(VARCHAR(30), APO_DATA - 1,103)) > 0 then cal_data end as De,\r\ncase when (select isnull(APO_MARCACAO1,0) from aponta where APO_MARCACAO1 is not null and (CAL_EXTRA > 0 or CAL_EXTRAn > 0 or CAL_EXTRAF >\r\n0 or CAL_EXTRANF > 0 or cal_atrb > 0) and FUNC_IND = APO_FUNC and\r\ncal_data = CONVERT(VARCHAR(30), APO_DATA - 1,103)) > 0 then CONVERT(VARCHAR(30), APO_DATA + 1,103) end Para,\r\n\r\nConvert(char(5), DateAdd(minute, DATEDIFF(minute,case when APO_MARCACAO8 is not null then APO_MARCACAO8 when APO_MARCACAO6 is not null then\r\nAPO_MARCACAO6 when APO_MARCACAO4 is not null then APO_MARCACAO4 when APO_MARCACAO2 is not null and APO_MARCACAO3 is null then APO_MARCACAO2\r\nend,\r\n(select APO_MARCACAO1 from aponta where APO_MARCACAO1 is not null and FUNC_IND = APO_FUNC and cal_data = CONVERT(VARCHAR(30), APO_DATA -\r\n1,103)))   \r\n, 0), 108) as Diferenca\r\n           \r\nfrom Funcionarios\r\ninner join Empresas  on EMP_IND = FUNC_EMPRESA\r\ninner join calculo  on cal_func = FUNC_IND         \r\nleft join aponta on  FUNC_IND = APO_FUNC and cal_data = apo_data                                                  \r\n\r\nwhere dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1 and (aPO_MARCACAO4 is not null or aPO_MARCACAO6 is not null or\r\naPO_MARCACAO8 is not null or aPO_MARCACAO2 is not null)and APO_MARCACAO1 is not null and cal_data >= @DATAINICIAL and cal_data <=\r\n@DATAFINAL and (CAL_EXTRA > 0 or CAL_EXTRAn > 0 or CAL_EXTRAF > 0 or CAL_EXTRANF >0 or cal_atrb > 0)\r\norder by EMP_NOME, FUNC_NOME asc','Gabriel','2018-09-26 16:41:47'),(379,'Relatorio de Expediente do funcionario no apontamento','RELATORIOS','--COLUNAGRUPO#1#\r\n--LARGURA# 250,250,100,150,150# \r\nSELECT FUNC_NOME,EMP_Nome,                                                                                     \r\nCASE DATEPART(weekday, APO_DATA) WHEN 1 THEN \'DOMINGO\' WHEN 2 THEN \'SEGUNDA\' WHEN 3 THEN \'TERÃ‡A\' WHEN 4 THEN \'QUARTA\' \r\n WHEN 5 THEN \'QUINTA\' WHEN 6 THEN \'SEXTA\' ELSE \'SABADO\' END \'DIA DA SEMANA\',\r\n\r\n(CASE WHEN APO_H = -990 THEN \'FOLGA\' WHEN APO_H = -999 then \'DSR\'\r\nWHEN APO_H = -994 then \'FERIADO\' WHEN APO_H1 IS NOT NULL and APO_HV is null THEN dbo.fn_expediente_dia(FUNC_IND,APO_DATA)\r\nelse CONVERT(VARCHAR(5),(APO_HV),108) END) EXPEDIENTE\r\n, APO_DATA DATA\r\nFROM Aponta\r\nINNER JOIN Funcionarios ON FUNC_IND = APO_FUNC\r\nINNER JOIN EMPRESAS ON EMP_IND = FUNC_EMPRESA    \r\nwhere FUNC_DT_DEM IS NULL and FUNC_MARCADO_EXCLUSAO = 0  and APO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL%\r\nAND dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) = 1\r\nORDER BY EMP_Nome, FUNC_NOME, APO_DATA','Gabriel','2018-09-26 16:42:00'),(380,'Relatorio de Expediente Semanal','RELATORIOS','--COLUNAGRUPO#1#\r\n--LARGURA# 250,250,100,150,150# \r\nSELECT FUNC_NOME,EMP_Nome,                                                                                     \r\nCASE DATEPART(weekday, APO_DATA) WHEN 1 THEN \'DOMINGO\' WHEN 2 THEN \'SEGUNDA\' WHEN 3 THEN \'TERÃ‡A\' WHEN 4 THEN \'QUARTA\' \r\n WHEN 5 THEN \'QUINTA\' WHEN 6 THEN \'SEXTA\' ELSE \'SABADO\' END \'DIA DA SEMANA\',\r\n\r\n(CASE WHEN APO_H = -990 THEN \'FOLGA\' WHEN APO_H = -999 then \'DSR\'\r\nWHEN APO_H = -994 then \'FERIADO\' WHEN APO_H1 IS NOT NULL and APO_HV is null THEN dbo.fn_expediente_dia(FUNC_IND,APO_DATA)\r\nelse CONVERT(VARCHAR(5),(APO_HV),108) END) EXPEDIENTE\r\n, APO_DATA DATA\r\nFROM Aponta\r\nINNER JOIN Funcionarios ON FUNC_IND = APO_FUNC\r\nINNER JOIN EMPRESAS ON EMP_IND = FUNC_EMPRESA    \r\nwhere FUNC_DT_DEM IS NULL and FUNC_MARCADO_EXCLUSAO = 0  and APO_DATA >= \'01/02/2018\' AND APO_DATA <= \'25/07/2018\'\r\nAND dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) = 1\r\nORDER BY EMP_Nome, FUNC_NOME, APO_DATA','Gabriel','2018-09-26 16:42:11'),(381,'Relatorio de Expediente, MarcaÃ§oes, Trab, Atrab, extras, atrasos, faltas, credito, debitos e saldo','RELATORIOS','--LARGURA#80,200,140,45,40,45,50,60,60,45,60,60,60,60,60,60,80#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#1#                                                                                                                            \r\nSELECT dbo.fn_getdate(CAL_DATA) AS \'Data\', FUNC_NOME \'Nome\',\r\ncase when apo_Hv > 0 then dbo.fn_gettimefull(apo_Hv) else dbo.fn_expediente_dia(func_ind,CAL_DATA) end AS Expediente,         \r\ndbo.fn_gettimefull(APO_MARCACAO1) AS \'Entrada1\',\r\ndbo.fn_gettimefull(APO_MARCACAO2) AS \'Saida1\',\r\ndbo.fn_gettimefull(APO_MARCACAO3) AS \'Entrada2\',                                         \r\ndbo.fn_gettimefull(APO_MARCACAO4) AS \'Saida2\',\r\n\r\nISNULL(dbo.fn_gettime5nullzero(CAL_ATRB), \'\') AS \'A Trabalhar\',\r\nISNULL(dbo.fn_gettime5nullzero(CAL_TRAB), \'\') AS \'Trabalhadas\',                                                       \r\n                                                                                            \r\nISNULL(dbo.fn_gettime5nullzero(CAL_EXTRA + CAL_EXTRAn), \'\') AS \'Extras\',\r\n\r\nISNULL(dbo.fn_gettime5nullzero(CAL_EXTRAF + CAL_EXTRANF), \'\') AS \'Extras Foga/Feriados\',\r\n\r\ndbo.fn_gettime5nullzero(CAL_DESCONTO) AS Desconto,\r\n\r\nCASE WHEN CAL_FALTAHORA > 0 THEN \'FALTA\' ELSE \'\' END AS Faltas,  \r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute                                          \r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA AND\r\nSUBSTRING(BCO_VALOR, 1, 1) <> \'-\') AS CREDITO,\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA\r\nAND SUBSTRING(BCO_VALOR, 1, 1) = \'-\') AS DEBITO,\r\n\r\ndbo.fn_get_banco_saldo_totalizado_dia(func_ind,CAL_DATA) AS \'SALDO DIA\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL and CAL_ATRB > 0\r\nAND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%         \r\ngroup by FUNC_NOME, CAL_DATA, CAL_TRAB,CAL_ATRB,FUNC_IND,CAL_EXTRAF, CAL_EXTRANF,CAL_EXTRA,apo_Hv,\r\nCAL_EXTRAn,APO_MARCACAO1,APO_MARCACAO2,APO_MARCACAO3,APO_MARCACAO4,CAL_DESCONTO,CAL_FALTAHORA, dbo.fn_get_banco_saldo_totalizado_dia\r\n(func_ind,CAL_DATA) \r\nOrder By FUNC_NOME, CAL_DATA','Gabriel','2018-09-26 16:42:20'),(382,'Relatorio de Expediente, marcaÃ§oes, trab, ferias, abonos','RELATORIOS','--LARGURA#70,200,140,50,45,50,45,60,65,50,80,120#\r\n--GRUPONREGISTROS#0#      \r\n--COLUNAGRUPO#1#                                                                                                                            \r\nSELECT dbo.fn_getdate(CAL_DATA) AS \'Data\', FUNC_NOME \'Nome\',\r\ncase when apo_Hv > 0 then dbo.fn_gettimefull(apo_Hv) else dbo.fn_expediente_dia(func_ind,CAL_DATA) end AS Expediente,\r\ndbo.fn_gettimefull(APO_MARCACAO1) AS \'Entrada1\',\r\ndbo.fn_gettimefull(APO_MARCACAO2) AS \'Saida1\',\r\ndbo.fn_gettimefull(APO_MARCACAO3) AS \'Entrada2\',                                                           \r\ndbo.fn_gettimefull(APO_MARCACAO4) AS \'Saida2\',\r\n\r\nISNULL(dbo.fn_gettime5nullzero(CAL_TRAB), \'\') AS \'Trabalhadas\',\r\nISNULL(dbo.fn_gettime5nullzero(CAL_ATRB), \'\') AS \'A Trabalhar\',\r\n\r\n(CASE WHEN CAL_ABONO > 0 THEN CONVERT(VARCHAR(5),(CAL_ABONO),108) ELSE \'\' END) as \'Abonado\',\r\n\r\n(CASE WHEN (SELECT TOP 1 dbo.fn_periodo_esta_contido(FER_DATA1, FER_DATA2,CAL_DATA, CAL_DATA) \r\nFROM FERIAS WHERE FER_FUNC = FUNC_IND order by dbo.fn_periodo_esta_contido(FER_DATA1, FER_DATA2,CAL_DATA, CAL_DATA) desc) = 1 THEN \'Ferias\' \r\nELSE\r\n(CASE WHEN (SELECT TOP 1 dbo.fn_periodo_esta_contido(AFA_DATA1 ,AFA_DATA2,CAL_DATA, CAL_DATA)\r\nFROM Afastamentos WHERE AFA_FUNC = FUNC_IND order by \r\ndbo.fn_periodo_esta_contido(AFA_DATA1 ,AFA_DATA2,CAL_DATA, CAL_DATA) desc) = 1 THEN \'Afastado\' ELSE\r\n(CASE WHEN CAL_DESCONTO > 0 THEN dbo.fn_gettime5nullzero(CAL_DESCONTO) ELSE\r\n(CASE APO_H WHEN -990 THEN \'FOLGA\' WHEN -999 THEN \'DSR\' END) END ) END) END) AS \'Faltas\\Ferias\',\r\n\r\n(select ISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_TRAB)))), \'\') from calculo where FUNC_IND = CAL_FUNC\r\nand cal_data >= %DATAINICIAL% and CAL_DATA <= %DATAFINAL%) AS TOTALL\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL and cal_data >= %DATAINICIAL% and CAL_DATA <= %DATAFINAL%\r\ngroup by FUNC_NOME, CAL_DATA, CAL_TRAB,CAL_ATRB,FUNC_IND,apo_Hv,CAL_ABONO,CAL_DESCONTO,APO_H,\r\nAPO_MARCACAO1,APO_MARCACAO2,APO_MARCACAO3,APO_MARCACAO4,dbo.fn_get_banco_saldo_totalizado_dia(func_ind,CAL_DATA)\r\nOrder By FUNC_NOME, CAL_DATA','Gabriel','2018-09-26 16:42:37'),(383,'Relatorio de Expediente','RELATORIOS','--LARGURA#80,200,140,80#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#1#                                                                                                                            \r\nSELECT dbo.fn_getdate(CAL_DATA) AS \'Data\', FUNC_NOME \'Nome\',\r\ncase when apo_Hv > 0 then dbo.fn_gettimefull(apo_Hv) else dbo.fn_expediente_dia(func_ind,CAL_DATA) end AS Expediente\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL and CAL_ATRB > 0\r\nAND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%         \r\n\r\ngroup by FUNC_NOME, CAL_DATA, FUNC_IND,apo_Hv,\r\ndbo.fn_get_banco_saldo_totalizado_dia(func_ind,CAL_DATA) \r\nOrder By FUNC_NOME, CAL_DATA','Gabriel','2018-09-26 16:42:49'),(384,'Relatorio de extras 50% e 100% detalhadas','RELATORIOS','--LARGURA#100,100,100,100#\r\n--COLUNAGRUPO#0#\r\nSELECT RTRIM(FUNC_NOME) + \' (\' + RTRIM(CAR_DESCRICAO) + \')\' AS\r\n\'Nome\',\r\n    dbo.fn_getdate(CAL_DATA) AS \'Data\',\r\n    dbo.fn_gettime5nullzero(CAL_EXTRA + CAL_EXTRAN) as \'Extra 65%\',\r\n    dbo.fn_gettime5nullzero(CAL_EXTRAF + CAL_EXTRANF) as \'Extra 100%\'\r\nFROM Calculo\r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nWHERE FUNC_DT_DEM IS NULL and FUNC_MARCADO_EXCLUSAO = 0 and (CAL_EXTRA > 0 OR\r\n    CAL_EXTRAF > 0)\r\n     and CAL_DATA >= \'01/09/2017\' AND CAL_DATA <= \'10/09/2017\'','Gabriel','2018-09-26 16:43:03'),(385,'Relatorio de extras 50% e 100% total','RELATORIOS','--LARGURA#250,120,120,100#  \r\nSELECT FUNC_NOME AS NOME,\r\n\r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_EXTRA + CAL_EXTRAn)))), \'\') AS \'TOTAL EXTRA 50%\',                                           \r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_EXTRAF +        \r\nCAL_EXTRANF)))), \'\') AS \'TOTAL EXTRA 100%\'     \r\n                 \r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nWHERE CAL_DATA >= \'01/01/2017\' AND CAL_DATA <= \'01/02/2017\' AND       \r\nFUNC_DT_DEM IS NULL and FUNC_MARCADO_EXCLUSAO = 0 and CAL_EXTRA > 0 OR\r\n    CAL_EXTRAF > 0   \r\nGROUP BY FUNC_NOME','Gabriel','2018-09-26 16:43:13'),(386,'Relatorio de extras 50%, 70%, 100% total','RELATORIOS','--LARGURA#40,60,200,120,80,80,80,80,80,80#\r\n--GRUPONREGISTROS#0#\r\nCREATE TABLE #dbtVariaveis (\r\n           [VAR_FUNC] [int] NOT NULL ,\r\n           [VAR_EVENTO] [int] NULL ,\r\n           [VAR_VALOR] [money],\r\n           [VAR_HORAS] [char] (10),\r\n                [VAR_DIAS] [int],\r\n           [VAR_EMPCODFOLHA] [char] (10),\r\n           [VAR_FALTADATA] SMALLDATETIME DEFAULT 0,\r\n                [VAR_ORDEM] [TINYINT] DEFAULT 0                             \r\n           ) ON [PRIMARY]\r\n\r\nexec rst_variaveis @P_DATAINICIAL = %DATAINICIAL%, @P_DATAFINAL = %DATAFINAL%, @P_DEPTO = 1, @P_CRIARTMP = 0\r\n\r\ndeclare @datainicial smalldatetime = %DATAINICIAL%\r\ndeclare @datafinal smalldatetime =  %DATAFINAL%\r\nSELECT DISTINCT  YEAR(%DATAINICIAL%) ANO,\r\nDATENAME(mm, %DATAINICIAL%) MES, FUNC_NOME \'Nome\', EMP_Nome Empresa,\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(VAR_HORAS))) from #dbtVariaveis where VAR_EVENTO = 22 and VAR_FUNC = FUNC_IND) \r\nas \'Extras 50%\',\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(VAR_HORAS))) from #dbtVariaveis where VAR_EVENTO = 22 and VAR_FUNC = FUNC_IND) \r\nas \'Extras 70%\',\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(VAR_HORAS))) from #dbtVariaveis where VAR_EVENTO = 8 and VAR_FUNC = FUNC_IND) \r\nas \'Extra 110%\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nINNER JOIN #dbtVariaveis ON VAR_FUNC = FUNC_IND                                                                      \r\n           \r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL\r\nAND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%\r\n\r\ngroup by FUNC_NOME,EMP_Nome,FUNC_IND                                              \r\n                                                                            \r\nOrder By EMP_Nome, FUNC_NOME   \r\n\r\nDROP TABLE #dbtVariaveis','Gabriel','2018-09-26 16:43:25'),(387,'Relatorio de Extras na entrada, intervalo e saida','RELATORIOS','--LARGURA#200,80,200,80,80,80,80,80#                   \r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\nSELECT DISTINCT EMP_Nome, dbo.fn_getdate(CAL_DATA) AS \'Data\', FUNC_NOME \'Nome\',\r\nISNULL(dbo.fn_gettime5nullzero(CAL_ATRB), \'\') AS \'A Trabalhar\',\r\nISNULL(dbo.fn_gettime5nullzero(CAL_TRAB), \'\') AS \'Trabalhadas\',\r\n\r\ncase when PAPO_EXTRAREAL1_INICIO is not null then dbo.fn_gettime5nullzero(PAPO_EXTRAREAL1_FIM - PAPO_EXTRAREAL1_INICIO) else \'\' end as \r\n\'Extra Entada\',\r\n\r\nISNULL(dbo.fn_gettime5nullzero(PAPO_INTERVALO_EXTRA), \'\') as \'Extra Int\',\r\n                                           \r\ncase when PAPO_EXTRAREAL4_INICIO is not null then dbo.fn_gettime5nullzero(PAPO_EXTRAREAL4_FIM - PAPO_EXTRAREAL4_INICIO)\r\nwhen PAPO_EXTRAREAL2_INICIO is not null then dbo.fn_gettime5nullzero(PAPO_EXTRAREAL2_FIM - PAPO_EXTRAREAL2_INICIO) else \'\' end as\r\n\'Extra Saida\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nleft JOIN PreAponta ON CAL_FUNC = PAPO_FUNC and PAPO_DATA = CAL_DATA\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL and CAL_ATRB > 0 \r\nAND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%\r\n\r\ngroup by FUNC_NOME, CAL_DATA, CAL_TRAB,CAL_ATRB, CAL_EXTRA, CAL_EXTRAN,CAL_EXTRAF, CAL_EXTRANF,EMP_Nome,\r\nPAPO_EXTRAREAL1_INICIO, PAPO_EXTRAREAL1_FIM, PAPO_INTERVALO_EXTRA,\r\nPAPO_EXTRAREAL4_INICIO, PAPO_EXTRAREAL4_FIM, PAPO_EXTRAREAL2_INICIO, PAPO_EXTRAREAL2_FIM\r\nOrder By EMP_Nome, FUNC_NOME','Gabriel','2018-09-26 16:43:37'),(388,'Relatorio de Extras, atrasos, saldo e faltas','RELATORIOS','--COLUNAGRUPO#2#\r\n--LARGURA#80,280,280,60,60,60,60#\r\nSELECT CAL_DATA Data, FUNC_NOME AS Nome, EMP_Nome Empresa,                 \r\ndbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute\r\n(CAL_EXTRA + CAL_EXTRAN)))) as \'Extras\',\r\n\r\ndbo.fn_gettime5nullzero(CAL_DESCONTO) AS Desconto,\r\n                           \r\ncase when (CAL_EXTRA + CAL_EXTRAN) >= CAL_DESCONTO  then              \r\ndbo.fn_hourlongnullzero(dbo.fn_minutetohourlong\r\n(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRA + CAL_EXTRAN) - dbo.fn_smalldatetimetominute(CAL_DESCONTO))))                  \r\n\r\nelse dbo.fn_gettime5nullzero(CAL_DESCONTO) end as Saldo,\r\n \r\nCASE WHEN CAL_FALTAHORA > 0 THEN \'FALTA\' ELSE \'\' END AS Faltas  \r\n\r\nFROM Funcionarios                                                                                             \r\nINNER JOIN calculo ON cal_FUNC = FUNC_IND      \r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA     \r\nWHERE  CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL% and\r\n((CAL_EXTRA + CAL_EXTRAN) > 0 or CAL_DESCONTO > 0 or CAL_FALTAHORA > 0)                      \r\ngroup by FUNC_EMPRESA, FUNC_NOME, EMP_IND,EMP_Nome,CAL_DESCONTO, CAL_EXTRA, CAL_EXTRAN, CAL_DATA, CAL_FALTAHORA\r\nORDER BY EMP_Nome, FUNC_NOME','Gabriel','2018-09-26 16:43:49'),(389,'Relatorio de extras, desconto total','RELATORIOS','--LARGURA#250,120,120,100#  \r\nDECLARE @DATAINICIO SMALLDATETIME = \'01/08/2018\'\r\nDECLARE @DATAFIM SMALLDATETIME = \'30/08/2018\'\r\n\r\nSELECT FUNC_NOME AS NOME,\r\n\r\nISNULL(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DESCONTO))), \'\') AS \'Descontos\',\r\n\r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_EXTRA + CAL_EXTRAn + CAL_EXTRAF + CAL_EXTRANF)))), \'\') AS \'EXTRA%\'                               \r\n                 \r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nWHERE CAL_DATA >= @DATAINICIO  AND CAL_DATA <= @DATAFIM AND       \r\nFUNC_DT_DEM IS NULL and FUNC_MARCADO_EXCLUSAO = 0 and \r\n(CAL_EXTRA > 0 OR CAL_EXTRAF > 0 or CAL_EXTRAF > 0 or CAL_EXTRANF > 0 or CAL_DESCONTO >0)\r\nGROUP BY FUNC_NOME\r\norder by FUNC_NOME','Gabriel','2018-09-26 16:43:59'),(390,'Relatorio de Falta de Marcacoes no dia atual','RELATORIOS','--LARGURA#200,70,60,60,60,60,70,70#\r\nSELECT FUNC_NOME AS Nome ,\r\nAPO_DATA AS Data,\r\ndbo.fn_gettimefull(APO_MARCACAO1) AS Entrada,\r\ndbo.fn_gettimefull(APO_MARCACAO2) AS \'Intervalo 1\',\r\ndbo.fn_gettimefull(APO_MARCACAO3) AS \'Intervalo 2\',     \r\ndbo.fn_gettimefull(APO_MARCACAO4) AS SaÃ­da,\r\n(CASE WHEN APO_H = -990 THEN \'FOLGA\' ELSE \'\' END) FOLGAS,\r\n(CASE WHEN APO_DSR = 0 THEN \'\' ELSE \'DSR\' END) DSR  \r\nFROM Funcionarios                      \r\nINNER JOIN Aponta ON APO_FUNC = FUNC_IND\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nleft JOIN ferias ON FER_FUNC = FUNC_IND\r\nleft JOIN Afastamentos ON AFA_FUNC = FUNC_IND\r\nWHERE APO_DATA = (cast(GETDATE() as date))\r\nAND (APO_MARCACAO1 IS NULL OR APO_MARCACAO2 IS NULL OR \r\nAPO_MARCACAO3 IS NULL OR APO_MARCACAO4 IS NULL) \r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 16:44:27'),(391,'Relatorio de falta de marcaÃ§oes no Intervalo','RELATORIOS','--COLUNAGRUPO#1#\r\n--LARGURA#200,200,70,60,60,60,60,70,70#          \r\nSELECT distinct FUNC_NOME AS Nome , EMP_nome,\r\nAPO_DATA AS Data,\r\ndbo.fn_gettimefull(APO_MARCACAO1) AS Entrada,\r\ndbo.fn_gettimefull(APO_MARCACAO2) AS \'Intervalo 1\',\r\ndbo.fn_gettimefull(APO_MARCACAO3) AS \'Intervalo 2\',     \r\ndbo.fn_gettimefull(APO_MARCACAO4) AS SaÃ­da\r\nFROM Funcionarios\r\nINNER JOIN Aponta ON APO_FUNC = FUNC_IND\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nWHERE APO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL%\r\nAND (APO_MARCACAO2 IS NULL OR APO_MARCACAO3 IS NULL) and (APO_MARCACAO1 IS not NULL OR APO_MARCACAO4 IS not NULL)\r\nORDER BY EMP_nome, FUNC_NOME','Gabriel','2018-09-26 16:44:38'),(392,'Relatorio de falta de marcaÃ§oes','RELATORIOS','--COLUNAGRUPO#1#\r\n--LARGURA#200,200,70,60,60,60,60,60,60,60,60#          \r\nSELECT distinct FUNC_NOME AS Nome , EMP_nome,\r\nAPO_DATA AS Data,\r\ndbo.fn_gettimefull(APO_MARCACAO1) AS \'Entrada\',          \r\ndbo.fn_gettimefull(APO_MARCACAO2) AS \'Saida\',\r\ndbo.fn_gettimefull(APO_MARCACAO3) AS \'Entrada2\',\r\ndbo.fn_gettimefull(APO_MARCACAO4) AS \'Saida2\',\r\ndbo.fn_gettimefull(APO_MARCACAO5) AS \'Entrada3\',              \r\ndbo.fn_gettimefull(APO_MARCACAO6) AS \'Saida3\',  \r\ndbo.fn_gettimefull(APO_MARCACAO7) AS \'Entrada4\',\r\ndbo.fn_gettimefull(APO_MARCACAO8) AS \'Saida4\'  \r\nFROM Funcionarios\r\nINNER JOIN Aponta ON APO_FUNC = FUNC_IND\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nWHERE APO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL% and APO_H >= -990 and FUNC_MARCADO_EXCLUSAO = 0    \r\nAND ((APO_MARCACAO1 IS not NULL and APO_MARCACAO2 IS not NULL and APO_MARCACAO3 IS not NULL and \r\nAPO_MARCACAO4 IS not NULL and APO_MARCACAO5 IS not NULL) or    \r\n(APO_MARCACAO1 IS not NULL and APO_MARCACAO2 IS not NULL and APO_MARCACAO3 IS not NULL and APO_MARCACAO4 IS not NULL \r\nand APO_MARCACAO5 IS not NULL and APO_MARCACAO6 IS not NULL and APO_MARCACAO7 IS not NULL) or     \r\n(APO_MARCACAO1 IS not NULL and APO_MARCACAO2 IS NULL and APO_MARCACAO3 IS NULL and APO_MARCACAO4 IS NULL) or\r\n(APO_MARCACAO1 IS not NULL and APO_MARCACAO2 IS NULL and APO_MARCACAO3 IS not NULL and APO_MARCACAO4 IS NULL) or\r\n(APO_MARCACAO1 IS NULL and APO_MARCACAO2 IS not NULL and APO_MARCACAO3 IS NULL and APO_MARCACAO4 IS not NULL) or\r\n(APO_MARCACAO1 IS NULL and APO_MARCACAO2 IS not NULL and APO_MARCACAO3 IS not NULL and APO_MARCACAO4 IS not NULL) or\r\n(APO_MARCACAO1 IS not NULL and APO_MARCACAO2 IS NULL and APO_MARCACAO3 IS not NULL and APO_MARCACAO4 IS not NULL) or\r\n(APO_MARCACAO1 IS not NULL and APO_MARCACAO2 IS not NULL and APO_MARCACAO3 IS NULL and APO_MARCACAO4 IS not NULL) or\r\n(APO_MARCACAO1 IS not NULL and APO_MARCACAO2 IS not NULL and APO_MARCACAO3 IS not NULL and APO_MARCACAO4 IS NULL) or\r\n(APO_MARCACAO1 IS NULL and APO_MARCACAO2 IS NULL and APO_MARCACAO3 IS NULL and APO_MARCACAO4 IS not NULL) or\r\n(APO_MARCACAO1 IS not NULL and APO_MARCACAO2 IS NULL) or\r\n(APO_MARCACAO1 IS NULL and APO_MARCACAO2 IS not NULL))                                              \r\nORDER BY EMP_nome, FUNC_NOME','Gabriel','2018-09-26 16:47:51'),(393,'Relatorio de Faltas com justificativa','RELATORIOS','--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\n--LARGURA#300,80,80,80,80,300#\r\nSELECT FUNC_NOME AS NOME, CAL_DATA AS DATA, dbo.fn_gettime5nullzero\r\n(CAL_DESCONTO) AS\r\nDESCONTO,\r\nCASE WHEN CAL_FALTAHORA > 0 THEN \'FALTA\' ELSE \'\' END AS\r\nFALTAS, dbo.fn_gettime5nullzero(CAL_ABONO) AS JUSTIFICATIVA,\r\nCASE WHEN CAL_ABONO > 0 THEN (SELECT JUS_DESCRICAO FROM\r\njustificativas\r\nWHERE JUS_FUNC = CAL_FUNC\r\nAND JUS_DATA = CAL_DATA) ELSE \'\' END  AS MOTIVO\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON CAL_FUNC = FUNC_IND\r\nWHERE (CAL_FALTAHORA > 0 OR CAL_ABONO > 0) AND CAL_DATA >=\r\n%DATAINICIAL% AND CAL_DATA <=\r\n%DATAFINAL%\r\nAND dbo.fn_departamentopertencente(FUNC_EMPRESA,\r\n%DEPSELECIONADOIND%) = 1\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:03:05'),(394,'Relatorio de Faltas e Presentes no dia ','RELATORIOS','--LARGURA#80,200,80,80,45,60,60,60,60,120#\r\nSELECT dbo.fn_getdate(CAL_DATA) AS \'Data\', FUNC_NOME \'Nome\',\r\n\r\nCASE WHEN CAL_FALTAHORA > 0 THEN \'AUSENTE\' WHEN BCO_STATUS = 10 THEN \'AUSENTE\' else \'\' end AS \'AUSENTE\',\r\nCASE WHEN CAL_FALTAHORA > 0 THEN \'\' WHEN BCO_VALOR > \'00:00\'\r\nand BCO_STATUS = 10 THEN \'\' else \'PRESENTE\' end PRESENTE\r\n\r\n                                                                                               \r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nleft JOIN BcoHoras ON BCO_FUNC = FUNC_IND and BCO_DATA = cal_data\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1 \r\nAND FUNC_MARCADO_EXCLUSAO = 0  AND CAL_DATA = CONVERT(VARCHAR(30), getdate() - 1, 103) and APO_H <> -990 and APO_H <> -999 and APO_H <> -\r\n994\r\ngroup by FUNC_NOME, CAL_DATA,FUNC_IND, CAL_DESCONTO,CAL_FALTAHORA, BCO_VALOR,BCO_STATUS, APO_H\r\nOrder By FUNC_NOME, CAL_DATA','Gabriel','2018-09-26 18:03:16'),(395,'Relatorio de Faltas LanÃ§adas no Banco mes atual','RELATORIOS','--COLUNAGRUPO#1#\r\n--LARGURA# 80,250,110,120#\r\nselect BCO_DATA DATA, FUNC_NOME As NOME, BCO_DESCRICAO DESCRICAO, \r\ndbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute (BCO_VALOR))) AS \'VALOR DESCONTADO\'\r\nFROM Funcionarios\r\nINNER JOIN BcoHoras ON BCO_FUNC = FUNC_IND\r\nINNER JOIN EMPRESAS ON  FUNC_EMPRESA = EMP_IND\r\nWHERE BCO_DATA >= %DATAINICIAL% AND BCO_DATA <= %DATAFINAL% AND \r\nFUNC_DT_DEM IS NULL and FUNC_MARCADO_EXCLUSAO = 0  and\r\ndbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) = 1 AND BCO_STATUS = 10 \r\nGROUP BY FUNC_NOME, FUNC_IND, EMP_NOME, BCO_DATA, BCO_DESCRICAO\r\nORDER BY EMP_NOME, FUNC_NOME, BCO_DATA','Gabriel','2018-09-26 18:03:26'),(396,'Relatorio de Faltas LanÃ§adas no Banco','RELATORIOS','--COLUNAGRUPO#1#\r\n--LARGURA# 80,250,110,120#\r\nselect BCO_DATA DATA, FUNC_NOME As NOME, BCO_DESCRICAO DESCRICAO, \r\ndbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute (BCO_VALOR))) AS \'VALOR DESCONTADO\'\r\nFROM Funcionarios\r\nINNER JOIN BcoHoras ON BCO_FUNC = FUNC_IND\r\nINNER JOIN EMPRESAS ON  FUNC_EMPRESA = EMP_IND\r\n--WHERE BCO_DATA >= \'01/01/2017\' AND BCO_DATA <= \'31/1/2017\' and\r\nWHERE BCO_DATA >= %DATAINICIAL% AND BCO_DATA <= CONVERT(nvarchar(30), getdate(), 103)  AND\r\nFUNC_DT_DEM IS NULL and FUNC_MARCADO_EXCLUSAO = 0  and\r\ndbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) = 1 AND BCO_STATUS = 10 \r\nGROUP BY FUNC_NOME, FUNC_IND, EMP_NOME, BCO_DATA, BCO_DESCRICAO\r\nORDER BY EMP_NOME, FUNC_NOME, BCO_DATA','Gabriel','2018-09-26 18:03:39'),(397,'Relatorio de Faltas, Justificativa atestados medico e LanÃ§amento de falta em banco','RELATORIOS','--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\n--LARGURA#300,80,200#\r\nSELECT FUNC_NOME as Nome, dbo.fn_getdate(cal_data) Data,\r\ncase when cal_FALTAHORA > 0 then \'Falta\' WHEN JUS_DESCRICAO = \'Atestado MÃ©dico\' THEN \'Atestado MÃ©dico\' else\r\n\'Falta LanÃ§ada em Banco\' END  AS MOTIVO\r\n\r\nFROM dbo.calculo\r\nINNER JOIN FuncIONARIOS ON FUNC_IND = cal_FUNC\r\nleft join justificativas on JUS_FUNC = CAL_FUNC AND JUS_DATA = CAL_DATA  \r\nleft JOIN BcoHoras ON BCO_FUNC = FUNC_IND and BCO_DATA = CAL_DATA        \r\nINNER JOIN Empresas ON Empresas.EMP_IND = FuncIONARIOS.FUNC_EMPRESA\r\nWHERE cal_DATA >= %DATAINICIAL% AND cal_DATA <= %DATAFINAL% and                                  \r\ndbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) = 1 and \r\n(BCO_DESCRICAO = \'Falta LanÃ§ada em Banco\' or cal_FALTAHORA > 0 or CAL_ABONO > 0) \r\nORDER BY EMP_NOME, FUNC_NOME, cal_DATA','Gabriel','2018-09-26 18:03:47'),(398,'RELATORIO DE FOLGA E DSR COM TODOS DIAS DO MES','RELATORIOS','--COLUNAGRUPO#1#\r\n--LARGURA# 250,250,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,#\r\nSELECT DISTINCT FUNC_NOME,EMP_Nome,\r\n                                         \r\nCASE WHEN APO_DATA = %DATAINICIAL% and APO_H = -990 THEN \'FOLGA\'\r\nWHEN APO_DATA = %DATAINICIAL% and APO_H = -999 then \'DSR\'\r\nWHEN APO_DATA = %DATAINICIAL% and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 1\',  \r\n\r\nCASE WHEN APO_DATA = DATEADD(day, 1, %DATAINICIAL%) and APO_H = -990 THEN \'FOLGA\'\r\nWHEN APO_DATA = DATEADD(day, 1, %DATAINICIAL%) and APO_H = -999 then \'DSR\'\r\nWHEN APO_DATA = DATEADD(day, 1, %DATAINICIAL%) and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 2\', \r\n\r\nCASE WHEN APO_DATA = DATEADD(day, 2, %DATAINICIAL%) and APO_H = -990 THEN \'FOLGA\'\r\nWHEN APO_DATA = DATEADD(day, 2, %DATAINICIAL%) and APO_H = -999 then \'DSR\'\r\nWHEN APO_DATA = DATEADD(day, 2, %DATAINICIAL%) and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 3\',\r\n\r\nCASE WHEN APO_DATA = DATEADD(day, 3, %DATAINICIAL%) and APO_H = -990 THEN \'FOLGA\'\r\nWHEN APO_DATA = DATEADD(day, 3, %DATAINICIAL%) and APO_H = -999 then \'DSR\'\r\nWHEN APO_DATA = DATEADD(day, 3, %DATAINICIAL%) and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 4\',\r\n\r\nCASE WHEN APO_DATA = DATEADD(day, 4, %DATAINICIAL%) and APO_H = -990 THEN \'FOLGA\'\r\nWHEN APO_DATA = DATEADD(day, 4, %DATAINICIAL%) and APO_H = -999 then \'DSR\'\r\nWHEN APO_DATA = DATEADD(day, 4, %DATAINICIAL%) and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 5\', \r\n\r\nCASE WHEN APO_DATA = DATEADD(day, 5, %DATAINICIAL%) and APO_H = -990 THEN \'FOLGA\'                       \r\nWHEN APO_DATA = DATEADD(day, 5, %DATAINICIAL%) and APO_H = -999 then \'DSR\'\r\nWHEN APO_DATA = DATEADD(day, 5, %DATAINICIAL%) and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 6\',\r\n\r\nCASE WHEN APO_DATA = DATEADD(day, 6, %DATAINICIAL%) and APO_H = -990 THEN \'FOLGA\'\r\nWHEN APO_DATA = DATEADD(day, 6, %DATAINICIAL%) and APO_H = -999 then \'DSR\'\r\nWHEN APO_DATA = DATEADD(day, 6, %DATAINICIAL%) and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 7\',\r\n\r\nCASE WHEN APO_DATA = DATEADD(day, 7, %DATAINICIAL%) and APO_H = -990 THEN \'FOLGA\'\r\nWHEN APO_DATA = DATEADD(day, 7, %DATAINICIAL%) and APO_H = -999 then \'DSR\'\r\nWHEN APO_DATA = DATEADD(day, 7, %DATAINICIAL%) and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 8\' ,\r\n\r\nCASE WHEN APO_DATA = DATEADD(day, 8, %DATAINICIAL%) and APO_H = -990 THEN \'FOLGA\'\r\nWHEN APO_DATA = DATEADD(day, 8, %DATAINICIAL%) and APO_H = -999 then \'DSR\'\r\nWHEN APO_DATA = DATEADD(day, 8, %DATAINICIAL%) and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 9\' ,\r\n\r\nCASE WHEN APO_DATA = DATEADD(day, 9, %DATAINICIAL%) and APO_H = -990 THEN \'FOLGA\'\r\nWHEN APO_DATA = DATEADD(day, 9, %DATAINICIAL%) and APO_H = -999 then \'DSR\'\r\nWHEN APO_DATA = DATEADD(day, 9, %DATAINICIAL%) and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 10\' ,\r\n\r\nCASE WHEN APO_DATA = DATEADD(day, 10, %DATAINICIAL%) and APO_H = -990 THEN \'FOLGA\'\r\nWHEN APO_DATA = DATEADD(day, 10, %DATAINICIAL%) and APO_H = -999 then \'DSR\'\r\nWHEN APO_DATA = DATEADD(day, 10, %DATAINICIAL%) and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 11\',\r\n\r\nCASE WHEN APO_DATA = DATEADD(day, 11, %DATAINICIAL%) and APO_H = -990 THEN \'FOLGA\'\r\nWHEN APO_DATA = DATEADD(day, 11, %DATAINICIAL%) and APO_H = -999 then \'DSR\'\r\nWHEN APO_DATA = DATEADD(day, 11, %DATAINICIAL%) and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 12\',\r\n\r\nCASE WHEN APO_DATA = DATEADD(day, 12, %DATAINICIAL%) and APO_H = -990 THEN \'FOLGA\'\r\nWHEN APO_DATA = DATEADD(day, 12, %DATAINICIAL%) and APO_H = -999 then \'DSR\'\r\nWHEN APO_DATA = DATEADD(day, 12, %DATAINICIAL%) and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 13\',\r\n\r\nCASE WHEN APO_DATA = DATEADD(day, 13, %DATAINICIAL%) and APO_H = -990 THEN \'FOLGA\'\r\nWHEN APO_DATA = DATEADD(day, 13, %DATAINICIAL%) and APO_H = -999 then \'DSR\'\r\nWHEN APO_DATA = DATEADD(day, 13, %DATAINICIAL%) and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 14\' ,\r\n\r\nCASE WHEN APO_DATA = DATEADD(day, 14, %DATAINICIAL%) and APO_H = -990 THEN \'FOLGA\'\r\nWHEN APO_DATA = DATEADD(day, 14, %DATAINICIAL%) and APO_H = -999 then \'DSR\'\r\nWHEN APO_DATA = DATEADD(day, 14, %DATAINICIAL%) and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 15\',\r\n                              \r\nCASE WHEN APO_DATA = DATEADD(day, 15, %DATAINICIAL%) and APO_H = -990 THEN \'FOLGA\'\r\nWHEN APO_DATA = DATEADD(day, 15, %DATAINICIAL%) and APO_H = -999 then \'DSR\'\r\nWHEN APO_DATA = DATEADD(day, 15, %DATAINICIAL%) and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 16\',\r\n\r\nCASE WHEN APO_DATA = DATEADD(day, 16, %DATAINICIAL%) and APO_H = -990 THEN \'FOLGA\'\r\nWHEN APO_DATA = DATEADD(day, 16, %DATAINICIAL%) and APO_H = -999 then \'DSR\'\r\nWHEN APO_DATA = DATEADD(day, 16, %DATAINICIAL%) and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 17\' ,\r\n\r\nCASE WHEN APO_DATA = DATEADD(day, 18, %DATAINICIAL%) and APO_H = -990 THEN \'FOLGA\'\r\nWHEN APO_DATA = DATEADD(day, 18, %DATAINICIAL%) and APO_H = -999 then \'DSR\'\r\nWHEN APO_DATA = DATEADD(day, 18, %DATAINICIAL%) and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 19\',\r\n\r\nCASE WHEN APO_DATA = DATEADD(day, 19, %DATAINICIAL%) and APO_H = -990 THEN \'FOLGA\'\r\nWHEN APO_DATA = DATEADD(day, 19, %DATAINICIAL%) and APO_H = -999 then \'DSR\'\r\nWHEN APO_DATA = DATEADD(day, 19, %DATAINICIAL%) and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 20\',\r\n\r\nCASE WHEN APO_DATA = DATEADD(day, 21, %DATAINICIAL%) and APO_H = -990 THEN \'FOLGA\'\r\nWHEN APO_DATA = DATEADD(day, 21, %DATAINICIAL%) and APO_H = -999 then \'DSR\'\r\nWHEN APO_DATA = DATEADD(day, 21, %DATAINICIAL%) and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 22\' ,\r\n\r\nCASE WHEN APO_DATA = DATEADD(day, 22, %DATAINICIAL%) and APO_H = -990 THEN \'FOLGA\'\r\nWHEN APO_DATA = DATEADD(day, 22, %DATAINICIAL%) and APO_H = -999 then \'DSR\'\r\nWHEN APO_DATA = DATEADD(day, 22, %DATAINICIAL%) and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 23\',\r\n\r\nCASE WHEN APO_DATA = DATEADD(day, 23, %DATAINICIAL%) and APO_H = -990 THEN \'FOLGA\'\r\nWHEN APO_DATA = DATEADD(day, 23, %DATAINICIAL%) and APO_H = -999 then \'DSR\'                              \r\nWHEN APO_DATA = DATEADD(day, 23, %DATAINICIAL%) and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 24\',\r\n\r\nCASE WHEN APO_DATA = DATEADD(day, 24, %DATAINICIAL%) and APO_H = -990 THEN \'FOLGA\'\r\nWHEN APO_DATA = DATEADD(day, 24, %DATAINICIAL%) and APO_H = -999 then \'DSR\'\r\nWHEN APO_DATA = DATEADD(day, 24, %DATAINICIAL%) and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 25\' ,\r\n\r\nCASE WHEN APO_DATA = DATEADD(day, 25, %DATAINICIAL%) and APO_H = -990 THEN \'FOLGA\'\r\nWHEN APO_DATA = DATEADD(day, 25, %DATAINICIAL%) and APO_H = -999 then \'DSR\'\r\nWHEN APO_DATA = DATEADD(day, 25, %DATAINICIAL%) and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 26\' ,\r\n\r\nCASE WHEN APO_DATA = DATEADD(day, 26, %DATAINICIAL%) and APO_H = -990 THEN \'FOLGA\'\r\nWHEN APO_DATA = DATEADD(day, 26, %DATAINICIAL%) and APO_H = -999 then \'DSR\'\r\nWHEN APO_DATA = DATEADD(day, 26, %DATAINICIAL%) and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 27\',\r\n\r\nCASE WHEN APO_DATA = DATEADD(day, 27, %DATAINICIAL%) and APO_H = -990 THEN \'FOLGA\'\r\nWHEN APO_DATA = DATEADD(day, 27, %DATAINICIAL%) and APO_H = -999 then \'DSR\'\r\nWHEN APO_DATA = DATEADD(day, 27, %DATAINICIAL%) and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 28\',\r\n\r\nCASE WHEN APO_DATA = DATEADD(day, 28, %DATAINICIAL%) and APO_H = -990 THEN \'FOLGA\'\r\nWHEN APO_DATA = DATEADD(day, 28, %DATAINICIAL%) and APO_H = -999 then \'DSR\'\r\nWHEN APO_DATA = DATEADD(day, 28, %DATAINICIAL%) and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 29\',\r\n\r\nCASE WHEN APO_DATA = DATEADD(day, 29, %DATAINICIAL%) and APO_H = -990 THEN \'FOLGA\'\r\nWHEN APO_DATA = DATEADD(day, 29, %DATAINICIAL%) and APO_H = -999 then \'DSR\'\r\nWHEN APO_DATA = DATEADD(day, 29, %DATAINICIAL%) and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 30\' ,\r\n\r\nCASE WHEN APO_DATA = %DATAFINAL% and APO_H = -990 THEN \'FOLGA\'\r\nWHEN APO_DATA = %DATAFINAL% and APO_H = -999 then \'DSR\'\r\nWHEN APO_DATA = %DATAFINAL% and APO_H = -994 then \'FERIADO\' else \'OK\' end as \'DIA 31\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN APONTA ON FUNC_IND = APO_FUNC                          \r\nINNER JOIN EMPRESAS ON EMP_IND = FUNC_EMPRESA\r\nwhere FUNC_DT_DEM IS NULL and FUNC_MARCADO_EXCLUSAO = 0  \r\nAND dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) = 1\r\nORDER BY EMP_Nome, FUNC_NOME','Gabriel','2018-09-26 18:03:58'),(399,'Relatorio de folgas com dias da semana','RELATORIOS','--COLUNAGRUPO#0#\r\n--LARGURA#200,80,70,60,60,60,60#\r\nSELECT FUNC_NOME AS Nome , APO_DATA AS Data, case DATEPART(weekday, APO_DATA) when 1 then \'DOMINGO\' WHEN 2 then \'SEGUNDA\'    \r\nWHEN 3 then \'TERÃ‡A\' WHEN 4 then \'QUARTA\' WHEN 5 then \'QUINTA\' WHEN 6 then \'SEXTA\'\r\nWHEN 7 then \'SABADO\' ELSE \'\' END AS Semana,                                       \r\n(CASE WHEN APO_H = -990 THEN \'FOLGA\' ELSE \'\' END) Folgas     \r\nFROM Funcionarios                      \r\nINNER JOIN Aponta ON APO_FUNC = FUNC_IND\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nWHERE APO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL%\r\nAND APO_H = -990 and FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL and \r\ndbo.fn_departamentopertencente( FUNC_EMPRESA,%DEPSELECIONADOIND%) = 1\r\nORDER BY FUNC_NOME,APO_DATA','Gabriel','2018-09-26 18:04:06'),(400,'Relatorio de Folgas e DSR no Domingo','RELATORIOS','declare @inicial datetime = %DATAINICIAL%,\r\n        @final datetime = %DATAFINAL%\r\n--COLUNAGRUPO#0#\r\n--LARGURA#300,100,100,100#                                               \r\nSELECT Distinct \r\nFUNC_NOME NOME, APO_DATA DATA, \r\n(CASE WHEN APO_H = -990 THEN \'FOLGA\' ELSE \'\' END) FOLGAS, \r\n(CASE WHEN APO_DSR = 0 THEN \'\' ELSE \'DSR\' END) DSR      \r\nFROM Aponta\r\nINNER JOIN Funcionarios ON FUNC_IND = APO_FUNC\r\nINNER JOIN Calculo ON APO_DATA = CAL_DATA\r\nWHERE APO_DATA >= @inicial AND APO_DATA <= @final and DATEPART(weekday, APO_DATA) = 1 and\r\n(APO_H = -990 or APO_DSR > 0)                \r\nGROUP BY FUNC_NOME,APO_DATA, APO_H, APO_DSR','Gabriel','2018-09-26 18:04:16'),(401,'RELATORIO DE FUNCIONARIO ASSOCIADOS AO EXPEDIENTE','RELATORIOS','--GRUPOQUEBRA#0#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#1#\r\nSELECT FUNC_NOME AS Nome, RTRIM(INt_COD) + \' - \' + RTRIM(INt_DESCRICAO) AS DescriÃ§Ã£o\r\nFROM FUNCionarios\r\nINNER JOIN Hora ON HR_FUNC = FUNC_INd\r\nINNER JOIN Expedientes ON INT_INd = HR_HORARIO\r\nWHERE FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL\r\nAND dbo.fn_departamentopertencente( FUNC_EMPRESA,%DEPSELECIONADOIND%) = 1\r\nORDER BY INt_DESCRICAO, FUNC_NOME','Gabriel','2018-09-26 18:04:24'),(402,'RELATORIO DE FUNCIONARIOS DEMITIDOS EM UM PERIODO E ADMITIDOS','RELATORIOS','--COLUNAGRUPO#1#\r\n--LARGURA#220,220,80,80#\r\nSELECT distinct FUNC_NOME AS NOME, EMP_NOME AS EMPRESA,\r\nFUNC_DT_ADM as ADMISSAO, case when FUNC_DT_DEM >= \'01/04/2017\' and FUNC_DT_DEM <= \'31/07/2017\' then CONVERT(NVARCHAR(30),\r\n(FUNC_DT_DEM),103) else \'\' end AS DEMISSAO\r\nFROM FUNCIONARIOS\r\nINNER JOIN EMPRESAS ON  FUNC_EMPRESA = EMP_IND\r\nwhere dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) = 1 AND FUNC_DT_DEM IS NULL and FUNC_MARCADO_EXCLUSAO = 0 or \r\n(FUNC_DT_DEM >= \'01/04/2017\' and FUNC_DT_DEM <= \'31/07/2017\')\r\nORDER BY EMP_NOME, FUNC_NOME','Gabriel','2018-09-26 18:04:35'),(403,'Relatorio de Funcionarios sem marcaÃ§oes do relogio','RELATORIOS','select a.FUNC_NOME Nome, a.FUNC_PIS Pis \r\nfrom Funcionarios a \r\nouter apply(\r\n       select MRC_IND from Marcacoes where a.FUNC_IND = MRC_FUNC and MRC_DATAHORA >= %DATAINICIAL% and MRC_DATAHORA <= %DATAFINAL%\r\n)b\r\nwhere b.MRC_IND is null\r\n','Gabriel','2018-09-26 18:04:44'),(404,'Relatorio de funcionarios, cargo, expediente do apontamento, pis, admissao','RELATORIOS','\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#3#\r\n--LARGURA#50,250,80,220,150,80,150#\r\nSET DATEFORMAT DMY                                   \r\n\r\nSELECT DISTINCT FUNC_REG AS Registro, FUNC_NOME AS Nome,FUNC_DT_ADM AS Admissao, EMP_NOME AS Depto, CAR_DESCRICAO AS CARGO, FUNC_PIS AS \r\nPIS, EXPEDIENTE\r\nFROM Funcionarios\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nOUTER APPLY\r\n(SELECT STUFF(\' \' + ISNULL(dbo.fn_gettimefull(APO_H1), \'\') + \' \' + ISNULL(dbo.fn_gettimefull(APO_H2), \'\') + \' \' + ISNULL\r\n(dbo.fn_gettimefull(APO_H3), \'\') + \' \' + ISNULL(dbo.fn_gettimefull(APO_H4), \'\'), 1, 1, \' \') AS EXPEDIENTE FROM Aponta WHERE APO_FUNC = \r\nFuncionarios.FUNC_IND AND APO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL%) a\r\nWHERE EXPEDIENTE <> \'\'\r\nORDER BY EMP_NOME, FUNC_NOME','Gabriel','2018-09-26 18:04:57'),(405,'Relatorio de funcionarios, cpf, pis, admissao','RELATORIOS','--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\n--LARGURA#250,220,120,120,80#                            \r\n\r\nSELECT EMP_NOME AS DEP, FUNC_NOME AS NOME, [REG_CPF_NUMERO] CPF, FUNC_PIS AS PIS, FUNC_DT_ADM AS ADMISSAO\r\nFROM Funcionarios\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nLEFT JOIN Registro ON REG_FUNC = FUNC_IND\r\nORDER BY EMP_NOME, FUNC_NOME','Gabriel','2018-09-26 18:05:07'),(406,'Relatorio de Funcionarios, Registro, Cargo, Empresa, Pis, Expediente, Escalas','RELATORIOS','SELECT DISTINCT FUNC_REG as REGISTRO, FUNC_NOME as NOME, FUNC_PIS, CAR_DESCRICAO as CARGO, EMP_NOME AS EMPRESA, DATA, EXPEDIENTE\r\nFROM Funcionarios\r\nINNER JOIN EMPRESAS ON  FUNC_EMPRESA = EMP_IND\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nOUTER APPLY\r\n(SELECT dbo.fn_getdate(APO_DATA) AS DATA, LTRIM(RTRIM(STUFF(\' \' + ISNULL(dbo.fn_gettimefull(APO_H1), \'\') + \' \' + ISNULL(dbo.fn_gettimefull(APO_H2), \'\') + \' \' + ISNULL \r\n(dbo.fn_gettimefull(APO_H3), \'\') + \' \' + ISNULL(dbo.fn_gettimefull(APO_H4), \'\') + \' \' + ISNULL(dbo.fn_gettimefull(APO_HV), \'\'), 1, 1, \' \'))) AS EXPEDIENTE FROM Aponta WHERE APO_FUNC =\r\nFuncionarios.FUNC_IND  AND APO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL%) a\r\nWHERE EXPEDIENTE <> \'\'\r\norder by  EMP_NOME, FUNC_NOME\r\n','Gabriel','2018-09-26 18:05:18'),(407,'Relatorio de horas noturnas totalizado','RELATORIOS','SELECT FUNC_NOME as Nome,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_NOTURNO)))as \'Adicional Noturno\'\r\nFROM Calculo\r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nWHERE CAL_NOTURNO > 0\r\n    AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%\r\nGROUP BY FUNC_NOME','Gabriel','2018-09-26 18:05:28'),(408,'Relatorio de Horas Trab, Horas a Trab, Credito e Debito','RELATORIOS','--LARGURA#80,80,50,50,50,80,50,50,80,80,50#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\nSELECT FUNC_NOME,\r\n\r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_ATRB)))), \'\') AS ATRAB,\r\n\r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_TRAB)))), \'\') AS TRAB,\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND  AND SUBSTRING(BCO_VALOR, 1, 1) <> \'-\') AS CREDITO,\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND                        \r\nAND SUBSTRING(BCO_VALOR, 1, 1) = \'-\') AS DEBITO\r\n  \r\nFROM Calculo\r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,\r\n%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0\r\nAND FUNC_DT_DEM IS NULL AND CAL_DATA >= %DATAINICIAL%\r\nAND CAL_DATA <= %DATAFINAL%\r\nGROUP BY FUNC_NOME, FUNC_IND','Gabriel','2018-09-26 18:05:39'),(409,'Relatorio de Horas trabalhadas por mes-2013','RELATORIOS','SET DATEFORMAT DMY\r\n\r\nSELECT \'Janeiro\', FUNC_NOME as Nome, CAR_DESCRICAO as Cargo, dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(dbo.fn_gettime(CAL_TRAB)))) as \'Horas Trab\'\r\nFROM [Calculo] \r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Cargos ON FUNC_CARGO = CAR_IND \r\nWHERE CAL_TRAB > 0 AND CAL_DATA > \'01/01/2013\' AND CAL_DATA < \'31/01/2013\'\r\nGROUP BY FUNC_NOME, CAR_DESCRICAO\r\nUNION\r\nSELECT \'Fevereiro\', FUNC_NOME as Nome, CAR_DESCRICAO as Cargo, dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(dbo.fn_gettime(CAL_TRAB)))) as \'Horas Trab\'\r\nFROM [Calculo] \r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Cargos ON FUNC_CARGO = CAR_IND \r\nWHERE CAL_TRAB > 0 AND CAL_DATA > \'01/02/2013\' AND CAL_DATA < \'28/02/2013\'\r\nGROUP BY FUNC_NOME, CAR_DESCRICAO\r\nUNION\r\nSELECT \'MarÃ§o\', FUNC_NOME as Nome, CAR_DESCRICAO as Cargo, dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(dbo.fn_gettime(CAL_TRAB)))) as \'Horas Trab\'\r\nFROM [Calculo] \r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Cargos ON FUNC_CARGO = CAR_IND \r\nWHERE CAL_TRAB > 0 AND CAL_DATA > \'01/03/2013\' AND CAL_DATA < \'31/03/2013\'\r\nGROUP BY FUNC_NOME, CAR_DESCRICAO\r\nUNION\r\nSELECT \'Abril\', FUNC_NOME as Nome, CAR_DESCRICAO as Cargo, dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(dbo.fn_gettime(CAL_TRAB)))) as \'Horas Trab\'\r\nFROM [Calculo] \r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Cargos ON FUNC_CARGO = CAR_IND \r\nWHERE CAL_TRAB > 0 AND CAL_DATA > \'01/04/2013\' AND CAL_DATA < \'30/04/2013\'\r\nGROUP BY FUNC_NOME, CAR_DESCRICAO\r\nUNION\r\nSELECT \'Maio\', FUNC_NOME as Nome, CAR_DESCRICAO as Cargo, dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(dbo.fn_gettime(CAL_TRAB)))) as \'Horas Trab\'\r\nFROM [Calculo] \r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Cargos ON FUNC_CARGO = CAR_IND \r\nWHERE CAL_TRAB > 0 AND CAL_DATA > \'01/05/2013\' AND CAL_DATA < \'31/05/2013\'\r\nGROUP BY FUNC_NOME, CAR_DESCRICAO\r\nUNION\r\nSELECT \'Junho\', FUNC_NOME as Nome, CAR_DESCRICAO as Cargo, dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(dbo.fn_gettime(CAL_TRAB)))) as \'Horas Trab\'\r\nFROM [Calculo] \r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Cargos ON FUNC_CARGO = CAR_IND \r\nWHERE CAL_TRAB > 0 AND CAL_DATA > \'01/06/2013\' AND CAL_DATA < \'30/06/2013\'\r\nGROUP BY FUNC_NOME, CAR_DESCRICAO\r\nUNION\r\nSELECT \'Julho\', FUNC_NOME as Nome, CAR_DESCRICAO as Cargo, dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(dbo.fn_gettime(CAL_TRAB)))) as \'Horas Trab\'\r\nFROM [Calculo] \r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Cargos ON FUNC_CARGO = CAR_IND \r\nWHERE CAL_TRAB > 0 AND CAL_DATA > \'01/07/2013\' AND CAL_DATA < \'31/07/2013\'\r\nGROUP BY FUNC_NOME, CAR_DESCRICAO\r\nUNION\r\nSELECT \'Agosto\', FUNC_NOME as Nome, CAR_DESCRICAO as Cargo, dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(dbo.fn_gettime(CAL_TRAB)))) as \'Horas Trab\'\r\nFROM [Calculo] \r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Cargos ON FUNC_CARGO = CAR_IND \r\nWHERE CAL_TRAB > 0 AND CAL_DATA > \'01/08/2013\' AND CAL_DATA < \'31/08/2013\'\r\nGROUP BY FUNC_NOME, CAR_DESCRICAO\r\nUNION\r\nSELECT \'Setembro\', FUNC_NOME as Nome, CAR_DESCRICAO as Cargo, dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(dbo.fn_gettime(CAL_TRAB)))) as \'Horas Trab\'\r\nFROM [Calculo] \r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Cargos ON FUNC_CARGO = CAR_IND \r\nWHERE CAL_TRAB > 0 AND CAL_DATA > \'01/09/2013\' AND CAL_DATA < \'30/09/2013\'\r\nGROUP BY FUNC_NOME, CAR_DESCRICAO\r\nUNION\r\nSELECT \'Outubro\', FUNC_NOME as Nome, CAR_DESCRICAO as Cargo, dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(dbo.fn_gettime(CAL_TRAB)))) as \'Horas Trab\'\r\nFROM [Calculo] \r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Cargos ON FUNC_CARGO = CAR_IND \r\nWHERE CAL_TRAB > 0 AND CAL_DATA > \'01/10/2013\' AND CAL_DATA < \'31/10/2013\'\r\nGROUP BY FUNC_NOME, CAR_DESCRICAO\r\nUNION\r\nSELECT \'Novembro\', FUNC_NOME as Nome, CAR_DESCRICAO as Cargo, dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(dbo.fn_gettime(CAL_TRAB)))) as \'Horas Trab\'\r\nFROM [Calculo] \r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Cargos ON FUNC_CARGO = CAR_IND \r\nWHERE CAL_TRAB > 0 AND CAL_DATA > \'01/11/2013\' AND CAL_DATA < \'30/11/2013\'\r\nGROUP BY FUNC_NOME, CAR_DESCRICAO\r\nUNION\r\nSELECT \'Dezembro\', FUNC_NOME as Nome, CAR_DESCRICAO as Cargo, dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(dbo.fn_gettime(CAL_TRAB)))) as \'Horas Trab\'\r\nFROM [Calculo] \r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Cargos ON FUNC_CARGO = CAR_IND \r\nWHERE CAL_TRAB > 0 AND CAL_DATA > \'01/12/2013\' AND CAL_DATA < \'31/12/2013\'\r\nGROUP BY FUNC_NOME, CAR_DESCRICAO\r\n','Gabriel','2018-09-26 18:05:51'),(410,'Relatorio de Justificativas detalhado, descriÃ§ao e Total Abonado','RELATORIOS','--LARGURA#80,300,80,100,200#\r\nSELECT FUNC_REG As Matricula, FUNC_NOME NOME, CAL_DATA AS DATA,\r\ndbo.fn_gettime5nullzero(CAL_ABONO) AS \'VALOR ABONADO\',   \r\nCASE WHEN CAL_ABONO > 0 THEN (SELECT JUS_DESCRICAO FROM justificativas\r\nWHERE JUS_FUNC = CAL_FUNC\r\nAND JUS_DATA = CAL_DATA) ELSE \'\' END  AS MOTIVO,\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_ABONO))) \r\nFROM calculo \r\nWHERE CAL_DATA  >= %DATAINICIAL% AND CAL_DATA  <= %DATAFINAL%) AS TOTAL\r\nFROM Funcionarios                \r\nINNER JOIN Calculo ON CAL_FUNC = FUNC_IND\r\nWHERE CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL% \r\nAND CAL_ABONO > 0\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:06:02'),(411,'Relatorio de LanÃ§amento de Credito no banco maior que 2h','RELATORIOS','--LARGURA#180,80,80#\r\n--COLUNAGRUPO#0#\r\nSELECT FUNC_NOME, CAL_DATA AS DATA,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) AS CREDITO             \r\n     \r\nFROM Calculo                       \r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nINNER JOIN BcoHoras on BCO_FUNC = FUNC_IND  \r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA, %DEPSELECIONADOIND%) =1\r\nAND FUNC_DT_DEM IS NULL and FUNC_MARCADO_EXCLUSAO = 0 AND CAL_DATA >= %DATAINICIAL%\r\nAND CAL_DATA <= %DATAFINAL%  AND BCO_DATA = CAL_DATA and BCO_status in (1,2,3,4) and BCO_VALOR >= \'2:00\'                              \r\nGROUP BY FUNC_NOME, FUNC_IND, CAL_DATA, BCO_VALOR','Gabriel','2018-09-26 18:06:13'),(412,'Relatorio de MarcaÃ§ao, expediente, extras, desconto, faltas, adicional noturno','RELATORIOS','--LARGURA#80,200,140,45,40,45,50,70,70,45,60,60,60,60,120#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#1#                                                                                                                            \r\nSELECT dbo.fn_getdate(CAL_DATA) AS \'Data\', FUNC_NOME \'Nome\',\r\ncase when apo_Hv > 0 then dbo.fn_gettimefull(apo_Hv) else dbo.fn_expediente_dia(func_ind,CAL_DATA) end AS Expediente,\r\ndbo.fn_gettimefull(APO_MARCACAO1) AS \'Entrada1\',\r\ndbo.fn_gettimefull(APO_MARCACAO2) AS \'Saida1\',\r\ndbo.fn_gettimefull(APO_MARCACAO3) AS \'Entrada2\',\r\ndbo.fn_gettimefull(APO_MARCACAO4) AS \'Saida2\',\r\n\r\nISNULL(dbo.fn_gettime5nullzero(CAL_TRAB), \'\') AS \'Trabalhadas\',\r\nISNULL(dbo.fn_gettime5nullzero(CAL_ATRB), \'\') AS \'A Trabalhar\',\r\n\r\nISNULL(dbo.fn_gettime5nullzero(CAL_EXTRA + CAL_EXTRAn), \'\') AS \'Extras\',\r\n\r\nISNULL(dbo.fn_gettime5nullzero(CAL_EXTRAF + CAL_EXTRANF), \'\') AS \'Extras Foga/Feriados\',\r\n                                                                                        \r\nCASE WHEN CAL_FALTAHORA > 0 THEN \'\' else dbo.fn_gettime5nullzero(CAL_DESCONTO) end AS Desconto,\r\n\r\nCASE WHEN CAL_FALTAHORA > 0 THEN dbo.fn_gettime5nullzero(CAL_DESCONTO) else \'\' end AS \'Faltas Horas\',\r\nCASE WHEN CAL_FALTAHORA > 0 THEN \'FALTA\' ELSE \'\' END AS Faltas,\r\n\r\nCASE WHEN CAL_NOTURNO > 0 THEN dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_NOTURNO)))\r\nELSE \'\' END as \'ADICIONAL NOTURNO\'\r\n                                                                                 \r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL and CAL_ATRB > 0\r\nAND CAL_DATA = CONVERT(VARCHAR(30), getdate() - 2, 103)                                          \r\ngroup by FUNC_NOME, CAL_DATA, CAL_TRAB,CAL_ATRB,FUNC_IND,CAL_EXTRAF, CAL_EXTRANF,CAL_EXTRA,apo_Hv,\r\nCAL_EXTRAn,APO_MARCACAO1,APO_MARCACAO2,APO_MARCACAO3,APO_MARCACAO4,CAL_DESCONTO,CAL_FALTAHORA, dbo.fn_get_banco_saldo_totalizado_dia\r\n(func_ind,CAL_DATA), CAL_NOTURNO\r\nOrder By FUNC_NOME, CAL_DATA','Gabriel','2018-09-26 18:06:27'),(413,'Relatorio de MarcaÃ§ao, extras, desconto','RELATORIOS','--LARGURA#80,200,140,45,40,45,50,70,70,45,60,60,60,60,120#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#1#\r\n--declare @inicio smalldatetime = %DATAINICIAL% \r\n--declare @fim smalldatetime = %DATAFINAL%   \r\n\r\ndeclare @inicio smalldatetime = \'01/08/2018\'\r\ndeclare @fim smalldatetime = \'30/08/2018\'   \r\n                                          \r\nSELECT dbo.fn_getdate(CAL_DATA) AS \'Data\', FUNC_NOME \'Nome\',\r\ndbo.fn_gettimefull(APO_MARCACAO1) AS \'Entrada1\',\r\ndbo.fn_gettimefull(APO_MARCACAO2) AS \'Saida1\',\r\ndbo.fn_gettimefull(APO_MARCACAO3) AS \'Entrada2\',\r\ndbo.fn_gettimefull(APO_MARCACAO4) AS \'Saida2\',\r\n\r\nISNULL(dbo.fn_gettime5nullzero(CAL_EXTRA + CAL_EXTRAn), \'\') AS \'Extras\',\r\n\r\nISNULL(dbo.fn_gettime5nullzero(CAL_EXTRAF + CAL_EXTRANF), \'\') AS \'Extras Foga/Feriados\',\r\n                                                                                        \r\nCASE WHEN CAL_FALTAHORA > 0 THEN \'\' else dbo.fn_gettime5nullzero(CAL_DESCONTO) end AS Desconto\r\n                                                                                 \r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL and CAL_ATRB > 0\r\nAND CAL_DATA >= @inicio AND CAL_DATA <= @fim                                      \r\ngroup by FUNC_NOME, CAL_DATA, FUNC_IND,CAL_EXTRAF, CAL_EXTRANF,CAL_EXTRA,\r\nCAL_EXTRAn,APO_MARCACAO1,APO_MARCACAO2,APO_MARCACAO3,APO_MARCACAO4,CAL_DESCONTO,CAL_FALTAHORA \r\n\r\nOrder By FUNC_NOME, CAL_DATA','Gabriel','2018-09-26 18:06:38'),(414,'RELATORIO DE MARCAÃ‡OES DO RELOGIO E INCLUSAS','RELATORIOS','--LARGURA#200,80,75,50,120#\r\nSELECT FUNC_NOME NOME, MRC_PIS PIS, CONVERT(nvarchar(30), MRC_DATAHORA, 103) as DATA, CONVERT(nvarchar(5), MRC_DATAHORA, 108) as HORA,\r\nCASE WHEN MRC_OBS_USUARIO is not NULL THEN \'INCLUSA\' ELSE \'RELOGIO\' END TIPO\r\nFROM Marcacoes\r\nINNER JOIN Funcionarios ON MRC_FUNC = FUNC_IND\r\nWHERE MRC_DATAHORA >= %DATAINICIAL% AND MRC_DATAHORA <= %DATAFINAL%\r\nAND FUNC_MARCADO_EXCLUSAO = 0 and MRC_PIS is Not null\r\nORDER BY FUNC_NOME, MRC_DATAHORA','Gabriel','2018-09-26 18:06:49'),(415,'Relatorio de MarcaÃ§oes e dias da Semana','RELATORIOS','--COLUNAGRUPO#0#\r\n--LARGURA#200,80,70,60,60,60,60#\r\nSELECT FUNC_NOME AS Nome , APO_DATA AS Data, case DATEPART(weekday, APO_DATA) when 1 then \'DOMINGO\' WHEN 2 then \'SEGUNDA\'    \r\nWHEN 3 then \'TERÃ‡A\' WHEN 4 then \'QUARTA\' WHEN 5 then \'QUINTA\' WHEN 6 then \'SEXTA\'\r\nWHEN 7 then \'SABADO\' ELSE \'\' END AS Semana,                                       \r\n(CASE WHEN APO_H = -990 THEN \'FOLGA\' ELSE \'\' END) FOLGAS,     \r\nFROM Funcionarios                      \r\nINNER JOIN Aponta ON APO_FUNC = FUNC_IND\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nWHERE APO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL%\r\nAND (APO_MARCACAO1 IS NOT NULL OR APO_MARCACAO2 IS NOT NULL OR\r\nAPO_MARCACAO3 IS NOT NULL OR APO_MARCACAO4 IS NOT NULL) and FUNC_MARCADO_EXCLUSAO = 0\r\nORDER BY FUNC_NOME,APO_DATA','Gabriel','2018-09-26 18:06:58'),(416,'Relatorio de marcaÃ§oes e relogio marcado - MOBEL leve','RELATORIOS','--ORIENTACAO#paisagem#\r\n--LARGURA#165,40,70,55,55,55,55,55,55,55,60,55,55,55,55,55,55,55#\r\n--DECLARE @INICIO SMALLDATETIME = %DATAINICIAL%\r\n--DECLARE @FINAL SMALLDATETIME = %DATAFINAL%              \r\nDECLARE @INICIO SMALLDATETIME = \'01/01/2018\'              \r\nDECLARE @FINAL SMALLDATETIME = \'30/06/2018\'             \r\n\r\n\r\nSELECT DISTINCT FUNC_NOME FUNCIONARIO, FUNC_REG REGISTRO, CAL_DATA DATA,\r\n\r\nISNULL((select top 1 TRM_DESCRICAO from Terminais where TRM_IND = (select top 1 MRC_REP from marcacoes where FUNC_pis = MRC_pis and\r\n[MRC_DATAAP] = CAL_DATA)),\'\') as \'REP\',\r\n\r\ndbo.fn_gettimefull(APO_MARCACAO1) AS \'Entrada\',\r\ndbo.fn_gettimefull(APO_MARCACAO2) AS \'Saida\',\r\ndbo.fn_gettimefull(APO_MARCACAO3) AS \'Entrada2\',\r\ndbo.fn_gettimefull(APO_MARCACAO4) AS \'Saida2\',\r\n                                                                  \r\nISNULL(dbo.fn_gettime5nullzero(CAL_ATRB), \'\') AS \'ATRAB\',                 \r\nISNULL(dbo.fn_gettime5nullzero(CAL_TRAB), \'\') AS \'TRAB\',                                                       \r\n                   \r\nISNULL(dbo.fn_gettime5nullzero(CAL_EXTRA + CAL_EXTRAn), \'\') AS \'HE\',\r\n\r\nISNULL(dbo.fn_gettime5nullzero(CAL_EXTRAF + CAL_EXTRANF), \'\') AS \'HE Foga/Feriados\',\r\n\r\ndbo.fn_gettime5nullzero(CAL_DESCONTO) AS DESCONTO, \r\n                                                                    \r\nCASE WHEN CAL_FALTAHORA > 0 THEN \'FALTA\' ELSE \'\' END AS FALTAS    \r\n       \r\nFROM Marcacoes\r\nINNER JOIN Funcionarios ON FUNC_pis = MRC_pis \r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC and CAL_DATA = MRC_DATAAP\r\nINNER JOIN Terminais ON TRM_IND = MRC_REP\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA and APO_DATA = MRC_DATAAP     \r\nwhere FUNC_DT_DEM IS NULL AND FUNC_MARCADO_EXCLUSAO = 0 and CAL_ATRB > 0 and MRC_REP is not null AND dbo.fn_departamentopertencente\r\n(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1 and CAL_DATA >= @INICIO AND CAL_DATA <= @FINAL           \r\ngroup by FUNC_NOME,FUNC_IND, MRC_DATAHORA, FUNC_REG, MRC_DATAAP, TRM_IND, MRC_REP, FUNC_pis, MRC_pis , cal_data ,CAL_ATRB,\r\nCAL_TRAB,CAL_EXTRA, APO_MARCACAO1,APO_MARCACAO2,APO_MARCACAO3,APO_MARCACAO4, \r\nCAL_EXTRAn ,CAL_EXTRAF , CAL_EXTRANF  , CAL_DESCONTO,  CAL_FALTAHORA \r\nORDER BY FUNC_NOME, CAL_DATA','Gabriel','2018-09-26 18:07:09'),(417,'Relatorio de marcaÃ§oes e relogio marcado - MOBEL','RELATORIOS','--ORIENTACAO#paisagem#\r\n--LARGURA#165,40,70,55,55,55,55,55,55,55,60,55,55,55,55,55,55,55#\r\nSELECT DISTINCT FUNC_NOME FUNCIONARIO, FUNC_REG REGISTRO, CONVERT(nvarchar(10), apo_DATA, 103) DATA,\r\nISNULL((select top 1 CONVERT(nvarchar(5), MRC_DATAHORA, 108) from marcacoes where FUNC_pis = MRC_pis and\r\n[MRC_DATAAP] = apo_DATA and MRC_REP is not null),\'\') as \'ENTRADA\',\r\n\r\nISNULL((select top 1 TRM_DESCRICAO from Terminais where TRM_IND = (select top 1 MRC_REP from marcacoes where FUNC_pis = MRC_pis and\r\n[MRC_DATAAP] = apo_DATA)),\'\') as \'REP\',\r\n\r\nISNULL((select top 1 CONVERT(nvarchar(5), MRC_DATAHORA, 108) from marcacoes where FUNC_pis = MRC_pis and\r\n[MRC_DATAAP] = apo_DATA and (MRC_DATAHORA NOT IN\r\n (SELECT TOP 1 MRC_DATAHORA FROM marcacoes where FUNC_pis = MRC_pis and\r\n[MRC_DATAAP] = apo_DATA))),\'\') as \'SAIDA\',\r\n\r\nISNULL((select top 1 TRM_DESCRICAO from Terminais where TRM_IND = (select top 1 MRC_REP from marcacoes where FUNC_pis = MRC_pis and\r\n[MRC_DATAAP] = apo_DATA and MRC_DATAHORA = (select top 1 MRC_DATAHORA from marcacoes where FUNC_pis = MRC_pis and\r\n[MRC_DATAAP] = apo_DATA and (MRC_DATAHORA NOT IN (SELECT TOP 1 MRC_DATAHORA FROM marcacoes where FUNC_pis = MRC_pis and\r\n[MRC_DATAAP] = apo_DATA))))),\'\') as \'REP2\',\r\n\r\nISNULL((select top 1 CONVERT(nvarchar(5), MRC_DATAHORA, 108) from marcacoes where FUNC_pis = MRC_pis and\r\n[MRC_DATAAP] = apo_DATA and (MRC_DATAHORA NOT IN\r\n (SELECT TOP 2 MRC_DATAHORA FROM marcacoes where FUNC_pis = MRC_pis and\r\n[MRC_DATAAP] = apo_DATA))),\'\') as \'RETORNO\',\r\n\r\nISNULL((select top 1 TRM_DESCRICAO from Terminais where TRM_IND = (select top 1 MRC_REP from marcacoes where FUNC_pis = MRC_pis and\r\n[MRC_DATAAP] = apo_DATA and MRC_DATAHORA = (select top 1 MRC_DATAHORA from marcacoes where FUNC_pis = MRC_pis and\r\n[MRC_DATAAP] = apo_DATA and (MRC_DATAHORA NOT IN (SELECT TOP 2 MRC_DATAHORA FROM marcacoes where FUNC_pis = MRC_pis and\r\n[MRC_DATAAP] = apo_DATA))))),\'\') \'REP3\',\r\n\r\nISNULL((select top 1 CONVERT(nvarchar(5), MRC_DATAHORA, 108) from marcacoes where FUNC_pis = MRC_pis and\r\n[MRC_DATAAP] = apo_DATA and (MRC_DATAHORA NOT IN\r\n (SELECT TOP 3 MRC_DATAHORA FROM marcacoes where FUNC_pis = MRC_pis and\r\n[MRC_DATAAP] = apo_DATA))),\'\') as \'SAIDA2\',\r\n\r\nISNULL((select top 1 TRM_DESCRICAO from Terminais where TRM_IND = (select top 1 MRC_REP from marcacoes where FUNC_pis = MRC_pis and\r\n[MRC_DATAAP] = apo_DATA and MRC_DATAHORA = (select top 1 MRC_DATAHORA from marcacoes where FUNC_pis = MRC_pis and\r\n[MRC_DATAAP] = apo_DATA and (MRC_DATAHORA NOT IN (SELECT TOP 3 MRC_DATAHORA FROM marcacoes where FUNC_pis = MRC_pis and\r\n[MRC_DATAAP] = apo_DATA))))),\'\') \'REP4\', \r\n\r\nISNULL(dbo.fn_gettime5nullzero(CAL_TRAB), \'\') AS \'HORAS TRAB\',   \r\n\r\nISNULL(dbo.fn_gettime5nullzero(CAL_EXTRA + CAL_EXTRAn + CAL_EXTRAF + CAL_EXTRANF), \'\') AS \'EXTRAS\',\r\n\r\nCASE WHEN CAL_FALTAHORA > 0 THEN \'\' else dbo.fn_gettime5nullzero(CAL_DESCONTO) end AS DESCONTO,  \r\n\r\nCASE WHEN CAL_NOTURNO > 0 THEN dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_NOTURNO)))\r\nELSE \'\' END as \'ADC. NOTURNO\'\r\n                            \r\nFROM Marcacoes                              \r\nINNER JOIN Funcionarios ON FUNC_pis = MRC_pis \r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA and [MRC_DATAAP] = apo_DATA\r\nINNER JOIN Terminais ON TRM_IND = MRC_REP\r\nwhere apo_DATA >= %DATAINICIAL% AND apo_DATA <= %DATAFINAL% AND dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0                                   \r\ngroup by FUNC_NOME, CAL_DATA, CAL_TRAB,CAL_ATRB,FUNC_IND,CAL_EXTRAF, CAL_EXTRANF,CAL_EXTRA,CAL_DESCONTO,MRC_DATAHORA,\r\nCAL_FALTAHORA, CAL_NOTURNO, FUNC_REG, apo_DATA, MRC_DATAAP, TRM_IND, MRC_REP, FUNC_pis, MRC_pis, CAL_EXTRAn   \r\nORDER BY FUNC_NOME, (CONVERT(nvarchar(10), apo_DATA, 103))','Gabriel','2018-09-26 18:07:26'),(418,'relatorio de marcaÃ§oes inclusas  2 ','RELATORIOS','--GRUPOQUEBRA#0#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\n--LARGURA#200,200,80,75,50,120#\r\n\r\ndeclare @inicio smalldatetime = \'21/08/2018\'\r\ndeclare @fim smalldatetime = \'20/09/2018\'\r\n\r\nSELECT EMP_Nome SETOR, FUNC_NOME NOME, CONVERT(nvarchar(30), MRC_DATAHORA, 103) as DATA, CONVERT(nvarchar(5), MRC_DATAHORA, 108) as HORA\r\n  \r\nFROM Marcacoes                                    \r\nINNER JOIN Funcionarios ON MRC_FUNC = FUNC_IND\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nWHERE  dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1 and\r\nMRC_DATAAP >= @inicio AND MRC_DATAAP <= @fim AND FUNC_MARCADO_EXCLUSAO = 0 and MRC_OBS_USUARIO is not NULL\r\nORDER BY EMP_Nome, FUNC_NOME, MRC_DATAAP','Gabriel','2018-09-26 18:07:46'),(419,'Relatorio de marcaÃ§oes inclusas e descriÃ§ao','RELATORIOS','--COLUNAGRUPO#1#\r\n--LARGURA#220,220,80,80,230#\r\nSELECT FUNC_NOME as Nome, emp_nome, CONVERT(nvarchar(30), MRC_DATAHORA, 103) as DATA,\r\nCONVERT(nvarchar(5), MRC_DATAHORA, 108) as HORA, MRC_OBS AS Status\r\nFROM Marcacoes\r\nINNER JOIN Funcionarios ON FUNC_IND = MRC_FUNC\r\nINNER JOIN EMPRESAS ON  FUNC_EMPRESA = EMP_IND\r\nWHERE MRC_DATAAP >= %DATAINICIAL% AND MRC_DATAAP <= %DATAFINAL% and\r\ndbo.fn_departamentopertencente(FUNC_EMPRESA, %DEPSELECIONADOIND%) =1\r\nAND FUNC_DT_DEM IS NULL and FUNC_MARCADO_EXCLUSAO = 0  and  MRC_OBS is not null             \r\nORDER BY emp_nome, FUNC_NOME, MRC_DATAHORA','Gabriel','2018-09-26 18:08:01'),(420,'Relatorio de marcaÃ§oes inclusas, desconsideradas e justificativas','RELATORIOS','--GRUPOQUEBRA#0#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#3#\r\n--LARGURA#40,80,200,150,70,40,120,70,80,200#\r\nSELECT DISTINCT YEAR(%DATAINICIAL%) ANO, DATENAME(mm, %DATAINICIAL%) MES,\r\nFUNC_NOME \'Nome\', EMP_Nome SETOR, CAL_DATA AS \'DIA\',                     \r\ndbo.fn_gettime5nullzero(CAL_ABONO) ABONO,\r\nJus_descricao AS JUSTIFICATIVA,\r\ndbo.fn_gettime5nullzero(MRC_DATAHORA) as MARCACAO,\r\nCASE WHEN MRC_STATUS = 5 THEN \'DESCONSIDERADA\' WHEN MRC_OBS is not null then \'INCLUIDA\' else \'\' END AS \'STATUS\',\r\nMRC_OBS AS DESCRIÃ‡AO\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON CAL_FUNC = FUNC_IND\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nleft join Marcacoes on FUNC_IND = MRC_FUNC and  cal_data = MRC_DATAAP      \r\nleft join Justificativas on jus_func = FUNC_IND and cal_data = JUS_data\r\n\r\nWHERE ( MRC_OBS is not null or CAL_ABONO >0 ) and CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%\r\nORDER BY EMP_Nome,FUNC_NOME,CAL_DATA','Gabriel','2018-09-26 18:08:12'),(421,'Relatorio de marcaÃ§oes inclusas','RELATORIOS','--COLUNAGRUPO#1#\r\n--LARGURA#220,220,80,55,50,55,50,55,50,55,50#                 \r\nSELECT FUNC_NOME as Nome, emp_nome, CONVERT(nvarchar(30), APO_DATA, 103) as DATA\r\n      ,case when [APO_OCORRENCIA1] = \'I\' then  CONVERT(nvarchar(5), [APO_MARCACAO1], 108) else \' \' end \'Entrada1\'\r\n      ,case when [APO_OCORRENCIA2] = \'I\' then  CONVERT(nvarchar(5), [APO_MARCACAO2], 108) else \' \' end \'Saida1\'  \r\n      ,case when [APO_OCORRENCIA3] = \'I\' then  CONVERT(nvarchar(5), [APO_MARCACAO3], 108) else \' \' end \'Entrada2\'   \r\n      ,case when [APO_OCORRENCIA4] = \'I\' then  CONVERT(nvarchar(5), [APO_MARCACAO4], 108) else \' \' end \'Saida2\'  \r\n      ,case when [APO_OCORRENCIA5] = \'I\' then  CONVERT(nvarchar(5), [APO_MARCACAO5], 108) else \' \' end \'Entrada3\' \r\n      ,case when [APO_OCORRENCIA6] = \'I\' then  CONVERT(nvarchar(5), [APO_MARCACAO6], 108) else \' \' end \'Saida3\'  \r\n      ,case when [APO_OCORRENCIA7] = \'I\' then  CONVERT(nvarchar(5), [APO_MARCACAO7], 108) else \' \' end \'Entrada4\'  \r\n      ,case when [APO_OCORRENCIA8] = \'I\' then  CONVERT(nvarchar(5), [APO_MARCACAO8], 108) else \' \' end \'Saida4\'   \r\n  FROM [Aponta]\r\nINNER JOIN Funcionarios ON FUNC_IND = APO_FUNC\r\nINNER JOIN EMPRESAS ON  FUNC_EMPRESA = EMP_IND  \r\nwhere ([APO_OCORRENCIA1] = \'I\' or [APO_OCORRENCIA2] = \'I\' or [APO_OCORRENCIA3] = \'I\' or [APO_OCORRENCIA4] = \'I\' or \r\n[APO_OCORRENCIA5] = \'I\' or [APO_OCORRENCIA6] = \'I\'  or [APO_OCORRENCIA7] = \'I\'  or [APO_OCORRENCIA8] = \'I\') and\r\nAPO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL% and\r\ndbo.fn_departamentopertencente(FUNC_EMPRESA, %DEPSELECIONADOIND%) =1\r\nAND FUNC_DT_DEM IS NULL and FUNC_MARCADO_EXCLUSAO = 0  \r\nORDER BY emp_nome, FUNC_NOME','Gabriel','2018-09-26 18:08:24'),(422,'Relatorio de MarcaÃ§oes por cargo','RELATORIOS','--LARGURA#80,200,140,45,40,45,50,60,60,45,60,60,60,60,60,60,80#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#2#                                                                                                                            \r\nSELECT dbo.fn_getdate(CAL_DATA) AS \'Data\', FUNC_NOME \'Nome\',CAR_DESCRICAO as CARGO         \r\ndbo.fn_gettimefull(APO_MARCACAO1) AS \'Entrada1\',\r\ndbo.fn_gettimefull(APO_MARCACAO2) AS \'Saida1\',\r\ndbo.fn_gettimefull(APO_MARCACAO3) AS \'Entrada2\',                                         \r\ndbo.fn_gettimefull(APO_MARCACAO4) AS \'Saida2\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL and CAL_ATRB > 0\r\nAND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%         \r\ngroup by FUNC_NOME, CAL_DATA, FUNC_IND,APO_MARCACAO1,APO_MARCACAO2,APO_MARCACAO3,APO_MARCACAO4,\r\nOrder By CAR_DESCRICAO,FUNC_NOME, CAL_DATA','Gabriel','2018-09-26 18:08:37'),(423,'Relatorio de Marcacoes, DSR, Folgas, Abonos e Justificativas','RELATORIOS','--LARGURA#200,70,60,60,60,60,60,40,80,200#\r\nSELECT distinct FUNC_NOME AS Nome,\r\nCAL_DATA AS Data,\r\ndbo.fn_gettimefull(APO_MARCACAO1) AS Entrada,\r\ndbo.fn_gettimefull(APO_MARCACAO2) AS \'Intervalo 1\',\r\ndbo.fn_gettimefull(APO_MARCACAO3) AS \'Intervalo 2\',\r\ndbo.fn_gettimefull(APO_MARCACAO4) AS SaÃ­da,\r\n(CASE WHEN APO_H = -990 THEN \'FOLGA\' ELSE \'\' END) FOLGAS,\r\n(CASE WHEN APO_DSR = 0 THEN \'\' ELSE \'DSR\' END) DSR,\r\n(CASE WHEN CAL_ABONO > 0 THEN CONVERT(VARCHAR(5),(CAL_ABONO),108) ELSE \'\' END) as \'Valor Abonado\',\r\nCASE WHEN CAL_ABONO > 0 THEN (SELECT JUS_DESCRICAO FROM\r\njustificativas WHERE JUS_FUNC = CAL_FUNC AND JUS_DATA = CAL_DATA) ELSE \'\' END  AS MOTIVO\r\nFROM Calculo\r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nleft JOIN ferias ON FER_FUNC = FUNC_IND                                           \r\nleft JOIN Afastamentos ON AFA_FUNC = FUNC_IND\r\nleft join Justificativas on jus_func = FUNC_IND\r\nWHERE CAL_DATA >= %DATAINICIAL% and CAL_DATA <= %DATAFINAL%             \r\nAND (APO_MARCACAO1 IS NULL OR APO_MARCACAO2 IS NULL OR\r\nAPO_MARCACAO3 IS NULL OR APO_MARCACAO4 IS NULL) and FUNC_DT_DEM IS NULL and FUNC_MARCADO_EXCLUSAO = 0 and\r\nAFA_DESCRICAO_ESPELHO is null and  FER_DESCRICAO_SISTEMA is null          \r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:08:47'),(424,'Relatorio de Marcacoes, Extras 50%, 75% e 100%','RELATORIOS','--LARGURA# 40,280,80,60,60,60,60,60,60,60,60,60,60,60,60#\r\ndeclare @HE time = \'02:00\'\r\nSELECT FUNC_REG AS Registro, FUNC_NOME AS Nome,\r\ndbo.fn_getdate(CAL_DATA) AS \'Data\',\r\ndbo.fn_gettimefull(APO_MARCACAO1) AS \'Entrada1\',\r\ndbo.fn_gettimefull(APO_MARCACAO2) AS \'Saida1\',\r\ndbo.fn_gettimefull(APO_MARCACAO3) AS \'Entrada2\',\r\ndbo.fn_gettimefull(APO_MARCACAO4) AS \'Saida2\',\r\ndbo.fn_gettime5nullzero(CAL_TRAB) AS Realizado,\r\ndbo.fn_gettime5nullzero(CAL_EXTRA + CAL_EXTRAN + CAL_EXTRAF + CAL_EXTRANF) As \'Total Extra\',\r\nCASE WHEN (CAL_EXTRA + CAL_EXTRAN) <= \'2:00\' THEN dbo.fn_gettime5nullzero(CAL_EXTRA + CAL_EXTRAN)\r\nWHEN (CAL_EXTRA + CAL_EXTRAN) >= \'2:00\' THEN \'02:00\' ELSE \'-\' end as \'Extra 50%\',              \r\nCASE WHEN (CAL_EXTRA + CAL_EXTRAN) >= \'2:00\' THEN dbo.fn_gettime5nullzero(CAL_EXTRA + CAL_EXTRAN - @HE)       \r\nELSE \' \' end as \'Extra 75%\',\r\ndbo.fn_gettime5nullzero(CAL_EXTRAF + CAL_EXTRANF) as \'Extra 100%\'                     \r\nFROM Calculo                              \r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nWHERE CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%    \r\nORDER BY Nome','Gabriel','2018-09-26 18:08:56'),(425,'Relatorio de marcacoes, extras, desconto, noturno, saldo, dsr, feriado, folga','RELATORIOS','--GRUPOQUEBRA#1#\r\n--ORIENTACAO#paisagem#\r\n--LARGURA#70,250,180,140,50,45,50,45,50,50,45,60,50,50,50#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#1#\r\ndeclare @datainicial  nvarchar(50)                            \r\ndeclare @datafinal  nvarchar(50)\r\ndeclare @periodo nvarchar(50)\r\nset @datainicial =  %DATAINICIAL%\r\nset @datafinal = %DATAFINAL%                                \r\nset @periodo = \' APONTAMENTO: \'\r\nset @periodo +=  @datainicial\r\nset @periodo += \' - \'\r\nset @periodo += @datafinal\r\n                                                 \r\nSELECT dbo.fn_getdate(CAL_DATA) AS \'Data\', RTRIM(Func_nome)  +                       \r\n\' \' +  RTRIM(@periodo) + \'\' AS \'Desc\',emp_nome DEP,\r\n(CASE WHEN (SELECT TOP 1 dbo.fn_periodo_esta_contido(AFA_DATA1 ,AFA_DATA2,CAL_DATA, CAL_DATA)\r\nFROM Afastamentos WHERE AFA_FUNC = FUNC_IND order by\r\ndbo.fn_periodo_esta_contido(AFA_DATA1 ,AFA_DATA2,CAL_DATA, CAL_DATA) desc) = 1 THEN \'Afastado\' ELSE\r\n(CASE APO_H WHEN -990 THEN \'FOLGA\' WHEN -994 then \'FERIADO\' WHEN -999 THEN \'DSR\' else (case when apo_Hv > 0 then\r\ndbo.fn_gettimefull(apo_Hv) else\r\ndbo.fn_expediente_dia(func_ind,CAL_DATA) end) END) END) AS \'Expediente\',\r\ndbo.fn_gettimefull(APO_MARCACAO1) AS \'Entrada1\',\r\ndbo.fn_gettimefull(APO_MARCACAO2) AS \'Saida1\',                  \r\ndbo.fn_gettimefull(APO_MARCACAO3) AS \'Entrada2\',                                                           \r\ndbo.fn_gettimefull(APO_MARCACAO4) AS \'Saida2\',\r\ndbo.fn_gettimefull(APO_MARCACAO5) AS \'Entrada3\',\r\ndbo.fn_gettimefull(APO_MARCACAO6) AS \'Saida3\',\r\nCASE WHEN CAL_FALTAHORA > 0 THEN \'\' else dbo.fn_gettime5nullzero(CAL_DESCONTO) end AS Desconto,\r\nISNULL(dbo.fn_gettime5nullzero(CAL_EXTRA + CAL_EXTRAn), \'\') AS \'HE\',\r\n\r\nISNULL(dbo.fn_gettime5nullzero(CAL_EXTRAF + CAL_EXTRANF), \'\') AS \'HE Foga/Feriados\',\r\n\r\n\r\nCASE WHEN CAL_NOTURNO > 0 THEN dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_NOTURNO))) ELSE \'\' END as \'Noturno\',\r\n\r\n\r\ndbo.fn_get_banco_saldo_totalizado_dia(func_ind,CAL_DATA) AS \'Saldo\'\r\n\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\ninner join empresas on func_empresa = emp_ind\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL and cal_data >= @datainicial and CAL_DATA <= @datafinal            \r\ngroup by FUNC_NOME, CAL_DATA, CAL_TRAB,CAL_ATRB,FUNC_IND,apo_Hv,CAL_ABONO,CAL_DESCONTO,APO_H,CAL_EXTRA, \r\nCAL_EXTRAn,CAL_NOTURNO,CAL_FALTAHORA, emp_nome,\r\nAPO_MARCACAO1,APO_MARCACAO2,APO_MARCACAO3,APO_MARCACAO4,APO_MARCACAO5,APO_MARCACAO6,dbo.fn_get_banco_saldo_totalizado_dia\r\n(func_ind,CAL_DATA),CAL_EXTRAF, CAL_EXTRANF\r\nOrder By emp_nome, FUNC_NOME, CAL_DATA','Gabriel','2018-09-26 18:09:06'),(426,'Relatorio de Nome, Credito, Debito, Saldo do mes de cada empresa','RELATORIOS','--LARGURA#200,100,100#\r\n--TITULO#Empresa BcoHoras Credito Debito Saldo#\r\nDECLARE @DATAINICIAL SMALLDATETIME = %DATAINICIAL%,\r\n        @DATAFINAL SMALLDATETIME = %DATAFINAL%,\r\n        @DEPSELECIONADOIND INT = %DEPSELECIONADOIND%\r\n\r\nselect EMP_NOME as Nome, banco.credito as \'CrÃ©dito\', banco.debito as \'DÃ©bito\', banco.saldo as \'Banco de Horas\'\r\nfrom Empresas \r\nouter apply(\r\n    select dbo.fn_minutetohourlong(a.credito) as credito,  \r\n		   dbo.fn_minutetohourlong(a.debito) as debito,  \r\n		   dbo.fn_minutetohourlong(a.saldo) as saldo \r\n    from (\r\n        select sum(case when substring(BCO_VALOR, 1, 1) = \'-\'\r\n                        then 0\r\n                        else (convert(int, replace(BCO_VALOR, substring(BCO_VALOR, (len(BCO_VALOR) - 2), 3), \'\')) * 60) + \r\n                             (convert(int, substring(BCO_VALOR, (len(BCO_VALOR) - 1), 2)))\r\n                   end) as credito, \r\n			   sum(case when substring(BCO_VALOR, 1, 1) = \'-\'\r\n                        then -(convert(int, replace(replace(BCO_VALOR, \'-\', \'\'), substring(BCO_VALOR, (len(BCO_VALOR) - 2), 3), \'\')) * 60) +\r\n                              (convert(int, replace(substring(BCO_VALOR, (len(BCO_VALOR) - 1), 2), \'-\', \'\')))\r\n                        else 0\r\n                   end) as debito, \r\n			   sum(case when substring(BCO_VALOR, 1, 1) = \'-\'\r\n                        then -(convert(int, replace(replace(BCO_VALOR, \'-\', \'\'), substring(BCO_VALOR, (len(BCO_VALOR) - 2), 3), \'\')) * 60) +\r\n                              (convert(int, replace(substring(BCO_VALOR, (len(BCO_VALOR) - 1), 2), \'-\', \'\')))\r\n                        else (convert(int, replace(BCO_VALOR, substring(BCO_VALOR, (len(BCO_VALOR) - 2), 3), \'\')) * 60) + \r\n                             (convert(int, substring(BCO_VALOR, (len(BCO_VALOR) - 1), 2)))\r\n                   end) as saldo \r\n        from BcoHoras\r\n        inner join Funcionarios on FUNC_IND = BCO_FUNC\r\n        where BCO_DATA >= @DATAINICIAL and BCO_DATA <= @DATAFINAL and\r\n              FUNC_DT_DEM is null and FUNC_EMPRESA = EMP_IND\r\n    ) a \r\n)banco','Gabriel','2018-09-26 18:09:17'),(427,'Relatorio de ObservaÃ§oes funcionarios selecionado','RELATORIOS','--ALINHAMENTO#L#\r\n--LARGURA#250,100,300#\r\nselect FUNC_NOME AS Nome, CONVERT(nvarchar(10), OBS_DATA,103) AS Data, OBS_DESCRICAO AS ObservaÃ§Ã£o\r\nfrom Observacoes\r\nINNER JOIN Funcionarios on FUNC_IND = OBS_FUNC\r\nwhere OBS_DATA >= %DATAINICIAL% and OBS_DATA <= %DATAFINAL%  AND FUNC_IND =\r\n%FUNCIONARIO%','Gabriel','2018-09-26 18:09:31'),(428,'Relatorio de ObservaÃ§oes','RELATORIOS','--ALINHAMENTO#L#\r\n--LARGURA#250,100,300#\r\nselect FUNC_NOME AS Nome, CONVERT(nvarchar(10), OBS_DATA,103) AS Data, OBS_DESCRICAO AS ObservaÃ§Ã£o\r\nfrom Observacoes\r\nINNER JOIN Funcionarios on FUNC_IND = OBS_FUNC\r\nwhere OBS_DATA >= %DATAINICIAL% and OBS_DATA <= %DATAFINAL%','Gabriel','2018-09-26 18:09:41'),(429,'Relatorio de PIS e MarcaÃ§oes associadas','RELATORIOS','--LARGURA#100,100,100#\r\nSELECT  MRC_PIS PIS, CONVERT(nvarchar(30), MRC_DATAHORA, 103) as DATA, cast(MRC_DATAHORA AS time(0)) as HORA\r\nFROM Marcacoes\r\nINNER JOIN Funcionarios ON MRC_FUNC = FUNC_IND\r\nWHERE MRC_DATAHORA >= %DATAINICIAL% AND MRC_DATAHORA <= %DATAFINAL%\r\nAND FUNC_DT_DEM IS NULL and FUNC_MARCADO_EXCLUSAO = 0 and MRC_PIS is Not null\r\nORDER BY MRC_PIS, MRC_DATAHORA','Gabriel','2018-09-26 18:09:52'),(430,'Relatorio de quantidade de domingos trabalhado','RELATORIOS','--COLUNAGRUPO#0#\r\n--LARGURA#200,200,70,60,60,60,60#\r\nSELECT EMP_Nome Empresa, FUNC_NOME AS Nome, COUNT(*)  AS Domingos\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON CAL_FUNC = FUNC_IND\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nWHERE EMP_COD LIKE \'%DEPSELECIONADO%%\'\r\nAND (DATEPART(WEEKDAY, CAL_DATA) = 1) AND CAL_DATA >= %DATAINICIAL%\r\nAND CAL_DATA <= %DATAFINAL% and APO_H > 0 and (cal_dsr <= 0\r\nor cal_ddsr <= 0) and (APO_MARCACAO1 IS NOT NULL OR APO_MARCACAO2 IS NOT NULL OR\r\nAPO_MARCACAO3 IS NOT NULL OR APO_MARCACAO4 IS NOT NULL) and FUNC_MARCADO_EXCLUSAO = 0     \r\nGROUP BY EMP_NOME, FUNC_NOME                    \r\nORDER BY EMP_NOME, FUNC_NOME','Gabriel','2018-09-26 18:10:02'),(431,'Relatorio de quantidade de justificativas no mes','RELATORIOS','--LARGURA#250,250,80#\r\nSELECT EMP_NOME EMPRESA, FUNC_NOME FUNCIONARIO, COUNT(*)  AS QUANTIDADE\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON CAL_FUNC = FUNC_IND\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\ninner join Justificativas on jus_func = FUNC_IND and JUS_DATA = CAL_DATA\r\nleft join [Motivos] on JUS_MOTIVO = mot_ind\r\nWHERE CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%\r\nand (JUS_descricao = \'ATESTADO MEDICO DIA\' or Mot_descricao  = \'ATESTADO MEDICO DIA\') and\r\ndbo.fn_departamentopertencente(FUNC_EMPRESA ,%DEPSELECIONADOIND%) = 1 AND FUNC_DT_DEM IS NULL and FUNC_MARCADO_EXCLUSAO = 0\r\ngroup by FUNC_NOME,EMP_NOME\r\nHAVING  COUNT(*) >= 15\r\nORDER BY EMP_NOME, FUNC_NOME','Gabriel','2018-09-26 18:10:13'),(432,'relatorio de saldo positovo no banco','RELATORIOS','SELECT FUNC_NOME,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR))) AS SALDO\r\nFROM BcoHoras\r\nINNER JOIN Funcionarios ON FUNC_IND = BCO_FUNC\r\n--WHERE BCO_DATA >= \'01/01/2017\' AND BCO_DATA <= \'31/1/2017\' AND dbo.fn_hourlongtominute(BCO_VALOR) >= 0\r\nWHERE BCO_DATA >= %DATAINICIAL% AND BCO_DATA <= %DATAFINAL% AND dbo.fn_hourlongtominute(BCO_VALOR) >= 0 AND\r\nFUNC_DT_DEM IS NULL and FUNC_MARCADO_EXCLUSAO = 0\r\nGROUP BY FUNC_NOME','Gabriel','2018-09-26 18:10:25'),(433,'Relatorio de terminal definido para funcionario','RELATORIOS','--GRUPOQUEBRA#0#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\n--LARGURA#200,265,120#\r\nSELECT EMP_NOME AS Setor,FUNC_NOME FUNCIONARIO,TRM_DESCRICAO as \'REP\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nleft JOIN TerminaisFuncionarios on func_IND = TRMF_FUNC  \r\nINNER JOIN Terminais ON TRM_IND = TRMF_TERMINAL               \r\nwhere dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0                                            \r\n\r\nORDER BY EMP_NOME, FUNC_NOME','Gabriel','2018-09-26 18:10:35'),(434,'Relatorio de trabalhadas noturnas e diurnas Detalhado','RELATORIOS','--ORIENTACAO#paisagem#\r\n--GRUPOQUEBRA#0#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\n--LARGURA#200,70,200,50,50,50,70,50,60,70#\r\nDECLARE @INICIO SMALLDATETIME = \'22:00\'\r\nDECLARE @FINAL SMALLDATETIME = \'05:00\'\r\n\r\nSELECT EMP_NOME EMPRESA,CONVERT(nvarchar(10), CAL_DATA,103) AS Data, FUNC_NOME AS NOME,\r\ndbo.fn_gettimefull(APO_MARCACAO1) AS \'Entrada\',\r\ndbo.fn_gettimefull(APO_MARCACAO2) AS \'Saida\',\r\ndbo.fn_gettimefull(APO_MARCACAO3) AS \'Entrada2\',\r\ndbo.fn_gettimefull(APO_MARCACAO4) AS \'Saida2\',\r\n\r\n\r\n(case when  dbo.fn_gettimefull(APO_MARCACAO1) >= \'22:00\' and dbo.fn_gettimefull(APO_MARCACAO4) <= \'05:00\' then \'\'\r\nwhen CONVERT(nvarchar(5), APO_MARCACAO1,114) < \'22:00\' and CONVERT(nvarchar(5), APO_MARCACAO4,114) > \'05:00\' then\r\ndbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM((dbo.fn_smalldatetimetominute(@INICIo) - dbo.fn_smalldatetimetominute(CONVERT\r\n(nvarchar(5),APO_MARCACAO1,114)) + (dbo.fn_smalldatetimetominute(CONVERT(nvarchar(5),APO_MARCACAO4,114)) - dbo.fn_smalldatetimetominute\r\n(@FINAL) )))))\r\nwhen CONVERT(nvarchar(5), APO_MARCACAO1,114) >= \'22:00\' and CONVERT(nvarchar(5), APO_MARCACAO4,114) >= \'05:00\' then\r\ndbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CONVERT(nvarchar(5),APO_MARCACAO4,114)) -\r\ndbo.fn_smalldatetimetominute(@FINAL) )))\r\nwhen CONVERT(nvarchar(5), APO_MARCACAO1,114) < \'22:00\' and CONVERT(nvarchar(5), APO_MARCACAO4,114) <= \'05:00\' then\r\ndbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(@INICIo) - dbo.fn_smalldatetimetominute(CONVERT\r\n(nvarchar(5),APO_MARCACAO1,114)) ))) else \'\' END) AS \'TRABD\',\r\n\r\ndbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_NOTURNO)/1.14 ))) AS \'TRABN\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nWHERE FUNC_DT_DEM IS NULL AND dbo.fn_departamentopertencente(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1 and CAL_TRAB > 0 and\r\nCAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%\r\nGROUP BY EMP_NOME, FUNC_NOME,FUNC_IND,CAL_DATA,CAL_TRABN,CAL_TRAB,APO_MARCACAO1,APO_MARCACAO2,APO_MARCACAO3,APO_MARCACAO4\r\nORDER BY EMP_NOME, FUNC_NOME','Gabriel','2018-09-26 18:10:45'),(435,'Relatorio de trabalhadas noturnas e diurnas totalizadas','RELATORIOS','--ORIENTACAO#paisagem#\r\n--GRUPOQUEBRA#0#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\n--LARGURA#200,200,70,50,60,70#\r\n\r\n\r\nSELECT EMP_NOME EMPRESA, FUNC_NOME AS NOME,\r\n\r\ndbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute((Cal_trab + CAL_EXTRA + CAL_EXTRAN + CAL_EXTRAF + \r\nCAL_EXTRANF))\r\n- (dbo.fn_smalldatetimetominute(CAL_NOTURNO)/1.14 ) ))) AS \'TRABD\',\r\n\r\ndbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_NOTURNO)/1.14 ))) AS \'TRABN\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nWHERE CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL% AND\r\nFUNC_DT_DEM IS NULL AND dbo.fn_departamentopertencente(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1 and CAL_TRAB > 0\r\nGROUP BY EMP_NOME, FUNC_NOME,FUNC_IND                                                                                     \r\nORDER BY EMP_NOME, FUNC_NOME','Gabriel','2018-09-26 18:10:54'),(436,'relatorio dia e horarios trabalhado','RELATORIOS','--LARGURA#80,200,140,80#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#1#\r\nSELECT dbo.fn_getdate(CAL_DATA) AS \'Data\', FUNC_NOME \'Nome\',\r\ncase when apo_Hv > 0 then dbo.fn_gettimefull(apo_Hv) else dbo.fn_expediente_dia(func_ind,CAL_DATA) end AS Expediente\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL and CAL_ATRB > 0\r\nAND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%\r\n\r\ngroup by FUNC_NOME, CAL_DATA, FUNC_IND,apo_Hv,\r\ndbo.fn_get_banco_saldo_totalizado_dia(func_ind,CAL_DATA)\r\nOrder By FUNC_NOME, CAL_DATA','Gabriel','2018-09-26 18:11:14'),(437,'Relatorio do  log no Usuario para justificativas','RELATORIOS','--LARGURA#250,100,100,200,120,150, 100, 100, 200#\r\nSELECT DISTINCT FUNC_NOME FUNCIONARIO, CAL_DATA AS \'DIA ABONADO\',\r\ndbo.fn_gettime5nullzero(CAL_ABONO) AS \'VALOR ABONADO\',   \r\nJus_descricao  AS MOTIVO,\r\nUSU_NOME USUARIO,  \r\nJUS_ABONADOEM as \'CRIAÃ‡AO DA JUSTIFICATIVA\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON CAL_FUNC = FUNC_IND\r\ninner join Justificativas on jus_func = FUNC_IND\r\nleft join usuarios on USU_IND = JUS_ABONADOPOR\r\nWHERE CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%\r\nAND CAL_ABONO >= 0              \r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:11:36'),(438,'Relatorio do  log no Usuario para Marcacoes','RELATORIOS','--LARGURA#250,80,80,100,120,120, 200#\r\nSET DATEFORMAT DMY                                    \r\nselect func_nome FUNCIONARIO, CONVERT(nvarchar(30), MRC_DATAHORA, 103) as DATA, cast(MRC_DATAHORA AS time(0)) as MARCACÃƒO,\r\nCASE WHEN MRC_STATUS = 5 THEN \'DESCONSIDERADA\' ELSE \'INCLUIDA\' END AS \'STATUS\',\r\nUSU_NOME USUARIO,\r\nMRC_OBS_DATA AS \'DATA DE INCLUSAO\',\r\nMRC_OBS AS DESCRIÃ‡AO \r\n\r\nfrom Marcacoes\r\ninner join funcionarios on FUNC_IND = MRC_FUNC\r\ninner join usuarios on USU_IND = MRC_OBS_USUARIO\r\nWHERE MRC_DATAHORA >= %DATAINICIAL% AND MRC_DATAHORA <= %DATAFINAL% AND MRC_OBS_USUARIO IS NOT NULL\r\nORDER BY func_nome','Gabriel','2018-09-26 18:11:47'),(439,'RelatÃ³rio Empresa, Funcionarios Ativos','RELATORIOS','SELECT EMP_NOME AS Empresa, FUNC_NOME as Nome\r\nFROM Funcionarios INNER JOIN Empresas ON EMP_IND = dbo.fn_getempresafuncionario(FUNC_IND)\r\nORDER BY EMP_NOME, FUNC_NOME\r\nwhere func_dt_dem is null','Gabriel','2018-09-26 18:11:58'),(440,'RelatÃ³rio Empresa, Funcionarios','RELATORIOS','SELECT EMP_NOME AS Empresa, FUNC_NOME as Nome\r\nFROM Funcionarios INNER JOIN Empresas ON EMP_IND = dbo.fn_getempresafuncionario(FUNC_IND)\r\nORDER BY EMP_NOME, FUNC_NOME','Gabriel','2018-09-26 18:12:10'),(441,'RelatÃ³rio Entrada e SaÃ­da com Setor - Departamento','RELATORIOS','--LARGURA#60,200,200,70,60,60,60,80#\r\nSELECT FUNC_REG AS Registro, FUNC_NOME AS Nome, CAR_DESCRICAO as\r\nCargo, EMP_NOME AS Setor, APO_DATA AS Data,\r\ndbo.fn_gettimefull(APO_MARCACAO1) AS Entrada,\r\ndbo.fn_gettimefull(APO_MARCACAO4) AS SaÃ­da,\r\n(SELECT dbo.fn_gettimefull(CAL_TRAB) FROM Calculo WHERE\r\nCAL_FUNC = FUNC_IND AND CAL_DATA = APO_DATA) AS Jornada\r\nFROM Funcionarios\r\nINNER JOIN Aponta ON APO_FUNC = FUNC_IND\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nLEFT JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nWHERE APO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL%   AND\r\nAPO_MARCACAO1 IS NOT NULL AND APO_MARCACAO4 IS NOT NULL\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:12:22'),(442,'RelatÃ³rio Escalas Por Funcionario','RELATORIOS','--ORIENTACAO#paisagem#\r\n--LARGURA#70,150,70,100,100,100,60,60,60,60,120#\r\nSELECT FUNC_REG AS Registro, FUNC_NOME AS Nome, dbo.fn_getdate\r\n(FUNC_DT_ADM) AS AdmissÃ£o,\r\nEMP_NOME As Depto, CAR_DESCRICAO AS Cargo, FUNC_PIS AS Pis,\r\ndbo.fn_gettimefull(APO_MARCACAO1) AS Entrada,\r\ndbo.fn_gettimefull(APO_MARCACAO2) AS Inter1,\r\ndbo.fn_gettimefull(APO_MARCACAO3) AS Inter2,\r\ndbo.fn_gettimefull(APO_MARCACAO4) AS SaÃ­da,\r\n(SELECT ESC_DESCRICAO FROM Escalas WHERE ESC_IND =\r\ndbo.fn_escala_funcionario_dia(FUNC_IND, APO_DATA)) AS Escala          \r\n                            \r\nFROM Funcionarios\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nINNER JOIN Aponta ON APO_FUNC = FUNC_IND                              \r\n    \r\nWHERE (APO_MARCACAO1 IS NOT NULL OR APO_MARCACAO2 IS NOT NULL OR \r\nAPO_MARCACAO3 IS NOT NULL OR APO_MARCACAO4 IS NOT NULL)\r\nAND dbo.fn_escala_funcionario_dia(FUNC_IND, APO_DATA) IS NOT NULL\r\nAND APO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL%\r\nORDER BY FUNC_NOME, APO_DATA','Gabriel','2018-09-26 18:12:36'),(443,'Relatorio Extras maiores de 2 horas','RELATORIOS','--COLUNAGRUPO#1#\r\n--TITULO#Extra maior que 2hrs#\r\n--LARGURA# 200,280,80,80#\r\ndeclare @HE smalldatetime = \'02:00\'\r\nSELECT FUNC_NOME AS Nome, EMP_NOME AS Empresa,\r\nCAL_DATA AS \'Data\',\r\ndbo.fn_gettime5nullzero(CAL_EXTRA + CAL_EXTRAN + CAL_EXTRAF + CAL_EXTRANF) As \'Extra Totais\'\r\nFROM Calculo\r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA \r\nWHERE CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%\r\nand dbo.fn_gettime5nullzero(CAL_EXTRA + CAL_EXTRAN + CAL_EXTRAF + CAL_EXTRANF) > @HE\r\nORDER BY EMP_NOME, FUNC_NOME','Gabriel','2018-09-26 18:12:46'),(444,'RELATORIO FALTAS , ATRASOS  TOTALIZADO','RELATORIOS','--LARGURA#200,80,80,80,80,80,80,80#\r\nSELECT FUNC_NOME AS Nome,\r\nSUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 ELSE 0 END) as Faltas,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DESCONTO\r\n- CAL_FALTAHORA))) as Atrasos\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON CAL_FUNC = FUNC_IND\r\nWHERE (CAL_FALTAHORA > 0 or CAL_DESCONTO > 0) and CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%                           \r\nGROUP BY FUNC_NOME\r\nORDER BY  FUNC_NOME','Gabriel','2018-09-26 18:12:59'),(445,'RelatÃ³rio FALTAS admitidos em um determinado periodo.','RELATORIOS','SELECT FUNC_REG as Registro, FUNC_NOME as Nome, CAR_DESCRICAO as\r\nCargo, EMP_NOME as Setor,\r\nSUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 ELSE 0 END) as Faltas\r\nFROM Funcionarios\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nINNER JOIN Calculo ON CAL_FUNC = FUNC_IND\r\nWHERE CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL% AND FUNC_DT_ADM >\'27/11/2016\'\r\nGROUP BY FUNC_REG, FUNC_NOME, CAR_DESCRICAO, EMP_NOME','Gabriel','2018-09-26 18:13:11'),(446,'Relatorio faltas de marcaÃ§Ãµes, faltas, atrasos e saÃ­das antecipadas','RELATORIOS','--COLUNAGRUPO#1#\r\n--LARGURA#200,200,70,60,60,60,60,60,60,60,60,60,60,80#          \r\nSELECT distinct FUNC_NOME AS Nome , EMP_nome,\r\nAPO_DATA AS Data,\r\ndbo.fn_gettimefull(APO_MARCACAO1) AS \'Entrada\',          \r\ndbo.fn_gettimefull(APO_MARCACAO2) AS \'Saida\',\r\ndbo.fn_gettimefull(APO_MARCACAO3) AS \'Entrada2\',\r\ndbo.fn_gettimefull(APO_MARCACAO4) AS \'Saida2\',\r\ndbo.fn_gettimefull(APO_MARCACAO5) AS \'Entrada3\',              \r\ndbo.fn_gettimefull(APO_MARCACAO6) AS \'Saida3\',  \r\ndbo.fn_gettimefull(APO_MARCACAO7) AS \'Entrada4\',\r\ndbo.fn_gettimefull(APO_MARCACAO8) AS \'Saida4\',  \r\nCASE WHEN CAL_FALTAHORA > 0 THEN 1 ELSE 0 END as Faltas,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DESCONTO - CAL_FALTAHORA))) as Atrasos,\r\n\r\nISNULL((SELECT dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(PAPO_ATRASO4_FIM - PAPO_ATRASO4_INICIO))))\r\nFROM PreAponta WHERE PAPO_FUNC = FUNC_IND AND PAPO_DATA >= %DATAINICIAL%\r\nAND PAPO_DATA <= %DATAFINAL%), \'\') AS \'SaÃ­da atecipadas\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nINNER JOIN Calculo ON CAL_FUNC = FUNC_IND\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA                                      \r\n                                                                                                 \r\nWHERE APO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL% and APO_H >= -990 and FUNC_MARCADO_EXCLUSAO = 0    \r\nAND ((APO_MARCACAO1 IS not NULL and APO_MARCACAO2 IS not NULL and APO_MARCACAO3 IS not NULL and \r\nAPO_MARCACAO4 IS not NULL and APO_MARCACAO5 IS not NULL) or    \r\n(APO_MARCACAO1 IS not NULL and APO_MARCACAO2 IS not NULL and APO_MARCACAO3 IS not NULL and APO_MARCACAO4 IS not NULL \r\nand APO_MARCACAO5 IS not NULL and APO_MARCACAO6 IS not NULL and APO_MARCACAO7 IS not NULL) or     \r\n(APO_MARCACAO1 IS not NULL and APO_MARCACAO2 IS NULL and APO_MARCACAO3 IS NULL and APO_MARCACAO4 IS NULL) or\r\n(APO_MARCACAO1 IS not NULL and APO_MARCACAO2 IS NULL and APO_MARCACAO3 IS not NULL and APO_MARCACAO4 IS NULL) or\r\n(APO_MARCACAO1 IS NULL and APO_MARCACAO2 IS not NULL and APO_MARCACAO3 IS NULL and APO_MARCACAO4 IS not NULL) or\r\n(APO_MARCACAO1 IS NULL and APO_MARCACAO2 IS not NULL and APO_MARCACAO3 IS not NULL and APO_MARCACAO4 IS not NULL) or\r\n(APO_MARCACAO1 IS not NULL and APO_MARCACAO2 IS NULL and APO_MARCACAO3 IS not NULL and APO_MARCACAO4 IS not NULL) or\r\n(APO_MARCACAO1 IS not NULL and APO_MARCACAO2 IS not NULL and APO_MARCACAO3 IS NULL and APO_MARCACAO4 IS not NULL) or\r\n(APO_MARCACAO1 IS not NULL and APO_MARCACAO2 IS not NULL and APO_MARCACAO3 IS not NULL and APO_MARCACAO4 IS NULL) or\r\n(APO_MARCACAO1 IS NULL and APO_MARCACAO2 IS NULL and APO_MARCACAO3 IS NULL and APO_MARCACAO4 IS not NULL) or\r\n(APO_MARCACAO1 IS not NULL and APO_MARCACAO2 IS NULL) or\r\n(APO_MARCACAO1 IS NULL and APO_MARCACAO2 IS not NULL))\r\ngroup by EMP_nome, FUNC_NOME,APO_DATA,APO_MARCACAO1,APO_MARCACAO2,APO_MARCACAO3,APO_MARCACAO4,APO_MARCACAO5,APO_MARCACAO6,\r\nAPO_MARCACAO7,APO_MARCACAO8,CAL_FALTAHORA, CAL_DESCONTO, func_ind\r\nORDER BY EMP_nome, FUNC_NOME','Gabriel','2018-09-26 18:13:25'),(447,'Relatorio faltas por periodo selecionado','RELATORIOS','--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\n--LARGURA#300,80,80,80,80,300#\r\nSELECT FUNC_NOME AS NOME, CAL_DATA AS DATA,\r\nCASE WHEN CAL_FALTAHORA > 0 THEN \'FALTA\' ELSE \'\' END AS FALTAS\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON CAL_FUNC = FUNC_IND\r\nWHERE CAL_DATA >= \'01/01/2017\' AND CAL_DATA <= \'31/12/2017\'\r\nAND dbo.fn_departamentopertencente(FUNC_EMPRESA,\r\n%DEPSELECIONADOIND%) = 1 AND CAL_FALTAHORA > 0\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:13:46'),(448,'RelatÃ³rio Faltas, Abonos, Atrasos e Extras','RELATORIOS','DECLARE @DATAINICIAL DATE, @DATAFINAL DATE, @MOTIVO NVARCHAR(MAX)\r\nSET @DATAINICIAL = %DATAINICIAL%\r\nSET @DATAFINAL = %DATAFINAL%\r\nSET @MOTIVO = \'justi\'\r\n\r\nSELECT FUNC_NOME,\r\n(SELECT COUNT(*) FROM Calculo WHERE CAL_FUNC = FUNC_IND AND CAL_DATA\r\n>= @DATAINICIAL AND CAL_DATA <= @DATAFINAL AND CAL_FALTAHORA IS NOT\r\nNULL) AS Faltas,\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_ABONO))) FROM Calculo INNER JOIN\r\nJustificativas ON JUS_FUNC = CAL_FUNC AND JUS_DATA = CAL_DATA WHERE\r\nCAL_FUNC = FUNC_IND AND CAL_DATA >= @DATAINICIAL AND CAL_DATA <=\r\n@DATAFINAL AND JUS_DESCRICAO LIKE \'%\' + @MOTIVO + \'%\'), \'\') AS\r\nAbonos,\r\nISNULL((SELECT dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_DESCONTO - CAL_FALTAHORA)))) FROM\r\nCalculo WHERE CAL_FUNC = FUNC_IND AND CAL_DATA >= @DATAINICIAL AND\r\nCAL_DATA <= @DATAFINAL), \'\') AS Atrasos,\r\nISNULL((SELECT dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_EXTRA + CAL_EXTRAF + CAL_EXTRAN +\r\nCAL_EXTRANF)))) FROM Calculo WHERE CAL_FUNC = FUNC_IND AND CAL_DATA\r\n>= @DATAINICIAL AND CAL_DATA <= @DATAFINAL), \'\') AS Extras\r\nFROM Funcionarios\r\nWHERE\r\n(SELECT COUNT(*) FROM Calculo WHERE CAL_FUNC = FUNC_IND AND CAL_DATA\r\n>= @DATAINICIAL AND CAL_DATA <= @DATAFINAL AND CAL_FALTAHORA IS NOT\r\nNULL) > 0 OR\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_ABONO))) FROM Calculo INNER JOIN\r\nJustificativas ON JUS_FUNC = CAL_FUNC AND JUS_DATA = CAL_DATA WHERE\r\nCAL_FUNC = FUNC_IND AND CAL_DATA >= @DATAINICIAL AND CAL_DATA <=\r\n@DATAFINAL AND JUS_DESCRICAO LIKE \'%\' + @MOTIVO + \'%\'), \'\') <> \'\' OR \r\nISNULL((SELECT dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_DESCONTO - CAL_FALTAHORA)))) FROM\r\nCalculo WHERE CAL_FUNC = FUNC_IND AND CAL_DATA >= @DATAINICIAL AND\r\nCAL_DATA <= @DATAFINAL), \'\') <> \'\' OR \r\nISNULL((SELECT dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_EXTRA + CAL_EXTRAF + CAL_EXTRAN +\r\nCAL_EXTRANF)))) FROM Calculo WHERE CAL_FUNC = FUNC_IND AND CAL_DATA\r\n>= @DATAINICIAL AND CAL_DATA <= @DATAFINAL), \'\') <> \'\'\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:14:00'),(449,'Relatorio faltas, desconto, dsr, extra','RELATORIOS','SELECT FUNC_REG as Registro, FUNC_NOME as Nome, CAR_DESCRICAO as\r\nCargo, EMP_NOME as Setor,\r\nSUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 ELSE 0 END) as Faltas,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute\r\n(CAL_FALTAHORA))) as \'Faltas Hora\',\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DESCONTO\r\n- CAL_FALTAHORA))) as Desconto,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute\r\n(CAL_NOTURNO))) as Noturno,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DSR)))\r\nas Dsr,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRA)))\r\nas \'Extra 50%\',\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute\r\n(CAL_EXTRAF))) as \'Extra 100%\'\r\nFROM Funcionarios\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nINNER JOIN Calculo ON CAL_FUNC = FUNC_IND\r\nWHERE CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%\r\nGROUP BY FUNC_REG, FUNC_NOME, CAR_DESCRICAO, EMP_NOME','Gabriel','2018-09-26 18:14:10'),(450,'RelatÃ³rio Ferias Matricula Nome setor funÃ§Ã£o data de inicio das fÃ©rias e data do fim das fÃ©rias','RELATORIOS','--LARGURA#50,200,150,150,150,150#\r\nSELECT FUNC_REG As Matricula, FUNC_NOME AS Nome, EMP_NOME AS SETOR,\r\nCAR_DESCRICAO AS FUNCAO, FER_DATA1 as \'Data Inicio das FÃ©rias\',\r\nFER_DATA2 as \'Data Fim das FÃ©rias\'\r\nFROM Funcionarios\r\nINNER JOIN Ferias ON FER_FUNC = FUNC_IND\r\nLEFT JOIN Cargos ON FUNC_CARGO = CAR_IND\r\nLEFT JOIN Empresas ON Empresas.EMP_IND = FuncIONARIOS.FUNC_EMPRESA\r\nWHERE dbo.fn_periodo_esta_contido(FER_DATA1, FER_DATA2,\r\n%DATAINICIAL%, %DATAFINAL%) = 1 AND dbo.fn_departamentopertencente\r\n(FUNC_EMPRESA,\r\n%DEPSELECIONADOIND%) = 1\r\nORDER BY FUNC_REG, FUNC_NOME','Gabriel','2018-09-26 18:14:25'),(451,'RelatÃ³rio func e marcaÃ§Ãµes','RELATORIOS','select * FROM MARCACOES WHERE MRC_FUNC =%FUNCIONARIO% AND MRC_DATAHORA>=%DATAINICIAL% AND MRC_DATAHORA<=%DATAFINAL%','Gabriel','2018-09-26 18:14:37'),(452,'RelatÃ³rio func e param e func e escalas','RELATORIOS','COMANDO PARA PUXAR FUNCIONARIOS E PARAMETROS, PONTO3:\r\n\r\nSELECT FUNC_NOME, PAR_DESC\r\nFROM Func\r\nLEFT JOIN Paramet ON PAR_INC = FUNC_TABPARAM\r\nWHERE FUNC_DT_DEM IS NULL\r\nORDER BY FUNC_NOME\r\n___________________________________\r\n\r\n\r\nCOMANDO PARA PUXAR FUNCIONARIOS E ESCALAS, PONTO3:\r\n\r\nSELECT FUNC_NOME, ESC_DESC FROM Func INNER JOIN Escalas ON ESC_INC = FUNC_ESCALA WHERE FUNC_DT_DEM IS NULL ORDER BY FUNC_NOME\r\n___________________________________\r\n\r\n\r\nCOMANDO PARA PUXAR FUNCIONARIOS E CÃ“DIGOS DAS ESCALAS, PONTO3:\r\n\r\nSELECT FUNC_NOME, ESC_CODIGO FROM Func INNER JOIN Escalas ON ESC_INC = FUNC_ESCALA WHERE FUNC_DT_DEM IS NULL ORDER BY FUNC_NOME\r\n___________________________________\r\n\r\n\r\nCOMANDO PARA PUXAR FUNCIONARIOS E CÃ“DIGOS DAS ESCALAS, PONTO3:\r\n\r\nSELECT FUNC_NOME, ESC_CODIGO, ESC_INICIO FROM Func INNER JOIN Escalas ON ESC_INC = FUNC_ESCALA WHERE FUNC_DT_DEM IS NULL ORDER BY FUNC_NOME\r\n\r\n___________________________________\r\n\r\n\r\nAPAGAR MARCAÃ‡OES DE 1 CERTO CRACHÃ NO PONTO4 PARA REIMPORTAR NOVAMENTE:\r\n\r\nDELETE FROM Marcacoes WHERE MRC_DATAHORA >= \'1/4/2010\' AND MRC_CRACHA = ???\r\n___________________________________\r\n\r\n\r\ncomando para colocar todos os horarios com intervalo prÃ©-assinalado, ponto 4:\r\n\r\nUPDATE Expedientes SET INT_INTERVALO_AUTO = 1\r\n___________________________________\r\n\r\n\r\ncomando para colocar todos os horarios com compensaÃ§Ã£o no intervalo, ponto 4:\r\n\r\nUPDATE Expedientes SET INT_COMPENSARINTERVALO = 1\r\n___________________________________\r\n\r\n\r\ncomando para puxar funcionarios, cargo e nascimento de determinada empresa (alterar 003 pelo numero da empresa), ponto 3:\r\n\r\nSELECT FUNC_NOME, CAR_DESC, REG_NASC_DATA\r\nFROM Func\r\nINNER JOIN Empresa ON EMP_INC = FUNC_EMPRESA\r\nLEFT JOIN Cargos ON CAR_INC = FUNC_CARGO\r\nLEFT JOIN Registro ON REG_FUNC = FUNC_INC\r\nWHERE EMP_COD LIKE \'003%\' AND FUNC_DT_DEM IS NULL\r\nORDER BY FUNC_NOME\r\n','Gabriel','2018-09-26 18:14:49'),(453,'RelatÃ³rio FUNC, ATRASO, FALTA, JUSTIFICATIVA, MOTIVOS','RELATORIOS','--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\n--LARGURA#300,80,80,80,80,300#\r\nSELECT FUNC_NOME AS NOME, CAL_DATA AS DATA, dbo.fn_gettime5nullzero\r\n(CAL_DESCONTO) AS                \r\nDESCONTO,\r\nCASE WHEN CAL_FALTAHORA > 0 THEN \'FALTA\' ELSE \'\' END AS\r\nFALTAS, dbo.fn_gettime5nullzero(CAL_ABONO) AS JUSTIFICATIVA,     \r\nCASE WHEN CAL_ABONO > 0 THEN (SELECT JUS_DESCRICAO FROM \r\njustificativas                     \r\nWHERE JUS_FUNC = CAL_FUNC\r\nAND JUS_DATA = CAL_DATA) ELSE \'\' END  AS MOTIVO\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON CAL_FUNC = FUNC_IND\r\nWHERE CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL% \r\nAND dbo.fn_departamentopertencente(FUNC_EMPRESA,\r\n%DEPSELECIONADOIND%) = 1\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:14:59'),(454,'RelatÃ³rio FUNC, CRACHÃ','RELATORIOS','SELECT FUNC_NOME AS NOME, CRA_NUMERO AS CRACHÃ FROM FUNCIONARIOS\r\nINNER JOIN CRACHAS ON CRA_FUNC = FUNC_IND order by func_nome','Gabriel','2018-09-26 18:15:09'),(455,'RelatÃ³rio FUNC, REGISTRO, CRACHÃ, PIS','RELATORIOS','SELECT FUNC_NOME AS NOME, FUNC_REG AS REGISTRO,\r\nCRA_NUMERO AS CRACHÃ, func_pis as PIS FROM FUNCIONARIOS\r\nINNER JOIN CRACHAS ON CRA_FUNC = FUNC_IND order by func_nome','Gabriel','2018-09-26 18:15:19'),(456,'RelatÃ³rio FUNC, REGISTRO, CRACHÃ','RELATORIOS','SELECT FUNC_NOME AS NOME, FUNC_REG AS REGISTRO,\r\nCRA_NUMERO AS CRACHÃ FROM FUNCIONARIOS\r\nINNER JOIN CRACHAS ON CRA_FUNC = FUNC_IND order by func_nome','Gabriel','2018-09-26 18:15:30'),(457,'RelatÃ³rio FUNC, REGISTRO','RELATORIOS','SELECT FUNC_NOME AS NOME, FUNC_REG AS REGISTRO FROM FUNCIONARIOS\r\norder by func_nome','Gabriel','2018-09-26 18:15:40'),(458,'RelatÃ³rio funcionario ,horarios','RELATORIOS','SELECT DISTINCT  FUNC_NOME AS Nome, FUNC_PIS  INt_COD AS Codigo, INt_DESCRICAO AS DescriÃ§Ã£o\r\nFROM FUNCionarios\r\nINNER JOIN Hora ON HR_FUNC = FUNC_INd AND HR_TIPO = 0\r\nINNER JOIN Expedientes ON INT_INd = HR_HORARIO\r\nORDER BY FUNC_NOME\r\n\r\n___________________________________ OU\r\n\r\nSELECT DISTINCT FUNC_NOME AS Nome, \r\n(SELECT TOP 1 INT_DESCRICAO FROM Hora INNER JOIN Expedientes ON INT_IND = HR_HORARIO WHERE HR_FUNC = FUNC_IND AND HR_TIPO = 0\r\nORDER BY HR_DATAINICIAL DESC) AS DescriÃ§Ã£o\r\nFROM Funcionarios WHERE FUNC_DT_DEM IS NULL AND FUNC_MARCADO_EXCLUSAO = 0\r\nORDER BY FUNC_NOME\r\n\r\n\r\n\r\n------------------------------------------------------------------------------------------\r\nTODOS OS EXPEDIENTES\r\n\r\nSELECT DISTINCT FUNC_NOME AS Nome, \r\n(SELECT INT_DESCRICAO FROM Hora INNER JOIN Expedientes ON INT_IND = HR_HORARIO WHERE HR_FUNC = FUNC_IND \r\nORDER BY HR_DATAINICIAL DESC) AS DescriÃ§Ã£o\r\nFROM Funcionarios WHERE FUNC_DT_DEM IS NULL AND FUNC_MARCADO_EXCLUSAO = 0\r\nORDER BY FUNC_NOME\r\n\r\n\r\n','Gabriel','2018-09-26 18:15:49'),(459,'RelatÃ³rio funcionario, cargo, expediente dos funcionarios','RELATORIOS',' SET DATEFORMAT DMY\r\n\r\nSELECT DISTINCT FUNC_NOME as NOME, FUNC_REG as REGISTRO, CAR_DESCRICAO as CARGO, EMP_NOME as EMPRESA, EXPEDIENTE\r\nFROM Funcionarios\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nOUTER APPLY\r\n(SELECT STUFF(\' \' + ISNULL(dbo.fn_gettimefull(APO_H1), \'\') + \' \' + ISNULL(dbo.fn_gettimefull(APO_H2), \'\') + \' \' + ISNULL(dbo.fn_gettimefull(APO_H3), \'\') + \' \' + ISNULL(dbo.fn_gettimefull(APO_H4), \'\'), 1, 1, \' \') AS EXPEDIENTE FROM Aponta WHERE APO_FUNC = Funcionarios.FUNC_IND AND APO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL%) a\r\nWHERE EXPEDIENTE <> \'\'\r\n\r\n','Gabriel','2018-09-26 18:16:02'),(460,'RelatÃ³rio funcionario, cargo, marcaÃ§oes, extras por dia','RELATORIOS','--GRUPOQUEBRA#0#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\n--ALINHAMENTO#R#\r\n--LARGURA#100,80,80,80,80,80#\r\n--TITULO#Funcionarios MarcaÃ§Ãµes Extras#\r\nselect (LTRIM(RTRIM(a.FUNC_NOME)) + \' - \' + LTRIM(RTRIM(b.CAR_DESCRICAO)) + \' - \' + LTRIM(RTRIM(c.EMP_NOME))) as \'FUNCIONARIO\', \r\ndbo.fn_getdate(e.APO_DATA) as \'DATA\',\r\n       dbo.fn_gettimefull(e.APO_MARCACAO1) as \'MARCAÃ‡ÃƒO 1\', dbo.fn_gettimefull(e.APO_MARCACAO2) as \'MARCAÃ‡ÃƒO 2\', \r\n       dbo.fn_gettimefull(e.APO_MARCACAO3) as \'MARCAÃ‡ÃƒO 3\', dbo.fn_gettimefull(e.APO_MARCACAO4) as \'MARCAÃ‡ÃƒO 4\', \r\n       dbo.fn_gettimefull((select (ISNULL(CAL_EXTRA, 0) + ISNULL(CAL_EXTRAF, 0) + ISNULL(CAL_EXTRAN, 0) + ISNULL(CAL_EXTRANF, 0)) \r\n        from Calculo where CAL_DATA = e.APO_DATA and CAL_FUNC = e.APO_FUNC)) AS \'EXTRAS\'\r\nfrom Funcionarios a\r\nINNER JOIN Cargos b on b.CAR_IND = a.FUNC_CARGO\r\nINNER JOIN Empresas c on c.EMP_IND = a.FUNC_EMPRESA\r\nINNER JOIN Aponta e on e.APO_FUNC = a.FUNC_IND\r\nwhere a.FUNC_DT_DEM is null and \r\n      a.FUNC_RECEXTRA = 1 and\r\n     (e.APO_MARCACAO1 is not null or \r\n      e.APO_MARCACAO2 is not null or\r\n      e.APO_MARCACAO3 is not null or\r\n      e.APO_MARCACAO4 is not null) and\r\n     (select REPLACE(CONVERT(TIME, (ISNULL(CAL_EXTRA, 0) + ISNULL(CAL_EXTRAF, 0) + ISNULL(CAL_EXTRAN, 0) + ISNULL(CAL_EXTRANF, 0))), \r\n\'.0000000\', \'\') \r\n        from Calculo where CAL_DATA = e.APO_DATA and CAL_FUNC = e.APO_FUNC) != \'00:00:00\' and\r\n        e.APO_DATA >= %DATAINICIAL% AND e.APO_DATA <= %DATAFINAL% and\r\n     dbo.fn_departamentopertencente(a.FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1\r\nGROUP BY a.FUNC_NOME, b.CAR_DESCRICAO, c.EMP_NOME, e.APO_MARCACAO1, e.APO_MARCACAO2, e.APO_MARCACAO3, e.APO_MARCACAO4,\r\n          e.APO_DATA, e.APO_FUNC\r\nORDER BY a.FUNC_NOME','Gabriel','2018-09-26 18:16:13'),(461,'RelatÃ³rio funcionario, Crachas por departameto','RELATORIOS','SELECT CRA_NUMERO, FUNC_NOME\r\nFROM Crachas\r\nINNER JOIN Funcionarios ON FUNC_IND = CRA_FUNC\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1','Gabriel','2018-09-26 18:16:22'),(462,'Relatorio Funcionario, folga, macaÃ§Ãµes na escala','RELATORIOS','--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\n--LARGURA#200,200,80,80,80,80,80,80#\r\nSELECT FUNC_NOME AS Nome, EMP_NOME AS Depto, APO_DATA AS DATA,\r\nCASE WHEN APO_H = -990 THEN \'FOLGA\' END, CONVERT(VARCHAR(11),\r\nAPO_MARCACAO1,108) AS \'MarcaÃ§Ã£o1\',\r\nCONVERT(VARCHAR(11), APO_MARCACAO2,108) AS \'MarcaÃ§Ã£o2\', CONVERT\r\n(VARCHAR(11),\r\nAPO_MARCACAO3,108) AS \'MarcaÃ§Ã£o3\',\r\nCONVERT(VARCHAR(11), APO_MARCACAO4,108) AS \'MarcaÃ§Ã£o4\'\r\nFROM Funcionarios\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nINNER JOIN HoraEscala ON HRE_FUNC = FUNC_IND\r\nINNER JOIN Escalas ON ESC_IND = HRE_ESCALA\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND\r\nWHERE APO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL%','Gabriel','2018-09-26 18:16:31'),(463,'RelatÃ³rio Funcionario, PIS somente ativos','RELATORIOS','SELECT FUNC_NOME as NOME, FUNC_PIS as PIS\r\nFROM Funcionarios\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nwhere func_dt_dem is null\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:16:39'),(464,'Relatorio Funcionario, Registro, admissao, pis,  MarcaÃ§Ãµes, escala','RELATORIOS','--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\n--LARGURA#150,150,80,80,80,80,80,80#\r\nSELECT FUNC_REG AS Registro, FUNC_NOME AS Nome,FUNC_DT_ADM AS\r\nAdmissao, EMP_NOME AS Depto, CAR_DESCRICAO AS CARGO, FUNC_PIS AS PIS,\r\nAPO_DATA AS Data,\r\nCASE APO_H WHEN -990 THEN \'FOLGA\' WHEN -999 THEN \'DSR\' END AS \' \',\r\nCONVERT (VARCHAR(11),\r\nAPO_MARCACAO1,108) AS \'MarcaÃ§Ã£o1\',\r\nCONVERT(VARCHAR(11), APO_MARCACAO2,108) AS \'MarcaÃ§Ã£o2\', CONVERT\r\n(VARCHAR(11),\r\nAPO_MARCACAO3,108) AS \'MarcaÃ§Ã£o3\',\r\nCONVERT(VARCHAR(11), APO_MARCACAO4,108) AS \'MarcaÃ§Ã£o4\',\r\nESC_DESCRICAO AS Escala\r\nFROM Funcionarios\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nINNER JOIN HoraEscala ON HRE_FUNC = FUNC_IND\r\nINNER JOIN Escalas ON ESC_IND = HRE_ESCALA\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND\r\nLEFT JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nWHERE APO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL%','Gabriel','2018-09-26 18:16:50'),(465,'RelatÃ³rio Funcionarios Ativos e Inativos','RELATORIOS','--LARGURA# 50, 200, 150, 100, 100#\r\nSELECT  FUNC_REG AS\r\nREGISTRO, FUNC_NOME AS NOME, CAR_DESCRICAO AS CARGO, FUNC_PIS AS PIS,\r\nFUNC_DT_ADM AS ADMISSAO, FUNC_DT_DEM AS DEMISSAO\r\nFROM Funcionarios\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nORDER BY FUNC_DT_DEM, FUNC_DT_ADM, FUNC_NOME','Gabriel','2018-09-26 18:17:05'),(466,'RelatÃ³rio FuncionÃ¡rios e Escalas','RELATORIOS','--LARGURA#200,200,200,200#\r\nSELECT FUNC_NOME AS Nome, CAR_DESCRICAO AS Cargo, EMP_NOME AS Depto, \r\nESC_DESCRICAO AS Escala\r\nFROM Funcionarios\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nINNER JOIN HoraEscala ON HRE_FUNC = FUNC_IND\r\nINNER JOIN Escalas ON ESC_IND = HRE_ESCALA\r\nLEFT JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:17:16'),(467,'RelatÃ³rio FuncionÃ¡rios e Folgas','RELATORIOS','--LARGURA#300,300#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\nSELECT FUNC_NOME, APO_DATA FROM Aponta INNER JOIN Funcionarios ON\r\nFUNC_IND = APO_FUNC\r\nWHERE APO_DATA >= \'1/7/2014\' AND APO_DATA\r\n<= \'30/7/2014\' AND APO_H = -990 ORDER BY FUNC_NOME, APO_DATA','Gabriel','2018-09-26 18:17:43'),(468,'RelatÃ³rio FuncionÃ¡rios e Escalas','RELATORIOS','--LARGURA#200,200,200,200#\r\nSELECT FUNC_NOME AS Nome, CAR_DESCRICAO AS Cargo, EMP_NOME AS Depto, \r\nESC_DESCRICAO AS Escala\r\nFROM Funcionarios\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nINNER JOIN HoraEscala ON HRE_FUNC = FUNC_IND\r\nINNER JOIN Escalas ON ESC_IND = HRE_ESCALA\r\nLEFT JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:17:59'),(469,'RelatÃ³rio Funcionarios e Horarios separados por empresa','RELATORIOS','SELECT DISTINCT FUNC_NOME AS Nome, INt_COD AS Codigo, INt_DESCRICAO AS DescriÃ§Ã£o\r\nFROM FUNCionarios\r\nINNER JOIN Hora ON HR_FUNC = FUNC_INd AND HR_TIPO = 0\r\nINNER JOIN Expedientes ON INT_INd = HR_HORARIO\r\nWHERE FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL \r\nAND dbo.fn_departamentopertencente( FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:18:11'),(470,'RelatÃ³rio Funcionarios que nao marcaram entrada','RELATORIOS','SELECT CAST(FUNC_nome AS CHAR (50)) AS nome,\r\ndbo.fn_getdate(APO_DATA) AS DATA,\r\ndbo.fn_gettime5nullzero(APO_MARCACAO1) AS \'Marcacao 1\'\r\nFROM Aponta\r\nINNER JOIN Funcionarios ON FUNC_IND = APO_FUNC\r\nWHERE APO_DATA >= \'24/11/2016\' AND APO_DATA <= \'24/11/2016\' and dbo.fn_gettime5nullzero(APO_MARCACAO1) is null\r\nORDER BY FUNC_NOME, APO_DATA','Gabriel','2018-09-26 18:18:22'),(471,'RelatÃ³rio Funcionarios que trabalharam em finais de semana','RELATORIOS','select c.FUNC_NOME AS Nome, dbo.fn_getdate(MRC_DATAAP) as Data, x.MARCACOES as MarcaÃ§Ãµes\r\n        from Funcionarios c INNER JOIN Marcacoes d ON MRC_FUNC = FUNC_IND\r\n            cross apply (select stuff((select \',\' + dbo.fn_gettime(MRC_DATAHORA) from Marcacoes o where o.MRC_FUNC = c.FUNC_IND AND dbo.fn_getdate(o.MRC_DATAHORA) = dbo.fn_getdate(d.MRC_DATAHORA) for xml path(\'\')),1,1,\'\') as MARCACOES) x\r\n            WHERE MARCACOES IS NOT NULL AND DATEPART(weekday, MRC_DATAAP) = 7 /*sabado*/ OR DATEPART(weekday, MRC_DATAAP) = 1 /*domingo*/\r\n            GROUP BY FUNC_NOME, dbo.fn_getdate(MRC_DATAAP), x.MARCACOES\r\n\r\n\r\n\r\nELA QUER QUE ESPECIFIQUE SE Ã‰ SABADO OU DOMINGO AO LADO DA DATA IGUAL A OUTRA PESQUISA.','Gabriel','2018-09-26 18:18:37'),(472,'RelatÃ³rio Funcionarios que trabalharam','RELATORIOS','SELECT FUNC_NOME AS NOME, FUNC_REG AS REGISTRO, CAR_DESCRICAO as CARGO, EMP_NOME AS EMPRESA\r\nFROM FUNCIONARIOS\r\nINNER JOIN EMPRESAS ON  FUNC_EMPRESA = EMP_IND\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nwhere dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) = 1\r\nAND EXISTS(SELECT * FROM Marcacoes WHERE MRC_FUNC = FUNC_IND AND MRC_DATAHORA >= %DATAINICIAL% AND MRC_DATAHORA <= %DATAFINAL%)\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:18:49'),(473,'Relatorio Horas Extras e banco maior que 0200 Dia','RELATORIOS','--GRUPOQUEBRA#0#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\n--TITULO#Credito maior que 2hrs#\r\nDECLARE @DATAINICIAL SMALLDATETIME = %DATAINICIAL%,\r\n        @DATAFINAL SMALLDATETIME = %DATAFINAL%\r\n\r\n--LARGURA#400,400,50,180,60#\r\nSELECT A.EMP_NOME AS Empresa, B.EMP_NOME AS Departamento, FUNC_REG as Registro, FUNC_NOME as Nome, dbo.fn_getdate(APO_DATA) AS Data\r\nFROM Funcionarios\r\nINNER JOIN Aponta ON APO_FUNC = FUNC_IND\r\nINNER JOIN Expedientes ON INT_IND = APO_H\r\nINNER JOIN Empresas A ON A.EMP_IND = FUNC_EMPRESA \r\nINNER JOIN Empresas B ON B.EMP_IND = dbo.fn_getempresafuncionario(FUNC_IND)\r\nWHERE INT_TIPOTEMPO = \'F\' AND\r\n((INT_PERIODO_UNICO = 0 AND ((APO_MARCACAO1 IS NOT NULL AND \r\n  dbo.fn_smalldatetimetominute(APO_H1) - dbo.fn_smalldatetimetominute(APO_MARCACAO1) < 120) OR\r\n (APO_MARCACAO4 IS NOT NULL AND dbo.fn_smalldatetimetominute(APO_MARCACAO4) - dbo.fn_smalldatetimetominute(APO_H4) < 120))) OR\r\n (INT_PERIODO_UNICO = 1 AND ((APO_MARCACAO1 IS NOT NULL AND \r\n dbo.fn_smalldatetimetominute(APO_H1) - dbo.fn_smalldatetimetominute(APO_MARCACAO1) > 120) OR \r\n (APO_MARCACAO2 IS NOT NULL AND dbo.fn_smalldatetimetominute(APO_MARCACAO2) - dbo.fn_smalldatetimetominute(APO_H2) < 120)))) AND \r\nAPO_DATA >= @DATAINICIAL AND APO_DATA <= @DATAFINAL','Gabriel','2018-09-26 18:19:01'),(475,'Relatorio Intrajornada','RELATORIOS','--GRUPOQUEBRA#0#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\n--LARGURA#300,300,50,180,80,80#\r\n--TITULO#Funcionarios com intervalo menor que 11hrs#\r\nDECLARE @DATAINICIAL SMALLDATETIME = %DATAINICIAL%,\r\n        @DATAFINAL SMALLDATETIME = %DATAFINAL%,\r\n        @DEPSELECIONADOIND INT = %DEPSELECIONADOIND%\r\nselect d.EMP_NOME as Empresa, e.EMP_NOME as Departamento, c.FUNC_REG as Registro, c.FUNC_NOME as Nome,\r\n       (case when datepart(day, a.APO_DATA) >= 10\r\n             then convert(varchar(5), datepart(day, a.APO_DATA))\r\n             else \'0\' + convert(varchar(5), datepart(day, a.APO_DATA))\r\n        end + \'/\' + \r\n        case when datepart(month, a.APO_DATA) >= 10\r\n             then convert(varchar(5), datepart(month, a.APO_DATA))\r\n             else \'0\' + convert(varchar(5), datepart(month, a.APO_DATA))\r\n        end + \' - \' + \r\n        case when datepart(hour, a.APO_MARCACAO4) >= 10\r\n             then convert(varchar(5), datepart(hour, a.APO_MARCACAO4))\r\n             else \'0\' + convert(varchar(5), datepart(hour, a.APO_MARCACAO4))\r\n        end + \':\' + \r\n        case when datepart(minute, a.APO_MARCACAO4) >= 10 \r\n             then convert(varchar(5), datepart(minute, a.APO_MARCACAO4))\r\n             else \'0\' + convert(varchar(5), datepart(minute, a.APO_MARCACAO4))\r\n        end) as Saida,\r\n       (case when datepart(day, b.APO_DATA) >= 10\r\n             then convert(varchar(5), datepart(day, b.APO_DATA))\r\n             else \'0\' + convert(varchar(5), datepart(day, b.APO_DATA))\r\n        end + \'/\' + \r\n        case when datepart(month, b.APO_DATA) >= 10\r\n             then convert(varchar(5), datepart(month, b.APO_DATA))\r\n             else \'0\' + convert(varchar(5), datepart(month, b.APO_DATA))\r\n        end + \' - \' + \r\n        case when datepart(hour, b.APO_MARCACAO1) >= 10\r\n             then convert(varchar(5), datepart(hour, b.APO_MARCACAO1))\r\n             else \'0\' + convert(varchar(5), datepart(hour, b.APO_MARCACAO1))\r\n        end + \':\' + \r\n        case when datepart(minute, b.APO_MARCACAO1) >= 10 \r\n             then convert(varchar(5), datepart(minute, b.APO_MARCACAO1))\r\n             else \'0\' + convert(varchar(5), datepart(minute, b.APO_MARCACAO1))\r\n        end) as Retorno \r\nfrom Aponta a\r\ninner join Funcionarios c on c.FUNC_IND = a.APO_FUNC\r\ninner join Empresas d on d.EMP_IND = c.FUNC_EMPRESA\r\ninner join Empresas e on e.EMP_IND = dbo.fn_getempresafuncionario(c.FUNC_IND)\r\nouter apply(\r\n    select ba.APO_IND, ba.APO_FUNC, ba.APO_DATA, ba.APO_MARCACAO1 \r\n    from Aponta ba\r\n    where DATEDIFF(day, a.APO_DATA, ba.APO_DATA) = 1 and \r\n          ba.APO_MARCACAO1 is not null and \r\n          ba.APO_MARCACAO4 is not null and\r\n          ba.APO_FUNC = a.APO_FUNC\r\n) b\r\nwhere a.APO_MARCACAO4 is not null and \r\n      b.APO_MARCACAO1 is not null and\r\n      b.APO_DATA is not null and \r\n      DATEDIFF(hour, a.APO_MARCACAO4, b.APO_MARCACAO1) < 11 and \r\n      a.APO_DATA >= @DATAINICIAL and a.APO_DATA <= @DATAFINAL\r\norder by a.APO_DATA asc','Gabriel','2018-09-26 18:19:25'),(476,'RelatÃ³rio JUSTIFICATIVAS COM DATA DE LCTO ASSEPONTO','RELATORIOS','--LARGURA#50,200,200,200,200, 80#\r\nSELECT FUNC_REG As Matricula, FUNC_NOME AS Nome, EMP_NOME AS\r\nSETOR,JUS_DESCRICAO as\r\nJustificativa, JUS_DATA as DATA, JUS_ABONADOEM AS \'ABONADO EM\' FROM\r\nJustificativas\r\nINNER JOIN Funcionarios ON FUNC_IND = JUS_FUNC\r\nLEFT JOIN Empresas ON Empresas.EMP_IND = FuncIONARIOS.FUNC_EMPRESA\r\nWHERE JUS_DATA >= %DATAINICIAL% AND JUS_DATA <= %DATAFINAL%\r\nAND dbo.fn_departamentopertencente(FUNC_EMPRESA,\r\n%DEPSELECIONADOIND%) = 1 ORDER BY\r\nFUNC_NOME\r\n','Gabriel','2018-09-26 18:19:34'),(477,'Relatorio Justificativas Detalhadas agrupado por Cargo','RELATORIOS','--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\n--LARGURA#50,100,100,250,100, 110#\r\nSELECT CAR_DESCRICAO AS FUNCAO, FUNC_REG As Matricula,\r\nFUNC_NOME\r\nAS Nome, EMP_NOME AS\r\nSETOR,JUS_DESCRICAO as\r\nJustificativa, JUS_DATA as DATA, JUS_ABONADOEM AS \'ABONADO EM\' FROM\r\nJustificativas\r\nINNER JOIN Funcionarios ON FUNC_IND = JUS_FUNC\r\nLEFT JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nLEFT JOIN Empresas ON Empresas.EMP_IND = Funcionarios.FUNC_EMPRESA\r\nWHERE JUS_DATA >= %DATAINICIAL% AND JUS_DATA <= %DATAFINAL% ORDER BY\r\nFUNC_NOME','Gabriel','2018-09-26 18:19:44'),(478,'RelatÃ³rio Justificativas Totalizadas','RELATORIOS','--LARGURA#150,50#\r\n--COLUNAGRUPO#0#\r\nSELECT FUNC_NOME, JUS_DESCRICAO as Justificativa,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_ABONO)))\r\nas Valor\r\nFROM Justificativas\r\nINNER JOIN Funcionarios ON FUNC_IND = JUS_FUNC\r\nINNER JOIN Calculo ON CAL_FUNC = JUS_FUNC AND CAL_DATA = JUS_DATA\r\nWHERE\r\nJUS_DATA >= %DATAINICIAL% AND JUS_DATA <= %DATAFINAL%\r\nAND (JUS_DESCRICAO LIKE \'%???%\' OR JUS_DESCRICAO LIKE \'%????%\')\r\nGROUP BY FUNC_NOME, JUS_DESCRICAO\r\nHAVING SUM(dbo.fn_smalldatetimetominute(CAL_ABONO)) > 0\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:19:57'),(479,'RelatÃ³rio Listagem de funcionarios exceto setor indicado','RELATORIOS','-- trocar xxxxxxxxx pelo cargo\r\n-- trocar yyyyyyyyy pelo departamento\r\nDECLARE @ESTAGIARIOS INT\r\nDECLARE @CARGO NVARCHAR(100)\r\nSET @CARGO = \'%xxxxxxx%\'\r\nSELECT @ESTAGIARIOS = EMP_IND FROM Empresas WHERE EMP_NOME LIKE \'%yyyyyyyyy%\'\r\n\r\nSELECT FUNC_NOME\r\nFROM Funcionarios\r\nWHERE FUNC_DT_DEM IS NULL AND dbo.fn_departamentopertencente(FUNC_EMPRESA, @ESTAGIARIOS) = 0 AND \r\nFUNC_CARGO NOT IN (SELECT CAR_IND FROM Cargos WHERE CAR_DESCRICAO LIKE @CARGO)\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:20:08'),(480,'RelatÃ³rio MarcaÃ§Ã£oes registradas 10 min antes ou depois Horario','RELATORIOS','--LARGURA#50,200,100,100,100,100,100#\r\nSELECT FUNC_REG as Registro, FUNC_NOME as Nome, dbo.fn_getdate(APO_DATA) AS Data\r\nFROM Funcionarios\r\nINNER JOIN Aponta ON APO_FUNC = FUNC_IND\r\nINNER JOIN Expedientes ON INT_IND = APO_H\r\nWHERE INT_TIPOTEMPO = \'F\' AND\r\n(\r\n (INT_PERIODO_UNICO = 0 AND ((APO_MARCACAO1 IS NOT NULL AND\r\n dbo.fn_smalldatetimetominute(APO_H1) - dbo.fn_smalldatetimetominute\r\n(APO_MARCACAO1) > 10) OR\r\n (APO_MARCACAO4 IS NOT NULL AND dbo.fn_smalldatetimetominute\r\n(APO_MARCACAO4) - dbo.fn_smalldatetimetominute(APO_H4) > 10))) OR\r\n (INT_PERIODO_UNICO = 1 AND ((APO_MARCACAO1 IS NOT NULL AND\r\n dbo.fn_smalldatetimetominute(APO_H1) - dbo.fn_smalldatetimetominute\r\n(APO_MARCACAO1) > 10) OR\r\n (APO_MARCACAO2 IS NOT NULL AND dbo.fn_smalldatetimetominute\r\n(APO_MARCACAO2) - dbo.fn_smalldatetimetominute(APO_H2) > 10)))\r\n)','Gabriel','2018-09-26 18:20:18'),(481,'RelatÃ³rio marcaÃ§Ãµes de apontamento (HIGA)','RELATORIOS','SELECT CAST(FUNC_PIS AS CHAR (12)) AS PIS,\r\ndbo.fn_getdate(APO_DATA) AS DATA,\r\ndbo.fn_gettime5nullzero(APO_MARCACAO1) AS \'Marcacao 1\',\r\ndbo.fn_gettime5nullzero(APO_MARCACAO2) AS \'Marcacao 2\',\r\ndbo.fn_gettime5nullzero(APO_MARCACAO3) AS \'Marcacao 3\',\r\ndbo.fn_gettime5nullzero(APO_MARCACAO4) AS \'Marcacao 4\'\r\nFROM Aponta\r\nINNER JOIN Funcionarios ON FUNC_IND = APO_FUNC\r\nWHERE APO_DATA >= \'01/01/2013\' AND APO_DATA <= \'31/01/2013\'\r\nORDER BY FUNC_NOME, APO_DATA','Gabriel','2018-09-26 18:20:29'),(482,'RelatÃ³rio MarcaÃ§Ãµes Desconsideradas','RELATORIOS','--LARGURA#120,80,130#\r\nSELECT FUNC_NOME as Nome, dbo.fn_getdatetime(MRC_DATAHORA) as\r\nMarcaÃ§Ã£o\r\nFROM Marcacoes\r\nINNER JOIN Funcionarios ON FUNC_IND = MRC_FUNC\r\nWHERE MRC_DATAAP >= %DATAINICIAL% AND MRC_DATAAP <= %DATAFINAL%\r\nAND (MRC_STATUS = 5)\r\nORDER BY FUNC_NOME, MRC_DATAHORA','Gabriel','2018-09-26 18:20:43'),(483,'Relatorio MarcaÃ§Ãµes Escala','RELATORIOS','--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\n--LARGURA#200,200,80,80,80,80,80,80#\r\nSELECT FUNC_NOME AS Nome, EMP_NOME AS Depto, APO_DATA AS DATA,\r\nCASE WHEN APO_H = -990 THEN \'FOLGA\' END, CONVERT(VARCHAR(11),\r\nAPO_MARCACAO1,108) AS \'MarcaÃ§Ã£o1\',\r\nCONVERT(VARCHAR(11), APO_MARCACAO2,108) AS \'MarcaÃ§Ã£o2\', CONVERT\r\n(VARCHAR(11),\r\nAPO_MARCACAO3,108) AS \'MarcaÃ§Ã£o3\',\r\nCONVERT(VARCHAR(11), APO_MARCACAO4,108) AS \'MarcaÃ§Ã£o4\'\r\nFROM Funcionarios\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nINNER JOIN HoraEscala ON HRE_FUNC = FUNC_IND\r\nINNER JOIN Escalas ON ESC_IND = HRE_ESCALA\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND\r\nWHERE APO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL%','Gabriel','2018-09-26 18:21:18'),(484,'RelatÃ³rio MarcaÃ§Ãµes Ignoradas','RELATORIOS','--LARGURA#120,80#\r\n--Trocar %DATAINICIAL% pela data inicial desejada ou deixar como estÃ¡ para usar a data inicial do apontamento, exemplo: \'25/02/2010\'\r\n--%DATAFINAL% vale o mesmo que a data inicial, mas para data final\r\n\r\nSELECT FUNC_NOME as Nome, dbo.fn_getdatetime(MRC_DATAHORA) as\r\nMarcaÃ§Ã£o\r\nFROM Marcacoes\r\nINNER JOIN Funcionarios ON FUNC_IND = MRC_FUNC\r\nWHERE MRC_DATAAP >= %DATAINICIAL% AND MRC_DATAAP <= %DATAFINAL%\r\nAND (MRC_STATUS = 5)\r\nORDER BY FUNC_NOME, MRC_DATAHORA','Gabriel','2018-09-26 18:21:28'),(485,'RelatÃ³rio MarcaÃ§Ãµes Inclusive Faltas','RELATORIOS','--LARGURA#70,200,200,70,60,60,60,60#\r\nSELECT FUNC_REG AS MatrÃ­cula, FUNC_NOME AS Nome , EMP_NOME AS Setor ,\r\nAPO_DATA AS Data,\r\ndbo.fn_gettimefull(APO_MARCACAO1) AS Entrada,\r\ndbo.fn_gettimefull(APO_MARCACAO2) AS \'Intervalo 1\',\r\ndbo.fn_gettimefull(APO_MARCACAO3) AS \'Intervalo 2\',     \r\ndbo.fn_gettimefull(APO_MARCACAO4) AS SaÃ­da        \r\nFROM Funcionarios                      \r\nINNER JOIN Aponta ON APO_FUNC = FUNC_IND\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nWHERE APO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL%\r\n--AND (APO_MARCACAO1 IS NOT NULL OR APO_MARCACAO2 IS NOT NULL OR \r\n--APO_MARCACAO3 IS NOT NULL OR APO_MARCACAO4 IS NOT NULL)\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:21:39'),(486,'RelatÃ³rio Marcacoes Por Dia','RELATORIOS','select c.FUNC_PIS AS Pis, dbo.fn_getdate(MRC_DATAHORA) as Data, x.MARCACOES as MarcaÃ§Ãµes\r\n        from Funcionarios c INNER JOIN Marcacoes d ON MRC_FUNC = FUNC_IND\r\n            cross apply (select stuff((select \',\' + dbo.fn_gettime(MRC_DATAHORA) from Marcacoes o where o.MRC_FUNC = c.FUNC_IND AND dbo.fn_getdate(o.MRC_DATAHORA) = dbo.fn_getdate(d.MRC_DATAHORA) AND MRC_PIS IS NOT NULL for xml path(\'\')),1,1,\'\') as MARCACOES) x\r\n            WHERE MARCACOES IS NOT NULL AND MRC_DATAHORA >= \'???????\' and MRC_DATAHORA <= \'??????\'\r\n            GROUP BY FUNC_PIS, dbo.fn_getdate(MRC_DATAHORA), x.MARCACOES','Gabriel','2018-09-26 18:21:49'),(487,'RelatÃ³rio marcaÃ§oes reais dos funcionarios','RELATORIOS','--LARGURA#70,200,200,70,60,60,60,60#\r\nSELECT FUNC_REG AS MatrÃ­cula, FUNC_NOME AS Nome , EMP_NOME AS Setor ,\r\nAPO_DATA AS Data,\r\nCASE WHEN ISNULL(APO_OCORRENCIA1, \'\') <> \'I\' AND ISNULL \r\n(APO_OCORRENCIA1, \'\') <> \'P\' THEN dbo.fn_gettimefull(APO_MARCACAO1) \r\nELSE \'\' END AS Entrada,\r\nCASE WHEN ISNULL(APO_OCORRENCIA2, \'\') <> \'I\' AND ISNULL \r\n(APO_OCORRENCIA2, \'\') <> \'P\' THEN dbo.fn_gettimefull(APO_MARCACAO2) \r\nELSE \'\' END AS \'Intervalo 1\',\r\nCASE WHEN ISNULL(APO_OCORRENCIA3, \'\') <> \'I\' AND ISNULL \r\n(APO_OCORRENCIA3, \'\') <> \'P\' THEN dbo.fn_gettimefull(APO_MARCACAO3) \r\nELSE \'\' END AS \'Intervalo 2\',\r\nCASE WHEN ISNULL(APO_OCORRENCIA4, \'\') <> \'I\' AND ISNULL \r\n(APO_OCORRENCIA4, \'\') <> \'P\' THEN dbo.fn_gettimefull(APO_MARCACAO4) \r\nELSE \'\' END AS SaÃ­da\r\nFROM Funcionarios\r\nINNER JOIN Aponta ON APO_FUNC = FUNC_IND\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nWHERE APO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL%\r\nAND (APO_MARCACAO1 IS NOT NULL OR APO_MARCACAO2 IS NOT NULL OR \r\nAPO_MARCACAO3 IS NOT NULL OR APO_MARCACAO4 IS NOT NULL)\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:21:59'),(488,'RelatÃ³rio marcaÃ§oes reais e pre assinaladas no intervalo','RELATORIOS','--LARGURA#70,200,200,70,60,60,60,60#\r\nSELECT FUNC_REG AS MatrÃ­cula, FUNC_NOME AS Nome , EMP_NOME AS Setor ,\r\nAPO_DATA AS Data,\r\ndbo.fn_gettimefull(APO_MARCACAO2) AS \'Intervalo 1\', dbo.fn_gettimefull(APO_MARCACAO3) AS \'Intervalo 2\'\r\nFROM Funcionarios\r\nINNER JOIN Aponta ON APO_FUNC = FUNC_IND\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nWHERE APO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL%\r\nAND (APO_MARCACAO1 IS NOT NULL OR APO_MARCACAO2 IS NOT NULL OR \r\nAPO_MARCACAO3 IS NOT NULL OR APO_MARCACAO4 IS NOT NULL)\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:22:09'),(489,'RelatÃ³rio marcaÃ§oes reais no intervalo','RELATORIOS','--LARGURA#70,200,200,70,60,60,60,60#\r\nSELECT FUNC_REG AS MatrÃ­cula, FUNC_NOME AS Nome , EMP_NOME AS Setor ,\r\nAPO_DATA AS Data,\r\nCASE WHEN ISNULL(APO_OCORRENCIA2, \'\') <> \'I\' AND ISNULL \r\n(APO_OCORRENCIA2, \'\') <> \'P\' THEN dbo.fn_gettimefull(APO_MARCACAO2) \r\nELSE \'\' END AS \'Intervalo 1\',\r\nCASE WHEN ISNULL(APO_OCORRENCIA3, \'\') <> \'I\' AND ISNULL \r\n(APO_OCORRENCIA3, \'\') <> \'P\' THEN dbo.fn_gettimefull(APO_MARCACAO3) \r\nELSE \'\' END AS \'Intervalo 2\'\r\nFROM Funcionarios\r\nINNER JOIN Aponta ON APO_FUNC = FUNC_IND\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nWHERE APO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL%\r\nAND (APO_MARCACAO1 IS NOT NULL OR APO_MARCACAO2 IS NOT NULL OR \r\nAPO_MARCACAO3 IS NOT NULL OR APO_MARCACAO4 IS NOT NULL)\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:22:22'),(490,'RelatÃ³rio MarcaÃ§Ãµes','RELATORIOS','--LARGURA#70,200,200,70,60,60,60,60#\r\nSELECT FUNC_REG AS MatrÃ­cula, FUNC_NOME AS Nome , EMP_NOME AS Setor ,\r\nAPO_DATA AS Data,\r\ndbo.fn_gettimefull(APO_MARCACAO1) AS Entrada,\r\ndbo.fn_gettimefull(APO_MARCACAO2) AS \'Intervalo 1\',\r\ndbo.fn_gettimefull(APO_MARCACAO3) AS \'Intervalo 2\',     \r\ndbo.fn_gettimefull(APO_MARCACAO4) AS SaÃ­da        \r\nFROM Funcionarios                      \r\nINNER JOIN Aponta ON APO_FUNC = FUNC_IND\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nWHERE APO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL%\r\nAND (APO_MARCACAO1 IS NOT NULL OR APO_MARCACAO2 IS NOT NULL OR \r\nAPO_MARCACAO3 IS NOT NULL OR APO_MARCACAO4 IS NOT NULL)\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:22:32'),(491,'RelatÃ³rio MarcaÃµes Desconsideradas e Incluidas','RELATORIOS','--LARGURA#120,80,130#\r\nSELECT FUNC_NOME as Nome, dbo.fn_getdatetime(MRC_DATAHORA) as\r\nMarcaÃ§Ã£o,\r\n(CASE WHEN MRC_STATUS = 5 THEN \'Desconsiderado\' ELSE \'IncluÃ­do\' END)\r\nAS Status\r\nFROM Marcacoes\r\nINNER JOIN Funcionarios ON FUNC_IND = MRC_FUNC\r\nWHERE MRC_DATAAP >= %DATAINICIAL% AND MRC_DATAAP <= %DATAFINAL%\r\nAND (MRC_STATUS = 5 OR (MRC_CRACHA IS NULL OR MRC_PIS IS NULL))\r\nORDER BY FUNC_NOME, MRC_DATAHORA','Gabriel','2018-09-26 18:22:41'),(492,'Relatorio menos de 0100 Intervalo','RELATORIOS','--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\n--LARGURA#40,200,100,70,60,60,60,80#\r\nDECLARE @DATAINICIAL SMALLDATETIME = %DATAINICIAL%,\r\n        @DATAFINAL SMALLDATETIME = %DATAFINAL%\r\nSELECT A.FUNC_NOME AS Nome, A.EMP_NOME AS Setor, A.APO_DATA AS Data, A.APO_MARCACAO1 AS Entrada, \r\n       A.APO_MARCACAO2 AS \'Inter 1\', A.APO_MARCACAO3 AS \'Inter 2\', A.APO_MARCACAO4 AS SaÃ­da, dbo.fn_minutetohourlong(A.Intervalo) AS \r\nIntervalo\r\nFROM (\r\n    SELECT FUNC_NOME, EMP_NOME, CONVERT(DATE, APO_DATA) AS APO_DATA,\r\n            dbo.fn_gettimefull(APO_MARCACAO1) AS APO_MARCACAO1, dbo.fn_gettimefull(APO_MARCACAO2) AS APO_MARCACAO2,\r\n            dbo.fn_gettimefull(APO_MARCACAO3) AS APO_MARCACAO3, dbo.fn_gettimefull(APO_MARCACAO4) AS APO_MARCACAO4,\r\n            (dbo.fn_smalldatetimetominute(APO_MARCACAO3) - dbo.fn_smalldatetimetominute(APO_MARCACAO2)) AS Intervalo\r\n    FROM Funcionarios\r\n    INNER JOIN Aponta ON APO_FUNC = FUNC_IND\r\n    INNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA                 \r\n    WHERE APO_DATA >= @DATAINICIAL AND APO_DATA <= @DATAFINAL\r\n) A\r\nWHERE (A.Intervalo < 60 AND \r\n        (APO_MARCACAO1 IS NOT NULL OR \r\n         APO_MARCACAO2 IS NOT NULL OR \r\n         APO_MARCACAO3 IS NOT NULL OR \r\n         APO_MARCACAO4 IS NOT NULL))\r\nORDER BY A.FUNC_NOME','Gabriel','2018-09-26 18:22:52'),(493,'RelatÃ³rio NÃ£o Marcou a Entrada','RELATORIOS','--LARGURA# 50,200,200,100#\r\nSELECT FUNC_REG as Registro, FUNC_NOME as Nome, EMP_NOME as Depart,\r\nAPO_DATA as DATA\r\nFROM Aponta\r\nINNER JOIN Funcionarios ON FUNC_IND = APO_FUNC\r\nLEFT JOIN Empresas ON FUNC_EMPRESA = EMP_IND\r\nLEFT JOIN Expedientes ON APO_H = INT_IND\r\nWHERE ((APO_MARCACAO1 is null AND\r\n    APO_MARCACAO4 is not null AND INT_PERIODO_UNICO = 0)\r\n    OR\r\n     (APO_MARCACAO1 is null AND\r\n    APO_MARCACAO2 is not null AND INT_PERIODO_UNICO = 1))\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL\r\nAND APO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL%','Gabriel','2018-09-26 18:23:03'),(494,'RelatÃ³rio NÃ£o Marcou a SaÃ­da','RELATORIOS','--LARGURA# 50,200,200,100#\r\nSELECT FUNC_REG as Registro, FUNC_NOME as Nome, EMP_NOME as Depart,\r\nAPO_DATA as DATA\r\nFROM Aponta\r\nINNER JOIN Funcionarios ON FUNC_IND = APO_FUNC\r\nLEFT JOIN Empresas ON FUNC_EMPRESA = EMP_IND\r\nLEFT JOIN Expedientes ON APO_H = INT_IND\r\nWHERE ((APO_MARCACAO1 is not null AND\r\n    APO_MARCACAO4 is null AND INT_PERIODO_UNICO = 0)\r\n    OR\r\n     (APO_MARCACAO1 is not null AND\r\n    APO_MARCACAO2 is null AND INT_PERIODO_UNICO = 1))\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL\r\nAND APO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL%','Gabriel','2018-09-26 18:23:18'),(495,'RelatÃ³rio Nome,  Cargo,  ativos','RELATORIOS','SELECT FUNC_NOME as NOME, CAR_DESCRICAO as CARGO,\r\nFROM Funcionarios\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nwhere func_dt_dem is null\r\norder by func_cargo','Gabriel','2018-09-26 18:23:29'),(496,'Relatorio Nome, marcaÃ§Ãµes, atrab, trab, Credito, Debito, Extra','RELATORIOS','--LARGURA#80,80,50,50,50,80,50,50,80,80,50#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\nSELECT FUNC_NOME, CAL_DATA AS DATA,\r\n\r\ndbo.fn_gettimefull(APO_MARCACAO1) AS Entrada,\r\ndbo.fn_gettimefull(APO_MARCACAO2) AS Intervalo1,\r\ndbo.fn_gettimefull(APO_MARCACAO3) AS Intervalo2,\r\ndbo.fn_gettimefull(APO_MARCACAO4) AS Saida,\r\n\r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_TRAB)))), \'\') AS ATRAB,\r\n\r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_TRAB)))), \'\') AS TRAB,\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA AND\r\nSUBSTRING(BCO_VALOR, 1, 1) <> \'-\') AS CREDITO,\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA\r\nAND SUBSTRING(BCO_VALOR, 1, 1) = \'-\') AS\r\nDEBITO,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute\r\n(CAL_EXTRA) +\r\ndbo.fn_smalldatetimetominute(CAL_EXTRAN) +\r\ndbo.fn_smalldatetimetominute(CAL_EXTRANF)))AS EXTRA\r\nFROM Calculo\r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,\r\n%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0\r\nAND FUNC_DT_DEM IS NULL AND CAL_DATA >= %DATAINICIAL%\r\nAND CAL_DATA <= %DATAFINAL%\r\nGROUP BY FUNC_NOME, FUNC_IND, CAL_DATA, APO_MARCACAO1, APO_MARCACAO2,\r\nAPO_MARCACAO3, APO_MARCACAO4','Gabriel','2018-09-26 18:23:40'),(497,'Relatorio Nome, MarcaÃ§oes, Credito, Debito e Saldo','RELATORIOS','--LARGURA#80,80,50,50,50,80,50,50,60,50,60#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\n--ORIENTACAO#paisagem#\r\nSELECT FUNC_NOME, CAL_DATA AS DATA,\r\n\r\ndbo.fn_gettimefull(APO_MARCACAO1) AS Entrada,\r\ndbo.fn_gettimefull(APO_MARCACAO2) AS Intervalo1,\r\ndbo.fn_gettimefull(APO_MARCACAO3) AS Intervalo2,\r\ndbo.fn_gettimefull(APO_MARCACAO4) AS Saida,\r\n\r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_ATRB)))), \'\') AS ATRAB,\r\n\r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_TRAB)))), \'\') AS TRAB,\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA AND\r\nSUBSTRING(BCO_VALOR, 1, 1) <> \'-\') AS CREDITO,\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA\r\nAND SUBSTRING(BCO_VALOR, 1, 1) = \'-\') AS DEBITO,\r\n\r\ndbo.fn_get_banco_saldo_totalizado_dia(func_ind,CAL_DATA) AS \'SALDO\'\r\n\r\nFROM Calculo    \r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,\r\n%DEPSELECIONADOIND%) =1\r\nAND FUNC_DT_DEM IS NULL and FUNC_MARCADO_EXCLUSAO = 0 AND CAL_DATA >= %DATAINICIAL%\r\nAND CAL_DATA <= %DATAFINAL%\r\nGROUP BY FUNC_NOME, FUNC_IND, CAL_DATA, APO_MARCACAO1, APO_MARCACAO2,\r\nAPO_MARCACAO3, APO_MARCACAO4','Gabriel','2018-09-26 18:23:50'),(498,'RelatÃ³rio NOME, PIS, FALTAS POR DEPARTAMENTO','RELATORIOS','--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\n--LARGURA#300,300#\r\nSELECT FUNC_NOME as Nome, FUNC_Pis as Pis, \r\ndbo.fn_getdate(cal_data) as\r\nData\r\nFROM dbo.calculo\r\nINNER JOIN FuncIONARIOS ON FUNC_IND = cal_FUNC\r\nINNER JOIN Empresas ON Empresas.EMP_IND = FuncIONARIOS.FUNC_EMPRESA\r\nWHERE cal_FALTAHORA > 0\r\nAND cal_DATA >= %DATAINICIAL% AND cal_DATA <= %DATAFINAL% AND\r\ndbo.fn_departamentopertencente(FUNC_EMPRESA,\r\n%DEPSELECIONADOIND%) = 1\r\nORDER BY EMP_NOME, FUNC_NOME, cal_DATA','Gabriel','2018-09-26 18:24:01'),(499,'RelatÃ³rio Nome, Registro, Cargo, Admissao ,demissao  pis ','RELATORIOS','SELECT FUNC_NOME, FUNC_REG, CAR_DESCRICAO,func_pis, FUNC_DT_ADM, func_DT_dem\r\nFROM Funcionarios\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nORDER BY FUNC_NOME\r\n\r\n','Gabriel','2018-09-26 18:24:14'),(500,'RelatÃ³rio Nome, Registro, Cargo, Admissao somente func. ativos','RELATORIOS','SELECT FUNC_NOME, FUNC_REG, CAR_DESCRICAO, FUNC_DT_ADM\r\nFROM Funcionarios\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nORDER BY FUNC_NOME\r\nwhere func_dt_dem is not null\r\n','Gabriel','2018-09-26 18:24:24'),(501,'RelatÃ³rio Nome, Registro, Cargo, Admissao, PIS','RELATORIOS','SELECT FUNC_NOME as NOME, FUNC_REG as REGISTRO, CAR_DESCRICAO as CARGO, FUNC_DT_ADM, FUNC_PIS as PIS\r\nFROM Funcionarios\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:24:36'),(502,'RelatÃ³rio Nome, Registro, Cargo, Admissao, PIS_ POR DEPTO','RELATORIOS','SELECT FUNC_NOME as NOME, FUNC_REG as REGISTRO, CAR_DESCRICAO as CARGO, FUNC_DT_ADM, FUNC_PIS as PIS\r\nFROM Funcionarios\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nWHERE DBO.FN_DEPARTAMENTOPERTENCENTE (FUNC_EMPRESA, %DEPSELECIONADOIND% ) = 1\r\nORDER BY func_dt_adm','Gabriel','2018-09-26 18:24:47'),(503,'RelatÃ³rio Nome, Registro, Cargo, Admissao','RELATORIOS','SELECT FUNC_NOME, FUNC_REG, CAR_DESCRICAO, FUNC_DT_ADM\r\nFROM Funcionarios\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:24:59'),(504,'RelatÃ³rio Nome, Registro, Cargo, Data, Entrada, Saida, Jornada do dia','RELATORIOS','--LARGURA#60,200,200,70,60,60,60,80#\r\nSELECT FUNC_REG AS Registro, FUNC_NOME AS Nome, CAR_DESCRICAO as\r\nCargo, APO_DATA AS Data,\r\ndbo.fn_gettimefull(APO_MARCACAO1) AS Entrada,\r\ndbo.fn_gettimefull(APO_MARCACAO4) AS SaÃ­da,\r\n(SELECT dbo.fn_gettimefull(CAL_TRAB) FROM Calculo WHERE\r\nCAL_FUNC = FUNC_IND AND CAL_DATA = APO_DATA) AS Jornada\r\nFROM Funcionarios\r\nINNER JOIN Aponta ON APO_FUNC = FUNC_IND\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nLEFT JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nWHERE APO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL%   AND\r\nAPO_MARCACAO1 IS NOT NULL AND APO_MARCACAO4 IS NOT NULL\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:25:09'),(505,'RelatÃ³rio Nome, Registro, Cargo, Setor, Admissao, DemissÃ£o','RELATORIOS','SELECT FUNC_NOME AS NOME, FUNC_REG AS REGISTRO, fun_cargo as CARGO, EMP_NOME AS EMPRESA, FUNC_DT_ADM AS ADMISSAO, FUNC_DT_DEM AS DEMISSAO FROM FUNCIONARIOS\r\nINNER JOIN EMPRESAS ON  FUNC_EMPRESA = EMP_IND\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nwhere dbo.fn_departamentopertencente(FUNC_EMPRESA,\r\n%DEPSELECIONADOIND%) = 1\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:25:19'),(506,'RelatÃ³rio Nome, registro, cargo, setor, total de atestados, e total por departamento','RELATORIOS','--LARGURA#50,200,100,200,100#\r\nSELECT FUNC_REG As Matricula, FUNC_NOME AS Nome,CAR_DESCRICAO AS\r\nFUNÃ‡ÃƒO, EMP_NOME AS\r\nSETOR, COUNT(JUS_IND) AS QUANTIDADE FROM\r\nJustificativas\r\nINNER JOIN Funcionarios ON FUNC_IND = JUS_FUNC\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nLEFT JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nWHERE JUS_DATA >= %DATAINICIAL% AND JUS_DATA <= %DATAFINAL%\r\nAND dbo.fn_departamentopertencente(FUNC_EMPRESA,\r\n%DEPSELECIONADOIND%) = 1\r\nGROUP BY FUNC_REG, FUNC_NOME, CAR_DESCRICAO, EMP_NOME\r\nUNION ALL\r\nSELECT \'\', \'Total\', \'\', \'\', COUNT(JUS_IND) AS QUANTIDADE FROM\r\nJustificativas\r\nLEFT JOIN Funcionarios ON FUNC_IND = JUS_FUNC\r\nWHERE JUS_DATA >= %DATAINICIAL% AND JUS_DATA <= %DATAFINAL%\r\nAND dbo.fn_departamentopertencente(FUNC_EMPRESA,\r\n%DEPSELECIONADOIND%) = 1\r\n','Gabriel','2018-09-26 18:25:29'),(507,'RelatÃ³rio nome, registro, cargo, setor','RELATORIOS','SELECT FUNC_NOME AS NOME, FUNC_REG AS REGISTRO, CAR_DESCRICAO as CARGO, EMP_NOME AS EMPRESA\r\nFROM FUNCIONARIOS\r\nINNER JOIN EMPRESAS ON  FUNC_EMPRESA = EMP_IND\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nwhere dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) = 1\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:25:41'),(508,'RelatÃ³rio Nome, Registro, Cargo','RELATORIOS','SELECT FUNC_REG AS REGISTRO, FUNC_NOME AS NOME, CAR_DESCRICAO AS \r\nCARGO\r\nFROM Funcionarios\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nWHERE FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:25:54'),(509,'RelatÃ³rio NOME, REGISTRO, FALTAS POR DEPARTAMENTO','RELATORIOS','--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\n--LARGURA#300,300#\r\nSELECT EMP_NOME, FUNC_NOME as Nome, FUNC_REG as Registro, \r\ndbo.fn_getdate(cal_data) as\r\nData\r\nFROM dbo.calculo\r\nINNER JOIN FuncIONARIOS ON FUNC_IND = cal_FUNC\r\nINNER JOIN Empresas ON Empresas.EMP_IND = FuncIONARIOS.FUNC_EMPRESA\r\nWHERE cal_FALTAHORA > 0\r\nAND cal_DATA >= %DATAINICIAL% AND cal_DATA <= %DATAFINAL% AND\r\ndbo.fn_departamentopertencente(FUNC_EMPRESA,\r\n%DEPSELECIONADOIND%) = 1\r\nORDER BY EMP_NOME, FUNC_NOME, cal_DATA','Gabriel','2018-09-26 18:26:06'),(510,'RelatÃ³rio Nome, Setor, Admissao, DemissÃ£o, func inativos','RELATORIOS','SELECT FUNC_NOME AS NOME, EMP_NOME AS EMPRESA, FUNC_DT_ADM AS ADMISSAO, FUNC_DT_DEM AS DEMISSAO FROM FUNCIONARIOS\r\nINNER JOIN EMPRESAS ON  FUNC_EMPRESA = EMP_IND\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nwhere dbo.fn_departamentopertencente(FUNC_EMPRESA,\r\n%DEPSELECIONADOIND%) = 1 and FUNC_DT_DEM is not null\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:26:16'),(511,'RelatÃ³rio REGISTRO EVENTO E FALTAS DIAS DETALHADO COM A DATA','RELATORIOS','--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\n--LARGURA#300,80,80,80,80,300#\r\nSELECT FUNC_REG AS REGISTRO, 223, CAL_DATA AS DATA\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON CAL_FUNC = FUNC_IND\r\nWHERE CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL% \r\nAND dbo.fn_departamentopertencente(FUNC_EMPRESA,\r\n%DEPSELECIONADOIND%) = 1 AND CAL_FALTAHORA > 0\r\nORDER BY FUNC_REG','Gabriel','2018-09-26 18:26:29'),(512,'RelatÃ³rio Registro, Funcionario e expediente','RELATORIOS','SELECT DISTINCT FUNC_REG AS Registro, FUNC_NOME AS Nome, INt_COD AS Codigo, INt_DESCRICAO AS DescriÃ§Ã£o\r\nFROM FUNCionarios\r\nINNER JOIN Hora ON HR_FUNC = FUNC_INd AND HR_TIPO = 0\r\nINNER JOIN Expedientes ON INT_INd = HR_HORARIO\r\nWHERE FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL\r\nAND dbo.fn_departamentopertencente( FUNC_EMPRESA,%DEPSELECIONADOIND%) = 1\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:26:40'),(513,'RelatÃ³rio Registro, FuncionÃ¡rio, Departamento, Entrada, SaÃ­da','RELATORIOS','SELECT FUNC_REG as MatrÃ­cula, FUNC_NOME as Nomta, EMP_NOME as Depto,\r\nFROM Funcionarios\r\nINNER JOIN Empresas ON FUNC_EMPRESA = EMP_IND\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:26:51'),(514,'RelatÃ³rio REGISTRO, Funcionario, PIS','RELATORIOS','--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\n--LARGURA#300,80,250,150#\r\nSELECT DISTINCT EMP_NOME, FUNC_REG REGISTRO, FUNC_NOME as Nome, FUNC_PIS as PIS\r\nFROM Funcionarios\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nINNER JOIN Calculo ON CAL_FUNC = FUNC_IND\r\nwhere dbo.fn_departamentopertencente( FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1\r\norder BY EMP_NOME, FUNC_NOME','Gabriel','2018-09-26 18:27:05'),(515,'RelatÃ³rio Registro, Nome , Setor, Justificativa, Valor, Data, Abonado Em, Total','RELATORIOS','--LARGURA#50,150,150, 80, 80, 150, 150, 150#\r\nSELECT FUNC_REG As Matricula,\r\nFUNC_NOME AS Nome, EMP_NOME AS Setor, JUS_DATA as Data,dbo.fn_gettime5nullzero(\r\n(CAL_ABONO)) AS Horas, JUS_DESCRICAO as Justificativa, JUS_ABONADOEM AS \'Abonado em\'\r\nFROM Justificativas\r\nINNER JOIN Funcionarios ON FUNC_IND = JUS_FUNC\r\nINNER JOIN Calculo ON CAL_FUNC = JUS_FUNC AND CAL_DATA = JUS_DATA\r\nLEFT JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nWHERE JUS_DATA >= %DATAINICIAL% AND JUS_DATA <= %DATAFINAL% ORDER BY\r\nFUNC_NOME','Gabriel','2018-09-26 18:27:12'),(516,'RelatÃ³rio registro, nome, cargo,admissao,pis,cargo por departamento','RELATORIOS','SELECT FUNC_NOME as NOME, FUNC_REG as REGISTRO, CAR_DESCRICAO as CARGO, FUNC_DT_ADM, FUNC_PIS as PIS\r\nFROM Funcionarios\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:27:23'),(517,'RelatÃ³rio registro, nome, cargo,admissao,pis,cargo','RELATORIOS','SELECT FUNC_NOME as NOME, FUNC_REG as REGISTRO, CAR_DESCRICAO as CARGO, FUNC_DT_ADM, FUNC_PIS as PIS\r\nFROM Funcionarios\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 18:27:34'),(518,'RelatÃ³rio registro,nome,cargo,departamento,variaveis','RELATORIOS','SELECT FUNC_REG as Registro, FUNC_NOME as Nome, CAR_DESCRICAO as Cargo, EMP_NOME as Setor,\r\nSUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 ELSE 0 END) as Faltas,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_FALTAHORA))) as \'Faltas Hora\',\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DESCONTO - CAL_FALTAHORA))) as Desconto,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_NOTURNO))) as Noturno,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DSR))) as Dsr,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRA))) as \'Extra 50%\',\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRAF))) as \'Extra 100%\'\r\nFROM Funcionarios\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nINNER JOIN Calculo ON CAL_FUNC = FUNC_IND\r\nWHERE CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%\r\nGROUP BY FUNC_REG, FUNC_NOME, CAR_DESCRICAO, EMP_NOME\r\n','Gabriel','2018-09-26 18:28:09'),(519,'RelatÃ³rio registro,nome,cargo,departamento','RELATORIOS','SELECT FUNC_REG as Registro, FUNC_NOME as Nome, CAR_DESCRICAO as Cargo, EMP_NOME as Setor,\r\nSUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 ELSE 0 END) as Faltas,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_FALTAHORA))) as \'Faltas Hora\',\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DESCONTO - CAL_FALTAHORA))) as Desconto,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_NOTURNO))) as Noturno,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DSR))) as Dsr,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRA))) as \'Extra 50%\',\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRA))) as \'Extra 75%\',\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRAF))) as \'Extra 100%\'\r\nFROM Funcionarios\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nINNER JOIN Calculo ON CAL_FUNC = FUNC_IND\r\nWHERE CAL_DATA > = \'21/11/2016\' AND CAL_DATA <= \'30/11/2016\'\r\nGROUP BY FUNC_REG, FUNC_NOME, CAR_DESCRICAO, EMP_NOME','Gabriel','2018-09-26 19:56:30'),(520,'RelatÃ³rio saidas antecipadas, atrasos na entrada','RELATORIOS','--LARGURA#220, 100, 100#\r\nSELECT FUNC_NOME AS NOME,\r\nISNULL((SELECT dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(PAPO_ATRASO4_FIM -\r\nPAPO_ATRASO4_INICIO)))) FROM\r\nPreAponta WHERE PAPO_FUNC = FUNC_IND AND PAPO_DATA >= %DATAINICIAL%\r\nAND\r\nPAPO_DATA <= %DATAFINAL%), \'\') AS \'SaÃ­da atecipadas\',\r\n\r\nISNULL((SELECT dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(PAPO_ATRASO1_FIM - PAPO_ATRASO1_INICIO)\r\n) )) FROM\r\nPreAponta WHERE PAPO_FUNC = FUNC_IND AND PAPO_ATRASO1_FIM IS NOT NULL\r\nAND  PAPO_DATA >= %DATAINICIAL% AND\r\nPAPO_DATA <= %DATAFINAL%), \'\') AS \'Atrasos na entrada\',\r\n\r\n(SELECT dbo.fn_hourlongnullzero(SUM(CASE WHEN CAL_FALTAHORA > \r\n0 THEN 1 ELSE 0 END))\r\nFROM Calculo WHERE CAL_FUNC = FUNC_IND AND CAL_DATA >=\r\n%DATAINICIAL% AND\r\nCAL_DATA <= %DATAFINAL%) AS Faltas,\r\n\r\nISNULL((SELECT dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_ABONO)))) FROM\r\nCalculo WHERE CAL_FUNC = FUNC_IND AND CAL_DATA >= %DATAINICIAL% AND\r\nCAL_DATA <= %DATAFINAL%), \'\') AS Abono,\r\n\r\nISNULL((SELECT dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_DESCONTO - CAL_FALTAHORA)))) FROM\r\nCalculo WHERE CAL_FUNC = FUNC_IND AND CAL_DATA >= %DATAINICIAL% AND\r\nCAL_DATA <= %DATAFINAL%), \'\') AS Total\r\nFROM Funcionarios\r\nWHERE FUNC_DT_DEM IS NULL AND dbo.fn_departamentopertencente\r\n(FUNC_EMPRESA,\r\n%DEPSELECIONADOIND%) = 1\r\nORDER BY FUNC_NOME\r\n','Gabriel','2018-09-26 19:56:40'),(521,'Relatorio sistema Passfinger','RELATORIOS','declare @func varchar(5) = \';\'\r\nSELECT DISTINCT FUNC_REG, @func, FUNC_NOME, @func, FUNC_PIS, @func, (select top 1 CRA_NUMERO from crachas where CRA_FUNC = FUNC_IND )\r\nFROM FUNCIONARIOS\r\nINNER JOIN CRACHAS ON CRA_FUNC = FUNC_IND \r\nwhere FUNC_MARCADO_EXCLUSAO = 0 and FUNC_PIS is not null\r\norder by func_nome, FUNC_PIS','Gabriel','2018-09-26 19:56:51'),(522,'RelatÃ³rio Todas as justificativa + total','RELATORIOS','--LARGURA#200,200,200#\r\nSELECT COALESCE([JUS_DESCRICAO],\'Todos\') AS \'Justificativa\', \r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute\r\n(CAL_ABONO))) AS Valor                              \r\nFROM        Justificativas\r\nINNER JOIN Funcionarios ON FUNC_IND = JUS_FUNC\r\nINNER JOIN Calculo ON CAL_FUNC = FUNC_IND AND CAL_DATA = JUS_DATA\r\nWHERE\r\nJUS_DATA >= %DATAINICIAL% AND JUS_DATA <= %DATAFINAL%\r\nGROUP BY CUBE ([JUS_DESCRICAO])','Gabriel','2018-09-26 19:57:03'),(523,'Relatorio total do banco de horas da empresa','RELATORIOS','--LARGURA#200,65,65,65,80#           \r\nSELECT  EMP_Nome Empresa,\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR))) FROM BcoHoras\r\nWHERE  EMP_IND = FUNC_EMPRESA and BCO_FUNC = FUNC_IND AND BCO_DATA >= %DATAINICIAL% AND BCO_DATA <= %DATAFINAL%\r\nAND SUBSTRING(BCO_VALOR, 1, 1) <> \'-\') AS CREDITO,\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR))) FROM BcoHoras\r\nWHERE EMP_IND = FUNC_EMPRESA and BCO_FUNC = FUNC_IND AND BCO_DATA >= %DATAINICIAL% AND BCO_DATA <= %DATAFINAL%\r\nAND SUBSTRING(BCO_VALOR, 1, 1) = \'-\') AS DEBITO,\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR)))\r\nFROM BcoHoras WHERE EMP_IND = FUNC_EMPRESA and BCO_FUNC = FUNC_IND  AND BCO_DATA >= %DATAINICIAL% AND BCO_DATA <= %DATAFINAL%), \'\') AS \r\n\'SALDO MES\',  \r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR)))\r\nFROM BcoHoras WHERE EMP_IND = FUNC_EMPRESA and BCO_FUNC = FUNC_IND  AND BCO_DATA <= %DATAFINAL% ), \'\') AS \'SALDO TOTAL\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nINNER join BcoHoras on  BCO_FUNC = FUNC_IND\r\n\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND BCO_DATA >= %DATAINICIAL% AND BCO_DATA <= %DATAFINAL%\r\n\r\ngroup by EMP_Nome,EMP_IND,FUNC_EMPRESA, FUNC_IND                                  \r\n                                                                            \r\nOrder By EMP_Nome','Gabriel','2018-09-26 19:57:37'),(524,'Relatorio Total Horas Trabalhadas ','RELATORIOS','SELECT FUNC_NOME AS NOME,\r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_TRAB)))), \'\') AS TRAB,\r\n\r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_TRAB)))), \'\') AS TOTAL\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nWHERE CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL% AND\r\nFUNC_DT_DEM IS NULL AND dbo.fn_departamentopertencente\r\n(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1\r\nGROUP BY FUNC_NOME','Gabriel','2018-09-26 19:57:46'),(525,'Relatorio Total Horas Trabalhadas + Extra','RELATORIOS','SELECT FUNC_NOME AS NOME,\r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_TRAB)))), \'\') AS TRAB,\r\n\r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_EXTRA + CAL_EXTRAF + CAL_EXTRAN +\r\nCAL_EXTRANF)))), \'\') AS EXTRAS,\r\n\r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_EXTRA + CAL_EXTRAF + CAL_EXTRAN +\r\nCAL_EXTRANF + CAL_TRAB)))), \'\') AS TOTAL\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nWHERE CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL% AND\r\nFUNC_DT_DEM IS NULL AND dbo.fn_departamentopertencente\r\n(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1\r\nGROUP BY FUNC_NOME','Gabriel','2018-09-26 19:57:57'),(526,'Relatorio Total Horas Trabalhadas por Empresa','RELATORIOS','--LARGURA#200,100,100#\r\n--TITULO#Horas Trabalhadas Por Empresa - Testar#\r\nDECLARE @DATAINICIAL SMALLDATETIME = %DATAINICIAL%,\r\n        @DATAFINAL SMALLDATETIME = %DATAFINAL%,\r\n        @DEPSELECIONADOIND INT = %DEPSELECIONADOIND%\r\n--DECLARE @DATAINICIAL SMALLDATETIME = \'01/11/2015\',\r\n--        @DATAFINAL SMALLDATETIME = \'30/11/2015\',\r\n--        @DEPSELECIONADOIND INT = 1\r\n\r\nSELECT EMP_NOME AS NOME,\r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_TRAB)))), \'\') AS TRAB,\r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR)))), \'\') AS TOTAL\r\nFROM Funcionarios \r\nLEFT JOIN Calculo ON FUNC_IND = CAL_FUNC \r\nINNER JOIN Empresas ON FUNC_EMPRESA = EMP_IND \r\nLEFT JOIN BcoHoras ON FUNC_IND = BCO_FUNC \r\nWHERE CAL_DATA >= @DATAINICIAL AND CAL_DATA <= @DATAFINAL AND \r\n      BCO_DATA >= @DATAINICIAL AND BCO_DATA <= @DATAFINAL AND \r\n      FUNC_DT_DEM IS NULL AND \r\n      dbo.fn_departamentopertencente(FUNC_EMPRESA, @DEPSELECIONADOIND) = 1 \r\nGROUP BY EMP_NOME','Gabriel','2018-09-26 19:58:18'),(527,'RelatÃ³rio TotalizaÃ§Ã£o de descontos no perÃ­odo atual','RELATORIOS','--LARGURA#400#\r\nSELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute\r\n(CAL_DESCONTO))) AS \'Total de Descontos\' FROM Calculo WHERE CAL_DATA\r\n>= %DATAINICIAL% AND\r\nCAL_DATA <= %DATAFINAL% AND CAL_DESCONTO > 0 AND CAL_FALTAHORA = 0','Gabriel','2018-09-26 19:59:09'),(528,'RELATORIO TOTALIZADO REGISTRO, CREDITO, DEBITO, SALDO, EXTRAS, ATRASOS, FALTAS, NOTURO','RELATORIOS','--GRUPOQUEBRA#0#\r\n--ORIENTACAO#paisagem#\r\n--LARGURA#200,45,200,50,50,50,50,50,50,50#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\nSELECT DISTINCT EMP_Nome Empresa, FUNC_REG REGISTRO, FUNC_NOME \'Nome\',            \r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRA))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL% AND CAL_EXTRA > 0 ),\'\') as \'Extras\',\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRAn))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL% AND CAL_EXTRAn > 0 ),\'\') as \'ExtraN\',\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRAF))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL% AND CAL_EXTRAF > 0 ),\'\') as \'ExtraF\', \r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRANF))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL% AND CAL_EXTRANF > 0 ),\'\') as \'ExtraFN\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_NOTURNO))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL% AND CAL_NOTURNO > 0 ),\'\')  as Noturno,\r\n                                                             \r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DESCONTO - CAL_FALTAHORA))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL% AND CAL_DESCONTO - CAL_FALTAHORA > 0 ),\'\') as Atrasos,\r\n\r\nSUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 ELSE 0 END) as Faltas,\r\n                                                                                                         \r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA >= %DATAINICIAL% AND BCO_DATA <= %DATAFINAL%\r\nAND SUBSTRING(BCO_VALOR, 1, 1) <> \'-\') AS Credito,  \r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA >= %DATAINICIAL% AND BCO_DATA <= %DATAFINAL%                                                        \r\nAND SUBSTRING(BCO_VALOR, 1, 1) = \'-\') AS Debito, \r\n                                                                                                      \r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR)))\r\nFROM BcoHoras WHERE BCO_FUNC = FUNC_IND  AND BCO_DATA <= %DATAFINAL% ), \'\') AS \'Saldo Atual\' \r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC \r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nleft join BcoHoras on  BCO_FUNC = FUNC_IND and CAL_DATA = BCO_DATA                                                                         \r\n           \r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%\r\n\r\ngroup by FUNC_NOME,EMP_Nome,FUNC_IND,FUNC_REG                                   \r\n                                                                            \r\nOrder By EMP_Nome, FUNC_NOME','Gabriel','2018-09-26 19:59:20'),(529,'RelatÃ³rio Trab por Funcionario','RELATORIOS','DECLARE @DATAINICIAL DATE, @DATAFINAL DATE, @MOTIVO NVARCHAR(MAX)\r\nSET @DATAINICIAL = %DATAINICIAL%\r\nSET @DATAFINAL = %DATAFINAL%\r\n\r\nSELECT FUNC_NOME,\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_TRAB))) FROM Calculo WHERE\r\nCAL_FUNC = FUNC_IND AND CAL_DATA >= @DATAINICIAL AND CAL_DATA <=\r\n@DATAFINAL), \'\') AS Trab\r\nFROM Funcionarios\r\nWHERE ISNULL((SELECT dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_TRAB))) FROM Calculo WHERE\r\nCAL_FUNC = FUNC_IND AND CAL_DATA >= @DATAINICIAL AND CAL_DATA <=\r\n@DATAFINAL), \'0:00\') <> \'0:00\'\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 19:59:31'),(530,'Relatorio Trabalharam mais que 6 dias','RELATORIOS','--LARGURA#200,200,50,200,50#\r\n--TITULO#Dias Trabalhados > 6 por FuncionÃ¡rio - Testar#\r\nDECLARE @DATAINICIAL SMALLDATETIME = %DATAINICIAL%,\r\n        @DATAFINAL SMALLDATETIME = %DATAFINAL%\r\n\r\nSELECT A.EMP_NOME AS Empresa, B.EMP_NOME AS Departamento, FUNC_REG AS Registro, FUNC_NOME as Nome, D.Dias\r\nFROM Funcionarios\r\nINNER JOIN Empresas A ON A.EMP_IND = FUNC_EMPRESA\r\nINNER JOIN Empresas B ON B.EMP_IND = DBO.fn_getempresafuncionario(FUNC_IND)\r\nOUTER APPLY(\r\n    SELECT COUNT(*) as Dias FROM Calculo\r\n        WHERE CAL_TRAB > 0 AND CAL_FUNC = FUNC_IND AND CAL_DATA >= @DATAINICIAL AND CAL_DATA <= @DATAFINAL\r\n) D\r\nWHERE D.Dias > 6\r\nORDER BY FUNC_NOME','Gabriel','2018-09-26 20:00:17'),(531,'RelatÃ³rio variaveis por periodo','RELATORIOS','CREATE TABLE #dbtFuncionarios (\r\n    FUNC INT\r\n    ) ON [PRIMARY]\r\nINSERT INTO #dbtFuncionarios\r\nSELECT FUNC_IND FROM Funcionarios WHERE\r\ndbo.fn_departamentopertencente(FUNC_EMPRESA,  %DEPSELECIONADOIND%) = 1\r\nEXEC rst_relatorios_variaveis\r\n@P_DATAINICIAL = \'01/11/2016\',\r\n@P_DATAFINAL = \'11/11/2016\',\r\n@P_DEPTO = NULL,\r\n@P_CLASSIFICACAO = 0\r\nDROP TABLE #dbtFuncionarios','Gabriel','2018-09-26 20:00:28'),(532,'Relatorio-extras-anual','RELATORIOS','declare @ano int = 0, \r\n		@data datetime,\r\n		@datainicial datetime = %DATAINICIAL%\r\n\r\nif (@ano = 0)\r\nbegin \r\n	set @data = @datainicial\r\nend else begin \r\n	set @data = convert(datetime, \'01/01/\' + convert(varchar(4), @ano))\r\nend\r\n\r\nif exists(select * from tempdb.sys.objects where name like \'#rel%\')\r\n	drop table #rel\r\ncreate table #rel(\r\n	Indice int, \r\n	Registro int, \r\n	Nome varchar(100), \r\n	Setor varchar(100), \r\n	Mes int, \r\n	Ano int, \r\n	Minutos int, \r\n	Horas varchar(10)\r\n);\r\n\r\ninsert into #rel (Indice, Registro, Nome, Setor, Mes, Ano, Minutos) \r\nselect FUNC_IND, FUNC_REG, FUNC_NOME, EMP_NOME, datepart(MONTH, CAL_DATA), datepart(YEAR, CAL_DATA), \r\nsum(((datepart(hour, CAL_EXTRA) + datepart(hour, CAL_EXTRAN) + datepart(hour, CAL_EXTRAF) + datepart(hour, CAL_EXTRANF)) * 60) + \r\n     (datepart(minute, CAL_EXTRA) + datepart(minute, CAL_EXTRAN) + datepart(minute, CAL_EXTRAF) + datepart(minute, CAL_EXTRANF))) as MINUTOS\r\nfrom Funcionarios \r\ninner join Calculo on FUNC_IND = CAL_FUNC \r\ninner join Empresas on FUNC_EMPRESA = EMP_IND\r\nwhere datepart(YEAR, CAL_DATA) = datepart(YEAR, @data) \r\ngroup by FUNC_IND, FUNC_REG, FUNC_NOME, EMP_NOME, datepart(MONTH, CAL_DATA), datepart(YEAR, CAL_DATA)\r\norder by EMP_NOME, FUNC_NOME\r\n\r\n--select * from rel\r\n\r\ndeclare @i1 int = 0, \r\n		@i2 int = 0\r\n\r\nwhile exists(select * from #rel where Indice >= @i1)\r\nbegin\r\n	if exists(select * from #rel where Indice = @i1)\r\n	begin\r\n		while exists(select * from #rel where Indice = @i1 and Mes >= @i2)\r\n		begin\r\n			if exists(select * from #rel where Indice = @i1 and Mes = @i2)\r\n			begin \r\n				declare @hora varchar(100), \r\n						@minuto varchar(100), \r\n						@minutos int\r\n\r\n				select @minutos = Minutos from #rel where Indice = @i1 and Mes = @i2\r\n				set @hora = convert(varchar(10), (@minutos / 60))\r\n				set @minuto = convert(varchar(10), (@minutos % 60))\r\n		\r\n				if len(@hora) = 1\r\n					set @hora = \'0\' + @hora\r\n				if len(@minuto) = 1\r\n					set @minuto = \'0\' + @minuto\r\n\r\n				update #Rel \r\n				set Horas = @hora + \':\' + @minuto\r\n				where Indice = @i1 and Mes = @i2\r\n			end \r\n			set @i2 = @i2 + 1\r\n		end \r\n	end\r\n	set @i2 = 0\r\n	set @i1 = @i1 + 1\r\nend\r\n\r\n--Horas extras por pessoa\r\nselect Registro, Nome, Setor, \r\ncase when len(convert(varchar(10), (sum(case when Mes = 1 then Minutos else 0 end) / 60))) = 1\r\n	 then \'0\' + convert(varchar(10), (sum(case when Mes = 1 then Minutos else 0 end) / 60)) \r\n	 else convert(varchar(10), (sum(case when Mes = 1 then Minutos else 0 end) / 60)) end + \':\' + \r\ncase when len(convert(varchar(10), (sum(case when Mes = 1 then Minutos else 0 end) % 60))) = 1 \r\n	 then \'0\' + convert(varchar(10), (sum(case when Mes = 1 then Minutos else 0 end) % 60)) \r\n	 else convert(varchar(10), (sum(case when Mes = 1 then Minutos else 0 end) % 60)) end as \'Jan\', \r\n\r\ncase when len(convert(varchar(10), (sum(case when Mes = 2 then Minutos else 0 end) / 60))) = 1\r\n	 then \'0\' + convert(varchar(10), (sum(case when Mes = 2 then Minutos else 0 end) / 60)) \r\n	 else convert(varchar(10), (sum(case when Mes = 2 then Minutos else 0 end) / 60)) end + \':\' + \r\ncase when len(convert(varchar(10), (sum(case when Mes = 2 then Minutos else 0 end) % 60))) = 1 \r\n	 then \'0\' + convert(varchar(10), (sum(case when Mes = 2 then Minutos else 0 end) % 60)) \r\n	 else convert(varchar(10), (sum(case when Mes = 2 then Minutos else 0 end) % 60)) end as \'Fev\', \r\n\r\ncase when len(convert(varchar(10), (sum(case when Mes = 3 then Minutos else 0 end) / 60))) = 1\r\n	 then \'0\' + convert(varchar(10), (sum(case when Mes = 3 then Minutos else 0 end) / 60)) \r\n	 else convert(varchar(10), (sum(case when Mes = 3 then Minutos else 0 end) / 60)) end + \':\' + \r\ncase when len(convert(varchar(10), (sum(case when Mes = 3 then Minutos else 0 end) % 60))) = 1 \r\n	 then \'0\' + convert(varchar(10), (sum(case when Mes = 3 then Minutos else 0 end) % 60)) \r\n	 else convert(varchar(10), (sum(case when Mes = 3 then Minutos else 0 end) % 60)) end as \'Mar\', \r\n\r\ncase when len(convert(varchar(10), (sum(case when Mes = 4 then Minutos else 0 end) / 60))) = 1\r\n	 then \'0\' + convert(varchar(10), (sum(case when Mes = 4 then Minutos else 0 end) / 60)) \r\n	 else convert(varchar(10), (sum(case when Mes = 4 then Minutos else 0 end) / 60)) end + \':\' + \r\ncase when len(convert(varchar(10), (sum(case when Mes = 4 then Minutos else 0 end) % 60))) = 1 \r\n	 then \'0\' + convert(varchar(10), (sum(case when Mes = 4 then Minutos else 0 end) % 60)) \r\n	 else convert(varchar(10), (sum(case when Mes = 4 then Minutos else 0 end) % 60)) end as \'Abr\', \r\n\r\ncase when len(convert(varchar(10), (sum(case when Mes = 5 then Minutos else 0 end) / 60))) = 1\r\n	 then \'0\' + convert(varchar(10), (sum(case when Mes = 5 then Minutos else 0 end) / 60)) \r\n	 else convert(varchar(10), (sum(case when Mes = 5 then Minutos else 0 end) / 60)) end + \':\' + \r\ncase when len(convert(varchar(10), (sum(case when Mes = 5 then Minutos else 0 end) % 60))) = 1 \r\n	 then \'0\' + convert(varchar(10), (sum(case when Mes = 5 then Minutos else 0 end) % 60)) \r\n	 else convert(varchar(10), (sum(case when Mes = 5 then Minutos else 0 end) % 60)) end as \'Mai\', \r\n\r\ncase when len(convert(varchar(10), (sum(case when Mes = 6 then Minutos else 0 end) / 60))) = 1\r\n	 then \'0\' + convert(varchar(10), (sum(case when Mes = 6 then Minutos else 0 end) / 60)) \r\n	 else convert(varchar(10), (sum(case when Mes = 6 then Minutos else 0 end) / 60)) end + \':\' + \r\ncase when len(convert(varchar(10), (sum(case when Mes = 6 then Minutos else 0 end) % 60))) = 1 \r\n	 then \'0\' + convert(varchar(10), (sum(case when Mes = 6 then Minutos else 0 end) % 60)) \r\n	 else convert(varchar(10), (sum(case when Mes = 6 then Minutos else 0 end) % 60)) end as \'Jun\', \r\n\r\ncase when len(convert(varchar(10), (sum(case when Mes = 7 then Minutos else 0 end) / 60))) = 1\r\n	 then \'0\' + convert(varchar(10), (sum(case when Mes = 7 then Minutos else 0 end) / 60)) \r\n	 else convert(varchar(10), (sum(case when Mes = 7 then Minutos else 0 end) / 60)) end + \':\' + \r\ncase when len(convert(varchar(10), (sum(case when Mes = 7 then Minutos else 0 end) % 60))) = 1 \r\n	 then \'0\' + convert(varchar(10), (sum(case when Mes = 7 then Minutos else 0 end) % 60)) \r\n	 else convert(varchar(10), (sum(case when Mes = 7 then Minutos else 0 end) % 60)) end as \'Jul\', \r\n\r\ncase when len(convert(varchar(10), (sum(case when Mes = 8 then Minutos else 0 end) / 60))) = 1\r\n	 then \'0\' + convert(varchar(10), (sum(case when Mes = 8 then Minutos else 0 end) / 60)) \r\n	 else convert(varchar(10), (sum(case when Mes = 8 then Minutos else 0 end) / 60)) end + \':\' + \r\ncase when len(convert(varchar(10), (sum(case when Mes = 8 then Minutos else 0 end) % 60))) = 1 \r\n	 then \'0\' + convert(varchar(10), (sum(case when Mes = 8 then Minutos else 0 end) % 60)) \r\n	 else convert(varchar(10), (sum(case when Mes = 8 then Minutos else 0 end) % 60)) end as \'Ago\', \r\n\r\ncase when len(convert(varchar(10), (sum(case when Mes = 9 then Minutos else 0 end) / 60))) = 1\r\n	 then \'0\' + convert(varchar(10), (sum(case when Mes = 9 then Minutos else 0 end) / 60)) \r\n	 else convert(varchar(10), (sum(case when Mes = 9 then Minutos else 0 end) / 60)) end + \':\' + \r\ncase when len(convert(varchar(10), (sum(case when Mes = 9 then Minutos else 0 end) % 60))) = 1 \r\n	 then \'0\' + convert(varchar(10), (sum(case when Mes = 9 then Minutos else 0 end) % 60)) \r\n	 else convert(varchar(10), (sum(case when Mes = 9 then Minutos else 0 end) % 60)) end as \'Set\', \r\n\r\ncase when len(convert(varchar(10), (sum(case when Mes = 10 then Minutos else 0 end) / 60))) = 1\r\n	 then \'0\' + convert(varchar(10), (sum(case when Mes = 10 then Minutos else 0 end) / 60)) \r\n	 else convert(varchar(10), (sum(case when Mes = 10 then Minutos else 0 end) / 60)) end + \':\' + \r\ncase when len(convert(varchar(10), (sum(case when Mes = 10 then Minutos else 0 end) % 60))) = 1 \r\n	 then \'0\' + convert(varchar(10), (sum(case when Mes = 10 then Minutos else 0 end) % 60)) \r\n	 else convert(varchar(10), (sum(case when Mes = 10 then Minutos else 0 end) % 60)) end as \'Out\', \r\n\r\ncase when len(convert(varchar(10), (sum(case when Mes = 11 then Minutos else 0 end) / 60))) = 1\r\n	 then \'0\' + convert(varchar(10), (sum(case when Mes = 11 then Minutos else 0 end) / 60)) \r\n	 else convert(varchar(10), (sum(case when Mes = 11 then Minutos else 0 end) / 60)) end + \':\' + \r\ncase when len(convert(varchar(10), (sum(case when Mes = 11 then Minutos else 0 end) % 60))) = 1 \r\n	 then \'0\' + convert(varchar(10), (sum(case when Mes = 11 then Minutos else 0 end) % 60)) \r\n	 else convert(varchar(10), (sum(case when Mes = 11 then Minutos else 0 end) % 60)) end as \'Nov\', \r\n\r\ncase when len(convert(varchar(10), (sum(case when Mes = 12 then Minutos else 0 end) / 60))) = 1\r\n	 then \'0\' + convert(varchar(10), (sum(case when Mes = 12 then Minutos else 0 end) / 60)) \r\n	 else convert(varchar(10), (sum(case when Mes = 12 then Minutos else 0 end) / 60)) end + \':\' + \r\ncase when len(convert(varchar(10), (sum(case when Mes = 12 then Minutos else 0 end) % 60))) = 1 \r\n	 then \'0\' + convert(varchar(10), (sum(case when Mes = 12 then Minutos else 0 end) % 60)) \r\n	 else convert(varchar(10), (sum(case when Mes = 12 then Minutos else 0 end) % 60)) end as \'Dez\' , \r\n\r\ncase when len(convert(varchar(10), (sum(Minutos) / 60))) = 1\r\n	 then \'0\' + convert(varchar(10), (sum(Minutos) / 60)) \r\n	 else convert(varchar(10), (sum(Minutos) / 60)) end + \':\' + \r\ncase when len(convert(varchar(10), (sum(Minutos) % 60))) = 1 \r\n	 then \'0\' + convert(varchar(10), (sum(Minutos) % 60)) \r\n	 else convert(varchar(10), (sum(Minutos) % 60)) end as \'Total\' \r\nfrom #rel\r\nwhere Minutos > 0\r\ngroup by Registro, Nome, Setor\r\norder by Setor, Nome\r\ndrop table #rel','Gabriel','2018-09-26 20:00:42'),(533,'Relatorios de afastamentos','RELATORIOS','--LARGURA#200,200, 80, 80#\r\nSELECT FUNC_NOME AS NOME, AFA_DESCRICAO_ESPELHO AS MOTIVO, AFA_DATA1\r\nAS INICIO, AFA_DATA2 AS FINAL FROM\r\nFuncionarios INNER JOIN\r\nAfastamentos ON AFA_FUNC = FUNC_IND WHERE AFA_DATA1 >= \'1/1/2014\' AND\r\ndbo.fn_departamentopertencente(FUNC_EMPRESA,\r\n%DEPSELECIONADOIND%) = 1 ORDER BY FUNC_NOME','Gabriel','2018-09-26 20:00:53'),(534,'Relatorios de Total Trabalhado e Banco de horas Negativo','RELATORIOS','--LARGURA#200,100,100#\r\n--TITULO#Horas Trabalhadas Por Empresa - Testar#\r\nDECLARE @DATAINICIAL SMALLDATETIME = \'01/01/2017\',\r\n        @DATAFINAL SMALLDATETIME = \'31/01/2017\',\r\n        @DEPSELECIONADOIND INT = %DEPSELECIONADOIND%\r\n\r\nselect e.EMP_NOME as Nome, a.ATRAB, b.DEBITO \r\nfrom Empresas e\r\nouter apply(\r\n    select ISNULL(dbo.fn_hourlongnullzero(\r\n            dbo.fn_minutetohourlong(\r\n             (SUM(dbo.fn_smalldatetimetominute(c.CAL_ATRB))))), \'\') as ATRAB\r\n    from Calculo c \r\n    inner join Funcionarios f on c.CAL_FUNC = f.FUNC_IND\r\n    inner join Empresas es on es.EMP_IND = f.FUNC_EMPRESA \r\n    where es.EMP_IND = e.EMP_IND and f.FUNC_DT_DEM is null and\r\n          c.CAL_DATA >= @DATAINICIAL and c.CAL_DATA <= @DATAFINAL \r\n) a\r\nouter apply(\r\n    select dbo.fn_minutetohourlong(\r\n        (SUM(dbo.fn_hourlongtominute(b.BCO_VALOR)))) as DEBITO\r\n    from BcoHoras b\r\n    inner join Funcionarios f on b.BCO_FUNC = f.FUNC_IND \r\n    inner join Empresas es on es.EMP_IND = f.FUNC_EMPRESA \r\n    where es.EMP_IND = e.EMP_IND and f.FUNC_DT_DEM is null and SUBSTRING(b.BCO_VALOR, 1, 1) = \'-\' and\r\n          b.BCO_DATA >= @DATAINICIAL and b.BCO_DATA <= @DATAFINAL\r\n) b \r\nwhere dbo.fn_departamentopertencente(e.EMP_IND, @DEPSELECIONADOIND) = 1 \r\nand a.ATRAB != \'\' and b.DEBITO != \'\'','Gabriel','2018-09-26 20:01:05'),(535,'RelatÃ³rios ferias concessivo e aquisitiva','RELATORIOS','SELECT FUNC_REG As Matricula, FUNC_NOME AS Nome, EMP_NOME AS SETOR,\r\nCAR_DESCRICAO AS FUNCAO, FER_DATA1 as \'Data Inicio das FÃ©rias\',\r\nFER_DATA2 as \'Data Fim das FÃ©rias\'\r\nFROM Funcionarios\r\nINNER JOIN Ferias ON FER_FUNC = FUNC_IND\r\nLEFT JOIN Cargos ON FUNC_CARGO = CAR_IND\r\nLEFT JOIN Empresas ON Empresas.EMP_IND = FuncIONARIOS.FUNC_EMPRESA\r\nWHERE dbo.fn_periodo_esta_contido(FER_DATA1, FER_DATA2,\r\n\'01/01/2015\',\'01/06/2015\') = 1 AND dbo.fn_departamentopertencente\r\n(FUNC_EMPRESA,\r\n%DEPSELECIONADOIND%) = 1\r\nORDER BY FUNC_REG, FUNC_NOME','Gabriel','2018-09-26 20:01:15'),(536,'RelatÃ³rios FuncionÃ¡rio e PIS','RELATORIOS','Select func_nome,  \r\nfunc_pis  from funcionarios\r\norder by func_nome','Gabriel','2018-09-26 20:01:26'),(537,'RelatÃ³rios FuncionÃ¡rio Nome, Cargo, Pis (Ativos e Inativos)','RELATORIOS','--LARGURA# 50, 200, 150, 100, 100#\r\nSELECT  FUNC_REG AS\r\nREGISTRO, FUNC_NOME AS NOME, CAR_DESCRICAO AS CARGO, FUNC_PIS AS PIS,\r\nFUNC_DT_ADM AS ADMISSAO, FUNC_DT_DEM AS DEMISSAO\r\nFROM Funcionarios\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nORDER BY FUNC_DT_DEM, FUNC_DT_ADM, FUNC_NOME\r\n','Gabriel','2018-09-26 20:01:36'),(538,'RelatÃ³rios Funcionario, Domingos e Feriados por Departamento','RELATORIOS','SELECT FUNC_NOME AS Nome, COUNT(*)  AS Domingos\r\n\r\nFROM Funcionarios\r\n\r\nINNER JOIN Calculo ON CAL_FUNC = FUNC_IND\r\n\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\n\r\nWHERE EMP_COD LIKE \'%DEPSELECIONADO%%\'\r\n\r\nAND (DATEPART(WEEKDAY, CAL_DATA) = 1 OR dbo.fn_data_eh_feriado(CAL_FUNC, CAL_DATA) = 1) AND CAL_DATA >= %DATAINICIAL%\r\n\r\nAND CAL_DATA <= %DATAFINAL% AND\r\n\r\n(CAL_TRAB > 0 OR CAL_EXTRA > 0 OR CAL_EXTRAF > 0)\r\n\r\nGROUP BY FUNC_NOME\r\n','Gabriel','2018-09-26 20:01:47'),(539,'RelatÃ³rios Funcionario, Domingos por Departamento','RELATORIOS','SELECT FUNC_NOME AS Nome, COUNT(*) AS Domingos\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON CAL_FUNC = FUNC_IND\r\nWHERE EMP_COD LIKE \'%DEPSELECIONADO%%\'\r\nAND DATEPART(WEEKDAY, CAL_DATA) = 1 AND CAL_DATA >= %DATAINICIAL%\r\nAND CAL_DATA <= %DATAFINAL% AND\r\n(CAL_TRAB > 0 OR CAL_EXTRA > 0 OR CAL_EXTRAF > 0)\r\nGROUP BY FUNC_NOME\r\n','Gabriel','2018-09-26 20:01:57'),(540,'RelatÃ³rios funcionario, empresa, dpto e admissÃ£o','RELATORIOS','SELECT FUNC_NOME AS NOME, FUNC_REG AS REGISTRO, EMP_NOME AS EMPRESA,  CRA_NUMERO AS CRACHÃ, FUNC_DT_ADM AS ADMISSAO  FROM FUNCIONARIOS\r\nINNER JOIN EMPRESAS ON  FUNC_EMPRESA = EMP_IND\r\nINNER JOIN CRACHAS ON CRA_FUNC = FUNC_IND','Gabriel','2018-09-26 20:02:07'),(541,'RelatÃ³rios FuncionÃ¡rio, FunÃ§Ã£o, Hora Extra 50%, Hora Extra 100%, Faltas, Descontos, Desconto DDSR, noturno por periodo','RELATORIOS','--LARGURA#100,100,100,100,100,100,100,100,100,100,100#\r\n--COLUNAGRUPO#0#\r\nSELECT RTRIM(FUNC_NOME) + \' (\' + RTRIM(CAR_DESCRICAO) + \')\' AS\r\n\'Nome\',\r\n    dbo.fn_getdate(CAL_DATA) AS \'Data\',\r\n    dbo.fn_gettime5nullzero(CAL_NOTURNO) as \'Noturno\',\r\n    dbo.fn_gettime5nullzero(CAL_EXTRA) as \'Extra\',\r\n    dbo.fn_gettime5nullzero(CAL_EXTRAF) as \'Feriados\',\r\n    (CASE WHEN dbo.fn_faltou(CAL_FALTAHORA) = \'1\' THEN \'Falta\' ELSE\r\n\'\'\r\nEND) as \'Falta Hora\',\r\n    dbo.fn_gettime5nullzero(CAL_DESCONTO) as \'Descontos\',\r\n    dbo.fn_gettime5nullzero(CAL_DDSR) as \'DDSR\'\r\nFROM Calculo\r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nWHERE CAL_NOTURNO > 0 OR CAL_EXTRA > 0 OR\r\n    CAL_EXTRAF > 0 OR CAL_DESCONTO > 0 OR CAL_DDSR > 0\r\n     WHERE CAL_DATA >= \'DIA/MES/ANO\' AND CAL_DATA <= \'DIA/MES/ANO\'','Gabriel','2018-09-26 20:02:16'),(542,'RelatÃ³rios FuncionÃ¡rio, FunÃ§Ã£o, Hora Extra 50%, Hora Extra 100%, Faltas, Descontos, Desconto DDSR, noturno, Escala','RELATORIOS','SELECT FUNC_REG AS Registro, FUNC_NOME AS Nome,\r\nCAR_DESCRICAO AS CARGO, EMP_NOME AS Setor,\r\n\r\nSUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 ELSE 0 END) as Faltas,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute\r\n(CAL_FALTAHORA))) as \'Faltas Hora\',\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DESCONTO\r\n- CAL_FALTAHORA))) as Desconto,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute\r\n(CAL_NOTURNO))) as Noturno,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DSR)))\r\nas Dsr,\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRA)))\r\nas \'Extra 50%\',\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute\r\n(CAL_EXTRAF))) as \'Extra 100%\',\r\nESC_DESCRICAO AS Escala\r\n\r\nFROM Funcionarios\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nINNER JOIN HoraEscala ON HRE_FUNC = FUNC_IND\r\nINNER JOIN Calculo ON CAL_FUNC = FUNC_IND\r\nINNER JOIN Escalas ON ESC_IND = HRE_ESCALA\r\nLEFT JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nWHERE (CAL_NOTURNO > 0 OR CAL_EXTRA > 0 OR CAL_EXTRAF > 0 OR \r\nCAL_DESCONTO > 0 OR CAL_DDSR > 0) AND\r\nCAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%\r\nGROUP BY FUNC_REG, FUNC_NOME, CAR_DESCRICAO, EMP_NOME, ESC_DESCRICAO\r\n\r\n','Gabriel','2018-09-26 20:02:26'),(543,'RelatÃ³rios FuncionÃ¡rio, FunÃ§Ã£o, Hora Extra 50%, Hora Extra 100%, Faltas, Descontos, Desconto DDSR, noturno','RELATORIOS','--LARGURA#100,100,100,100,100,100,100,100,100,100,100#\r\n--COLUNAGRUPO#0#\r\nSELECT RTRIM(FUNC_NOME) + \' (\' + RTRIM(CAR_DESCRICAO) + \')\' AS\r\n\'Nome\',\r\n    dbo.fn_getdate(CAL_DATA) AS \'Data\',\r\n    dbo.fn_gettime5nullzero(CAL_NOTURNO) as \'Noturno\',\r\n    dbo.fn_gettime5nullzero(CAL_EXTRA) as \'Extra\',\r\n    dbo.fn_gettime5nullzero(CAL_EXTRAF) as \'Feriados\',\r\n    (CASE WHEN dbo.fn_faltou(CAL_FALTAHORA) = \'1\' THEN \'Falta\' ELSE\r\n\'\'\r\nEND) as \'Falta Hora\',\r\n    dbo.fn_gettime5nullzero(CAL_DESCONTO) as \'Descontos\',\r\n    dbo.fn_gettime5nullzero(CAL_DDSR) as \'DDSR\'\r\nFROM Calculo\r\nINNER JOIN Funcionarios ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nWHERE CAL_NOTURNO > 0 OR CAL_EXTRA > 0 OR\r\n    CAL_EXTRAF > 0 OR CAL_DESCONTO > 0 OR CAL_DDSR > 0\r\n    AND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%','Gabriel','2018-09-26 20:02:53'),(544,'totalizado em minutos','RELATORIOS','--LARGURA#200,200,50,50,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45#\r\n--GRUPONREGISTROS#0#       \r\n--COLUNAGRUPO#0#\r\n--DECLARE @DATAINICIO SMALLDATETIME = %DATAINICIAL%\r\n\r\nDECLARE @DATAINICIO SMALLDATETIME = \'01/08/2018\'\r\n\r\nSELECT DISTINCT EMP_Nome Empresa,FUNC_NOME \'Nome\',\r\nISNULL(dbo.fn_hourlongtominute(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_TRAB)))), \'\') AS \'H Trab\',\r\nISNULL(dbo.fn_hourlongtominute(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_ATRB)))), \'\') AS \'CargaH\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_TRAB > 0 THEN 1 ELSE 0 END) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= @DATAINICIO AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and (DATEPART(weekday,\r\nCAL_DATA) = 2 or DATEPART(weekday, CAL_DATA) = 3 or DATEPART(weekday, CAL_DATA) = 4 or DATEPART(weekday, CAL_DATA) =\r\n5 or DATEPART(weekday, CAL_DATA) = 6) and CAL_ABONO > 0),\'\') as \'D TRAB SEG/SEXTA\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_TRAB > 0 THEN 1 ELSE 0 END) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= @DATAINICIO AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and\r\n(DATEPART(weekday,CAL_DATA) = 1 or DATEPART(weekday, CAL_DATA) = 7) and CAL_ABONO > 0),\'\') as \'D TRAB SAB/DOM\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_ATRB > 0 THEN 1 ELSE 0 END) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= @DATAINICIO AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and (DATEPART(weekday,\r\nCAL_DATA) = 2 or DATEPART(weekday, CAL_DATA) = 3 or DATEPART(weekday, CAL_DATA) = 4 or DATEPART(weekday, CAL_DATA) =\r\n5 or DATEPART(weekday, CAL_DATA) = 6) and CAL_ABONO > 0),\'\') as \'D ATRAB SEG/SEXTA\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_ATRB > 0 THEN 1 ELSE 0 END) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= @DATAINICIO AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and\r\n(DATEPART(weekday,CAL_DATA) = 1 or DATEPART(weekday, CAL_DATA) = 7) and CAL_ABONO > 0),\'\') as \'D ATRAB SAB/DOM\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 ELSE 0 END) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= @DATAINICIO AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and (DATEPART(weekday,\r\nCAL_DATA) = 2 or DATEPART(weekday, CAL_DATA) = 3 or DATEPART(weekday, CAL_DATA) = 4 or DATEPART(weekday, CAL_DATA) =\r\n5 or DATEPART(weekday, CAL_DATA) = 6) AND CAL_FALTAHORA > 0 ),\'\') as \'FaltasD SEG/SEXTA\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 ELSE 0 END) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= @DATAINICIO AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and\r\n(DATEPART(weekday,CAL_DATA) = 1 or DATEPART(weekday, CAL_DATA) = 7) AND CAL_FALTAHORA > 0 ),\'\') as \'FaltasD SAB/DOM\',\r\n\r\nISNULL((SELECT dbo.fn_hourlongtominute(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_FALTAHORA)))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= @DATAINICIO AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and (DATEPART(weekday,\r\nCAL_DATA) = 2 or DATEPART(weekday, CAL_DATA) = 3 or DATEPART(weekday, CAL_DATA) = 4 or DATEPART(weekday, CAL_DATA) =\r\n5 or DATEPART(weekday, CAL_DATA) = 6) AND CAL_FALTAHORA > 0 ),\'\') as \'FaltasH  SEG/SEXTA\',\r\n\r\nISNULL((SELECT dbo.fn_hourlongtominute(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_FALTAHORA)))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= @DATAINICIO AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and\r\n(DATEPART(weekday,CAL_DATA) = 1 or DATEPART(weekday, CAL_DATA) = 7) AND CAL_FALTAHORA > 0 ),\'\') as \'FaltasH SAB/DOM\',\r\n\r\nISNULL((SELECT SUM(case when CAL_ABONO > 0  THEN 1 ELSE 0 END) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= @DATAINICIO AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and (DATEPART(weekday,\r\nCAL_DATA) = 2 or DATEPART(weekday, CAL_DATA) = 3 or DATEPART(weekday, CAL_DATA) = 4 or DATEPART(weekday, CAL_DATA) =\r\n5 or DATEPART(weekday, CAL_DATA) = 6) and CAL_ABONO > 0),\'\') as \'ABONO SEG/SEXTA\',\r\n\r\nISNULL((SELECT SUM(case when CAL_ABONO > 0  THEN 1 ELSE 0 END) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= @DATAINICIO AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and\r\n(DATEPART(weekday,CAL_DATA) = 1 or DATEPART(weekday, CAL_DATA) = 7) and CAL_ABONO > 0),\'\') as \'ABONO SAB/DOM\',\r\n\r\nISNULL((SELECT dbo.fn_hourlongtominute(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DESCONTO - CAL_FALTAHORA)))) FROM \r\nCALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= @DATAINICIO AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and (DATEPART(weekday,\r\nCAL_DATA) = 2 or DATEPART(weekday, CAL_DATA) = 3 or DATEPART(weekday, CAL_DATA) = 4 or DATEPART(weekday, CAL_DATA) =\r\n5 or DATEPART(weekday, CAL_DATA) = 6) AND CAL_DESCONTO - CAL_FALTAHORA > 0 ),\'\') as \'Atrasos  SEG/SEXTA\',\r\n\r\nISNULL((SELECT dbo.fn_hourlongtominute(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DESCONTO - CAL_FALTAHORA)))) FROM \r\nCALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= @DATAINICIO AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and\r\n(DATEPART(weekday,CAL_DATA) = 1 or DATEPART(weekday, CAL_DATA) = 7) AND CAL_DESCONTO - CAL_FALTAHORA > 0 ),\'\') as \'Atrasos SAB/DOM\',\r\n\r\nISNULL((SELECT dbo.fn_hourlongtominute(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRA + CAL_EXTRAn)))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= @DATAINICIO AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and (DATEPART(weekday,\r\nCAL_DATA) = 2 or DATEPART(weekday, CAL_DATA) = 3 or DATEPART(weekday, CAL_DATA) = 4 or DATEPART(weekday, CAL_DATA) =\r\n5 or DATEPART(weekday, CAL_DATA) = 6) and CAL_EXTRA + CAL_EXTRAn > 0),\'\') as \'Extras SEG/SEXTA\',\r\n\r\nISNULL((SELECT dbo.fn_hourlongtominute(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRA + CAL_EXTRAn)))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= @DATAINICIO AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and\r\n(DATEPART(weekday,CAL_DATA) = 1 or DATEPART(weekday, CAL_DATA) = 7) and CAL_EXTRA + CAL_EXTRAn > 0),\'\') as \'Extras SAB/DOM\',\r\n\r\nISNULL((SELECT dbo.fn_hourlongtominute(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRAF + CAL_EXTRAnF)))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= @DATAINICIO AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and (DATEPART(weekday,\r\nCAL_DATA) = 2 or DATEPART(weekday, CAL_DATA) = 3 or DATEPART(weekday, CAL_DATA) = 4 or DATEPART(weekday, CAL_DATA) =\r\n5 or DATEPART(weekday, CAL_DATA) = 6) and CAL_EXTRAF + CAL_EXTRAnF > 0),\'\') as \'ExtrasF SEG/SEXTA\',\r\n\r\nISNULL((SELECT dbo.fn_hourlongtominute(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRAF + CAL_EXTRAnF)))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= @DATAINICIO AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and\r\n(DATEPART(weekday,CAL_DATA) = 1 or DATEPART(weekday, CAL_DATA) = 7) and CAL_EXTRAF + CAL_EXTRAnF > 0),\'\') as \'Extras SAB/DOM\',\r\n\r\nISNULL((SELECT dbo.fn_hourlongtominute(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_NOTURNO)))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= @DATAINICIO AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and (DATEPART(weekday,\r\nCAL_DATA) = 2 or DATEPART(weekday, CAL_DATA) = 3 or DATEPART(weekday, CAL_DATA) = 4 or DATEPART(weekday, CAL_DATA) =\r\n5 or DATEPART(weekday, CAL_DATA) = 6) AND CAL_NOTURNO > 0 ),\'\')  as \'Noturno  SEG/SEXTA\',\r\n\r\nISNULL((SELECT dbo.fn_hourlongtominute(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_NOTURNO)))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= @DATAINICIO AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103) and\r\n(DATEPART(weekday,CAL_DATA) = 1 or DATEPART(weekday, CAL_DATA) = 7) AND CAL_NOTURNO > 0 ),\'\') as \'Noturno SAB/DOM\',              \r\n\r\ndbo.fn_hourlongtominute(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRA)))) as EXTRAS,\r\ndbo.fn_hourlongtominute(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRAn)))) as EXTRASN,\r\ndbo.fn_hourlongtominute(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRAF))))  as EXTRASF,\r\ndbo.fn_hourlongtominute(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_EXTRAnF))))  as EXTRASNF,\r\ndbo.fn_hourlongtominute(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DESCONTO - CAL_FALTAHORA)))) as ATRASOS,\r\ndbo.fn_hourlongtominute(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_FALTAHORA)))) as FALTASHORAS,\r\nSUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 ELSE 0 END) FALTASDIAS,                    \r\ndbo.fn_hourlongtominute(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_ABONO)))) ABONOS,\r\ndbo.fn_hourlongtominute(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_Noturno)))) NOTURNOS,\r\ndbo.fn_hourlongtominute(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DSR)))) DSR,\r\ndbo.fn_hourlongtominute(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_DDSR)))) DDSR\r\n                                                                             \r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nleft JOIN Cargos ON CAR_IND = FUNC_CARGO\r\n\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL AND CAL_DATA >= @DATAINICIO AND CAL_DATA <= CONVERT(VARCHAR(30), getdate(), 103)\r\n\r\ngroup by FUNC_NOME,EMP_Nome,FUNC_IND\r\nOrder By EMP_Nome, FUNC_NOME','Gabriel','2018-09-26 20:03:04'),(545,'RelatÃ³rio  Apontamento Totalizado','RELATORIOS','CREATE TABLE #dbtFuncionarios (\r\n    FUNC INT\r\n    ) ON [PRIMARY]\r\nINSERT INTO #dbtFuncionarios\r\nSELECT FUNC_IND FROM Funcionarios WHERE\r\ndbo.fn_departamentopertencente(FUNC_EMPRESA,  %DEPSELECIONADOIND%) = 1\r\nEXEC rst_relatorio_apontamento_totais \r\n@P_DEPARTAMENTO = %DEPSELECIONADOIND%,\r\n@P_TRAB = 1,\r\n@P_ATRB = 1,\r\n@P_EXTRA = 0,\r\n@P_EXTRAN = 0,\r\n@P_EXTRAF = 0,\r\n@P_EXTRANF = 0,\r\n@P_DESCONTO =1,\r\n@P_FALTAHORA = 0,\r\n@P_FALTADIA = 1,\r\n@P_ABONO = 1,\r\n@P_NOTURNO = 1,\r\n@P_DSR = 0,\r\n@P_DDSR = 0,\r\n@P_DATAINICIAL = %DATAINICIAL%,\r\n@P_DATAFINAL = %DATAFINAL%\r\n\r\nDROP TABLE #dbtFuncionarios','Gabriel','2018-09-26 20:03:18'),(546,'RelatÃ³rio Apontamento detalhado','RELATORIOS','CREATE TABLE #dbtFuncionarios (\r\n    FUNC INT\r\n    ) ON [PRIMARY]\r\nINSERT INTO #dbtFuncionarios\r\nSELECT FUNC_IND FROM Funcionarios WHERE\r\ndbo.fn_departamentopertencente(FUNC_EMPRESA,  %DEPSELECIONADOIND%) = 1\r\nEXEC rst_relatorio_apontamento_detalhes \r\n@P_DEPARTAMENTO = %DEPSELECIONADOIND%,\r\n@P_TRAB = 0,\r\n@P_ATRB = 0,\r\n@P_EXTRA = 1,\r\n@P_EXTRAN = 1,\r\n@P_EXTRAF = 1,\r\n@P_EXTRANF = 1,\r\n@P_DESCONTO = 0,\r\n@P_FALTAHORA = 0,\r\n@P_FALTADIA = 0,\r\n@P_ABONO = 0,\r\n@P_NOTURNO = 0,\r\n@P_DSR = 1,\r\n@P_DDSR = 1,\r\n@P_DATAINICIAL = %DATAINICIAL%,\r\n@P_DATAFINAL = %DATAFINAL%,\r\n@P_EXIBIR_CARGO = 1\r\nDROP TABLE #dbtFuncionarios','Gabriel','2018-09-26 20:03:29'),(547,'RelatÃ³rio Banco de Horas Detalhado','RELATORIOS','CREATE TABLE #dbtFuncionarios (\r\n    FUNC INT\r\n    ) ON [PRIMARY]\r\nINSERT INTO #dbtFuncionarios\r\nSELECT FUNC_IND FROM Funcionarios WHERE\r\ndbo.fn_departamentopertencente(FUNC_EMPRESA,  %DEPSELECIONADOIND%) = 1\r\nEXEC rst_banco_horas_detalhado\r\n@P_DATAINICIAL = %DATAINICIAL%,\r\n@P_DATAFINAL = %DATAFINAL%,\r\n@P_MARCACOES = 1\r\n\r\nDROP TABLE #dbtFuncionarios','Gabriel','2018-09-26 20:03:46'),(548,'RelatÃ³rio Banco de Horas Totalizado','RELATORIOS','CREATE TABLE #dbtFuncionarios (\r\n    FUNC INT\r\n    ) ON [PRIMARY]\r\nINSERT INTO #dbtFuncionarios\r\nSELECT FUNC_IND FROM Funcionarios WHERE\r\ndbo.fn_departamentopertencente(FUNC_EMPRESA,  %DEPSELECIONADOIND%) = 1\r\nEXEC rst_banco_horas_totalizado\r\n@P_DATAINICIAL = \'20/07/2018\',\r\n@P_DATAFINAL = %DATAFINAL%\r\n\r\nDROP TABLE #dbtFuncionarios','Gabriel','2018-09-26 20:03:56'),(549,'RelatÃ³rio Justificativas com Registro','RELATORIOS','## Esse comando vc precisa executar no suporte do asseponto, e usar o relatoriod e justificativas normal\r\n\r\nALTER PROCEDURE [dbo].[rst_relatorios_justificativas]\r\n@P_DATAINICIAL SMALLDATETIME,\r\n@P_DATAFINAL SMALLDATETIME,\r\n@P_DEPTO INT = NULL,\r\n@P_MOTIVO NVARCHAR(MAX) = NULL\r\n--WITH ENCRYPTION\r\nAS\r\nBEGIN\r\nCREATE TABLE #dbtJustificativas (\r\n           [REL_REG] [char] (15),\r\n                [REL_NOME] [char] (50),\r\n           [REL_DATA] [smalldatetime] ,\r\n           [REL_VALOR] [char] (7),\r\n           [REL_ABONADOEM] [smalldatetime],\r\n           [REL_DESCRICAO] [nvarchar] (max)\r\n           ) ON [PRIMARY]\r\n           \r\nDECLARE @FUNC INT, @SOMA CHAR(6), @NOME CHAR(50), @REG CHAR(15)\r\n\r\nIF @P_DEPTO IS NULL\r\n    DECLARE funcionarios_cursor CURSOR FOR\r\n        SELECT FUNC, FUNC_NOME, FUNC_REG FROM #dbtFuncionarios INNER JOIN Funcionarios ON FUNC_IND = FUNC\r\nELSE\r\n    DECLARE funcionarios_cursor CURSOR FOR\r\n        SELECT FUNC_IND, FUNC_NOME, FUNC_REG FROM Funcionarios --WHERE dbo.fn_departamentopertencente(FUNC_EMPRESA, @P_DEPTO) = 1\r\n        \r\nOPEN funcionarios_cursor\r\n\r\nFETCH NEXT FROM funcionarios_cursor INTO @FUNC, @NOME, @REG\r\n\r\nWHILE @@FETCH_STATUS = 0\r\n    BEGIN\r\n    IF EXISTS(SELECT * FROM Justificativas\r\n            INNER JOIN Funcionarios ON FUNC_IND = JUS_FUNC\r\n            INNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\n        WHERE JUS_FUNC = @FUNC\r\n            AND JUS_DATA >= @P_DATAINICIAL AND JUS_DATA <= @P_DATAFINAL\r\n            AND (@P_MOTIVO IS NULL OR CHARINDEX(RTRIM(JUS_DESCRICAO), @P_MOTIVO) > 0)\r\n)\r\n        BEGIN\r\n        INSERT INTO #dbtJustificativas \r\n            SELECT @NOME,\r\n                    @REG,\r\n            JUS_DATA,\r\n            dbo.fn_gettime((CASE JUS_TUDO WHEN 1 THEN (SELECT CAL_ABONO FROM Calculo WHERE CAL_FUNC = JUS_FUNC AND CAL_DATA = JUS_DATA) ELSE JUS_VALOR END)),\r\n            JUS_ABONADOEM,\r\n            JUS_DESCRICAO\r\n            FROM Justificativas\r\n                INNER JOIN Funcionarios ON FUNC_IND = JUS_FUNC\r\n                INNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\n            WHERE JUS_FUNC = @FUNC\r\n                AND JUS_DATA >= @P_DATAINICIAL AND JUS_DATA <= @P_DATAFINAL\r\n                AND (@P_MOTIVO IS NULL OR CHARINDEX(RTRIM(JUS_DESCRICAO), @P_MOTIVO) > 0)\r\n\r\n        SELECT @SOMA = dbo.fn_funcionario_justificativas_total(@FUNC, @P_DATAINICIAL, @P_DATAFINAL, @P_MOTIVO)\r\n        \r\n        INSERT INTO #dbtJustificativas SELECT @NOME, @REG, NULL, @SOMA, NULL, \'TOTAL\'\r\n        END\r\n        \r\n    FETCH NEXT FROM funcionarios_cursor INTO @FUNC, @NOME, @REG\r\n    END\r\n    \r\nCLOSE funcionarios_cursor\r\nDEALLOCATE funcionarios_cursor\r\n\r\nSELECT REL_NOME AS Nome,\r\n          REL_REG AS Registro,\r\n       REL_DATA AS Data,\r\n       REL_VALOR AS Valor,\r\n       REL_ABONADOEM AS \'Abonado em\',\r\n       REL_DESCRICAO AS DescriÃ§Ã£o\r\nFROM #dbtJustificativas\r\nEND\r\n','Gabriel','2018-09-26 20:04:07'),(550,'RelatÃ³rio Justificativas','RELATORIOS','CREATE TABLE #dbtFuncionarios (\r\n    FUNC INT\r\n    ) ON [PRIMARY]\r\nINSERT INTO #dbtFuncionarios\r\nSELECT FUNC_IND FROM Funcionarios WHERE\r\ndbo.fn_departamentopertencente(FUNC_EMPRESA,  %DEPSELECIONADOIND%) = 1\r\nEXEC rst_relatorios_justificativas\r\n@P_DATAINICIAL = %DATAINICIAL%,\r\n@P_DATAFINAL = %DATAFINAL%\r\nDROP TABLE #dbtFuncionarios','Gabriel','2018-09-26 20:04:20'),(551,'RelatÃ³rio Variaveis','RELATORIOS','CREATE TABLE #dbtFuncionarios (\r\n    FUNC INT\r\n    ) ON [PRIMARY]\r\nINSERT INTO #dbtFuncionarios\r\nSELECT FUNC_IND FROM Funcionarios WHERE\r\ndbo.fn_departamentopertencente(FUNC_EMPRESA,  %DEPSELECIONADOIND%) = 1\r\nEXEC rst_relatorios_variaveis\r\n@P_DATAINICIAL = %DATAINICIAL%,\r\n@P_DATAFINAL = %DATAFINAL%,\r\n@P_DEPTO = NULL,\r\n@P_CLASSIFICACAO = 0\r\nDROP TABLE #dbtFuncionarios','Gabriel','2018-09-26 20:04:32'),(552,'RHJ - senha gerenciador rhj','RELOGIO','senha padrao: admin','Gabriel','2018-09-26 22:42:54'),(553,'RELATORIO  Horas Trabalhadas, Extras Diurnas, Extra em Folgas/Feriados, Extra Noturna, Extra Noturna em Folgas/Feriados, DSR Descontado, Horas Noturnas,  Faltas em Dias, Atrasos','RELATORIOS','--LARGURA#250,180,45,45,45,45,50,60,65,45,45,45,60#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#1#\r\nDECLARE @DATAINICIAL  NVARCHAR(50)                            \r\nDECLARE @DATAFINAL  NVARCHAR(50)\r\nDECLARE @PERIODO NVARCHAR(50)\r\nSET @DATAINICIAL =  %DATAINICIAL%\r\nSET @DATAFINAL = %DATAFINAL%                                \r\nSET @PERIODO = \' APONTAMENTO: \'\r\nSET @PERIODO +=  @DATAINICIAL\r\nSET @PERIODO += \' - \'\r\nSET @PERIODO += @DATAFINAL\r\n\r\nSELECT (FUNC_NOME) FUNCIONARIO,RTRIM(@PERIODO) + \'                                              \' +  RTRIM(Emp_nome)AS \'DESC\',              \r\n     \r\n                     \r\n\r\nISNULL(DBO.FN_HOURLONGNULLZERO(DBO.FN_MINUTETOHOURLONG(SUM\r\n(DBO.FN_SMALLDATETIMETOMINUTE(CAL_ATRB)))), \'\') AS ATRAB,\r\n\r\nISNULL(DBO.FN_HOURLONGNULLZERO(DBO.FN_MINUTETOHOURLONG(SUM\r\n(DBO.FN_SMALLDATETIMETOMINUTE(CAL_TRAB)))), \'\') AS TRAB,\r\n\r\nISNULL(DBO.FN_HOURLONGNULLZERO(DBO.FN_MINUTETOHOURLONG(SUM\r\n(DBO.FN_SMALLDATETIMETOMINUTE(CAL_ABONO)))), \'\') AS ABONO,\r\n\r\nISNULL(DBO.FN_HOURLONGNULLZERO(DBO.FN_MINUTETOHOURLONG(SUM\r\n(DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRA)))), \'\') AS \'HE\',\r\n\r\nISNULL(DBO.FN_HOURLONGNULLZERO(DBO.FN_MINUTETOHOURLONG(SUM\r\n(DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRAN)))), \'\') AS \'HE_NOT\',\r\n\r\nISNULL(DBO.FN_HOURLONGNULLZERO(DBO.FN_MINUTETOHOURLONG(SUM\r\n(DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRAF)))), \'\')  AS \'HE FERIADOS\',\r\n\r\nISNULL(DBO.FN_HOURLONGNULLZERO(DBO.FN_MINUTETOHOURLONG(SUM                    \r\n(DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRANF)))), \'\') AS \'HE_NOT FERIADOS\',  \r\n\r\nDBO.FN_HOURLONGNULLZERO(DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_DDSR)))) AS DDSR,\r\n\r\nDBO.FN_HOURLONGNULLZERO(DBO.FN_MINUTETOHOURLONG(SUM\r\n(DBO.FN_SMALLDATETIMETOMINUTE(CAL_TRABN)))) AS \'NOTURNO\',\r\n\r\nSUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 END) AS FALTAS,\r\n\r\nDBO.FN_HOURLONGNULLZERO(DBO.FN_MINUTETOHOURLONG(SUM\r\n(DBO.FN_SMALLDATETIMETOMINUTE(CAL_DESCONTO - CAL_FALTAHORA)))) AS ATRASOS\r\n\r\nFROM FUNCIONARIOS\r\nINNER JOIN CALCULO ON FUNC_IND = CAL_FUNC\r\nINNER JOIN EMPRESAS ON FUNC_EMPRESA = EMP_IND\r\nWHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL AND CAL_DATA >= @DATAINICIAL AND CAL_DATA <= @DATAFINAL\r\nGROUP BY FUNC_NOME, FUNC_IND,EMP_NOME\r\nORDER BY EMP_NOME, FUNC_NOME','Gabriel','2018-09-27 16:26:43'),(554,'usuario administrador','UTILIDADES','como muitos ainda tem duvidas sobre como ativar o usuÃ¡rio administrador do Windows\r\nSegue vÃ­deo explicativo e informaÃ§Ãµes sobre usuÃ¡rios do Windows \r\nhttps://youtu.be/JrUWXXOBmjA\r\n\r\n\r\nO QUE SÃƒO CONTAS DE USUÃRIO NO WINDOWS?\r\nAs contas de usuÃ¡rio permitem que uma pessoa tenha acesso ao computador e aos seus programas. Para entrar Ã© necessÃ¡rio introduzir um nome para a conta e uma senha. \r\n\r\nAs contas de usuÃ¡rio sÃ£o criados pelo administrador do computador, que serÃ¡ responsÃ¡vel em permitir acesso para outras pessoas. \r\n\r\nSe vocÃª tiver vÃ¡rias contas, poderÃ¡ proteger suas informaÃ§Ãµes pessoais ou acompanhar o que os outros estÃ£o fazendo no computador atravÃ©s de uma ferramenta chamada controle parental.\r\n\r\n \r\n\r\nTIPOS DE CONTA DE USUÃRIO \r\nUma das vantagens do Windows 10 Ã© que vocÃª pode dar acesso a outras pessoas criando contas individuais. Com essas contas eles poderÃ£o instalar ou desinstalar programas, alterar senhas, criar contas de usuÃ¡rio ou somente ter acesso a determinados programas, tudo conforme a conta que vocÃª criar. Veja quais tipos de contas estÃ£o disponÃ­veis:\r\n\r\nADMINISTRADOR:  Os administradores tÃªm a liberdade de instalar ou desinstalar softwares no seu computador, criar contas de usuÃ¡rio, alterar senhas, fazer alteraÃ§Ãµes para os outros usuÃ¡rios e para o acesso geral do computador. \r\n\r\nUSUÃRIO PADRÃƒO:  Esse tipo de conta permite acesso a maioria dos programas, mas sem a possibilidade de fazer alteraÃ§Ãµes. TambÃ©m nÃ£o Ã© permitido fazer configuraÃ§Ãµes que afetam outros usuÃ¡rios do computador.\r\nAgora vocÃª jÃ¡ sabe o que Ã© um usuÃ¡rio e quem pode criar contas no computador. Nas prÃ³ximas pÃ¡ginas vamos lhe mostrar como criar essas contas.\r\n\r\n \r\n','Gabriel','2018-09-27 16:53:15'),(555,'RW TECH Point line - configuraÃ§oes','RELOGIO','>>>>>\r\nCadastro de atÃ© 10 digitais por colaborador\r\nPossÃ­vel conectar teclado PS/2 para cadastro direto no relÃ³gio\r\nNÃ£o Ã© possÃ­vel envio de funcionÃ¡rio via pen drive (opÃ§Ã£o USB - ExportaÃ§Ã£o Ã© apenas para gerar o AFD do REP)\r\nPorta: 1001\r\n<<<<<\r\n\r\nVerificar IP >>> Pressionar Menu > Informar um CPF > IdentificaÃ§Ã£o padrÃ£o do REP: 0 (zero) > Senha padrÃ£o do REP: 000 (trÃªs vezes o nÃºmero zero) > Seguir com as setas atÃ© \'OPÃ‡Ã•ES\' > Seguir atÃ© \'COMUNICAÃ‡ÃƒO\' > Acessar opÃ§Ã£o \'TCP/IP\' > Verificar/Alterar as opÃ§Ãµes \'ENDEREÃ‡O IP\' / \'MASCARA DE REDE\' / \'GATEWAY PADRÃƒO\'.\r\n\r\nCadastrar Biometria >>> Pressionar Menu > Informar um CPF > IdentificaÃ§Ã£o padrÃ£o do REP: 0 (zero) > Senha padrÃ£o do REP: 000 (trÃªs vezes o nÃºmero zero) > Seguir com as setas atÃ© \'FUNCIONÃRIOS\' > OpÃ§Ã£o \'EDITAR\' > Informar o PIS do funcionÃ¡rio > Seguir com as setas atÃ© opÃ§Ã£o \'DIGITAL\', pressionar ok E COM AS SETAS ATE SALVAR USUARIO\r\n\r\nCadastrar FuncionÃ¡rio diretamente no REP >>> Pressionar Menu > Informar um CPF > IdentificaÃ§Ã£o padrÃ£o do REP: 0 (zero) > Senha padrÃ£o do REP: 000 (trÃªs vezes o nÃºmero zero) > Seguir com as setas atÃ© \'FUNCIONÃRIOS\' > opÃ§Ã£o \'CADASTRAR\' > Cadastrar primeiro o nome, informar o PIS e selecionar opÃ§Ã£o de acesso do funcionÃ¡rio. (NecessÃ¡rio teclado PS/2 para cadastro)\r\n\r\nAjustar horÃ¡rio de verÃ£o >>> Pressionar Menu > Informar um CPF > IdentificaÃ§Ã£o padrÃ£o do REP: 0 (zero) > Senha padrÃ£o do REP: 000 (trÃªs vezes o nÃºmero zero) > Seguir com as setas atÃ© \'OPÃ‡Ã•ES\'> OpÃ§Ã£o \'SISTEMA\' > OpÃ§Ã£o \'HORÃRIO VERÃƒO\' > Ajustar as opÃ§Ãµes \'INÃCIO H. VERÃƒO\' / \'FIM H. VERÃƒO\'.\r\n\r\n\r\n','Gabriel','2018-09-27 17:48:52'),(556,'MAC RELOGIOS','RELOGIO','zpm			C8:C1:26\r\ngertc(tecvan)		00:1D:5B\r\nhenry e			08:14:14\r\nhenry 			08:45:37\r\nhenry super f		08:3F:DD\r\ncontrol id		FC:52:CE\r\niddata(Daiken)		00:50:C2\r\ntrilobit		\r\nRHJ			2E:CA:8C\r\ntrix			\r\nPASSFINGER 		00:17:61\r\nRW			AC:02:CF\r\nathos(wiznet)		00:08:DC','Gabriel','2018-09-27 17:54:11'),(557,'CONTROL ID IDCLASS - ATUALIZAÃ‡ÃƒO DO FIRMWARE ','RELOGIO','pROCEDIMENTO FEITO VIA PENDRIVE\r\n\r\nACESSE O LINK E FAÃ‡A O DOWNLOAD DOS ARQUIVOS ( http://www.controlid.com.br/suporte/fw318.zip ) COPIE E COLE no Pendrive\r\nCONECTE O PENDRIVE NA PORTA DE DADOS > ACESSE O MENU DO RELÃ“GIO > CONFIGURAÃ‡Ã•ES > OPÃ‡ÃƒO MAIS >  SOBRE O REP > SELECIONE A OPÃ‡ÃƒO UPDATE > Aguarde a atualizaÃ§Ã£o concluir, apÃ³s atingir 100% o REP irÃ¡ reiniciar de forma automÃ¡tica. ApÃ³s a reinicializaÃ§Ã£o o REP estarÃ¡ atualizado','ANDERSON OLIVEIRA','2018-09-28 20:26:57'),(558,'Assefin  - altera email pelo banco','ASSEFIN','UPDATE [AssefinWeb_].[dbo].[Config]\r\n   SET CFG_EMAIL_HOST = \'smtplw.com.br\',\r\nCFG_EMAIL_PORTA = 587,\r\nCFG_EMAIL_ENDERECO = \'notificacao@assecont.com.br\',\r\nCFG_EMAIL_REMETENTE = \'Tirone\',\r\nCFG_EMAIL_USUARIO = \'cvtgdqnvMROJ\',\r\nCFG_EMAIL_SENHA = \'Cvt5D2nVMROJ\',\r\nCFG_EMAIL_CRIPTOGRAFIA  = 0\r\nGO','Gabriel','2018-10-01 21:07:43'),(559,'relatorio de nome, marcaÃ§Ã£o, justificativa, banco de horas atraso e folgas','RELATORIOS','--LARGURA#80,200,45,40,45,50,45,60,60,60,60,60,60,60,120#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#1#                                                                                                                            \r\nSELECT dbo.fn_getdate(CAL_DATA) AS \'Data\', FUNC_NOME \'Nome\',\r\ndbo.fn_gettimefull(APO_MARCACAO1) AS \'Entrada1\',\r\ndbo.fn_gettimefull(APO_MARCACAO2) AS \'Saida1\',\r\ndbo.fn_gettimefull(APO_MARCACAO3) AS \'Entrada2\',                                         \r\ndbo.fn_gettimefull(APO_MARCACAO4) AS \'Saida2\',\r\n\r\nISNULL(dbo.fn_gettime5nullzero(CAL_ATRB), \'\') AS \'A Trabalhar\',\r\nISNULL(dbo.fn_gettime5nullzero(CAL_TRAB), \'\') AS \'Trabalhadas\',\r\n\r\ndbo.fn_gettime5nullzero(CAL_DESCONTO) AS Desconto,\r\n\r\nCASE WHEN CAL_FALTAHORA > 0 THEN \'FALTA\' WHEN APO_H = -990 THEN \'FOLGA\' WHEN APO_DSR <> 0 THEN \'DSR\' ELSE \'\' END AS \'Faltas/Folgas\',\r\n                                                                                                                                            \r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA AND\r\nSUBSTRING(BCO_VALOR, 1, 1) <> \'-\') AS CREDITO,\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA\r\nAND SUBSTRING(BCO_VALOR, 1, 1) = \'-\') AS DEBITO,\r\n\r\ndbo.fn_get_banco_saldo_totalizado_dia(func_ind,CAL_DATA) AS \'SALDO DIA\',\r\n\r\n(CASE WHEN CAL_ABONO > 0 THEN CONVERT(VARCHAR(5),(CAL_ABONO),108) ELSE \'\' END) as \'Abonado\',\r\nCASE WHEN CAL_ABONO > 0 THEN (SELECT JUS_DESCRICAO FROM\r\njustificativas WHERE JUS_FUNC = CAL_FUNC AND JUS_DATA = CAL_DATA) ELSE \'\' END  AS MOTIVO\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL \r\nAND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%\r\ngroup by FUNC_NOME, CAL_DATA, CAL_TRAB,CAL_ATRB,FUNC_IND,CAL_EXTRAF, CAL_EXTRANF,CAL_EXTRA,apo_Hv,CAL_ABONO,\r\nCAL_EXTRAn,APO_MARCACAO1,APO_MARCACAO2,APO_MARCACAO3,APO_MARCACAO4,CAL_DESCONTO,CAL_FALTAHORA,APO_H,APO_DSR,CAL_FUNC\r\nOrder By FUNC_NOME, CAL_DATA','Gabriel','2018-10-03 16:37:55'),(560,'Relatorio de expediente diario e-social','RELATORIOS','--COLUNAGRUPO#1#\r\n--LARGURA# 250,250,80,150,150# \r\nSELECT FUNC_NOME,EMP_Nome, APO_DATA DATA,                                                                                     \r\n(CASE WHEN APO_H1 IS NOT NULL and APO_HV is null THEN dbo.fn_expediente_dia(FUNC_IND,APO_DATA)\r\nelse CONVERT(VARCHAR(5),(APO_HV),108) END) EXPEDIENTE\r\n\r\nFROM Aponta\r\nINNER JOIN Funcionarios ON FUNC_IND = APO_FUNC\r\nINNER JOIN EMPRESAS ON EMP_IND = FUNC_EMPRESA    \r\nwhere FUNC_DT_DEM IS NULL and FUNC_MARCADO_EXCLUSAO = 0  and APO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL%\r\nAND dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) = 1 and (CASE WHEN APO_H1 IS NOT NULL and APO_HV is null THEN \r\ndbo.fn_expediente_dia(FUNC_IND,APO_DATA)\r\nelse CONVERT(VARCHAR(5),(APO_HV),108) END) is not null                         \r\nORDER BY EMP_Nome, FUNC_NOME, APO_DATA','Gabriel','2018-10-04 16:53:22'),(561,'Relatorio de marcaÃ§oes, credito, debito, saldo, extras, atrb, trab','RELATORIOS','--ORIENTACAO#paisagem#\r\n--GRUPOQUEBRA#1#\r\n--LARGURA#70,200,70,55,50,50,50,50,50,50,50,50,50,50,50,55,55,55,80#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#1#\r\nSELECT dbo.fn_getdate(CAL_DATA) AS \'DATA\', FUNC_NOME \'NOME\', case DATEPART(weekday, APO_DATA) when 1 then \'DOMINGO\' WHEN 2 then \'SEGUNDA\'\r\nWHEN 3 then \'TERÃ‡A\' WHEN 4 then \'QUARTA\' WHEN 5 then \'QUINTA\' WHEN 6 then \'SEXTA\'\r\nWHEN 7 then \'SABADO\' ELSE \'\' END AS SEMANA,                  \r\nCASE WHEN CAL_FALTAHORA > 0 THEN \'FALTA\' WHEN APO_H = -990 THEN \'FOLGA\' WHEN APO_H = -994 then \'FERIADO\' WHEN APO_H = -999 THEN \'DSR\'\r\nELSE dbo.fn_gettimefull(APO_MARCACAO1) end AS \'ENT.1\',  \r\ndbo.fn_gettimefull(APO_MARCACAO2) AS \'SAI.1\',\r\ndbo.fn_gettimefull(APO_MARCACAO3) AS \'ENT.2\',\r\ndbo.fn_gettimefull(APO_MARCACAO4) AS \'SAI.2\',\r\ndbo.fn_gettimefull(APO_MARCACAO5) AS \'ENT.3\',\r\ndbo.fn_gettimefull(APO_MARCACAO6) AS \'SAI.3\',\r\ndbo.fn_gettimefull(APO_MARCACAO7) AS \'ENT.4\',\r\ndbo.fn_gettimefull(APO_MARCACAO8) AS \'SAI.4\',\r\n\r\nISNULL(dbo.fn_gettime5nullzero(CAL_ATRB), \'\') AS \'ATRB\',\r\nISNULL(dbo.fn_gettime5nullzero(CAL_TRAB), \'\') AS \'TRAB\',                                                       \r\n                                                                                            \r\nISNULL(dbo.fn_gettime5nullzero(CAL_EXTRA + CAL_EXTRAn), \'\') AS \'HE\',\r\n\r\nISNULL(dbo.fn_gettime5nullzero(CAL_EXTRAF + CAL_EXTRANF), \'\') AS \'HE F/F\',\r\n\r\ndbo.fn_gettime5nullzero(CAL_DESCONTO) AS ATRASOS,\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA AND     \r\nSUBSTRING(BCO_VALOR, 1, 1) <> \'-\') AS CREDITO,\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA\r\nAND SUBSTRING(BCO_VALOR, 1, 1) = \'-\') AS DEBITO,\r\n\r\ndbo.fn_get_banco_saldo_totalizado_dia(func_ind,CAL_DATA) AS \'SALDO DIA\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL              \r\nAND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%         \r\ngroup by FUNC_NOME, CAL_DATA, CAL_TRAB,CAL_ATRB,FUNC_IND,CAL_EXTRAF, CAL_EXTRANF,CAL_EXTRA,apo_Hv,APO_DATA,\r\nCAL_EXTRAn,APO_MARCACAO1,APO_MARCACAO2,APO_MARCACAO3,APO_MARCACAO4,APO_MARCACAO5,APO_MARCACAO6,APO_H,\r\nAPO_MARCACAO7,APO_MARCACAO8,CAL_DESCONTO,CAL_FALTAHORA, dbo.fn_get_banco_saldo_totalizado_dia\r\n(func_ind,CAL_DATA) \r\nOrder By FUNC_NOME, CAL_DATA','Gabriel','2018-10-04 21:25:53'),(562,'RElatorio quantidade total de funcionarios no sistema','RELATORIOS','SELECT COUNT(*)  AS Quantidade  \r\nFROM Funcionarios','Gabriel','2018-10-09 16:26:52'),(563,'Apagar funcionarios EXCLUÃDOS com problemas','COMANDOS','DELETE FROM Aponta WHERE APO_FUNC IN (SELECT FUNC_IND FROM Funcionarios WHERE FUNC_MARCADO_EXCLUSAO = 1)\r\nDELETE FROM Acidentes WHERE ACI_FUNC IN (SELECT FUNC_IND FROM Funcionarios WHERE FUNC_MARCADO_EXCLUSAO = 1)\r\nDELETE FROM Afastamentos WHERE AFA_FUNC IN (SELECT FUNC_IND FROM Funcionarios WHERE FUNC_MARCADO_EXCLUSAO = 1)\r\nDELETE FROM Alteracoes WHERE ALT_FUNC IN (SELECT FUNC_IND FROM Funcionarios WHERE FUNC_MARCADO_EXCLUSAO = 1)\r\nDELETE FROM BcoHoras WHERE BCO_FUNC IN (SELECT FUNC_IND FROM Funcionarios WHERE FUNC_MARCADO_EXCLUSAO = 1)\r\nDELETE FROM BcoHorasDesconsiderados WHERE BCOD_FUNC IN (SELECT FUNC_IND FROM Funcionarios WHERE FUNC_MARCADO_EXCLUSAO = 1)\r\nDELETE FROM Calculo WHERE CAL_FUNC IN (SELECT FUNC_IND FROM Funcionarios WHERE FUNC_MARCADO_EXCLUSAO = 1)\r\nDELETE FROM Justificativas WHERE JUS_FUNC IN (SELECT FUNC_IND FROM Funcionarios WHERE FUNC_MARCADO_EXCLUSAO = 1)\r\nDELETE FROM JustificativasPedidos WHERE JUSPED_FUNC IN (SELECT FUNC_IND FROM Funcionarios WHERE FUNC_MARCADO_EXCLUSAO = 1)\r\nDELETE FROM Marcacoes WHERE MRC_FUNC IN (SELECT FUNC_IND FROM Funcionarios WHERE FUNC_MARCADO_EXCLUSAO = 1)\r\nDELETE FROM PreAponta WHERE PAPO_FUNC IN (SELECT FUNC_IND FROM Funcionarios WHERE FUNC_MARCADO_EXCLUSAO = 1)\r\nDELETE FROM Registro WHERE REG_FUNC IN (SELECT FUNC_IND FROM Funcionarios WHERE FUNC_MARCADO_EXCLUSAO = 1)\r\nDELETE FROM Variaveis WHERE VAR_FUNC IN (SELECT FUNC_IND FROM Funcionarios WHERE FUNC_MARCADO_EXCLUSAO = 1)\r\nDELETE FROM Hora WHERE HR_FUNC IN (SELECT FUNC_IND FROM Funcionarios WHERE FUNC_MARCADO_EXCLUSAO = 1)\r\nDELETE FROM HMovel WHERE HRM_FUNC IN (SELECT FUNC_IND FROM Funcionarios WHERE FUNC_MARCADO_EXCLUSAO = 1)\r\n\r\nDELETE FROM funcionarios where FUNC_MARCADO_EXCLUSAO = 1 ','Gabriel','2018-10-09 17:27:13'),(564,'RELATORIO HORAS TRABALHADAS DIAS DO MES NA HORIZONTAL - POTENSA KARINA','RELOGIO','--ORIENTACAO#paisagem#\r\n--GRUPOQUEBRA#0#     \r\n--COLUNAGRUPO#0#\r\n--LARGURA#200,200,80,80,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40#\r\n--DECLARE @INICIO SMALLDATETIME = %DATAINICIAL%\r\n--DECLARE @FINAL SMALLDATETIME = %DATAFINAL%\r\n\r\nDECLARE @INICIO SMALLDATETIME = \'01/09/2018\'\r\nDECLARE @FINAL SMALLDATETIME = \'30/09/2018\'\r\n                                           \r\nSELECT EMP_NOME EMPRESA, FUNC_NOME as NOME, (select FUNC_DT_ADM from funcionarios where FUNC_IND = CAL_FUNC ) ADMISAO,\r\n(select FUNC_DT_DEM from funcionarios where FUNC_IND = CAL_FUNC) DEMISSAO,\r\n\r\n(SELECT top 1 case when cal_data = \'\' then \'\' when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when (CAL_TRaB > CAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and cal_data = @INICIO ) as \'1D\',\r\n\r\n(SELECT top 1 case when FUNC_DT_ADM > @INICIO then \'\' when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' \r\nwhen CAL_TRaB <= 0 then \'Falta\'  when CAL_TRABN >= 0\r\nthen dbo.fn_gettimefull(CAL_TRABN) else \'\' end from calculo where FUNC_IND = CAL_FUNC and cal_data = @INICIO ) as \'1N\',\r\n\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\'  when (CAL_TRaB > CAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 1,103)  ) as \'2D\',\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 \r\nthen \'Atestado\' when CAL_TRaB <= 0 then \'Falta\' when CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRABN)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 1,103) ) as \'2N\',\r\n\r\n\r\n\r\n(SELECT top 1 case when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\'  when (CAL_TRaB > CAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 2,103) ) as \'3D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo                                                          \r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 2,103)  ) as \'3N\',\r\n\r\n\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\'  when (CAL_TRaB > CAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 3,103) ) as \'4D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo                                                          \r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 3,103) ) as \'4N\',\r\n\r\n\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\'  when (CAL_TRaB > CAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 4,103) ) as \'5D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo                                                          \r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 4,103)  ) as \'5N\',\r\n\r\n\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\'  when (CAL_TRaB > CAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 5,103)  ) as \'6D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo                                                         \r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 5,103)  ) as \'6N\',\r\n\r\n\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\'  when (CAL_TRaB > CAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 6,103)  ) as \'7D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo                                                          \r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 6,103)  ) as \'7N\',\r\n\r\n\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\'  when (CAL_TRaB > CAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 7,103) ) as \'8D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo                                                          \r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 7,103) ) as \'8N\',\r\n\r\n\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\'  when (CAL_TRaB > CAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 8,103)  ) as \'9D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo\r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 8,103)  ) as \'9N\',\r\n\r\n\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when (CAL_TRaB > CAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 9,103) ) as \'10D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo\r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 9,103)  ) as \'10N\',\r\n\r\n\r\n                                                                                                 \r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when (CAL_TRaB > CAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 10,103) ) as \'11D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo\r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 10,103)  ) as \'11N\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when (CAL_TRaB > CAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 11,103) ) as \'12D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo\r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 11,103)  ) as \'12N\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when (CAL_TRaB > CAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 12,103) ) as \'13D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo\r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 12,103) ) as \'13N\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when (CAL_TRaB > CAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 13,103) ) as \'14D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo\r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 13,103)  ) as \'14N\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when (CAL_TRaB > CAL_TRABN)         \r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 14,103) ) as \'15D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo\r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 14,103) ) as \'15N\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when (CAL_TRaB > CAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 15,103) ) as \'16D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo\r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 15,103)) as \'16N\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when (CAL_TRaB > CAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 16,103) ) as \'17D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0\r\nthen dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo                      \r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 16,103)  ) as \'17N\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when (CAL_TRaB > CAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 17,103) ) as \'18D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo\r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 17,103) ) as \'18N\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when (CAL_TRaB > CAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 18,103) ) as \'19D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo\r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 18,103)  ) as \'19N\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when (CAL_TRaB > CAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 19,103) ) as \'20D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo\r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 19,103)  ) as \'20N\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when (CAL_TRaB > CAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 20,103)  ) as \'21D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo\r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 20,103) ) as \'21N\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when (CAL_TRaB > CAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 21,103) ) as \'22D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0\r\nthen dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo\r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 21,103) ) as \'22N\',\r\n\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when (CAL_TRaB >\r\nCAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 22,103) ) as \'23D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0\r\nthen dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo\r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 22,103) AND CAL_DATA <= @FINAL ) as \'23N\',\r\n\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when (CAL_TRaB >\r\nCAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 23,103)  ) as \'24D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0\r\nthen dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo\r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 23,103)   ) as \'24N\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when (CAL_TRaB > CAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 24,103)  ) as \'25D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo\r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 24,103)  ) as \'25N\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when (CAL_TRaB >\r\nCAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 25,103) ) \r\nas \'26D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0\r\nthen dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo\r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 25,103) ) as \'26N\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when (CAL_TRaB >\r\nCAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 26,103)  \r\n) as \'27D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0\r\nthen dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo\r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 26,103) and (DATEPART(day, CAL_DATA) = 27) ) as \'27N\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when (CAL_TRaB >\r\nCAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 27,103) ) \r\nas \'28D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0\r\nthen dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo\r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 27,103)  ) as \'28N\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when (CAL_TRaB >\r\nCAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 28,103)  \r\n) as \'29D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0\r\nthen dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo\r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 28,103)  ) as \'29N\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when (CAL_TRaB >\r\nCAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 29,103) ) \r\nas \'30D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0\r\nthen dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo\r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = CONVERT(VARCHAR(30), @INICIO + 29,103) ) as \'30N\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when (CAL_TRaB > CAL_TRABN)\r\nand CAL_TRaB - CAL_TRABN >= 0 then dbo.fn_gettimefull(CAL_TRaB - CAL_TRABN) when (CAL_TRaB < CAL_TRABN)\r\nand CAL_TRABN - CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRABN - CAL_TRaB) when CAL_TRaB >= 0 then dbo.fn_gettimefull(CAL_TRaB)\r\nelse \'\' end from calculo where FUNC_IND = CAL_FUNC and CAL_DATA = @FINAL ) as \'31D\',\r\n\r\n(SELECT top 1 case  when cal_atrb <= 0 then \'Folga\' when cal_abono > 0 then \'Atestado\' when CAL_TRaB <= \r\n0 then \'Falta\' when CAL_TRABN >= 0\r\nthen dbo.fn_gettimefull(CAL_TRABN)  else \'\' end from calculo\r\nwhere FUNC_IND = CAL_FUNC and CAL_DATA = @FINAL) as \'31N\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1 and\r\nCAL_DATA >= @INICIO AND CAL_DATA <= @FINAL\r\nGROUP BY EMP_NOME, FUNC_NOME,FUNC_IND,CAL_FUNC,FUNC_DT_ADM\r\nORDER BY EMP_NOME, FUNC_NOME','Gabriel','2018-10-09 21:13:34'),(565,'procedimentos atendimento','UTILIDADES','SCRIPT DE BOAS VINDAS\r\n\r\nOlÃ¡ bom dia, \r\nMe informe por favor, seu nome e CNPJ da empresa? \r\n\r\nâ€œconfirmar informaÃ§Ãµes cadastrais, TELEFONES e Emails...â€\r\n\r\n\r\n\r\nSCRIPT DE PRAZO DE SUPORTE EXPIRADO\r\n\r\nVerifiquei seu cadastro e o seu prazo de suporte gratuito expirou a __ dias, por esse motivo nÃ£o podemos dar continuidade com o atendimento, porem atualizamos seu cadastro e dentro de instantes nosso comercial vai encaminhar os planos de suporte por e-mail, tudo bem? \r\n\r\n\r\n\r\nSCRIPT DE CLIENTE BLOQUEADO\r\n\r\nVerifiquei seu cadastro, e o seu atendimento consta bloqueado, por favor, verifique junto ao seu financeiro se estÃ£o em dia com as mensalidades, se SIM; enviar comprovante para liberaÃ§Ã£o.... se NÃƒO; se preferir acesse nosso site para consultar se existe algum mÃªs ou titulo em aberto.  Segue responsÃ¡vel pelo financeiro da Assecont: (11) 2173-8864 Evellyn. \r\n\r\n\r\n\r\nSCRIPT DE ENCERRAMENTO \r\n\r\nPosso ajudar em algo mais ? \r\nJÃ¡ conhece a versÃ£o WEB do software ASSEPONTO? NÃ£o!... caso tenha interesse vou solicitar ao comercial  para encaminhar uma apresentaÃ§Ã£o.\r\nEnviar ao email do comercial dados do cliente.\r\n\r\nQualquer duvida estamos a disposÃ§Ã£o. \r\nTenha um Ã³timo dia (tarde) \r\n\r\nPor gentileza avalie meu atendimento respondendo o questionÃ¡rio de satisfaÃ§Ã£o que vai ser exibido ao encerrar a conexÃ£o do acesso remoto , OBRIGADO!\r\n','Gabriel','2018-10-11 16:11:27'),(566,'Relatorio - saldo do banco mensal   -   Cappta','RELATORIOS','--LARGURA#200,200,70,70,70,70,70,70#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\nSELECT DISTINCT EMP_Nome Empresa, FUNC_NOME \'Nome\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR)))\r\nFROM BcoHoras WHERE BCO_FUNC = FUNC_IND  AND BCO_DATA >= (RTRIM(\'01/01/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nBCO_DATA <= (RTRIM(\'30/01/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'JAN\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR)))\r\nFROM BcoHoras WHERE BCO_FUNC = FUNC_IND  AND BCO_DATA >= (RTRIM(\'01/02/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nBCO_DATA <= (RTRIM(\'28/02/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'FEV\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR)))\r\nFROM BcoHoras WHERE BCO_FUNC = FUNC_IND  AND BCO_DATA >= (RTRIM(\'01/03/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nBCO_DATA <= (RTRIM(\'31/03/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'MAR\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR)))\r\nFROM BcoHoras WHERE BCO_FUNC = FUNC_IND  AND BCO_DATA >= (RTRIM(\'01/04/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nBCO_DATA <= (RTRIM(\'30/04/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'ABRIL\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR)))\r\nFROM BcoHoras WHERE BCO_FUNC = FUNC_IND  AND BCO_DATA >= (RTRIM(\'01/05/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nBCO_DATA <= (RTRIM(\'31/05/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'MAI\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR)))\r\nFROM BcoHoras WHERE BCO_FUNC = FUNC_IND  AND BCO_DATA >= (RTRIM(\'01/06/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nBCO_DATA <= (RTRIM(\'30/06/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'JUN\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR)))\r\nFROM BcoHoras WHERE BCO_FUNC = FUNC_IND  AND BCO_DATA >= (RTRIM(\'01/07/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nBCO_DATA <= (RTRIM(\'31/07/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'JUL\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR)))\r\nFROM BcoHoras WHERE BCO_FUNC = FUNC_IND  AND BCO_DATA >= (RTRIM(\'01/08/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nBCO_DATA <= (RTRIM(\'31/08/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'AGO\',\r\n\r\nISNULL((SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(BCO_VALOR)))\r\nFROM BcoHoras WHERE BCO_FUNC = FUNC_IND  AND BCO_DATA >= (RTRIM(\'01/09/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nBCO_DATA <= (RTRIM(\'30/09/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'SET\',\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_HOURLONGTOMINUTE(BCO_VALOR)))\r\nFROM BCOHORAS WHERE BCO_FUNC = FUNC_IND  AND BCO_DATA >= (RTRIM(\'01/10/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nBCO_DATA <= (RTRIM(\'31/10/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'OUT\',\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_HOURLONGTOMINUTE(BCO_VALOR)))\r\nFROM BCOHORAS WHERE BCO_FUNC = FUNC_IND  AND BCO_DATA >= (RTRIM(\'01/11/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nBCO_DATA <= (RTRIM(\'30/11/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'NOV\',\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_HOURLONGTOMINUTE(BCO_VALOR)))\r\nFROM BCOHORAS WHERE BCO_FUNC = FUNC_IND  AND BCO_DATA >= (RTRIM(\'01/12/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nBCO_DATA <= (RTRIM(\'31/12/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'DEC\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN Empresas ON EMP_IND = FUNC_EMPRESA\r\nINNER join BcoHoras on  BCO_FUNC = FUNC_IND\r\n\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL\r\n\r\ngroup by FUNC_NOME, EMP_Nome, FUNC_IND                                    \r\n\r\nOrder By EMP_Nome, FUNC_NOME','Gabriel','2018-10-15 16:14:32'),(567,'Relatorio da quantidade de funcionarios ativos','RELATORIOS','SELECT COUNT(*)  AS Quantidade  \r\nFROM Funcionarios\r\nwhere FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL','Gabriel','2018-10-16 16:28:10'),(568,'ALterar \"inicio da semana\" de domingo para segunda - gertec.','RELOGIO','Seta para direita> senha 000000> opÃ§Ã£o 0. RelÃ³gio> Apertar tecla \"entra\"> navegar com as setas atÃ© o dia (domingo)> apertar o nÃºmero 2 (irÃ¡ alterar para segunda> entra.','Alessandro Sena','2018-10-22 16:52:07'),(569,'power Shell ','INSTALAR SQL','https://support.microsoft.com/pt-br/help/968929/windows-management-framework-windows-powershell-2-0-winrm-2-0-and-bits','Gabriel','2018-10-22 17:15:18'),(570,'HENRY SUPER FACIL - Login web','RELOGIO','Login: rep\r\nsenha: 121314\r\n\r\ncaso nao funcione verificar com cliente login correto','Gabriel','2018-10-23 15:34:40'),(571,'ODBC','CRIAR ESTACAO','1.	Clique no botÃ£o Iniciar , clique em configuraÃ§Ãµese, em seguida, clique em Painel de controle.\r\n2.	Se vocÃª estiver usando o Windows NT, clique duas vezes em Fontes de dados (ODBC). Para o Windows 2000 e XP, clique duas vezes em Ferramentas administrativase, em seguida, clique duas vezes em Fontes de dados (ODBC) . A janela ODBC Data Source Administrator deve aparecer.\r\n3.	Para criar uma fonte de dados para o atual usuÃ¡rio somente, clique na guia DSN de usuÃ¡rio . Para criar uma fonte de dados para todos os usuÃ¡rios do computador, clique na guia DSN de sistema FRx Software recomenda o uso de um DSN de sistema para todas as fontes de dados, mesmo se o computador for usado somente por um usuÃ¡rio.\r\n4.	Clique no botÃ£o Adicionar . Ã‰ exibida a janela Criar nova fonte de dados .\r\n5.	Selecione o driver Do SQL Server e, em seguida, clique em Concluir. Ã‰ exibida a janela Criar nova fonte de dados para SQL Server .\r\n6.	Digite um nome para a fonte de dados na caixa nome .\r\n7.	Se desejar, digite uma descriÃ§Ã£o para a fonte de dados na caixa DescriÃ§Ã£o .\r\n8.	Na caixa servidor , digite o nome do servidor para o qual a fonte de dados se conectar e, em seguida, clique em AvanÃ§ar.\r\n9.	Escolha o mÃ©todo de autenticaÃ§Ã£o necessÃ¡rio para conexÃ£o com o SQL Server.\r\n10.	Se a autenticaÃ§Ã£o do SQL Server foi escolhida na etapa 9, digite um ID de Login e senhae, em seguida, clique em AvanÃ§ar.\r\n11.	Se um nome de banco de dados nÃ£o pode ser especificado no aplicativo que irÃ¡ usar esta fonte de dados, marque a caixa de seleÃ§Ã£o alterar o banco de dados padrÃ£o e em seguida, selecione o banco de dados da lista suspensa. Se o aplicativo permitir que um nome de banco de dados deve ser especificado, que esta etapa nÃ£o Ã© necessÃ¡ria - o aplicativo fornecerÃ¡ o banco de dados padrÃ£o ao se conectar Ã  fonte de dados.\r\n12.	Todas as outras caixas de seleÃ§Ã£o na tela podem ser deixadas sozinhos, a menos que as alteraÃ§Ãµes especÃ­ficas sÃ£o necessÃ¡rias para o servidor ou o ambiente. Clique em AvanÃ§ar.\r\n13.	Todas as opÃ§Ãµes nesta tela podem ficar sozinho, a menos que as alteraÃ§Ãµes especÃ­ficas sÃ£o necessÃ¡rias para o servidor ou o ambiente. Clique em Concluir.\r\n14.	Clique no botÃ£o Testar fonte de dados e verifique se ele testa com Ãªxito.\r\n15.	Clique em Okeye, em seguida, clique em Okey novamente para retornar Ã  janela ODBC Data Source Administrator .\r\n16.	Clique Okey para fechar a janela ODBC Data Source Administrator .\r\n\r\n','Gabriel','2018-10-25 18:04:45'),(572,'relatorio das informaÃ§oes do registro eletronico - funcionario selecionado','RELATORIOS','--LARGURA#200,120,60,70,80,70,150,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70#                    \r\n/****** Script do comando SelectTopNRows de SSMS  ******/\r\ndeclare @DATAINICIAL smalldatetime =  %DATAINICIAL%\r\ndeclare @DATAFINAL smalldatetime = %DATAFINAL%\r\ndeclare @DATA smalldatetime = \'00:00\'               \r\n\r\nSELECT DISTINCT func_nome Nome, car_descricao Cargo, case [REG_INSTRUCAO] when \'S\' then \'Superior\' when \'A\'\r\nthen \'Alnafabeto\' when \'1\' then \'1Âº grau\' when \'2\' then \'2Âº grau\' end \'Escolaridade\'\r\n,case when (SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_TRABN))) from calculo\r\nwhere CAL_DATA >= @DATAINICIAL AND CAL_DATA <= @DATAFINAL and FUNC_IND = CAL_FUNC) > @DATA then \'Noturno\'\r\nelse \'Diurno\' end Periodo\r\n, FUNC_DT_ADM Adminssao, RTRIM(REG_DOM_TEL1) + \' - \' + RTRIM(REG_DOM_TEL2) Telefone\r\n,RTRIM(REG_DOM_LOGRADOURO) + \', \' + RTRIM(REG_DOM_NUMERO) + \' \' + RTRIM(REG_DOM_COMPLEMENTO) EndereÃ§o,\r\nRTRIM(REG_DOM_CIDADE) + \' \' + RTRIM(REG_DOM_UF) Cidade\r\n,[REG_DOM_BAIRRO] BAIRRO, [REG_DOM_CEP] CEP, REG_NASC_DATA \'Data Nascimento\'\r\n,[REG_RG_NUMERO] RG,[REG_RG_UF] UF ,[REG_RG_DATA] \'Data Emissao\'\r\n, REG_NASC_NATURAL \'MunicÃ­pio de Nascimento\',[REG_CPF_NUMERO] CPF\r\n, Func_PIS PIS,[REG_CT_NUMERO] \'Carteira de Trabalho\' ,[REG_CT_SERIE] Serie,[REG_CT_DATA] \'Data Emissao\'\r\n, RTRIM(REG_FIL_MAE) \'Mae\',  RTRIM(REG_FIL_PAI) \'Pai\'\r\n,case [REG_EST_CIVIL] when \'S\' then \'Solteiro\' when \'E\' then \'Separado\' when \'Q\' then \'Desquitado\'\r\n when \'C\' then \'Casado\' when \'V\' then \'ViÃºva\'  when \'D\' then \'Divorciado\' end \'Esta Civil\'\r\n,[REG_PIS_BANCO] Banco ,[REG_PIS_AGENCIA] Agencia\r\n\r\n\r\n\r\nFROM [Registro]\r\ninner join funcionarios on func_ind = reg_func\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nINNER JOIN calculo ON FUNC_IND = CAL_FUNC\r\n\r\nwhere FUNC_IND = %FUNCIONARIO% and CAL_DATA >= @DATAINICIAL AND CAL_DATA <= @DATAFINAL','Gabriel','2018-10-26 22:04:50'),(573,'relatorio das informaÃ§oes do registro eletronico','RELATORIOS','--LARGURA#200,120,60,70,80,70,150,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70#                    \r\n/****** Script do comando SelectTopNRows de SSMS  ******/\r\ndeclare @DATAINICIAL smalldatetime =  %DATAINICIAL%\r\ndeclare @DATAFINAL smalldatetime = %DATAFINAL%\r\ndeclare @DATA smalldatetime = \'00:00\'               \r\n\r\nSELECT DISTINCT func_nome Nome, car_descricao Cargo, case [REG_INSTRUCAO] when \'S\' then \'Superior\' when \'A\'\r\nthen \'Alnafabeto\' when \'1\' then \'1Âº grau\' when \'2\' then \'2Âº grau\' end \'Escolaridade\'\r\n,case when (SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_TRABN))) from calculo\r\nwhere CAL_DATA >= @DATAINICIAL AND CAL_DATA <= @DATAFINAL and FUNC_IND = CAL_FUNC) > @DATA then \'Noturno\'\r\nelse \'Diurno\' end Periodo\r\n, FUNC_DT_ADM Adminssao, RTRIM(REG_DOM_TEL1) + \' - \' + RTRIM(REG_DOM_TEL2) Telefone\r\n,RTRIM(REG_DOM_LOGRADOURO) + \', \' + RTRIM(REG_DOM_NUMERO) + \' \' + RTRIM(REG_DOM_COMPLEMENTO) EndereÃ§o,\r\nRTRIM(REG_DOM_CIDADE) + \' \' + RTRIM(REG_DOM_UF) Cidade\r\n,[REG_DOM_BAIRRO] BAIRRO, [REG_DOM_CEP] CEP, REG_NASC_DATA \'Data Nascimento\'\r\n,[REG_RG_NUMERO] RG,[REG_RG_UF] UF ,[REG_RG_DATA] \'Data Emissao\'\r\n, REG_NASC_NATURAL \'MunicÃ­pio de Nascimento\',[REG_CPF_NUMERO] CPF\r\n, Func_PIS PIS,[REG_CT_NUMERO] \'Carteira de Trabalho\' ,[REG_CT_SERIE] Serie,[REG_CT_DATA] \'Data Emissao\'\r\n, RTRIM(REG_FIL_MAE) \'Mae\',  RTRIM(REG_FIL_PAI) \'Pai\'\r\n,case [REG_EST_CIVIL] when \'S\' then \'Solteiro\' when \'E\' then \'Separado\' when \'Q\' then \'Desquitado\'\r\n when \'C\' then \'Casado\' when \'V\' then \'ViÃºva\'  when \'D\' then \'Divorciado\' end \'Esta Civil\'\r\n,[REG_PIS_BANCO] Banco ,[REG_PIS_AGENCIA] Agencia\r\n\r\n\r\n\r\nFROM [Registro]\r\ninner join funcionarios on func_ind = reg_func\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nINNER JOIN calculo ON FUNC_IND = CAL_FUNC\r\n\r\nwhere CAL_DATA >= @DATAINICIAL AND CAL_DATA <= @DATAFINAL','Gabriel','2018-10-26 22:05:06'),(574,'Relatorio de Extas, faltas, abono detalhado','RELATORIOS','--GRUPOQUEBRA#1#                                                      \r\n--LARGURA#70,250,180,50,50,50,50,50,50,50#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#1#\r\ndeclare @datainicial  nvarchar(50)\r\ndeclare @datafinal  nvarchar(50)\r\nset @datainicial =  %DATAINICIAL%\r\nset @datafinal = %DATAFINAL%                                \r\n\r\nSELECT dbo.fn_getdate(CAL_DATA) AS \'DATA\',Func_nome AS \'NOME\',emp_nome DEP, \r\n\r\nISNULL(dbo.fn_gettime5nullzero(CAL_FALTAHORA), \'\') AS FALTAS,                                                                 \r\nISNULL(dbo.fn_gettime5nullzero(CAL_ABONO), \'\') ABONOS,\r\nISNULL(dbo.fn_gettime5nullzero(CAL_EXTRA), \'\') AS \'HE\',\r\nISNULL(dbo.fn_gettime5nullzero(CAL_EXTRAn), \'\') AS \'HE N\',\r\nISNULL(dbo.fn_gettime5nullzero(CAL_EXTRAF), \'\') AS \'HE F\',          \r\nISNULL(dbo.fn_gettime5nullzero(CAL_EXTRANF), \'\') AS \'HE NF\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\ninner join empresas on func_empresa = emp_ind\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL and cal_data >= @datainicial and CAL_DATA <= @datafinal and\r\n(CAL_FALTAHORA > 0 or CAL_ABONO > 0 or CAL_EXTRA > 0 or CAL_EXTRAn > 0 or CAL_EXTRAF > 0 or CAL_EXTRANF > 0 )                               \r\n                                                                                             \r\ngroup by FUNC_NOME, CAL_DATA,FUNC_IND,CAL_ABONO,CAL_DESCONTO,CAL_EXTRA,\r\nCAL_EXTRAn,CAL_NOTURNO,CAL_FALTAHORA, emp_nome,CAL_EXTRAF, CAL_EXTRANF\r\nOrder By emp_nome, FUNC_NOME, CAL_DATA','Gabriel','2018-10-29 17:47:00'),(575,'RELATORIO DE EXTAS, FALTAS, ABONO TOtalizaso','RELATORIOS','--LARGURA#250,180,50,50,50,50,50,50,50#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#1#\r\ndeclare @datainicial  nvarchar(50)\r\ndeclare @datafinal  nvarchar(50)\r\nset @datainicial =  %DATAINICIAL%\r\nset @datafinal = %DATAFINAL%                                \r\n\r\nSELECT Func_nome AS \'NOME\',emp_nome DEP,\r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_FALTAHORA)))), \'\') AS FALTAS,\r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_ABONO)))), \'\') AS ABONOS, \r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_EXTRA)))), \'\') AS \'EXTRA\',\r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_EXTRAn)))), \'\') AS \'EXTRA N\',\r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_EXTRAF)))), \'\') AS \'EXTRA F\',\r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_EXTRANF)))), \'\') AS \'EXTRA NF\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\ninner join empresas on func_empresa = emp_ind\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL and cal_data >= @datainicial and CAL_DATA <= @datafinal and\r\n(CAL_FALTAHORA > 0 or CAL_ABONO > 0 or CAL_EXTRA > 0 or CAL_EXTRAn > 0 or CAL_EXTRAF > 0 or CAL_EXTRANF > 0 )                               \r\n\r\ngroup by FUNC_NOME, FUNC_IND, emp_nome                          \r\nOrder By emp_nome, FUNC_NOME','Gabriel','2018-10-29 18:05:35'),(576,'Recarregar tabelas ponto','COMANDOS','UPDATE [BD]\r\n   SET [BD_VERSAO_TBL] = 150\r\n      ,[BD_VERSAO_STP] = 400\r\nGO','Gabriel','2018-11-01 15:34:40'),(577,'cartao de proximidade','RELOGIO','para cadastrar cartao de proximidade sempre precisa estar marcado a opÃ§ao de hexadecimal no cracha\r\na ordem para testar as numeraÃ§oes S, W, A\r\n\r\nem alguns relogios precisa fazer CONFIGURAÃ‡Ã•ES especificas, como gertec bpd e D precisa usar o executavel de proximidade que esta na pasta antigos do relogio\r\n\r\nno caso do G3 precisa configurar o cartao de proximidade e um numero normal de cracha\r\n\r\nnos relogios ADV da henry geralmente deve utilizar o numero do \"W\" para enviar os funcionarios\r\n\r\nno control id caso nao consiga enviar o funcionario com a numeracao, solicite para o cliente cadastrar direto no relogio, menu usuarios, seleciona o funcionario, clica no desenho do cartao, passe o cartao na tela para gravar.\r\n','Gabriel','2018-11-01 22:46:50'),(578,'Relatorio de marcaÃ§oes, credito, debito, saldo sem saldo anterior e saldo','RELATORIOS','--ORIENTACAO#paisagem#\r\n--GRUPOQUEBRA#1#\r\n--LARGURA#80,200,60,40,45,50,60,60,60,60,60,60,60,70,70,80#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#1#\r\nSELECT dbo.fn_getdate(CAL_DATA) AS \'DATA\', FUNC_NOME \'NOME\',\r\ncase when DATEPART(weekday, CAL_DATA) = 1 and APO_MARCACAO1 is null then \'DOMINGO\' \r\nWHEN APO_MARCACAO1 is null and DATEPART(weekday, CAL_DATA) = 7 then \'SABADO\'\r\nWHEN APO_H = -990 THEN \'FOLGA\' WHEN APO_H = -994 then \'FERIADO\'\r\nelse dbo.fn_gettimefull(APO_MARCACAO1) end AS \'Entrada1\',\r\ndbo.fn_gettimefull(APO_MARCACAO2) AS \'Saida1\',\r\ndbo.fn_gettimefull(APO_MARCACAO3) AS \'Entrada2\',\r\ndbo.fn_gettimefull(APO_MARCACAO4) AS \'Saida2\',\r\ndbo.fn_gettimefull(APO_MARCACAO5) AS \'Entrada3\',\r\ndbo.fn_gettimefull(APO_MARCACAO6) AS \'Saida3\',\r\n\r\nISNULL(dbo.fn_gettime5nullzero(CAL_ATRB), \'\') AS \'ATRAB\',\r\n\r\nCASE WHEN CAL_FALTAHORA > 0 and CAL_DATA <= GETDATE() THEN \'FALTA\' ELSE ISNULL(dbo.fn_gettime5nullzero(CAL_TRAB), \'\')  end AS \'TRAB\'\r\n,\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA AND\r\nSUBSTRING(BCO_VALOR, 1, 1) <> \'-\') AS CREDITO,\r\n\r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA\r\nAND SUBSTRING(BCO_VALOR, 1, 1) = \'-\') AS DEBITO,\r\n                                           \r\n(SELECT dbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute\r\n(BCO_VALOR))) FROM BcoHoras\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA) AS \'SALDO DIA\',\r\n                                                               \r\n\r\ndbo.fn_minutetohourlong(SUM(dbo.fn_hourlongtominute(dbo.fn_get_banco_saldo_totalizado_dia(func_ind,CAL_DATA))) -\r\n(SELECT SUM(dbo.fn_hourlongtominute(BCO_VALOR)) FROM BcoHoras WHERE BCO_FUNC = FUNC_IND AND BCO_DATA < %DATAINICIAL%))AS \'SALDO MES\',    \r\n\r\ndbo.fn_get_banco_saldo_totalizado_dia(func_ind,CAL_DATA) AS \'SALDO TOTAL\'\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL\r\nAND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%\r\ngroup by FUNC_NOME, CAL_DATA, CAL_TRAB,CAL_ATRB,FUNC_IND,CAL_EXTRAF, CAL_EXTRANF,CAL_EXTRA,apo_Hv, APO_MARCACAO6,\r\nCAL_EXTRAn,APO_MARCACAO1,APO_MARCACAO2,APO_MARCACAO3,APO_MARCACAO4,CAL_DESCONTO,CAL_FALTAHORA,APO_H,APO_MARCACAO5              \r\nOrder By FUNC_NOME, CAL_DATA','Gabriel','2018-11-07 20:28:49'),(579,'Erro ao enviar NF-e: Forbidden (403)','ASSEFIN','https://www.essystem.com.br/downloads/erro_403_forbidden_acess_denied.pdf','Gabriel','2018-11-08 15:39:47'),(580,'ERRO AO ENVIAR NF-E: FORBIDDEN (403)','ASSEFIN','VÃ¡ atÃ© o Painel de Controle do Windows.\r\nEscolha a OpÃ§Ã£o \"OpÃ§Ãµes da Internet\"; \r\n \r\nVÃ¡ atÃ© a aba â€œAvanÃ§adasâ€;\r\nno bloco â€œConfiguraÃ§Ãµesâ€, vÃ¡ atÃ© as Ãºltimas opÃ§Ãµes;\r\nMarque: NÃ£o salvar pÃ¡ginas criptografadas em disco; \r\nMarque: Usar SSL 3.0;  \r\nDesmarque: Usar SSL 2.0;  \r\nMarque: Usar TLS 1.0;  \r\nDesmarque: Usar TLS 1.1; \r\nMarque: Usar TLS 1.2;  \r\nMARQUE: Usar HTTP 1.1;\r\nDESMARQUE: Verificar revogaÃ§Ã£o de certificados do servidor;\r\nDESMARQUE: Permitir que o software seja executado ou instalado mesmo que a assinatura seja invÃ¡lida;\r\nDESMARQUE: Usar HTTP 1.1 atravÃ©s de conexÃµes proxy.\r\nMARQUE: VERIFICAR SE HÃ ASSINATURAS EM PROGRAMAS  BAIXADOS\r\nMARQUE: VERIFICAR SE HA CERTIFICADOS REVOGADOS DO FORNECEDOR\r\n\r\nAgora clique na ABA, ConteÃºdo, clique na opÃ§Ã£o, Limpar estado SSL,\r\nespere a confirmaÃ§Ã£o e passe para prÃ³xima ABA;\r\n\r\nSerÃ¡ aberta uma nova Janela com vÃ¡rias ABAS, vamos a primeira\r\nconfiguraÃ§Ã£o a ser feita. Clique na Aba Privacidade, nesta aba vocÃª\r\ndeve baixar a barra de Cookies para opÃ§Ã£o, Aceitar Todos os\r\nCookies, como mostra a imagem abaixo;\r\n\r\n','Gabriel','2018-11-08 16:17:33'),(583,'TOTAL DE PENDENCIAS NO MES','RELATORIOS','set dateformat dmy;\r\nSELECT SUP_NOME,\r\nCOUNT(CASE WHEN PEN_TIPO_ATENDIMENTO = \'E-MAIL\'	THEN PEN_TIPO_ATENDIMENTO END) AS \'EMAIL\', \r\nCOUNT(CASE WHEN PEN_TIPO_ATENDIMENTO = \'REMOTO\'   THEN PEN_TIPO_ATENDIMENTO END) + \r\nCOUNT(CASE WHEN PEN_TIPO_ATENDIMENTO = \'TELEFONE-REMOTO\' THEN PEN_TIPO_ATENDIMENTO END) AS \'REMOTO\', \r\nCOUNT(CASE WHEN PEN_TIPO_ATENDIMENTO = \'SKYPE\'	THEN PEN_TIPO_ATENDIMENTO END) AS \'SKYPE\',\r\nCOUNT(CASE WHEN PEN_TIPO_ATENDIMENTO = \'TELEFONE\' THEN PEN_TIPO_ATENDIMENTO END) + \r\nCOUNT(CASE WHEN PEN_TIPO_ATENDIMENTO = \'TELEFONE-REMOTO\' THEN PEN_TIPO_ATENDIMENTO END) AS \'TELEFONE\',\r\nCOUNT(CASE WHEN PEN_TIPO_ATENDIMENTO = \'WHATSAPP\' THEN PEN_TIPO_ATENDIMENTO END) AS \'WHATSAPP\',\r\nsum(case when PEN_ind >= 0 then 1 else 0 end)\r\n      \r\n  FROM AssepontoSuporte\r\n  inner join [AssepontoPendencias] on SUP_IND = PEN_RESPONSAVEL1\r\n  where [SUP_SETOR] = 3 and CONVERT(DATE, PEN_DATAHORASOLUCAO) >= \'01-10-2018\' \r\n  and CONVERT(DATE, PEN_DATAHORASOLUCAO) <= \'31-10-2018\'\r\n  group by SUP_NOME, SUP_IND\r\n  order by SUP_NOME\r\n\r\n','Gabriel','2018-11-09 19:39:18'),(584,'Relatorio nome, cargo, cpf, endereÃ§o e empresa','RELATORIOS','--LARGURA#200,120,80,80,80,80,80,80,80,70,70,70,70,70,70#\r\n\r\nSELECT DISTINCT func_nome Nome, car_descricao Cargo\r\n,RTRIM(REG_DOM_LOGRADOURO) + \', \' + RTRIM(REG_DOM_NUMERO) + \' \' + RTRIM(REG_DOM_COMPLEMENTO) EndereÃ§o\r\n,[REG_DOM_BAIRRO] BAIRRO, RTRIM(REG_DOM_CIDADE) + \' \' + RTRIM(REG_DOM_UF) Cidade\r\n,[REG_DOM_CEP] CEP,[REG_CPF_NUMERO] CPF, Emp_nome Empresa, Emp_CNPj CNPJ\r\n\r\n\r\nFROM [Registro]\r\ninner join funcionarios on func_ind = reg_func\r\nINNER JOIN Cargos ON CAR_IND = FUNC_CARGO\r\ninner join empresas on func_empresa = emp_ind','Gabriel','2018-11-12 14:14:57'),(585,'Relatorio Nome do funcionario - cargo - Dias - marcaÃ§oes - Extras - atrab - descontos - Folgas - Atestados','RELATORIOS','--GRUPOQUEBRA#1#\r\n--ORIENTACAO#paisagem#\r\n--LARGURA#80,200,100,45,40,45,50,50,60,60,60,60,60,60,120#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#1#\r\nSELECT dbo.fn_getdate(CAL_DATA) AS \'Data\', FUNC_NOME \'Nome\', CAR_DESCRICAO as Cargo,\r\ndbo.fn_gettimefull(APO_MARCACAO1) AS \'Entrada1\',\r\ndbo.fn_gettimefull(APO_MARCACAO2) AS \'Saida1\',\r\ndbo.fn_gettimefull(APO_MARCACAO3) AS \'Entrada2\',                                         \r\ndbo.fn_gettimefull(APO_MARCACAO4) AS \'Saida2\',\r\n\r\nISNULL(dbo.fn_gettime5nullzero(CAL_ATRB), \'\') AS \'A Trabalhar\',\r\nISNULL(dbo.fn_gettime5nullzero(CAL_TRAB), \'\') AS \'Trabalhadas\',\r\n\r\nISNULL(dbo.fn_gettime5nullzero(CAL_EXTRA + CAL_EXTRAn), \'\') AS \'HE\',\r\n\r\nISNULL(dbo.fn_gettime5nullzero(CAL_EXTRAF + CAL_EXTRANF), \'\') AS \'HE F/F\',\r\n\r\nCASE WHEN CAL_FALTAHORA > 0 THEN \'\' else dbo.fn_gettime5nullzero(CAL_DESCONTO) end AS Desconto,\r\n\r\nCASE WHEN CAL_FALTAHORA > 0 THEN \'FALTA\' WHEN APO_H = -990 THEN \'FOLGA\' WHEN APO_H = -994 then \'FERIADO\'  WHEN APO_DSR <> 0 THEN \'DSR\' ELSE \r\n\'\' END AS \'Faltas/Folgas\',\r\n\r\n(CASE WHEN CAL_ABONO > 0 THEN CONVERT(VARCHAR(5),(CAL_ABONO),108) ELSE \'\' END) as \'Abonado\',\r\nCASE WHEN CAL_ABONO > 0 THEN (SELECT JUS_DESCRICAO FROM\r\njustificativas WHERE JUS_FUNC = CAL_FUNC AND JUS_DATA = CAL_DATA) ELSE \'\' END  AS Justigicativa  \r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nLEFT JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL \r\nAND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%\r\ngroup by FUNC_NOME, CAL_DATA, CAL_TRAB,CAL_ATRB,FUNC_IND,CAL_EXTRAF, CAL_EXTRANF,CAL_EXTRA,apo_Hv,CAL_ABONO,CAR_DESCRICAO,\r\nCAL_EXTRAn,APO_MARCACAO1,APO_MARCACAO2,APO_MARCACAO3,APO_MARCACAO4,CAL_DESCONTO,CAL_FALTAHORA,APO_H,APO_DSR,CAL_FUNC\r\nOrder By FUNC_NOME, CAL_DATA','Gabriel','2018-11-12 14:30:41'),(586,'RELOGIOS ATHOS','RELOGIO','athos nao fabrica relogios, somente revende relogios de outras empresas com outro nome\r\nentao entre no site da athos para identificar qual a marca correta do relogio pela foto.\r\n\r\nhttp://www.athos.net/categorias-produtos/rep-s','Gabriel','2018-11-12 18:01:37'),(587,'Cadastro de um novo horÃ¡rio fixo','UTILIDADES','Novo horÃ¡rio fixo: \r\ncampo DESCRIÃ‡ÃƒO colocar o horÃ¡rio que serÃ¡ feito. Ex: 08:30-12:00-13:00-18:00\r\n\r\nMenu Tabelas> Expedientes> Novo HorÃ¡rio Fixo> 1Âº perÃ­odo preencher a entrada e o inÃ­cio do intervalo> ao lado de \"definir faixa automaticamente \" colocar 3 horas e clicar sobre \"definir faixa automaticamente\"> Definir as tolerÃ¢ncias mÃ­nimas de 10 minutos> 2Âº perÃ­odo> entrada PREENCHER com o retorno do intervalo e definir a saÃ­da com o TÃ‰RMINO do expediente> ao lado de \"definir faixa automaticamente \" colocar 3 horas e clicar sobre \"definir faixa automaticamente\"> Definir as tolerÃ¢ncias mÃ­nimas de 10 minutos> em opÃ§Ãµes selecionar a opÃ§Ã£o compensa no intervalo> clicar em ok.\r\n','marina','2018-11-12 19:40:40'),(588,'RELATORIO NOME, CARGO, CPF, ENDEREÃ‡O E EMPRESA','RELATORIOS','--LARGURA#200,120,80,80,80,80,80,80,80,70,70,70,70,70,70#\r\nSELECT DISTINCT FUNC_NOME NOME, CAR_DESCRICAO CARGO\r\n,RTRIM(REG_DOM_LOGRADOURO) + \', \' + RTRIM(REG_DOM_NUMERO) + \' \' + RTRIM(REG_DOM_COMPLEMENTO) ENDEREÃ‡O\r\n,[REG_DOM_BAIRRO] BAIRRO, RTRIM(REG_DOM_CIDADE) + \' \' + RTRIM(REG_DOM_UF) CIDADE\r\n,[REG_DOM_CEP] CEP,[REG_CPF_NUMERO] CPF, EMP_NOME EMPRESA, EMP_CNPJ CNPJ\r\n\r\nFROM FUNCIONARIOS\r\nleft JOIN REGISTRO ON FUNC_IND = REG_FUNC\r\nINNER JOIN EMPRESAS ON FUNC_EMPRESA = EMP_IND\r\nleft JOIN CARGOS ON CAR_IND = FUNC_CARGO\r\nwhere dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1 and FUNC_DT_DEM IS NULL AND FUNC_MARCADO_EXCLUSAO = 0\r\norder by EMP_NOME, FUNC_NOME','Gabriel','2018-11-12 20:41:37'),(589,'ZPM - Senha CLrep','RELOGIO','Administrador: REPZPM\r\nSupervisor: SUPREP\r\nUsuÃ¡rio: USERREP','Gabriel','2018-11-13 13:44:59'),(590,'funcionÃ¡rios inativos, cargo, data de admissÃ£o, data de demissÃ£o','RELATORIOS','SELECT FUNC_NOME AS NOME, CAR_DESCRICAO CARGO, FUNC_DT_ADM AS ADMISSAO, FUNC_DT_DEM AS DEMISSAO \r\n\r\nFROM FUNCIONARIOS\r\nINNER JOIN EMPRESAS ON  FUNC_EMPRESA = EMP_IND\r\nleft JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nwhere dbo.fn_departamentopertencente(FUNC_EMPRESA,\r\n%DEPSELECIONADOIND%) = 1 and FUNC_DT_DEM is not null\r\nORDER BY FUNC_NOME\r\n','Gabriel','2018-11-13 20:44:26'),(591,'gertec g3 - erro A fonte segoe Ui light nao da suporte ao estilo regular','RELOGIO','Ã© preciso instalar a fonte novamente, \r\nbaixando ela no link abaixo, descompactando e instalando\r\n\r\nhttps://www.wfonts.com/download/data/2016/07/06/segoe-ui-light/segoe-ui-light.zip\r\n','Gabriel','2018-11-14 20:01:31'),(592,'Erro de assinatura no win 7','ASSEFIN','VÃ¡ atÃ© o Painel de Controle do Windows.\r\nEscolha a OpÃ§Ã£o \"OpÃ§Ãµes da Internet\"; \r\n \r\nVÃ¡ atÃ© a aba â€œAvanÃ§adasâ€;\r\nno bloco â€œConfiguraÃ§Ãµesâ€, vÃ¡ atÃ© as Ãºltimas opÃ§Ãµes;\r\nMarque: NÃ£o salvar pÃ¡ginas criptografadas em disco; \r\nMarque: Usar SSL 3.0;  \r\nDesmarque: Usar SSL 2.0;  \r\nMarque: Usar TLS 1.0;  \r\nDesmarque: Usar TLS 1.1; \r\nMarque: Usar TLS 1.2;  \r\nMARQUE: Usar HTTP 1.1;\r\nDESMARQUE: Verificar revogaÃ§Ã£o de certificados do servidor;\r\nDESMARQUE: Permitir que o software seja executado ou instalado mesmo que a assinatura seja invÃ¡lida;\r\nDESMARQUE: Usar HTTP 1.1 atravÃ©s de conexÃµes proxy.\r\nMARQUE: VERIFICAR SE HÃ ASSINATURAS EM PROGRAMAS  BAIXADOS\r\nMARQUE: VERIFICAR SE HA CERTIFICADOS REVOGADOS DO FORNECEDOR\r\n\r\nAgora clique na ABA, ConteÃºdo, clique na opÃ§Ã£o, Limpar estado SSL,\r\nespere a confirmaÃ§Ã£o e passe para prÃ³xima ABA;\r\n\r\nSerÃ¡ aberta uma nova Janela com vÃ¡rias ABAS, vamos a primeira\r\nconfiguraÃ§Ã£o a ser feita. Clique na Aba Privacidade, nesta aba vocÃª\r\ndeve baixar a barra de Cookies para opÃ§Ã£o, Aceitar Todos os\r\nCookies, como mostra a imagem abaixo;\r\n\r\ncaso erro continue, desistale reinicie a maquina e instale o certificado','Gabriel','2018-11-16 13:28:58'),(593,'Relatorio de quantidade de faltas e abonos no ano','RELATORIOS','--LARGURA#250,180,50,50,50,50,50,50,50#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#1#\r\ndeclare @datainicial  nvarchar(10)\r\ndeclare @datafinal  nvarchar(10)\r\nset @datainicial =  \'01/01/2018\'\r\nset @datafinal = \'31/12/2018\'                                \r\n\r\nSELECT Func_nome AS \'NOME\',emp_nome DEP,\r\n\r\nsum(case when CAL_FALTAHORA > 0 then 1 end) AS FALTAS,\r\nsum(case when CAL_ABONO > 0 and jus_descricao <> \'problema no cartÃ£o ponto\'\r\nand jus_descricao <> \'abonado pela chefia\' then 1 end) AS ABONOS\r\n\r\n\r\nFROM Funcionarios                                                                                                \r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\ninner join empresas on func_empresa = emp_ind\r\nleft join justificativas on JUS_FUNC = CAL_FUNC AND JUS_DATA = CAL_DATA  \r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1                                        \r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL and cal_data >= @datainicial and CAL_DATA <= @datafinal and\r\n(CAL_FALTAHORA > 0 or CAL_ABONO > 0 )         \r\n         \r\ngroup by FUNC_NOME, FUNC_IND, emp_nome                          \r\nOrder By emp_nome, FUNC_NOME','Gabriel','2018-11-23 13:48:22'),(594,'RELATORIO DE QUANTIDADE DE FALTAS E ABONOS em horas NO ANO','RELATORIOS','--LARGURA#250,180,80,80#                 \r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#1#\r\ndeclare @datainicial  nvarchar(10)\r\ndeclare @datafinal  nvarchar(10)\r\nset @datainicial =  \'01/01/2018\'\r\nset @datafinal = \'31/12/2018\'                                \r\n\r\nSELECT Func_nome AS \'NOME\',emp_nome DEP,\r\n\r\nISNULL(dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM\r\n(dbo.fn_smalldatetimetominute(CAL_FALTAHORA)))), \'\') AS FALTAS,\r\n  \r\n(select dbo.fn_hourlongnullzero(dbo.fn_minutetohourlong(SUM(dbo.fn_smalldatetimetominute(CAL_ABONO))))\r\nfrom calculo inner join justificativas on JUS_FUNC = CAL_FUNC AND JUS_DATA = CAL_DATA\r\nwhere CAL_ABONO > 0 and jus_descricao <> \'problema no cartÃ£o ponto\' and jus_descricao <> \'abonado pela chefia\'\r\nand FUNC_IND = CAL_FUNC and JUS_FUNC = CAL_FUNC AND JUS_DATA = CAL_DATA and cal_data >= @datainicial and CAL_DATA <= @datafinal)  AS ABONOS\r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\ninner join empresas on func_empresa = emp_ind\r\nleft join justificativas on JUS_FUNC = CAL_FUNC AND JUS_DATA = CAL_DATA \r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL and cal_data >= @datainicial and CAL_DATA <= @datafinal and\r\n(CAL_FALTAHORA > 0 or CAL_ABONO > 0 )         \r\n\r\ngroup by FUNC_NOME, FUNC_IND, emp_nome\r\nOrder By emp_nome, FUNC_NOME','Gabriel','2018-11-23 15:32:35'),(595,'AGENDAR IMPORTACAO DE MARCAÃ‡OES MANUAL','RELOGIO','pesquisar na maquina o agendador de tarefas e abrir\r\nclicar em biblioteca do agendador\r\nclicar em criar tarefa\r\ndigita o nome da tarefa\r\n\r\nclicar na aba disparadores\r\nnovo\r\ndeixar marcado uma vez\r\nmarca a opÃ§ao de repetir a tarefa a cada\r\nescolher o de quanto em quanto tempo vai repetir\r\nalterar por um periodo de tempo de: para indefinidamente\r\nmarca habilitado e da ok\r\n\r\nCLICAR NA ABA aÃ§oes\r\nnovo\r\nprocurar o executavel do relogio (lembrando que ele precisa estar na unidade c: ou documentos)\r\nem adicione argumentos coloque: /import\r\n( essa opÃ§ao pode variar se vc precisar importar as marcaÃ§oes de um ÃšNICO relogio, se for esse o caso deve ficar desta forma: \r\n/import /ip:192.168.1.196 /terminalNome:\"dimep\"\r\no ip Ã© o ip do relogio)\r\n\r\napos isso pode dar ok e ok novamente\r\nclica com botao direito na tarefa que vc criou e vai em executar\r\nverifique se esta importando\r\ncaso de algum erro arraste a barra para o lado e olhe a coluna de resultado da ultima execucao\r\n\r\n\r\nobs: em alguns casos Ã© preciso configurar outro usuario na aba geral da tarefa, pois dependendo das restriÃ§oes da maquina pode nao funcionar','gabriel','2018-11-28 22:39:53'),(596,'TESTAR IMPORTACAO DE MARCAÃ‡OES AUTOMATICAS','RELOGIO','ABRIR O EXECUTAVEL DO RELOGIO\r\nABRIR O TERMINAL\r\nMARCA A OPÃ‡AO DE INCLUIR TERMINAL NA PROGRAMACAO DE IMPORTACAO DE MARCAÃ‡OES\r\nDA OK\r\nVOLTAR O NSR DO RELOGIO\r\nCONFIGURAR A IMPORTACAO DE MARCAÃ‡OES\r\nAPOS IMPORTACAO VERIFICAR SE NSR MUDOU\r\n\r\n\r\nCASO TENHA MUDADO MAS AS MARCAÃ‡OES NAO APARECERAM\r\n\r\nVERIFICAR ARQUIVO DE MARCAÃ‡OES NA PASTA DO RELOGIO, PROVAVELMENTE VAI ESTAR NA PASTA ASSEPONTO\r\nSE ESTIVER CRIANDO O ARQUIVO ESTA IMPORTANDO NORMAL\r\nCASO NAO TIVER PODE SER RESTRIÃ‡OES DE USUARIO\r\n\r\n\r\nCASO NAO EXECUTE A IMPORTACAO\r\n\r\nEXECUTAR O PROGRAMA DO RELOGIO COMO ADM E AGENDAR A IMPORTACAO NOVAMENTE\r\nCASO NAO FUNCIONE \r\nPESQUISE NA MAQUINA DO CLIENTE O GERENCIADO DE TAREFAS E ABRA\r\nCLIQUE EM biblioteca do agendador\r\nPROCURE SEU AGENDAMENTO E EXECUTE PARA VER O ERRO\r\narraste a barra para o lado e olhe a coluna de resultado da ultima execucao \r\nSE O ERRO FOR RESTRIÃ‡OES DE USUARIO\r\nCRIE O AGENDAMENTO MANUAL\r\nALTERE O USUARIO OU CONFIGURE PARA EXECUTAR COM PRIVILEGIOS MAIS ALTO E EXECUTAR ESTANDO O USUARIO CONECTADO OU NAO\r\n\r\nCASO NAO FUNCIONE \r\nALTERE O USUARIO CLICANDO EM ALTERAR USUARIO OU GRUPO\r\nSELECIONE UM USUARIO ADMINISTRADOR OU SERVIÃ‡O LOCAL\r\nTESTE NOVAMENTE\r\n\r\nCASO NAO FUNCIONE VERIFIQUE COM TI UM USUARIO PAR CONFIGURAR','gabriel','2018-11-28 22:40:15'),(597,'configurar agendador de importacao automaticamente','REDES','pesquisar na maquina o agendador de tarefas e abrir\r\nclicar em biblioteca do agendador\r\nclicar em criar tarefa\r\ndigita o nome da tarefa\r\n\r\nclicar na aba disparadores\r\nnovo\r\ndeixar marcado uma vez\r\nmarca a opÃ§ao de repetir a tarefa a cada\r\nescolher o de quanto em quanto tempo vai repetir\r\nalterar por um periodo de tempo de: para indefinidamente\r\nmarca habilitado e da ok\r\n\r\nCLICAR NA ABA aÃ§oes\r\nnovo\r\nprocurar o executavel do relogio (lembrando que ele precisa estar na unidade c: ou documentos)\r\nem adicione argumentos coloque: /import\r\n( essa opÃ§ao pode variar se vc precisar importar as marcaÃ§oes de um ÃšNICO relogio, se for esse o caso deve ficar desta forma: \r\n/import /ip:192.168.1.196 /terminalNome:\"dimep\"\r\no ip Ã© o ip do relogio)\r\n\r\napos isso pode dar ok e ok novamente\r\nclica com botao direito na tarefa que vc criou e vai em executar\r\nverifique se esta importando\r\ncaso de algum erro arraste a barra para o lado e olhe a coluna de resultado da ultima execucao\r\n\r\n\r\nobs: em alguns casos Ã© preciso configurar outro usuario na aba geral da tarefa, pois dependendo das restriÃ§oes da maquina pode nao funcionar','gabriel','2018-11-29 13:24:47'),(598,'testar agendador de importacao automaticamente','REDES','ABRIR O EXECUTAVEL DO RELOGIO\r\nABRIR O TERMINAL\r\nMARCA A OPÃ‡AO DE INCLUIR TERMINAL NA PROGRAMACAO DE IMPORTACAO DE MARCAÃ‡OES\r\nDA OK\r\nVOLTAR O NSR DO RELOGIO\r\nCONFIGURAR A IMPORTACAO DE MARCAÃ‡OES\r\nAPOS IMPORTACAO VERIFICAR SE NSR MUDOU\r\n\r\n\r\nCASO TENHA MUDADO MAS AS MARCAÃ‡OES NAO APARECERAM\r\n\r\nVERIFICAR ARQUIVO DE MARCAÃ‡OES NA PASTA DO RELOGIO, PROVAVELMENTE VAI ESTAR NA PASTA ASSEPONTO\r\nSE ESTIVER CRIANDO O ARQUIVO ESTA IMPORTANDO NORMAL\r\nCASO NAO TIVER PODE SER RESTRIÃ‡OES DE USUARIO\r\n\r\n\r\nCASO NAO EXECUTE A IMPORTACAO\r\n\r\nEXECUTAR O PROGRAMA DO RELOGIO COMO ADM E AGENDAR A IMPORTACAO NOVAMENTE\r\nCASO NAO FUNCIONE \r\nPESQUISE NA MAQUINA DO CLIENTE O GERENCIADO DE TAREFAS E ABRA\r\nCLIQUE EM biblioteca do agendador\r\nPROCURE SEU AGENDAMENTO E EXECUTE PARA VER O ERRO\r\narraste a barra para o lado e olhe a coluna de resultado da ultima execucao \r\nSE O ERRO FOR RESTRIÃ‡OES DE USUARIO\r\nCRIE O AGENDAMENTO MANUAL\r\nALTERE O USUARIO OU CONFIGURE PARA EXECUTAR COM PRIVILEGIOS MAIS ALTO E EXECUTAR ESTANDO O USUARIO CONECTADO OU NAO\r\n\r\nCASO NAO FUNCIONE \r\nALTERE O USUARIO CLICANDO EM ALTERAR USUARIO OU GRUPO\r\nSELECIONE UM USUARIO ADMINISTRADOR OU SERVIÃ‡O LOCAL\r\nTESTE NOVAMENTE\r\n\r\nCASO NAO FUNCIONE VERIFIQUE COM TI UM USUARIO PAR CONFIGURAR','gabriel','2018-11-29 13:26:09'),(599,'RELATORIO NOME DO FUNCIONARIO - CARGO - DIAS - MARCAÃ‡OES - EXTRAS - ATRAB - DESCONTOS - FOLGAS - ATESTADOS  - individual','RELATORIOS','--GRUPOQUEBRA#1#\r\n--ORIENTACAO#paisagem#\r\n--LARGURA#80,200,100,45,40,45,50,50,60,60,60,60,60,60,120#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#1#\r\nSELECT dbo.fn_getdate(CAL_DATA) AS \'Data\', FUNC_NOME \'Nome\', CAR_DESCRICAO as Cargo,\r\ndbo.fn_gettimefull(APO_MARCACAO1) AS \'Entrada1\',\r\ndbo.fn_gettimefull(APO_MARCACAO2) AS \'Saida1\',\r\ndbo.fn_gettimefull(APO_MARCACAO3) AS \'Entrada2\',                                         \r\ndbo.fn_gettimefull(APO_MARCACAO4) AS \'Saida2\',\r\n\r\nISNULL(dbo.fn_gettime5nullzero(CAL_ATRB), \'\') AS \'A Trabalhar\',\r\nISNULL(dbo.fn_gettime5nullzero(CAL_TRAB), \'\') AS \'Trabalhadas\',\r\n\r\nISNULL(dbo.fn_gettime5nullzero(CAL_EXTRA + CAL_EXTRAn), \'\') AS \'HE\',\r\n\r\nISNULL(dbo.fn_gettime5nullzero(CAL_EXTRAF + CAL_EXTRANF), \'\') AS \'HE F/F\',\r\n\r\nCASE WHEN CAL_FALTAHORA > 0 THEN \'\' else dbo.fn_gettime5nullzero(CAL_DESCONTO) end AS Desconto,\r\n\r\nCASE WHEN CAL_FALTAHORA > 0 THEN \'FALTA\' WHEN APO_H = -990 THEN \'FOLGA\' WHEN APO_H = -994 then \'FERIADO\'  WHEN APO_DSR <> 0 THEN \'DSR\' ELSE \r\n\'\' END AS \'Faltas/Folgas\',\r\n\r\n(CASE WHEN CAL_ABONO > 0 THEN CONVERT(VARCHAR(5),(CAL_ABONO),108) ELSE \'\' END) as \'Abonado\',\r\nCASE WHEN CAL_ABONO > 0 THEN (SELECT JUS_DESCRICAO FROM\r\njustificativas WHERE JUS_FUNC = CAL_FUNC AND JUS_DATA = CAL_DATA) ELSE \'\' END  AS Justigicativa  \r\n\r\nFROM Funcionarios\r\nINNER JOIN Calculo ON FUNC_IND = CAL_FUNC\r\nLEFT JOIN Aponta ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nLEFT JOIN Cargos ON CAR_IND = FUNC_CARGO\r\nWHERE dbo.fn_departamentopertencente(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL and FUNC_IND = %FUNCIONARIO%\r\nAND CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL%\r\ngroup by FUNC_NOME, CAL_DATA, CAL_TRAB,CAL_ATRB,FUNC_IND,CAL_EXTRAF, CAL_EXTRANF,CAL_EXTRA,apo_Hv,CAL_ABONO,CAR_DESCRICAO,\r\nCAL_EXTRAn,APO_MARCACAO1,APO_MARCACAO2,APO_MARCACAO3,APO_MARCACAO4,CAL_DESCONTO,CAL_FALTAHORA,APO_H,APO_DSR,CAL_FUNC\r\nOrder By FUNC_NOME, CAL_DATA','gabriel','2018-11-29 17:41:39'),(600,'desconsiderar banco de horas','COMANDOS','esse comando esta configurado para desconsiderar antes da data de inicio do funcionario selecionado\r\n\r\nINSERT INTO BcoHorasDesconsiderados \r\nselect func_ind, cal_DATA from funcionarios \r\ninner join calculo on func_ind = cal_func\r\nleft join BcoHorasDesconsiderados on func_ind = bcod_func and cal_data = bcod_data \r\nWHERE cal_DATA < %DATAINICIAL% and func_ind = %FUNCIONARIO% and bcod_func is null and bcod_data is null\r\n\r\nDELETE FROM BCOHORAS\r\nINNER JOIN FUNCIONARIOS ON FUNC_IND = BCO_FUNC\r\nWHERE BCO_FUNC =%FUNCIONARIO% AND BCO_DATA < %DATAINICIAL%','gabriel','2018-11-30 19:38:18'),(601,'desconsiderar banco de horas','COMANDOS','esse comando esta configurado para desconsiderar antes da data de inicio do funcionario selecionado\r\n\r\nINSERT INTO BcoHorasDesconsiderados \r\nselect func_ind, cal_DATA from funcionarios \r\ninner join calculo on func_ind = cal_func\r\nleft join BcoHorasDesconsiderados on func_ind = bcod_func and cal_data = bcod_data \r\nWHERE cal_DATA < %DATAINICIAL% and func_ind = %FUNCIONARIO% and bcod_func is null and bcod_data is null\r\n\r\nDELETE FROM BCOHORAS\r\nINNER JOIN FUNCIONARIOS ON FUNC_IND = BCO_FUNC\r\nWHERE BCO_FUNC =%FUNCIONARIO% AND BCO_DATA < %DATAINICIAL%','gabriel','2018-11-30 19:39:30'),(602,'instalar power shell','ERRO SQL','pegar o instalador na pasta \r\nS:\\Suporte\\ASSEPONTO4\\INSTALADORES SQL\\ARQUIVOS AVULSOS\\POWER SHELL\r\n\r\ne executar no computador','gabriel','2018-11-30 21:20:07'),(603,'OperaÃ§Ã£o de E/S sobreposta em andamento.','ERRO SQL','Alterar o nome da pasta Microsoft\\Crypto\\RSA\r\n\r\n1 -  Renomear:\r\n\r\nC:\\ProgramData\\Microsoft\\Crypto\\RSA\\S-1-5-18 \r\n\r\npara\r\n\r\nC:\\ProgramData\\Microsoft\\Crypto\\RSA\\S-1-5-18_BAK\r\n\r\n2 - Tente instalar o SQL  novamente.','Steffany','2018-12-03 21:27:29'),(604,'apagar horario fiscal do expediente variavel','COMANDOS','UPDATE Expedientes set\r\n[INT_HORA1_FISCALIZACAO] = null\r\n,[INT_HORA2_FISCALIZACAO] = null\r\n','gabriel','2018-12-04 14:52:28'),(605,'falha de logon','CRIAR ESTACAO','esse erro pode acontecer quando em 3 casos\r\n\r\n1 - login e senha esta errado\r\ndigitar novamente o usuario e senha para resolver \r\n\r\n2 - banco de dados nao esta criado\r\nentao Ã© preciso clicar em testar antes de dar ok, assim vc pode criar um banco novo\r\n\r\n3 - bug no registro do windows\r\nprecisa abrir o regedit\r\nwin + R >> digitar \"regedit\" e da ok\r\nprocurar o caminho abaixo \r\nHKEY_CURRENT_USER\\Software\\Assecont\r\ndeletar a pasta assecont\r\nfechar e abrir o sistema\r\nliberar senha novamente e configurar o ponto\r\n','gabriel','2018-12-04 15:18:18'),(606,'nome e admissÃ£o somente ativos','RELATORIOS','--LARGURA#200,200#\r\nSELECT FUNC_NOME,  FUNC_DT_ADM\r\nFROM Funcionarios\r\nWHERE FUNC_DT_DEM IS NULL AND FUNC_MARCADO_EXCLUSAO = 0\r\nORDER BY FUNC_NOME','gabriel','2018-12-04 15:54:32'),(608,'DIMEP PRINT POINT 3 - BIOMETRIA','RELOGIO','Pressione as teclas  \"f1\" + <91> +  \"e\", \r\nem seguida, informe o crachÃ¡ e a senha do supervisor cadastrado, se houver.\r\nQuando aparecer a mensagem â€œDigite o PISâ€ ou â€œDigite a credencial ou passe o cartÃ£oâ€, basta digitar o nÃºmero referente ao funcionÃ¡rio e, em seguida, apertar .\r\nFeito isso, aparecerÃ¡ a mensagem â€œEscolha o Dedo: Indicador direitoâ€. Selecione o dedo desejado, por meio das teclas <0> ou <2>, e pressione  para confirmar.\r\nO display, entÃ£o, mostrarÃ¡ a mensagem â€œColoque o Primeiro Dedo 3 vezes!â€. PeÃ§a pare que o funcionÃ¡rio insira sua digital para cadastro. Em seguida, o display mostrarÃ¡ a mensagem â€œEscolha o Dedo: Indicador Esquerdoâ€. Selecione o 2Âº dedo, pressionando <0> ou <2>, e confirme com a tecla . Ao concluir a aÃ§Ã£o, o display mostrarÃ¡ â€œDigital Cadastrada com Sucessoâ€.\r\nDepois dessa mensagem, o display voltarÃ¡ a exibir â€œDigite o PISâ€ ou â€œDigite a credencial ou passe o cartÃ£oâ€. Prossiga para cadastrar mais funcionÃ¡rios ou, caso queira cancelar a operaÃ§Ã£o, pressione a tecla .','aLINE','2018-12-04 18:54:09'),(609,'ERRO ATL','ERRO SQL','falha de ATL na instalaÃ§ao do sql\r\n\r\nDescompact o sql,\r\nna pasta que foi descompactado o sql, procure por SQLSUPPORT.MSI\r\nprovavelmente ele vai achar alguns programas\r\ninstale esses programas (SQLSUPPORT.MSI )\r\napos instalar instale o sql\r\n','gabriel','2018-12-04 18:55:11'),(610,'FALHA CATASTROFICA','CRIAR ESTACAO','Para  resolver esse erro Ã© preciso ativar o modo de compatibilidade \r\n\r\nseleciona o asseponto4\r\nclica com botao direito\r\nvai em propriedades\r\nclica em COMPATIBILIDADE\r\nmarca a OPÃ‡ÃƒO executar esse programa em modo de COMPATIBILIDADE\r\nSEMPRE SELECIONAR O S.O. WINDOWS XP (sERVICE PACK 3)\r\nda ok\r\nexecuta o asseponto4 normal','aLINE','2018-12-04 18:57:11'),(611,'site para baixar nfe sem certificado','ASSEFIN','https://www.fsist.com.br/','gabriel','2018-12-05 15:09:12'),(616,'Manual Henry ADV - equipamento','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1Hf_aKI0Qys7ATKwoeduxmN_MrmnFJsun/preview\" width=\"100%\"></iframe></p>\r\n','gabriel','2018-12-05 21:50:43'),(617,'Manual Henry ADV - acessar rep pela web','RELOGIO','<p><iframe frameborder=\"0\" height=\"100%\" scrolling=\"no\" src=\"https://drive.google.com/file/d/11gV221TaSvmDXRS583ht--LXWx7JdNq6/preview\" width=\"100%\"></iframe></p>\r\n','gabriel','2018-12-05 21:52:03'),(618,'boi gigante','UTILIDADES','<p><iframe height=\"100%\" src=\"https://g1.globo.com/fantastico/noticia/2018/12/02/boi-de-194m-de-altura-impressiona-na-australia-e-fantastico-mostra-gigante-brasileira.ghtml\" width=\"100%\"></iframe></p>\r\n','gabriel','2018-12-05 21:56:50'),(619,'Athos star rep - manual','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1UkhW5r5yn0QEqdz_Rxvu7qm_BQdMhRo4/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 13:27:21'),(620,'control id class - manual','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1y7dhwusb3XfP3rY4l5fvANvHeZiTo_4O/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 13:29:03'),(621,'control id class - manual 2','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1mMJpGZ7ld2RhIDqcq2MzuO2j-25KXDbK/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 13:29:44'),(622,'control idx - manual','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1e3sf8UWN0TRmssHMRyRxGfyzMNZFv9hF/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 13:31:05'),(623,'control idx - manual 2','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1LTuh-1ZIsMIFyXhvje9V6dtSKeJLeNpZ/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 13:31:54'),(624,'dimep print point 2 - manual','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1V34ttmT6BEF5OKX3J1DFolQ8h2qvM9Qa/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 13:34:23'),(625,'dimep print point 2 - manual conf','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1Bp8NpInMln41FIPx_2Ay00f7m7nDaRre/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 13:35:51'),(626,'dimep print point 3 - manual conf','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1E6tCWNmyNfWsjGba1qL4lo8ZWJ4BvS_3/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 13:36:58'),(627,'dimep print point 3 - manual','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1XtkvA_nntzvUUXjv1_Pw4dgCbvgFmCdL/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 13:41:10'),(628,'gertec bpd - manual','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1DFj0-K5CjZLvH5r6kZON4oP9e7nMwiIS/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 13:42:45'),(629,'gertec D - manual','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1H_YLBfsLLaodMaPApEpJLINeUYeyoMLX/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 13:47:15'),(630,'gertec g3 - manual','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/11PUDsZTCt1mWRnAdOyoS4lrP1L1J80WX/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 13:48:06'),(631,'henry prime - manual','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1DuEjTjj1H9JTHwHiNQfQbgsGbOD9Nm7z/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 13:49:05'),(632,'henry compact s - manual','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1SlLU02prJVpeDfY3iMcdypXBrySEsTcC/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 13:54:18'),(633,'henry compact s - manual 2','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1HIOPfRQ6Je-StOzvTFpUMjAudSf5f6rA/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 13:55:59'),(634,'henry e adv - manual 2','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/19y_KI1Xrtx_yNdQNXW5X1QBV2pKadzw-/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 13:57:55'),(635,'henry e adv - manual','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1m0OpsWEww4Q68-tcTDi4cOaJaDcFvzWk/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 13:58:42'),(636,'henry hexa b - manual','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/15xbyQRuALtLCpEqM2uhsXGWFBPO10y-e/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 14:25:13'),(637,'henry hexa b - manual web','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1N9aB07Gm65VmJulymWOwUn-xSPNSfJQ3/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 14:25:40'),(638,'henry orion 6 - manual','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1NBOSZjAU7FCu9OPZY3yQED7bGQ8SgfbR/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 14:31:18'),(639,'henry orion 6 - manual 7x','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1xc3TJW-ibQO5Hqdg0EjU8o_CpGEhEO8V/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 14:31:45'),(642,'henry super facil - manual','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1lDc9eGNAkLMuD_v_WHQ_dC2HhTiYTpYo/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 14:35:46'),(643,'henry orion 6 - manual biometria','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1SLW9J1pMjRDfUEU-tOh2VS8oUigAJbgi/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 14:37:10'),(645,'madis - manual','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1XS4-LpT8oau7oLTcZjIzpQsHijGLqRmY/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 14:44:18'),(646,'iddata - manual','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1bYuXjiyc7ttNOyy46zIDy9qqSa82r-mG/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 14:45:39'),(647,'passfinger 2040 - manual','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1-3ZHdvnlpaCJg6gv6X4wR62PigZBNu29/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 14:46:51'),(648,'passfinger 2040 - manual conf','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1APsxno-C8UGAs_uIsDTLrn-xybXtwte2/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 14:47:52'),(649,'kurumin 3 - manual conf','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1p_Ue-9NfoMa3ldzAZfTU5NqhiPH5jYhW/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 14:49:19'),(650,'kurumin 3 - manual','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1VLLKxC-R3UR2taSXXNt0XVncKgvHUktK/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 15:06:21'),(651,'kurumin 2 - manual','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1IXz3BeUxgMvYRDQEqrvOi4cIF7sDPR3z/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 15:07:35'),(652,'kurumin 2 - manual 2','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/19zzYhnAXXLsYpSgQHxBSBXOcRjzs5PkU/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 15:08:30'),(653,'rhj - manual','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1piSyUmIQfh4dZZmWLQUYdWUZZDCk6Aab/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 15:09:33'),(654,'rhj - manual 2','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1wiO07s6ADdtXjn_ivrjROywZEkEPWDiK/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 15:10:13'),(655,'point line BIOPROX-C - manual','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/10h8d5bYGu9lLxMgu9nIRi-5jYaV0grw6/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 15:15:22'),(656,'top data inner rep - manual','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1F56d9prGGyYse1xr5Gs5HIMVQKGacYkS/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 15:16:31'),(657,'trilobit - manual','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/12HhzxkYz2TVWJ1R8Vg58ZiUNIAnngkhW/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 15:17:38'),(658,'trix r100 - manual','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1yrNqPeB-S2lwXKRCSK-kxjTUoNbSlnLL/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 15:18:37'),(659,'trix xrep 520 - manual','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/10cJmyn0TLi31nPso0mk_4_pceRgeW97i/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 15:21:48'),(660,'zpm eco 500 - manual','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/167fednTb2e-j3VJ-NH0J55IqncF74Z0q/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 15:22:52'),(661,'zpm eco 500 - manual conf','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1I8fLvjuRIrknMT8IgOvXQSdqIKhGCEFR/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 15:23:19'),(662,'zpm r130 - manual','RELOGIO','<p><iframe height=\"100%\" src=\"https://drive.google.com/file/d/1JOmmS4WcZl2N_MTrnrKC-FRlidJp12br/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 15:24:16'),(663,'manual de emissao de notas lucro presumido','ASSEFIN','<p><iframe frameborder=\"0\" height=\"100%\" scrolling=\"no\" src=\"https://drive.google.com/file/d/1mcfKM4kqm1atOb_Hy_Sr0eDF9sfvXsMh/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 19:01:14'),(664,'manual de emissao de notas simples nacional','ASSEFIN','<p><iframe frameborder=\"0\" height=\"100%\" scrolling=\"no\" src=\"https://drive.google.com/file/d/1N11X5f18dKtwnBqtcBRJtJUUbNOehjPD/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 19:07:08'),(665,'manual de emissao - notas emissor sefaz ','ASSEFIN','<p><iframe frameborder=\"0\" height=\"100%\" scrolling=\"no\" src=\"https://drive.google.com/file/d/16gVsr-PL5m2Y7RXg27mZPCekQvK0awSO/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 19:48:56'),(666,'instalacao do sql - manual','INSTALAR SQL','<p><iframe frameborder=\"0\" height=\"100%\" scrolling=\"no\" src=\"https://drive.google.com/file/d/1pNi_vrxIvHSj6pAxmsOQWiVmxGVPZh09/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 19:55:22'),(667,'compartilhar o sql - manual','INSTALAR SQL','<p><iframe frameborder=\"0\" height=\"100%\" scrolling=\"no\" src=\"https://drive.google.com/file/d/1zw7zp16jCcjbN21cR4twj8EiJB_ghCj8/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 19:56:15'),(668,'criar banco de dados novo - manual','CRIAR ESTACAO','<p><iframe frameborder=\"0\" height=\"100%\" scrolling=\"no\" src=\"https://drive.google.com/file/d/1Cy5z2viV2o_4txbLo-BX9VFKJeodkd9i/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 20:09:30'),(669,'script inicial ponto4 - manual','CRIAR ESTACAO','<p><iframe frameborder=\"0\" height=\"100%\" scrolling=\"no\" src=\"https://drive.google.com/file/d/15V3XYbdiXy5qd5JUPs5byikPAGMRn_j_/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 20:10:07'),(670,'importar planilha - manual','IMPORTAR PLANILHA','<p><iframe frameborder=\"0\" height=\"100%\" scrolling=\"no\" src=\"https://drive.google.com/file/d/1k67VPMMq-eDAqlIU8rf_bVdWypw-FZ_T/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 20:10:49'),(673,'CONFIGURAR REP NO PONTO - MANUAL','RELOGIO','<p><iframe frameborder=\"0\" height=\"100%\" scrolling=\"no\" src=\"https://drive.google.com/file/d/1Hp18bh8GaGXVbKLcdJq4sECrKrsnKfTP/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 20:14:38'),(674,'PONTO4 - MANUAL','RELOGIO','<p><iframe frameborder=\"0\" height=\"100%\" scrolling=\"no\" src=\"https://drive.google.com/file/d/1ilt2gPi5Us1uHikI-AxtPi7BnfQU4sU7/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 20:16:46'),(677,'assepontoweb - MANUAL','PARAMETROS DO SISTEMA','<p><iframe frameborder=\"0\" height=\"100%\" scrolling=\"no\" src=\"https://drive.google.com/file/d/1lPbmOh4QW29z1Hu5xE_59PW3IRvyWTV0/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 20:36:52'),(678,'instalacao inicial assepontoweb - MANUAL','PARAMETROS DO SISTEMA','<p><iframe frameborder=\"0\" height=\"100%\" scrolling=\"no\" src=\"https://drive.google.com/file/d/1XJp5P9iwiBp-4tU8t5StCs7juHL0LfjK/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 20:38:59'),(679,'migracao para assepontoweb - MANUAL','PARAMETROS DO SISTEMA','<p><iframe frameborder=\"0\" height=\"100%\" scrolling=\"no\" src=\"https://drive.google.com/file/d/1osgTDXbhMV_FX2279absmkeHqKGXf6fG/preview\" width=\"100%\"></iframe></p>\r\n','GABRIEL','2018-12-06 20:39:41'),(680,'MANUAL sobre redes','REDES','<p><iframe frameborder=\"0\" height=\"100%\" scrolling=\"no\" src=\"https://drive.google.com/file/d/1TByM5bSOhPBI6IH6IhPoyQrJEKVkx1Z9/preview\" width=\"100%\"></iframe></p>\r\n','gabriel','2018-12-06 20:47:51'),(683,'video nic br sobre redes - Parte 1: O protocolo IP','VIDEOS','<p><iframe frameborder=\"0\" height=\"480\" src=\"https://www.youtube.com/embed/HNQD0qJ0TC4?list=PLxvyNgS1BGn6V3vxq-5X1qQnWvgsfs3pU\" width=\"853\"></iframe></p>\r\n','gabriel','2018-12-06 20:56:08'),(684,'video nic br sobre redes - Parte 2: Sistemas AutÃ´nomos, BGP, PTTs.','VIDEOS','<iframe width=\"853\" height=\"480\" src=\"https://www.youtube.com/embed/C5qNAT_j63M?list=PLxvyNgS1BGn6V3vxq-5X1qQnWvgsfs3pU\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>','gabriel','2018-12-06 20:56:55'),(685,'video nic br sobre redes - Parte 3: DNS','VIDEOS','<iframe width=\"853\" height=\"480\" src=\"https://www.youtube.com/embed/ACGuo26MswI?list=PLxvyNgS1BGn6V3vxq-5X1qQnWvgsfs3pU\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>','gabriel','2018-12-06 20:57:42'),(686,'video nic br sobre redes - Parte 4: GovernanÃ§a da Internet','VIDEOS','<iframe width=\"853\" height=\"480\" src=\"https://www.youtube.com/embed/ZYsjMEISR6E?list=PLxvyNgS1BGn6V3vxq-5X1qQnWvgsfs3pU\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>','gabriel','2018-12-06 20:58:38'),(687,'video nic br sobre redes - Os endereÃ§os IP nÃ£o sÃ£o todos iguais - parte 1','VIDEOS','<iframe width=\"853\" height=\"480\" src=\"https://www.youtube.com/embed/jnuHODaLcO8?list=PLxvyNgS1BGn6V3vxq-5X1qQnWvgsfs3pU\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>','gabriel','2018-12-06 21:03:02'),(688,'video nic br sobre redes - Os endereÃ§os IP nÃ£o sÃ£o todos iguais - parte 2','VIDEOS','<iframe width=\"853\" height=\"480\" src=\"https://www.youtube.com/embed/63M61wttuMk?list=PLxvyNgS1BGn6V3vxq-5X1qQnWvgsfs3pU\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>','gabriel','2018-12-06 21:03:34'),(689,'video nic br sobre redes - IntroduÃ§Ã£o ao roteamento de pacotes IP','VIDEOS','<iframe width=\"853\" height=\"480\" src=\"https://www.youtube.com/embed/y9Vx5l-th9Y?list=PLxvyNgS1BGn6V3vxq-5X1qQnWvgsfs3pU\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>','gabriel','2018-12-06 21:04:06'),(690,'video nic br sobre redes - FragmentaÃ§Ã£o de pacotes IPv6 e IPv4, explicada pelo NIC.br','VIDEOS','<iframe width=\"853\" height=\"480\" src=\"https://www.youtube.com/embed/5OtebbSnwoM?list=PLxvyNgS1BGn6V3vxq-5X1qQnWvgsfs3pU\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>','gabriel','2018-12-06 21:04:47'),(691,'video nic.BR redes - A Internet das coisas, explicada pelo','VIDEOS','<iframe width=\"853\" height=\"480\" src=\"https://www.youtube.com/embed/jlkvzcG1UMk\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>','gabriel','2018-12-06 21:11:31'),(692,'video nic.BR redes - A importÃ¢ncia do DNS nas redes, explicada pelo NIC.br.','VIDEOS','<iframe width=\"853\" height=\"480\" src=\"https://www.youtube.com/embed/epWv0-eqRMw?list=PLxMpHN3bl70lLMesZhc72oJfJMpi3X87S\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>','gabriel','2018-12-06 21:13:16'),(693,'video nic.BR redes - O que Ã© o IPv6, por NICBR - CGNAT','VIDEOS','<iframe width=\"853\" height=\"480\" src=\"https://www.youtube.com/embed/WhgBJLDzkro\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>','gabriel','2018-12-06 21:14:03'),(694,'ID DATA - Editar dados dos funcionÃ¡rios no REP','RELOGIO','<p>Teclado&gt; ADM&gt; Teclado&gt; Senha 123456&gt; Dados Trabalhador&gt; Utilizar o bot&atilde;o &quot;Pr&oacute;ximo&quot; ou &quot;Anterior&quot; at&eacute; achar o colaborador&gt; Editar&gt; Selecionar os dados a serem mudados&gt; Ap&oacute;s alterar, clicar em Salvar</p>\r\n','Alessandro Sena','2018-12-18 20:37:28'),(695,'dimep print point 3 - Supervisor e responsavel','RELOGIO','<p>Supervisor&nbsp;</p>\r\n\r\n<p>codigo: 9</p>\r\n\r\n<p>senha: 99999</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>Responsavel</p>\r\n\r\n<p>login: login</p>\r\n\r\n<p>senha: senha</p>\r\n','gabriel','2018-12-19 21:17:50'),(696,'comando para definir demissao para mais de um funcionario','COMANDOS','<p>update Funcionarios<br />\r\nset FUNC_DT_DEM = &#39;12/12/2018&#39;<br />\r\nwhere FUNC_NOME in (&#39;Jaqueline Gon&ccedil;alves Dias Sampietro&#39;,&#39;Luiz Roberto Magnani Junior&#39;)</p>\r\n','GABRIEL','2018-12-26 17:28:05'),(697,'RELOGIO TOPDATA - porta','RELOGIO','<p>porta 51400</p>\r\n','GABRIEL','2018-12-26 17:34:04'),(698,'Painel de revenda control id','RELOGIO','<p>LOGIN: SUPORTE@ASSECONT.COM.BR</p>\r\n\r\n<p>SENHA: 44505500</p>\r\n','Aline Carvalho','2018-12-26 19:43:39'),(699,'alterar periodo de apontamento','COMANDOS','<p>UPDATE ApontamentoMeses<br />\r\n&nbsp; &nbsp;SET APOM_DATAINICIAL = &#39;21/12/2018&#39;<br />\r\n&nbsp; &nbsp; &nbsp; ,APOM_DATAFINAL = &#39;31/01/2019&#39;<br />\r\n&nbsp;WHERE APOM_DATAINICIAL = &#39;21/12/2018&#39;&nbsp;<br />\r\nGO</p>\r\n\r\n<p>-- na parte&nbsp;&nbsp;WHERE APOM_DATAINICIAL = &#39;21/12/2018&#39;&nbsp; &nbsp;alterar para data de inicio do apontamento que precisa mudar</p>\r\n','GABRIEL','2019-01-03 21:57:34'),(700,'relatorio de conversao do banco em extras - 4all','RELATORIOS','<p>--LARGURA# 200,150,70,80,60,60,60,60,60,60,60,60,60,70,70,70,70,70# &nbsp; &nbsp; &nbsp;<br />\r\n--COLUNAGRUPO#1#<br />\r\nSELECT DISTINCT FUNC_NOME AS NOME, EMP_NOME AS EMPRESA,<br />\r\nCAL_DATA AS &#39;DATA&#39;,<br />\r\n(SELECT CASE DATEPART(W, CAL_DATA) WHEN 1 THEN &#39;DOMINGO&#39; WHEN 2 THEN &#39;SEGUNDA-FEIRA&#39; WHEN 3 THEN &#39;TER&Ccedil;A-FEIRA&#39;<br />\r\nWHEN 4 THEN &#39;QUARTA-FEIRA&#39; WHEN 5 THEN &#39;QUINTA-FEIRA&#39; WHEN 6 THEN &#39;SEXTA-FEIRA&#39; WHEN 7 THEN &#39;S&Aacute;BADO&#39; END) AS &#39;DIA DA SEMANA&#39;,<br />\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO1) AS &#39;ENTRADA1&#39;,<br />\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO2) AS &#39;SAIDA1&#39;,<br />\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO3) AS &#39;ENTRADA2&#39;,<br />\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO4) AS &#39;SAIDA2&#39;,<br />\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO5) AS &#39;ENTRADA3&#39;,<br />\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO6) AS &#39;SAIDA3&#39;,<br />\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO7) AS &#39;ENTRADA4&#39;,<br />\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO8) AS &#39;SAIDA4&#39;,<br />\r\nDBO.FN_GETTIME5NULLZERO(CAL_TRAB) AS REALIZADO,</p>\r\n\r\n<p>(select CASE when DATEPART(WEEKDAY, cal_DATA) = 7 and DBO.FN_HOURLONGTOMINUTE(BCO_VALOR) &gt;= 120 then &#39;02:00&#39;<br />\r\nwhen DATEPART(WEEKDAY, cal_DATA) = 7 then DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_HOURLONGTOMINUTE(BCO_VALOR)))<br />\r\nelse DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_HOURLONGTOMINUTE(BCO_VALOR))) END &nbsp;from BCOHORAS<br />\r\nwhere BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA and BCO_STATUS IN (1) group by BCO_VALOR) AS &#39;EXTRAS 50%&#39;,</p>\r\n\r\n<p>(select DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_HOURLONGTOMINUTE(BCO_VALOR) - 120)) from BCOHORAS where BCO_FUNC = FUNC_IND AND<br />\r\nBCO_DATA = CAL_DATA and DBO.FN_HOURLONGTOMINUTE(BCO_VALOR) &gt; 120 and BCO_STATUS IN (1) and DATEPART(WEEKDAY, cal_DATA) = 7) AS &#39;EXTRA 75%&#39;,</p>\r\n\r\n<p>(select DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_HOURLONGTOMINUTE(BCO_VALOR))) from BCOHORAS where BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA &nbsp;<br />\r\nand BCO_STATUS IN (3) ) &nbsp;&#39;EXTRA 100%&#39;,</p>\r\n\r\n<p><br />\r\n(select DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_NOTURNO)-DBO.FN_HOURLONGTOMINUTE(BCO_VALOR))) from BCOHORAS<br />\r\nINNER JOIN CALCULO ON BCO_FUNC = CAL_FUNC AND BCO_DATA = CAL_DATA where BCO_FUNC = FUNC_IND and BCO_STATUS IN (2,4) and CAL_NOTURNO &gt; 0<br />\r\nand (DBO.FN_SMALLDATETIMETOMINUTE(CAL_NOTURNO)-DBO.FN_HOURLONGTOMINUTE(BCO_VALOR)) &gt; 0 ) as &#39;EXTRA 60% NOTURNA&#39;,<br />\r\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br />\r\n(select DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_HOURLONGTOMINUTE(BCO_VALOR))) from BCOHORAS where BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA<br />\r\nand BCO_STATUS IN (2,4) ) as &#39;EXTRA 100% NOTURNA&#39;</p>\r\n\r\n<p>FROM CALCULO<br />\r\nINNER JOIN FUNCIONARIOS ON FUNC_IND = CAL_FUNC<br />\r\nINNER JOIN BCOHORAS ON BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA<br />\r\nINNER JOIN EMPRESAS ON &nbsp;FUNC_EMPRESA = EMP_IND<br />\r\nLEFT JOIN APONTA ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA<br />\r\nWHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA, %DEPSELECIONADOIND%) =1<br />\r\nAND FUNC_DT_DEM IS NULL AND FUNC_MARCADO_EXCLUSAO = 0 AND CAL_DATA &gt;= %DATAINICIAL%<br />\r\nAND CAL_DATA &lt;= %DATAFINAL% AND (APO_MARCACAO1 IS NOT NULL OR APO_MARCACAO2 IS NOT NULL OR<br />\r\nAPO_MARCACAO3 IS NOT NULL OR APO_MARCACAO4 IS NOT NULL)<br />\r\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />\r\nGROUP BY EMP_NOME, FUNC_NOME, CAL_DATA, FUNC_IND, CAL_TRAB, BCO_STATUS, BCO_VALOR, APO_MARCACAO1, APO_MARCACAO2,CAL_NOTURNO,<br />\r\nAPO_MARCACAO3, APO_MARCACAO4, APO_MARCACAO5, APO_MARCACAO6, APO_MARCACAO7, APO_MARCACAO8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br />\r\nORDER BY EMP_NOME, FUNC_NOME, CAL_DATA</p>\r\n','GABRIEL','2019-01-09 09:24:25'),(701,'Apagar todos FUNCIONaRIOS do banco','COMANDOS','<pre>\r\nDELETE FROM APONTA \r\nDELETE FROM ACIDENTES \r\nDELETE FROM AFASTAMENTOS \r\nDELETE FROM ALTERACOES\r\nDELETE FROM BCOHORAS \r\nDELETE FROM BCOHORASDESCONSIDERADOS \r\nDELETE FROM CALCULO WHERE \r\nDELETE FROM JUSTIFICATIVAS \r\nDELETE FROM JUSTIFICATIVASPEDIDOS \r\nDELETE FROM MARCACOES \r\nDELETE FROM PREAPONTA \r\nDELETE FROM REGISTRO \r\nDELETE FROM VARIAVEIS \r\nDELETE FROM HORA \r\nDELETE FROM HMOVEL \r\nDELETE FROM FUNCIONARIOS</pre>\r\n','gabriel','2019-01-11 18:56:05'),(702,'Apagar todos FUNCIONaRIOS do banco de dados','COMANDOS','<pre>\r\nDELETE FROM APONTA \r\nDELETE FROM ACIDENTES \r\nDELETE FROM AFASTAMENTOS \r\nDELETE FROM ALTERACOES\r\nDELETE FROM BCOHORAS \r\nDELETE FROM BCOHORASDESCONSIDERADOS \r\nDELETE FROM CALCULO\r\nDELETE FROM JUSTIFICATIVAS \r\nDELETE FROM JUSTIFICATIVASPEDIDOS \r\nDELETE FROM MARCACOES \r\nDELETE FROM PREAPONTA \r\nDELETE FROM REGISTRO \r\nDELETE FROM VARIAVEIS \r\nDELETE FROM HORA \r\nDELETE FROM HMOVEL \r\nDELETE FROM FUNCIONARIOS</pre>\r\n','gabriel','2019-01-11 19:01:24'),(703,'RHJ - Login e senha do executÃ¡vel','RELOGIO','<p>Login: 1</p>\r\n\r\n<p>Senha: 123456</p>\r\n\r\n<p>CPF: Qualquer um v&aacute;lido</p>\r\n','Camila Diniz','2019-01-15 02:49:21'),(704,'RELATORIO DE JUSTIFICATIVAS, MOTIVOS, PARA WEB - DETALHADO','RELATORIOS','<p>--LARGURA#200,80,80,150,80#<br />\r\n--TITULO#RELATORIO DO TOTAL DE HORAS ABONADAS#</p>\r\n\r\n<p>declare @inicio smalldatetime = &#39;01/12/2018&#39;<br />\r\ndeclare @fim smalldatetime = &#39;31/12/2018&#39;<br />\r\ndeclare @NOME CHAR(50) = &#39;Andreia Salvagim Felipe&#39; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p>\r\n\r\n<p><br />\r\nSELECT FUNC_NOME NOME, CAL_DATA AS DATA,<br />\r\nDBO.FN_GETTIME5NULLZERO(CAL_ABONO) AS &#39;ABONADO&#39;,</p>\r\n\r\n<p>CASE WHEN JUS_DESCRICAO &lt;&gt; &#39;&#39; THEN JUS_DESCRICAO ELSE MOT_DESCRICAO END &nbsp;AS MOTIVO,</p>\r\n\r\n<p>(SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_ABONO)))&nbsp;<br />\r\nFROM CALCULO WHERE CAL_FUNC = FUNC_IND AND CAL_DATA &nbsp;&gt;= @inicio AND CAL_DATA &nbsp;&lt;= @fim) AS TOTAL</p>\r\n\r\n<p>FROM FUNCIONARIOS<br />\r\nINNER JOIN CALCULO ON CAL_FUNC = FUNC_IND<br />\r\nINNER JOIN JUSTIFICATIVAS ON CAL_FUNC = JUS_FUNC AND CAL_DATA = JUS_DATA<br />\r\nLEFT JOIN [Motivos] ON [JUS_MOTIVO] = &nbsp;[MOT_IND]<br />\r\nWHERE CAL_DATA &gt;= @inicio AND CAL_DATA &lt;= @fim AND CAL_ABONO &gt; 0 AND FUNC_NOME = @NOME<br />\r\nGROUP BY &nbsp;FUNC_IND, FUNC_NOME,CAL_DATA,CAL_ABONO,CAL_FUNC,JUS_DESCRICAO,MOT_DESCRICAO<br />\r\nORDER BY FUNC_NOME</p>\r\n','GABRIEL','2019-01-16 00:50:24'),(705,'dimep rsa invalido CORRETO','RELOGIO','<pre>\r\n1&ordm; EXPORTAR DO REL&Oacute;GIO O ARQUIVO CHAVE RSA ATRAV&Eacute;S DA USB.\r\nESTE ARQUIVO DEVE ESTAR NA PASTA COM OS EXECUT&Aacute;VEIS E DLLS ATUALIZADOS DA PASTA DIMEP PRINTPOINT III.\r\nPRESSIONE F1+45 DEPOIS INFORME O SUPERVISOR E SENHA\r\nOP&Ccedil;&Atilde;O EXPORTAR RSA PRESSIONE ENTER E CONECTE O PEN DRIVE NA USB DE DADOS NA PARTE DE BAIXO DO REL&Oacute;GIO.\r\nDEPOIS COPIAR DO PEN DRIVE PARA A PASTA DOS EXECUT&Aacute;VEIS E NA FRENTE DA PALAVRA CHAVE COLOCAR O IP SEM PONTO.\r\n\r\n\r\n</pre>\r\n','marcos','2019-01-16 02:27:40'),(706,'comando para desconsiderar banco de horas e marca como apontado - wan','COMANDOS','<p>INSERT INTO BCOHORASDESCONSIDERADOS&nbsp;<br />\r\nSELECT FUNC_IND, CAL_DATA FROM FUNCIONARIOS&nbsp;<br />\r\nINNER JOIN CALCULO ON FUNC_IND = CAL_FUNC<br />\r\nLEFT JOIN BCOHORASDESCONSIDERADOS ON FUNC_IND = BCOD_FUNC AND CAL_DATA = BCOD_DATA&nbsp;<br />\r\nWHERE CAL_DATA &lt; %DATAINICIAL% AND DBO.FN_DEPARTAMENTOPERTENCENTE( FUNC_EMPRESA,%DEPSELECIONADOIND%) = 1 AND BCOD_FUNC IS NULL AND BCOD_DATA IS NULL</p>\r\n\r\n<p>-----</p>\r\n\r\n<p>UPDATE CALCULO SET CAL_APONTADO = 1 WHERE CAL_DATA &gt;= %DATAINICIAL% AND CAL_DATA &lt;= %DATAFINAL% AND DBO.FN_DEPARTAMENTOPERTENCENTE((SELECT FUNC_EMPRESA FROM FUNCIONARIOS WHERE FUNC_IND = CAL_FUNC), %DEPSELECIONADOIND%) = 1</p>\r\n\r\n<p>usar esses 2 comando apos de desconsiderar o banco de horas<br />\r\nobs: usar os comando no apontamento que vc desconsiderou o banco</p>\r\n','gabriel','2019-01-16 05:32:30'),(707,'relatorio 4all','RELATORIOS','<p>--LARGURA# 200,150,70,80,60,60,60,60,60,60,60,60,60,70,70,70,70,70#<br />\r\n--COLUNAGRUPO#1#</p>\r\n\r\n<p>SELECT DISTINCT FUNC_NOME AS NOME, EMP_NOME AS EMPRESA, CAL_DATA AS &#39;DATA&#39;,<br />\r\n(SELECT CASE DATEPART(W, CAL_DATA) WHEN 1 THEN &#39;DOMINGO&#39; WHEN 2 THEN &#39;SEGUNDA-FEIRA&#39; WHEN 3 THEN &#39;TER&Ccedil;A-FEIRA&#39;<br />\r\nWHEN 4 THEN &#39;QUARTA-FEIRA&#39; WHEN 5 THEN &#39;QUINTA-FEIRA&#39; WHEN 6 THEN &#39;SEXTA-FEIRA&#39; WHEN 7 THEN &#39;S&Aacute;BADO&#39; END) AS &#39;DIA DA SEMANA&#39;,<br />\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO1) AS &#39;ENTRADA1&#39;,<br />\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO2) AS &#39;SAIDA1&#39;,<br />\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO3) AS &#39;ENTRADA2&#39;,<br />\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO4) AS &#39;SAIDA2&#39;,<br />\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO5) AS &#39;ENTRADA3&#39;,<br />\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO6) AS &#39;SAIDA3&#39;,<br />\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO7) AS &#39;ENTRADA4&#39;,<br />\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO8) AS &#39;SAIDA4&#39;,<br />\r\nDBO.FN_GETTIME5NULLZERO(CAL_TRAB) AS REALIZADO,</p>\r\n\r\n<p>(SELECT CASE WHEN DATEPART(WEEKDAY, CAL_DATA) = 7 AND DBO.FN_HOURLONGTOMINUTE(BCO_VALOR) &gt;= 120 THEN &#39;02:00&#39;</p>\r\n\r\n<p>WHEN DATEPART(WEEKDAY, CAL_DATA) = 7 THEN DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_HOURLONGTOMINUTE(BCO_VALOR)))</p>\r\n\r\n<p>ELSE DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_HOURLONGTOMINUTE(BCO_VALOR))) END &nbsp;FROM BCOHORAS</p>\r\n\r\n<p>WHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA AND BCO_STATUS IN (1) GROUP BY BCO_VALOR) AS &#39;EXTRAS 50%&#39;,</p>\r\n\r\n<p><br />\r\n(SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_HOURLONGTOMINUTE(BCO_VALOR) - 120)) FROM BCOHORAS WHERE BCO_FUNC = FUNC_IND AND</p>\r\n\r\n<p>BCO_DATA = CAL_DATA AND DBO.FN_HOURLONGTOMINUTE(BCO_VALOR) &gt; 120 AND BCO_STATUS IN (1) AND DATEPART(WEEKDAY, CAL_DATA) = 7) AS &#39;EXTRA 75%&#39;,</p>\r\n\r\n<p><br />\r\n(SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_HOURLONGTOMINUTE(BCO_VALOR)/2)) FROM BCOHORAS WHERE BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA &nbsp;<br />\r\nAND BCO_STATUS IN (3) ) &nbsp;&#39;EXTRA 100%&#39;,</p>\r\n\r\n<p>DBO.FN_MINUTETOHOURLONG(DBO.FN_SMALLDATETIMETOMINUTE(CAL_NOTURNO)-<br />\r\n(isnull((select DBO.FN_SMALLDATETIMETOMINUTE(CAST(BCO_VALOR AS smalldatetime)) from BCOHORAS where BCO_FUNC = FUNC_IND AND BCO_DATA =<br />\r\nCAL_DATA and BCO_STATUS IN (2) ),0) +<br />\r\nisnull((select DBO.FN_SMALLDATETIMETOMINUTE(CAST(BCO_VALOR AS smalldatetime))/2 from BCOHORAS where BCO_FUNC = FUNC_IND AND BCO_DATA =<br />\r\nCAL_DATA and BCO_STATUS IN (4) ),0)) ) &nbsp;AS &#39;EXTRA 60% NOTURNA&#39;,</p>\r\n\r\n<p><br />\r\nDBO.FN_MINUTETOHOURLONG(<br />\r\nisnull((select DBO.FN_SMALLDATETIMETOMINUTE(CAST(BCO_VALOR AS smalldatetime)) from BCOHORAS where BCO_FUNC = FUNC_IND AND BCO_DATA =<br />\r\nCAL_DATA and BCO_STATUS IN (2) ),0) +<br />\r\nisnull((select DBO.FN_SMALLDATETIMETOMINUTE(CAST(BCO_VALOR AS smalldatetime))/2 from BCOHORAS where BCO_FUNC = FUNC_IND AND BCO_DATA =<br />\r\nCAL_DATA and BCO_STATUS IN (4) ),0) &nbsp;) AS &#39;EXTRA 100% NOTURNA&#39;,</p>\r\n\r\n<p>case when CAL_NOTURNO &gt; 0 then DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_NOTURNO))) end AS NOTURNO</p>\r\n\r\n<p>FROM CALCULO<br />\r\nINNER JOIN FUNCIONARIOS ON FUNC_IND = CAL_FUNC<br />\r\nINNER JOIN BCOHORAS ON BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA &nbsp; &nbsp;<br />\r\nINNER JOIN EMPRESAS ON &nbsp;FUNC_EMPRESA = EMP_IND<br />\r\nLEFT JOIN APONTA ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA</p>\r\n\r\n<p>WHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA, %DEPSELECIONADOIND%) =1<br />\r\nAND FUNC_DT_DEM IS NULL AND FUNC_MARCADO_EXCLUSAO = 0 AND CAL_DATA &gt;= %DATAINICIAL%<br />\r\nAND CAL_DATA &lt;= %DATAFINAL% AND (APO_MARCACAO1 IS NOT NULL OR APO_MARCACAO2 IS NOT NULL Or<br />\r\nAPO_MARCACAO3 IS NOT NULL OR APO_MARCACAO4 IS NOT NULL)</p>\r\n\r\n<p>GROUP BY EMP_NOME, FUNC_NOME, CAL_DATA, FUNC_IND, CAL_TRAB, BCO_STATUS, BCO_VALOR, APO_MARCACAO1, APO_MARCACAO2,CAL_NOTURNO,<br />\r\nAPO_MARCACAO3, APO_MARCACAO4, APO_MARCACAO5, APO_MARCACAO6, APO_MARCACAO7, APO_MARCACAO8</p>\r\n\r\n<p>ORDER BY EMP_NOME, FUNC_NOME, CAL_DATA</p>\r\n','gabriel','2019-01-24 15:09:58'),(708,'relatorio nome, sobrenome, trab, abono, extras','RELATORIOS','<p>--LARGURA#70,50,80,150,50,45,50,45,60,65,50,80,120#</p>\r\n\r\n<p>declare @inicio smalldatetime = &#39;12/01/2019&#39;<br />\r\ndeclare @final smalldatetime = &#39;18/01/2019&#39;</p>\r\n\r\n<p><br />\r\nSELECT DBO.FN_GETDATE(CAL_DATA) AS &#39;Date&#39;,FUNC_reg &#39;Employee ID&#39;, SUBSTRING(FUNC_NOME, 1, CHARINDEX(&#39; &#39;, FUNC_NOME, 1) - 1) &#39;First Name&#39;,<br />\r\nCASE WHEN CHARINDEX(&#39; &#39;,LTRIM(RTRIM(FUNC_NOME))) &gt; 0 &nbsp;THEN LTRIM(RTRIM(SUBSTRING(FUNC_NOME, CHARINDEX(&#39; &#39;,LTRIM(RTRIM(FUNC_NOME))),<br />\r\n(LEN(LTRIM(RTRIM(FUNC_NOME)))+1 - CHARINDEX(&#39; &#39;,LTRIM(RTRIM(FUNC_NOME))) )) )) ELSE &#39;&#39; END AS &#39;Last Name&#39;,<br />\r\n&#39;&#39; as &#39;Site Name&#39;, &#39;&#39; as &#39;Work Area&#39;,<br />\r\nISNULL(DBO.FN_GETTIME5NULLZERO(CAL_TRAB), &#39;&#39;) AS &#39;Regular Operation Time (hours)&#39;,<br />\r\nISNULL(DBO.FN_GETTIME5NULLZERO(CAL_EXTRA + CAL_EXTRAN + CAL_EXTRAF + CAL_EXTRANF), &#39;&#39;) AS &#39;Overtimr hourd&#39;,<br />\r\n(CASE WHEN CAL_ABONO &gt; 0 THEN CONVERT(VARCHAR(5),(CAL_ABONO),108) ELSE &#39;&#39; END) AS &#39;Paid leave&#39;,<br />\r\ncase when (DBO.FN_SMALLDATETIMETOMINUTE(CAL_DESCONTO)+ DBO.FN_SMALLDATETIMETOMINUTE(CAL_ABONO)) &gt; 0 then<br />\r\nDBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_DESCONTO)+ DBO.FN_SMALLDATETIMETOMINUTE(CAL_ABONO))) else &#39;&#39;<br />\r\nend &#39;Umpaid leave&#39;,</p>\r\n\r\n<p>case when (DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRA) + DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRAN)) &gt; 0 then &#39;1,5&#39;<br />\r\nwhen (DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRAF) + DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRANF)) &gt; 0 then &#39;2,0&#39;<br />\r\nelse &#39;&#39; end &#39;Ratio&#39; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br />\r\n&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br />\r\nFROM FUNCIONARIOS<br />\r\nINNER JOIN CALCULO ON FUNC_IND = CAL_FUNC<br />\r\nWHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1<br />\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL AND CAL_DATA &gt;= @inicio AND CAL_DATA &lt;= @final &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />\r\nGROUP BY FUNC_NOME, CAL_DATA, CAL_TRAB,CAL_ATRB,FUNC_IND,CAL_ABONO,CAL_DESCONTO,FUNC_reg,CAL_EXTRA, CAL_EXTRAN, CAL_EXTRAF, CAL_EXTRANF<br />\r\nORDER BY FUNC_NOME, CAL_DATA</p>\r\n','gabriel','2019-01-24 15:10:42'),(709,'Relatorio FUNCIONARIO, ID e senha','RELATORIOS','<p>--LARGURA#200,80,80#<br />\r\nSELECT FUNC_NOME , FUNC_IND ID, CRA_NUMERO AS SENHA<br />\r\nFROM FUNCIONARIOS<br />\r\nINNER JOIN CRACHAS ON CRA_FUNC = FUNC_IND&nbsp;<br />\r\nWHERE FUNC_DT_DEM IS NULL<br />\r\nORDER BY FUNC_NOME</p>\r\n','GABRIEL','2019-01-24 15:31:31'),(710,'relatorio converter horas em decimais, extras e abonos','RELATORIOS','<p>--LARGURA#70,50,80,150,50,45,50,45,60,65,50,80,120#</p>\r\n\r\n<p>declare @inicio smalldatetime = &#39;18/01/2019&#39;<br />\r\ndeclare @final smalldatetime = &#39;25/01/2019&#39;</p>\r\n\r\n<p><br />\r\nSELECT DBO.FN_GETDATE(CAL_DATA) AS &#39;Date&#39;,FUNC_reg &#39;Employee ID&#39;, SUBSTRING(FUNC_NOME, 1, CHARINDEX(&#39; &#39;, FUNC_NOME, 1) - 1) &#39;First Name&#39;,<br />\r\nCASE WHEN CHARINDEX(&#39; &#39;,LTRIM(RTRIM(FUNC_NOME))) &gt; 0 &nbsp;THEN LTRIM(RTRIM(SUBSTRING(FUNC_NOME, CHARINDEX(&#39; &#39;,LTRIM(RTRIM(FUNC_NOME))),<br />\r\n(LEN(LTRIM(RTRIM(FUNC_NOME)))+1 - CHARINDEX(&#39; &#39;,LTRIM(RTRIM(FUNC_NOME))) )) )) ELSE &#39;&#39; END AS &#39;Last Name&#39;,<br />\r\n&#39;&#39; as &#39;Site Name&#39;, &#39;&#39; as &#39;Work Area&#39;,<br />\r\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br />\r\n(CONVERT(int,(DBO.FN_SMALLDATETIMETOMINUTE(CAL_TRAB)*100))/60)/CONVERT(decimal(6,2), 100) AS &#39;Regular Operation Time (hours)&#39;,</p>\r\n\r\n<p>(CONVERT(int,(DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRA + CAL_EXTRAN + CAL_EXTRAF + CAL_EXTRANF)*100))/60)/CONVERT(decimal(6,2), 100) &nbsp; &nbsp;<br />\r\nAS &#39;Overtimr hourd&#39;,</p>\r\n\r\n<p>(CONVERT(int,(DBO.FN_SMALLDATETIMETOMINUTE(CAL_ABONO)*100))/60)/CONVERT(decimal(6,2), 100) AS &#39;Paid leave&#39;,</p>\r\n\r\n<p>(CONVERT(int,(DBO.FN_SMALLDATETIMETOMINUTE(CAL_DESCONTO)+ DBO.FN_SMALLDATETIMETOMINUTE(CAL_ABONO))*100)/ 60)/CONVERT(decimal(6,2), 100)<br />\r\nas &#39;Umpaid leave&#39;,</p>\r\n\r\n<p>case when (DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRA) + DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRAN)) &gt; 0 then &#39;1,5&#39;<br />\r\nwhen (DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRAF) + DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRANF)) &gt; 0 then &#39;2,0&#39;<br />\r\nelse &#39;&#39; end &#39;Ratio&#39; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br />\r\n&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br />\r\nFROM FUNCIONARIOS<br />\r\nINNER JOIN CALCULO ON FUNC_IND = CAL_FUNC<br />\r\nWHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1<br />\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL AND CAL_DATA &gt;= @inicio AND CAL_DATA &lt;= @final &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />\r\nGROUP BY FUNC_NOME, CAL_DATA, CAL_TRAB,CAL_ATRB,FUNC_IND,CAL_ABONO,CAL_DESCONTO,FUNC_reg,CAL_EXTRA, CAL_EXTRAN, CAL_EXTRAF, CAL_EXTRANF<br />\r\nORDER BY FUNC_NOME, CAL_DATA</p>\r\n','gabriel','2019-01-30 15:19:36'),(711,'Relatorio valor total da soma das VARIÃVEIS ','RELATORIOS','<p>--LARGURA#200,120,80,80,80,80,80,80#<br />\r\n--GRUPONREGISTROS#0#<br />\r\nCREATE TABLE #DBTVARIAVEIS (<br />\r\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[VAR_FUNC] [INT] NOT NULL ,<br />\r\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[VAR_EVENTO] [INT] NULL ,<br />\r\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[VAR_VALOR] [MONEY],<br />\r\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[VAR_HORAS] [CHAR] (10),<br />\r\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [VAR_DIAS] [INT],<br />\r\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[VAR_EMPCODFOLHA] [CHAR] (10),<br />\r\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[VAR_FALTADATA] SMALLDATETIME DEFAULT 0,<br />\r\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [VAR_ORDEM] [TINYINT] DEFAULT 0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br />\r\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;) ON [PRIMARY]</p>\r\n\r\n<p>EXEC RST_VARIAVEIS @P_DATAINICIAL = %DATAINICIAL%, @P_DATAFINAL = %DATAFINAL%, @P_DEPTO = 1, @P_CRIARTMP = 0</p>\r\n\r\n<p>SELECT DISTINCT &nbsp;EVE_DESCRICAO &#39;Evento&#39;,<br />\r\n(select DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_HOURLONGTOMINUTE(VAR_HORAS))) from #DBTVARIAVEIS where VAR_EVENTO = EVE_IND and&nbsp;<br />\r\nDBO.FN_HOURLONGTOMINUTE(VAR_HORAS) &gt; 0) AS Horas,<br />\r\n(select sum(VAR_VALOR) from #DBTVARIAVEIS where VAR_EVENTO = EVE_IND) AS &#39;Valor&#39;</p>\r\n\r\n<p>FROM Eventos &nbsp; &nbsp;<br />\r\nINNER JOIN #DBTVARIAVEIS ON VAR_EVENTO = EVE_IND<br />\r\nwhere DBO.FN_HOURLONGTOMINUTE(VAR_HORAS) &gt; 0 or (VAR_VALOR) &gt; 0</p>\r\n\r\n<p>GROUP BY EVE_IND,EVE_DESCRICAO &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />\r\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br />\r\nORDER BY EVE_DESCRICAO &nbsp;&nbsp;</p>\r\n\r\n<p>DROP TABLE #DBTVARIAVEIS</p>\r\n','gabriel','2019-01-30 17:24:07'),(712,'relatorio, horario de entrada e marcacao da entrada','RELATORIOS','<p>--COLUNAGRUPO#0#<br />\r\n--LARGURA#200,200,90,80,80#<br />\r\nSELECT EMp_nome EMPRESA, FUNC_NOME AS NOME , APO_DATA AS DATA,<br />\r\nDBO.FN_GETTIMEFULL(INT_HORA1) ENTRADA,&nbsp;<br />\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO1) AS MARCACAO &nbsp;</p>\r\n\r\n<p>FROM FUNCIONARIOS<br />\r\nINNER JOIN APONTA ON APO_FUNC = FUNC_IND&nbsp;<br />\r\nINNER JOIN EMPRESAS ON EMP_IND = FUNC_EMPRESA<br />\r\ninner join Expedientes on APO_H = [INT_IND]</p>\r\n\r\n<p>WHERE APO_DATA &gt;= %DATAINICIAL% AND APO_DATA &lt;= %DATAFINAL%<br />\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL AND DBO.FN_GETTIMEFULL(INT_HORA1) &lt; DBO.FN_GETTIMEFULL(APO_MARCACAO1) AND<br />\r\nDBO.FN_DEPARTAMENTOPERTENCENTE( FUNC_EMPRESA,%DEPSELECIONADOIND%) = 1<br />\r\nORDER BY EMp_nome,FUNC_NOME,APO_DATA</p>\r\n','gabriel','2019-01-30 18:57:33'),(713,'bloqueio de firewall joinme','TREINAMENTO','<p>https://help.join.me/s/article/joinme-jm-faq-firewalls?language=pt_BR</p>\r\n','gabriel','2019-02-01 14:37:39'),(714,'atualizar produtos com 5% tirone','COMANDOS','<p>&nbsp;update [assefin_MECTIRONE].[dbo].[Produtos]<br />\r\n&nbsp; set [PRO_VALOR_BASE] = [PRO_VALOR_BASE]*1.05</p>\r\n','gabriel','2019-02-01 15:12:15'),(715,'NETFRAMEWORK 3.5 NO WINDOWS 10 (ERRO 0x800f081f)','ERRO SQL','<p>Sigam o passo a passo do video.<br />\r\nhttps://www.youtube.com/watch?v=-Y_FlgGzw9E</p>\r\n','ANDERSON OLIVEIRA','2019-02-01 20:59:21'),(716,'relatorio de faltas pela data selecionada - ponto4','RELATORIOS','<p>SELECT FUNC_NOME as Nome, dbo.fn_getdate(cal_data) as Data<br />\r\nFROM dbo.calculo<br />\r\nINNER JOIN FuncIONARIOS ON FUNC_IND = cal_FUNC<br />\r\nWHERE cal_FALTAHORA &gt; 0<br />\r\nAND cal_DATA = %DATASELECIONADA%<br />\r\nORDER BY FUNC_NOME, cal_DATA</p>\r\n','gabriel','2019-02-08 20:44:08'),(717,'dimep - smart point manual','RELOGIO','<p><iframe align=\"middle\" frameborder=\"0\" height=\"100%\" scrolling=\"yes\" src=\"https://drive.google.com/file/d/16_ypBROSWz206ffPGIWRcek2O8l-y8ac/preview\" width=\"100%\"></iframe></p>\r\n','gabriel','2019-02-11 18:53:06'),(718,'Relatorio funcionario, cracha e cargo','RELATORIOS','<p>SELECT FUNC_REG AS REGISTRO, FUNC_NOME AS NOME, CAR_DESCRICAO AS CARGO, CRA_NUMERO AS CRACH&Aacute;<br />\r\nFROM FUNCIONARIOS<br />\r\nleft JOIN CARGOS ON CAR_IND = FUNC_CARGO<br />\r\nleft JOIN CRACHAS ON CRA_FUNC = FUNC_IND<br />\r\nWHERE FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL<br />\r\nORDER BY FUNC_NOME</p>\r\n','gabriel','2019-02-11 20:24:12'),(719,'Dimep Smart Point - Configurar ip ','RELOGIO','<p>Manual comunica&ccedil;&atilde;o via rede cabo</p>\r\n\r\n<p>clicar no F1 &gt;&gt;&nbsp;Configuracao + E &gt;&gt; com F2 ir na op&ccedil;ao de Prog Tecnica&nbsp; + E&gt;&gt; digitar Supervisor e senha + E &gt;&gt; Prog tec interface +E&gt;&gt; ir em Ethernet&nbsp;</p>\r\n\r\n<p>Habilitar ou desabilitar&nbsp;DHCP</p>\r\n\r\n<p>clicar no F1 &gt;&gt;&nbsp;Configuracao + E &gt;&gt; com F2 ir na op&ccedil;ao de Prog Tecnica&nbsp; + E&gt;&gt; digitar Supervisor e senha + E &gt;&gt; Prog tec interface +E&gt;&gt; ConfigEhernet&gt;&gt;Clica no E e com f1 desabilita ou habilita.</p>\r\n\r\n<p>Ver IP</p>\r\n\r\n<p>Clicar no F2&nbsp; &gt;&gt; F2 ate endereco IP ira exibir o numewro conforme sua rede.</p>\r\n\r\n<p>Exportar RSA</p>\r\n\r\n<p>F1 apos F2 ir ate gerar chave RSA ( deve estar com um pen drive conectado), apos pressione E . O arquivo gerado no pen drive colocar na pasta dos executaveis a frente dele o endere&ccedil;o ip sem ponto.</p>\r\n\r\n<p>Configurar Asseponto&nbsp;</p>\r\n\r\n<p>Apos transferir os executaveis, utilitarios terminal, cadastrar o REP.</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>Supervisor&nbsp;</p>\r\n\r\n<p>Cliente pode definir</p>\r\n\r\n<p>Responsavel: login = login senha = senha definir um cpf valido.</p>\r\n\r\n<p>Apos enviar empregador para acessar menu e outras op&ccedil;&otilde;es digite o supervisor e senha cadastrados no asseponto.</p>\r\n\r\n<p>_____________________________________________________________________________________________________________</p>\r\n\r\n<p>A forma mais facil para configurar wifi acessando relogio pelo navegador,para acessar o relogio pelo navegador 1configure via cabo.</p>\r\n\r\n<p>Acesse com ip, em configura&ccedil;&otilde;es no rodape da pagina , login =&nbsp; Supervisor e Senha definidos no asseponto.</p>\r\n\r\n<p>Em configura&ccedil;&otilde;es wifi defina nome da rede em SSID</p>\r\n\r\n<p>Defina&nbsp; a senha Wifi</p>\r\n\r\n<p>em privacidade selecione WPA/WPA2</p>\r\n\r\n<p>Clique em enviar.</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>Para habilitar modo Wifi</p>\r\n\r\n<p>clicar no F1 &gt;&gt; Configuracao &gt;&gt; com F2 ir na op&ccedil;ao de Prog Tecnica &gt;&gt; digitar Supervisor e senha &gt;&gt; Prog tec interface &gt;&gt; ir em Wifi</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>________________________________________________________________________________________________________________________</p>\r\n\r\n<p>Apos as configura&ccedil;&otilde;es de rede e envio do empregador , enviamos os funcion&aacute;rios&nbsp;</p>\r\n\r\n<p>Para cadastrar digital&nbsp;</p>\r\n\r\n<p>F1 descer com f2 ate CAD DIGITAL + E &gt;&gt; informe supervisor e senha &gt;&gt; digite o crach&aacute; cadastrado no Asseponto +E o relogio vai informar para colocar&nbsp;</p>\r\n\r\n<p>o dedo no leitoraguarde a mensagem cadastrado com sucesso. Pode marcar o ponto.</p>\r\n\r\n<p>Duvidas Canais de atendimento Assecont Tecnologia&nbsp;</p>\r\n\r\n<p>http://assecont.com.br/servicos-tecnologia/&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>________________________________________________________________________________________________________________________</p>\r\n\r\n<p>Gerar AFD&nbsp;</p>\r\n\r\n<p>F1 ir com F2 ate coleta de pen drive pressione E, F2 ate formato AFD , acesse com supervisor e senha E.</p>\r\n\r\n<p>&nbsp;</p>\r\n','Gabriel','2019-02-15 19:59:17'),(720,'erro BOOLEAN rhj','COMANDOS','<p>UPDATE Terminais</p>\r\n\r\n<p>SET TRM_GRUPO&nbsp;= 1</p>\r\n','gabriel','2019-02-18 22:19:34'),(721,'RELATÃ“RIO DE HORÃRIO DE ENTRADA','RELATORIOS','<p>--COLUNAGRUPO#0#</p>\r\n\r\n<p>--LARGURA#200,200,90,80,80#</p>\r\n\r\n<p>SELECT EMP_NOME EMPRESA, FUNC_NOME AS NOME , APO_DATA AS DATA,</p>\r\n\r\n<p>DBO.FN_GETTIMEFULL(INT_HORA1) ENTRADA,</p>\r\n\r\n<p>DBO.FN_GETTIMEFULL(APO_MARCACAO1) AS MARCACAO</p>\r\n\r\n<p>FROM FUNCIONARIOS</p>\r\n\r\n<p>INNER JOIN APONTA ON APO_FUNC = FUNC_IND</p>\r\n\r\n<p>INNER JOIN EMPRESAS ON EMP_IND = FUNC_EMPRESA</p>\r\n\r\n<p>INNER JOIN EXPEDIENTES ON APO_H = [INT_IND]</p>\r\n\r\n<p>WHERE APO_DATA &gt;= %DATAINICIAL% AND APO_DATA &lt;= %DATAFINAL%</p>\r\n\r\n<p>AND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL AND (APO_MARCACAO1) IS NOT NULL AND</p>\r\n\r\n<p>DBO.FN_DEPARTAMENTOPERTENCENTE( FUNC_EMPRESA,%DEPSELECIONADOIND%) = 1</p>\r\n\r\n<p>ORDER BY EMP_NOME,FUNC_NOME,APO_DATA</p>\r\n','Camila Diniz','2019-02-21 17:19:42'),(722,'Erro para importar as marcaÃ§oes no RHJ','RELOGIO','<div><code>Quando esse erro estiver acontecendo execute o executavel como admin.</code></div>\r\n\r\n<div><code>pode ser que vai dar um erro boolean</code></div>\r\n\r\n<div><code>execute esse comando&nbsp;</code></div>\r\n\r\n<div><code>UPDATE TERMINAIS SET TRM_GRUPO&nbsp;= 1</code></div>\r\n','gabriel','2019-02-25 23:23:47'),(723,'Relatorio de Pendencias','RELATORIOS','<p>set dateformat dmy;<br />\r\nSELECT PEN_DATAHORASOLUCAO as DATA,<br />\r\nrtrim(A.SUP_NOME) AS ABRIU,<br />\r\nrtrim(B.SUP_NOME) AS FECHOU,<br />\r\nrtrim(PEN_TIPO_ATENDIMENTO) AS &#39;TIPO ATENDIMENTO&#39;,&nbsp;<br />\r\nREPLACE(REPLACE(rtrim(PEN_PROBLEMA), CHAR(13), &#39; &#39;), CHAR(10), &#39; &#39;) PROBLEMA,<br />\r\nREPLACE(REPLACE(rtrim([PEN_SOLUCAO]), CHAR(13), &#39; &#39;), CHAR(10), &#39; &#39;) SOLUCAO,<br />\r\nrtrim(CAD_RAZAOSOCIAL) EMPRESA</p>\r\n\r\n<p>&nbsp; &nbsp; &nbsp;&nbsp;<br />\r\n&nbsp; FROM [AssepontoPendencias]<br />\r\n&nbsp; inner join AssepontoSuporte AS A on A.SUP_IND = PEN_RESPONSAVEL1<br />\r\n&nbsp; inner join AssepontoSuporte AS B on B.SUP_IND = PEN_RESPONSAVEL2<br />\r\n&nbsp; INNER JOIN ASSEPONTOCLIENTES ON [PEN_INDCADASTRO] = CAD_IND<br />\r\n&nbsp; WHERE B.SUP_SETOR IN (3,4) AND A.SUP_SETOR IN (3,4) AND&nbsp;<br />\r\n&nbsp; CONVERT(DATE, PEN_DATAHORASOLUCAO) &gt;= &#39;01-02-2019&#39;&nbsp;<br />\r\n&nbsp; and CONVERT(DATE, PEN_DATAHORASOLUCAO) &lt;= &#39;28-02-2019&#39;<br />\r\n&nbsp; order by A.SUP_NOME, PEN_DATAHORASOLUCAO</p>\r\n','gabriel','2019-02-27 17:47:03'),(724,'teste','RELOGIO','<p>teste</p>\r\n','teste','2019-03-03 22:11:24'),(725,'','RELOGIO','','','2019-03-03 23:08:49'),(726,'RELATORIO DE HORAS TRABALHADAS NO DIA + EXTRA','RELATORIOS','<p>SELECT FUNC_NOME AS NOME,</p>\r\n\r\n<p><br />\r\nISNULL(DBO.FN_HOURLONGNULLZERO(DBO.FN_MINUTETOHOURLONG(SUM<br />\r\n(DBO.FN_SMALLDATETIMETOMINUTE(CAL_TRAB + CAL_EXTRA + CAL_EXTRAN + CAL_EXTRAF + CAL_EXTRANF )))), &#39;&#39;) AS TOTAL</p>\r\n\r\n<p>FROM FUNCIONARIOS<br />\r\nINNER JOIN CALCULO ON FUNC_IND = CAL_FUNC<br />\r\nWHERE CAL_DATA &gt;= %DATAINICIAL%&nbsp;AND CAL_DATA &lt;= %DATAFINAL%&nbsp;AND<br />\r\nFUNC_DT_DEM IS NULL AND DBO.FN_DEPARTAMENTOPERTENCENTE<br />\r\n(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1 AND (CAL_TRAB + CAL_EXTRA + CAL_EXTRAN + CAL_EXTRAF + CAL_EXTRANF ) &gt; 0<br />\r\nGROUP BY FUNC_NOME</p>\r\n','Camila Diniz','2019-03-08 17:21:43'),(727,'Control id - calibrar touch','RELOGIO','<pre>\r\nDESLIGUE O REL&Oacute;GIO DA TOMADA \r\nPRESSIONE O BOT&Atilde;O VERMELHO (MANTENHA PRESSIONADO) E LIGUE NA TOMADA ATE APARECER +1, DEPOIS SOLTE O BOTAO VERMELHO , CLIQUE EM +2,+3,+4, EM SEGUIDA O DISPLAY ESTA LIBERADO.</pre>\r\n','gabriel','2019-03-19 21:41:48'),(728,'RELATORIO - faltas por mes - CAPPTA','RELOGIO','--LARGURA#200,200,70,70,70,70,70,70#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\nSELECT DISTINCT EMP_NOME EMPRESA, FUNC_NOME \'NOME\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 else \'\' END)\r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/01/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'30/01/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'JAN\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 else \'\'  END)                                                               \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/02/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'28/02/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'FEV\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 else \'\'  END)                                                                 \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/03/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'31/03/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'MAR\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 else \'\' END)                                                                   \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/04/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'30/04/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'ABRIL\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 else \'\' END)\r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/05/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'31/05/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'MAI\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 else \'\'  END) \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/06/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'30/06/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'JUN\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 else \'\' END)   \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/07/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'31/07/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'JUL\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 else \'\' END)  \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/08/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'31/08/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'AGO\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 else \'\' END)    \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/09/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'30/09/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'SET\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 else \'\' END)                                          \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/10/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'31/10/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'OUT\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 else \'\' END)                                          \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/11/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'30/11/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'NOV\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 else \'\' END)                                              \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/12/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'31/12/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'DEC\'\r\n\r\nFROM FUNCIONARIOS\r\nINNER JOIN EMPRESAS ON EMP_IND = FUNC_EMPRESA\r\nINNER JOIN CALCULO ON FUNC_IND = CAL_FUNC    \r\n\r\nWHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL and CAL_FALTAHORA > 0\r\n\r\nGROUP BY FUNC_NOME, EMP_NOME, FUNC_IND                                    \r\n\r\nORDER BY EMP_NOME, FUNC_NOME','gabriel','2019-03-20 15:53:53'),(729,'RELATORIO - extras por mes - CAPPTA','RELOGIO','--LARGURA#200,200,70,70,70,70,70,70#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\nSELECT DISTINCT EMP_NOME EMPRESA, FUNC_NOME \'NOME\',\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRA + CAL_EXTRAN + CAL_EXTRAF + CAL_EXTRANF )))\r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/01/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'30/01/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'JAN\',\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRA + CAL_EXTRAN + CAL_EXTRAF + CAL_EXTRANF )))               \r\n                                          \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/02/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'28/02/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'FEV\',\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRA + CAL_EXTRAN + CAL_EXTRAF + CAL_EXTRANF )))               \r\n                                              \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/03/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'31/03/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'MAR\',\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRA + CAL_EXTRAN + CAL_EXTRAF + CAL_EXTRANF )))               \r\n                                           \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/04/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'30/04/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'ABRIL\',\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRA + CAL_EXTRAN + CAL_EXTRAF + CAL_EXTRANF )))               \r\n                                              \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/05/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'31/05/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'MAI\',\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRA + CAL_EXTRAN + CAL_EXTRAF + CAL_EXTRANF )))               \r\n                                          \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/06/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'30/06/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'JUN\',\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRA + CAL_EXTRAN + CAL_EXTRAF + CAL_EXTRANF )))               \r\n                                               \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/07/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'31/07/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'JUL\',\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRA + CAL_EXTRAN + CAL_EXTRAF + CAL_EXTRANF )))               \r\n                                          \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/08/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'31/08/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'AGO\',\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRA + CAL_EXTRAN + CAL_EXTRAF + CAL_EXTRANF )))   \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/09/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'30/09/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'SET\',\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRA + CAL_EXTRAN + CAL_EXTRAF + CAL_EXTRANF )))               \r\n                                         \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/10/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'31/10/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'OUT\',\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRA + CAL_EXTRAN + CAL_EXTRAF + CAL_EXTRANF )))               \r\n                                       \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/11/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'30/11/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'NOV\',\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRA + CAL_EXTRAN + CAL_EXTRAF + CAL_EXTRANF )))               \r\n                                       \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/12/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'31/12/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'DEC\'\r\n\r\nFROM FUNCIONARIOS\r\nINNER JOIN EMPRESAS ON EMP_IND = FUNC_EMPRESA\r\nINNER JOIN CALCULO ON FUNC_IND = CAL_FUNC    \r\n\r\nWHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL and (CAL_EXTRA + CAL_EXTRAN + CAL_EXTRAF + CAL_EXTRANF ) > 0\r\n\r\nGROUP BY FUNC_NOME, EMP_NOME, FUNC_IND                                    \r\n\r\nORDER BY EMP_NOME, FUNC_NOME','gabriel','2019-03-20 16:21:37'),(730,'RELATORIO - Abono por mes - CAPPTA','RELOGIO','--LARGURA#200,200,70,70,70,70,70,70#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\nSELECT DISTINCT EMP_NOME EMPRESA, FUNC_NOME \'NOME\',\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_ABONO)))\r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/01/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'30/01/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'JAN\',\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_ABONO)))\r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/02/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'28/02/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'FEV\',\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_ABONO)))\r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/03/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'31/03/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'MAR\',\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_ABONO)))                                                       \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/04/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'30/04/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'ABRIL\',\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_ABONO)))     \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/05/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'31/05/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'MAI\',\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_ABONO)))  \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/06/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'30/06/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'JUN\',\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_ABONO)))  \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/07/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'31/07/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'JUL\',\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_ABONO))) \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/08/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'31/08/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'AGO\',\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_ABONO)))                                                        \r\n         \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/09/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'30/09/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'SET\',\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_ABONO))) \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/10/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'31/10/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'OUT\',\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_ABONO)))   \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/11/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'30/11/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'NOV\',\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_ABONO))) \r\nFROM CALCULO WHERE FUNC_IND = CAL_FUNC  AND CAL_DATA >= (RTRIM(\'01/12/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nCAL_DATA <= (RTRIM(\'31/12/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'DEC\'\r\n\r\nFROM FUNCIONARIOS\r\nINNER JOIN EMPRESAS ON EMP_IND = FUNC_EMPRESA\r\nINNER JOIN CALCULO ON FUNC_IND = CAL_FUNC    \r\n\r\nWHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL and (CAL_ABONO) > 0\r\n\r\nGROUP BY FUNC_NOME, EMP_NOME, FUNC_IND\r\n\r\nORDER BY EMP_NOME, FUNC_NOME','gabriel','2019-03-20 16:27:58'),(731,'RELATORIO - fOLGAS por mes - CAPPTA','RELOGIO','--LARGURA#200,200,70,70,70,70,70,70#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\nSELECT DISTINCT EMP_NOME EMPRESA, FUNC_NOME \'NOME\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN APO_H < 0 THEN 1 END)  \r\nFROM aponta WHERE FUNC_IND = apo_FUNC  AND APO_DATA >= (RTRIM(\'01/01/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nAPO_DATA <= (RTRIM(\'30/01/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'JAN\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN APO_H < 0 THEN 1 END)                                                                      \r\nFROM APONTA WHERE FUNC_IND = APO_FUNC  AND APO_DATA >= (RTRIM(\'01/02/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nAPO_DATA <= (RTRIM(\'28/02/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'FEV\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN APO_H < 0 THEN 1 END)                                                                            \r\nFROM APONTA WHERE FUNC_IND = APO_FUNC  AND APO_DATA >= (RTRIM(\'01/03/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nAPO_DATA <= (RTRIM(\'31/03/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'MAR\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN APO_H < 0 THEN 1 END) \r\nFROM APONTA WHERE FUNC_IND = APO_FUNC  AND APO_DATA >= (RTRIM(\'01/04/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nAPO_DATA <= (RTRIM(\'30/04/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'ABRIL\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN APO_H < 0 THEN 1 END)      \r\nFROM APONTA WHERE FUNC_IND = APO_FUNC  AND APO_DATA >= (RTRIM(\'01/05/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nAPO_DATA <= (RTRIM(\'31/05/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'MAI\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN APO_H < 0 THEN 1 END)   \r\nFROM APONTA WHERE FUNC_IND = APO_FUNC  AND APO_DATA >= (RTRIM(\'01/06/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nAPO_DATA <= (RTRIM(\'30/06/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'JUN\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN APO_H < 0 THEN 1 END)   \r\nFROM APONTA WHERE FUNC_IND = APO_FUNC  AND APO_DATA >= (RTRIM(\'01/07/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nAPO_DATA <= (RTRIM(\'31/07/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'JUL\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN APO_H < 0 THEN 1 END)  \r\nFROM APONTA WHERE FUNC_IND = APO_FUNC  AND APO_DATA >= (RTRIM(\'01/08/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nAPO_DATA <= (RTRIM(\'31/08/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'AGO\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN APO_H < 0 THEN 1 END)                                                         \r\n         \r\nFROM APONTA WHERE FUNC_IND = APO_FUNC  AND APO_DATA >= (RTRIM(\'01/09/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nAPO_DATA <= (RTRIM(\'30/09/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'SET\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN APO_H < 0 THEN 1 END)  \r\nFROM APONTA WHERE FUNC_IND = APO_FUNC  AND APO_DATA >= (RTRIM(\'01/10/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nAPO_DATA <= (RTRIM(\'31/10/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'OUT\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN APO_H < 0 THEN 1 END)    \r\nFROM APONTA WHERE FUNC_IND = APO_FUNC  AND APO_DATA >= (RTRIM(\'01/11/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nAPO_DATA <= (RTRIM(\'30/11/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'NOV\',\r\n\r\nISNULL((SELECT SUM(CASE WHEN APO_H < 0 THEN 1 END)  \r\nFROM APONTA WHERE FUNC_IND = APO_FUNC  AND APO_DATA >= (RTRIM(\'01/12/\') + RTRIM(YEAR(%DATAINICIAL%))) AND\r\nAPO_DATA <= (RTRIM(\'31/12/\') + RTRIM(YEAR(%DATAINICIAL%))) ), \'\') AS \'DEC\'\r\n\r\nFROM FUNCIONARIOS\r\nINNER JOIN EMPRESAS ON EMP_IND = FUNC_EMPRESA\r\nINNER JOIN APONTA ON FUNC_IND = APO_FUNC    \r\n\r\nWHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL and (APO_H) < 0\r\n\r\nGROUP BY FUNC_NOME, EMP_NOME, FUNC_IND\r\n\r\nORDER BY EMP_NOME, FUNC_NOME','gabriel','2019-03-20 16:33:40'),(732,'Relatoriod de marcaÃ§oes, expediente por data','RELATORIOS','','Marina','2019-03-25 23:33:54'),(733,'teste','RELOGIO','','gabriel','2019-03-25 23:37:21'),(734,'teste','RELOGIO','','gabriel','2019-03-25 23:39:43'),(735,'marcaÃ§Ãµes inclusas e descricao web','RELATORIOS','<p>--COLUNAGRUPO#1#<br />\r\n--LARGURA#220,220,80,80,230#<br />\r\n--TITULO#RELATORIO DE MARCA&Ccedil;OES INCLUSAS#</p>\r\n\r\n<p>SELECT FUNC_NOME AS NOME, EMP_NOME, CONVERT(NVARCHAR(30), MRC_DATAHORA, 103) AS DATA,<br />\r\nCONVERT(NVARCHAR(5), MRC_DATAHORA, 108) AS HORA, &nbsp;&nbsp;<br />\r\nCASE WHEN MRC_OBS &lt;&gt; &#39;&#39; THEN MRC_OBS ELSE MOT_DESCRICAO END AS STATUS</p>\r\n\r\n<p>FROM MARCACOES<br />\r\nINNER JOIN FUNCIONARIOS ON FUNC_IND = MRC_FUNC<br />\r\nINNER JOIN EMPRESAS ON &nbsp;FUNC_EMPRESA = EMP_IND<br />\r\nLEFT JOIN [MOTIVOS] ON [MRC_MOTIVO] = &nbsp;[MOT_IND] &nbsp;<br />\r\nWHERE MRC_DATAAP &gt;= %DATAINICIAL% AND MRC_DATAAP &lt;= %DATAFINAL% AND<br />\r\nDBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA, %DEPSELECIONADOIND%) =1<br />\r\nAND FUNC_DT_DEM IS NULL AND FUNC_MARCADO_EXCLUSAO = 0 &nbsp;AND (MRC_OBS IS NOT NULL or MRC_MOTIVO IS NOT NULL ) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />\r\nORDER BY EMP_NOME, FUNC_NOME, MRC_DATAHORA</p>\r\n','gabriel','2019-03-28 18:22:53'),(738,'RELATÃ“RIO da quantidade de dias trabalhados','RELATORIOS','<p>--GRUPOQUEBRA#0#<br />\r\n--GRUPONREGISTROS#0#<br />\r\n--COLUNAGRUPO#0#<br />\r\n--LARGURA#200,200,80#<br />\r\ndeclare @dataincio smalldatetime = &#39;01/01/2019&#39;<br />\r\ndeclare @datafim smalldatetime = &#39;31/01/2019&#39;&nbsp;<br />\r\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br />\r\nSELECT emp_nome EMPRESA,FUNC_NOME AS NOME,<br />\r\nsum(case when CAL_TRAB &gt; 0 then 1 end) AS &#39;DIAS TRAB&#39;&nbsp;</p>\r\n\r\n<p>FROM FUNCIONARIOS<br />\r\nINNER JOIN CALCULO ON FUNC_IND = CAL_FUNC<br />\r\nINNER JOIN EMPRESAS ON &nbsp;FUNC_EMPRESA = EMP_IND<br />\r\nWHERE CAL_DATA &gt;= @dataincio AND CAL_DATA &lt;= @datafim AND CAL_TRAB &gt; 0 and &nbsp; &nbsp; &nbsp;<br />\r\nFUNC_DT_DEM IS NULL and FUNC_MARCADO_EXCLUSAO = 0 and<br />\r\nDBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1</p>\r\n\r\n<p>GROUP BY FUNC_NOME,emp_nome<br />\r\nORDER BY emp_nome, FUNC_NOME</p>\r\n','gabriel','2019-03-29 17:26:01'),(739,'smart point - configurar ip manualmente','RELOGIO','<p>CLICAR NO F1 &gt;&gt; CONFIGURACAO&nbsp; &gt;&gt; COM F2 IR NA OP&Ccedil;AO DE PROG TECNICA&nbsp; &gt;&gt; DIGITAR SUPERVISOR E SENHA &gt;&gt; conf ethernet &gt;&gt; conf rede</p>\r\n\r\n<p>utilize a tecla E para confirmar&nbsp;</p>\r\n','gabriel','2019-04-05 16:36:24'),(740,'propostas enviadas','RELATORIOS','<p><br />\r\nSELECT DISTINCT RTRIM(CAD_RAZAOSOCIAL) EMPRESA<br />\r\n&nbsp;&nbsp; &nbsp; &nbsp;,RTRIM([REV_RAZAOSOCIAL]) REVENDA<br />\r\n&nbsp; &nbsp; &nbsp; ,CASE WHEN [CAD_CNPJ] IS NOT NULL THEN RTRIM([CAD_CNPJ]) WHEN [CAD_CPF] IS NOT NULL THEN RTRIM([CAD_CPF]) ELSE &#39;&#39; END CNPJ<br />\r\n&nbsp; &nbsp; &nbsp; ,RTRIM(CAD_CONTATO) as CONTATO<br />\r\n&nbsp; &nbsp; &nbsp; ,RTRIM(CAD_UF) ESTADO<br />\r\n&nbsp; &nbsp; &nbsp; ,isnull(RTRIM(CAD_TELEFONE1_DDD) + &#39; &#39; + &nbsp;RTRIM(CAD_TELEFONE1),&#39;&#39;) as TELEFONE<br />\r\n&nbsp; &nbsp; &nbsp; ,isnull(RTRIM(CAD_TELEFONE2_DDD) + &#39; &#39; + &nbsp;RTRIM(CAD_TELEFONE2),&#39;&#39;) as TELEFONE2<br />\r\n&nbsp; &nbsp; &nbsp; ,isnull(RTRIM(CAD_TELEFONE3_DDD) + &#39; &#39; + &nbsp;RTRIM(CAD_TELEFONE3),&#39;&#39;) as TELEFONE3<br />\r\n&nbsp; &nbsp; &nbsp; ,isnull(RTRIM(CAD_CELULAR_DDD) + &#39; &#39; + &nbsp;RTRIM(CAD_CELULAR),&#39;&#39;) as CELULAR<br />\r\n&nbsp; &nbsp; &nbsp; ,CASE WHEN _CAD_ENT_TELEFONE1 IS NOT NULL THEN isnull(RTRIM(_CAD_ENT_TELEFONE1),&#39;&#39;) ELSE isnull(RTRIM(_CAD_ENT_TELEFONE2),&#39;&#39;) END &#39;OUTROS CONTATOS&#39;<br />\r\n&nbsp; &nbsp; &nbsp; ,isnull(RTRIM(CAD_EMAIL),&#39;&#39;) as EMAIL<br />\r\n&nbsp; &nbsp; &nbsp; ,isnull(RTRIM(CAD_EMAIL2),&#39;&#39;) as EMAIL2<br />\r\n&nbsp; &nbsp; &nbsp; ,isnull(RTRIM(CAD_EMAIL3),&#39;&#39;) as EMAIL3<br />\r\n&nbsp; FROM [assecont1].[dbo].[AssepontoClientes]<br />\r\n&nbsp; inner join [AssepontoClientesComercial] on cad_ind = [COM_CLIENTE]<br />\r\n&nbsp; INNER JOIN [AssepontoRevendas] ON [CAD_REVENDA] = [REV_IND]<br />\r\n&nbsp; left JOIN [AssepontoManutencao] ON cad_ind = [MNT_CLIENTE]<br />\r\n&nbsp; where (MNT_CLIENTE) is null<br />\r\n&nbsp; ORDER BY RTRIM(CAD_RAZAOSOCIAL)</p>\r\n','gabriel','2019-04-10 04:09:50'),(741,'CLientes com mais de 120 dias corridos','RELATORIOS','<p>/****** Script do comando SelectTopNRows de SSMS &nbsp;******/<br />\r\nSELECT DISTINCT RTRIM(CAD_RAZAOSOCIAL) EMPRESA<br />\r\n&nbsp;&nbsp; &nbsp; &nbsp;,RTRIM([REV_RAZAOSOCIAL]) REVENDA<br />\r\n&nbsp; &nbsp; &nbsp; ,CASE WHEN [CAD_CNPJ] IS NOT NULL THEN RTRIM([CAD_CNPJ]) WHEN [CAD_CPF] IS NOT NULL THEN RTRIM([CAD_CPF]) ELSE &#39;&#39; END CNPJ<br />\r\n&nbsp; &nbsp; &nbsp; ,RTRIM(CAD_CONTATO) as CONTATO<br />\r\n&nbsp; &nbsp; &nbsp; ,RTRIM(CAD_UF) ESTADO<br />\r\n&nbsp; &nbsp; &nbsp; ,isnull(RTRIM(CAD_TELEFONE1_DDD) + &#39; &#39; + &nbsp;RTRIM(CAD_TELEFONE1),&#39;&#39;) as TELEFONE<br />\r\n&nbsp; &nbsp; &nbsp; ,isnull(RTRIM(CAD_TELEFONE2_DDD) + &#39; &#39; + &nbsp;RTRIM(CAD_TELEFONE2),&#39;&#39;) as TELEFONE2<br />\r\n&nbsp; &nbsp; &nbsp; ,isnull(RTRIM(CAD_TELEFONE3_DDD) + &#39; &#39; + &nbsp;RTRIM(CAD_TELEFONE3),&#39;&#39;) as TELEFONE3<br />\r\n&nbsp; &nbsp; &nbsp; ,isnull(RTRIM(CAD_CELULAR_DDD) + &#39; &#39; + &nbsp;RTRIM(CAD_CELULAR),&#39;&#39;) as CELULAR<br />\r\n&nbsp; &nbsp; &nbsp; ,CASE WHEN _CAD_ENT_TELEFONE1 IS NOT NULL THEN isnull(RTRIM(_CAD_ENT_TELEFONE1),&#39;&#39;) ELSE isnull(RTRIM(_CAD_ENT_TELEFONE2),&#39;&#39;) END &#39;OUTROS CONTATOS&#39;<br />\r\n&nbsp; &nbsp; &nbsp; ,isnull(RTRIM(CAD_EMAIL),&#39;&#39;) as EMAIL<br />\r\n&nbsp; &nbsp; &nbsp; ,isnull(RTRIM(CAD_EMAIL2),&#39;&#39;) as EMAIL2<br />\r\n&nbsp; &nbsp; &nbsp; ,isnull(RTRIM(CAD_EMAIL3),&#39;&#39;) as EMAIL3<br />\r\n&nbsp; FROM [assecont1].[dbo].[AssepontoClientes]<br />\r\n&nbsp; INNER JOIN [AssepontoRevendas] ON [CAD_REVENDA] = [REV_IND]<br />\r\n&nbsp; INNER JOIN [AssepontoNSeries] on [NSE_CLIENTE] = cad_ind<br />\r\n&nbsp; left JOIN [AssepontoManutencao] ON cad_ind = [MNT_CLIENTE]<br />\r\n&nbsp; where (MNT_CLIENTE) is null and [NSE_SOLICITACAO] = 1 and [NSE_DATA] &lt;= &#39;2018-12-11&#39;<br />\r\n&nbsp; ORDER BY RTRIM(CAD_RAZAOSOCIAL)</p>\r\n','gabriel','2019-04-10 05:05:19'),(742,'propostas enviadas com data','RELATORIOS','<p>SET DATEFORMAT DMY;<br />\r\nSELECT DISTINCT RTRIM(CAD_RAZAOSOCIAL) EMPRESA<br />\r\n&nbsp; &nbsp; &nbsp; ,RTRIM([REV_RAZAOSOCIAL]) REVENDA<br />\r\n&nbsp; &nbsp; &nbsp; ,CASE WHEN [CAD_CNPJ] IS NOT NULL THEN RTRIM([CAD_CNPJ]) WHEN [CAD_CPF] IS NOT NULL THEN RTRIM([CAD_CPF]) ELSE &#39;&#39; END CNPJ<br />\r\n&nbsp; &nbsp; &nbsp; ,RTRIM(CAD_CONTATO) AS CONTATO<br />\r\n&nbsp; &nbsp; &nbsp; ,RTRIM(CAD_UF) ESTADO<br />\r\n&nbsp; &nbsp; &nbsp; ,ISNULL(RTRIM(CAD_TELEFONE1_DDD) + &#39; &#39; + &nbsp;RTRIM(CAD_TELEFONE1),&#39;&#39;) AS TELEFONE<br />\r\n&nbsp; &nbsp; &nbsp; ,ISNULL(RTRIM(CAD_TELEFONE2_DDD) + &#39; &#39; + &nbsp;RTRIM(CAD_TELEFONE2),&#39;&#39;) AS TELEFONE2<br />\r\n&nbsp; &nbsp; &nbsp; ,ISNULL(RTRIM(CAD_TELEFONE3_DDD) + &#39; &#39; + &nbsp;RTRIM(CAD_TELEFONE3),&#39;&#39;) AS TELEFONE3<br />\r\n&nbsp; &nbsp; &nbsp; ,ISNULL(RTRIM(CAD_CELULAR_DDD) + &#39; &#39; + &nbsp;RTRIM(CAD_CELULAR),&#39;&#39;) AS CELULAR<br />\r\n&nbsp; &nbsp; &nbsp; ,CASE WHEN _CAD_ENT_TELEFONE1 IS NOT NULL THEN ISNULL(RTRIM(_CAD_ENT_TELEFONE1),&#39;&#39;) ELSE ISNULL(RTRIM(_CAD_ENT_TELEFONE2),&#39;&#39;) END &#39;OUTROS CONTATOS&#39;<br />\r\n&nbsp; &nbsp; &nbsp; ,ISNULL(RTRIM(CAD_EMAIL),&#39;&#39;) AS EMAIL<br />\r\n&nbsp; &nbsp; &nbsp; ,ISNULL(RTRIM(CAD_EMAIL2),&#39;&#39;) AS EMAIL2<br />\r\n&nbsp; &nbsp; &nbsp; ,ISNULL(RTRIM(CAD_EMAIL3),&#39;&#39;) AS EMAIL3<br />\r\n&nbsp;&nbsp; &nbsp; &nbsp;,CONVERT(CHAR(12),[COM_FECHADOEM],103) + CONVERT(CHAR(5),[COM_FECHADOEM],108) ENVIADO</p>\r\n\r\n<p>&nbsp; FROM [ASSECONT1].[DBO].[ASSEPONTOCLIENTES]<br />\r\n&nbsp; INNER JOIN [ASSEPONTOCLIENTESCOMERCIAL] ON CAD_IND = [COM_CLIENTE]<br />\r\n&nbsp; INNER JOIN [ASSEPONTOREVENDAS] ON [CAD_REVENDA] = [REV_IND]<br />\r\n&nbsp; LEFT JOIN [ASSEPONTOMANUTENCAO] ON CAD_IND = [MNT_CLIENTE]<br />\r\n&nbsp; WHERE (MNT_CLIENTE) IS NULL</p>\r\n\r\n<p>&nbsp; ORDER BY RTRIM(CAD_RAZAOSOCIAL)</p>\r\n','gabriel','2019-04-10 08:26:57'),(743,'propostas enviadas com data','RELATORIOS','<p>SET DATEFORMAT DMY;<br />\r\nSELECT DISTINCT RTRIM(CAD_RAZAOSOCIAL) EMPRESA<br />\r\n&nbsp; &nbsp; &nbsp; ,RTRIM([REV_RAZAOSOCIAL]) REVENDA<br />\r\n&nbsp; &nbsp; &nbsp; ,CASE WHEN [CAD_CNPJ] IS NOT NULL THEN RTRIM([CAD_CNPJ]) WHEN [CAD_CPF] IS NOT NULL THEN RTRIM([CAD_CPF]) ELSE &#39;&#39; END CNPJ<br />\r\n&nbsp; &nbsp; &nbsp; ,RTRIM(CAD_CONTATO) AS CONTATO<br />\r\n&nbsp; &nbsp; &nbsp; ,RTRIM(CAD_UF) ESTADO<br />\r\n&nbsp; &nbsp; &nbsp; ,ISNULL(RTRIM(CAD_TELEFONE1_DDD) + &#39; &#39; + &nbsp;RTRIM(CAD_TELEFONE1),&#39;&#39;) AS TELEFONE<br />\r\n&nbsp; &nbsp; &nbsp; ,ISNULL(RTRIM(CAD_TELEFONE2_DDD) + &#39; &#39; + &nbsp;RTRIM(CAD_TELEFONE2),&#39;&#39;) AS TELEFONE2<br />\r\n&nbsp; &nbsp; &nbsp; ,ISNULL(RTRIM(CAD_TELEFONE3_DDD) + &#39; &#39; + &nbsp;RTRIM(CAD_TELEFONE3),&#39;&#39;) AS TELEFONE3<br />\r\n&nbsp; &nbsp; &nbsp; ,ISNULL(RTRIM(CAD_CELULAR_DDD) + &#39; &#39; + &nbsp;RTRIM(CAD_CELULAR),&#39;&#39;) AS CELULAR<br />\r\n&nbsp; &nbsp; &nbsp; ,CASE WHEN _CAD_ENT_TELEFONE1 IS NOT NULL THEN ISNULL(RTRIM(_CAD_ENT_TELEFONE1),&#39;&#39;) ELSE ISNULL(RTRIM(_CAD_ENT_TELEFONE2),&#39;&#39;) END &#39;OUTROS CONTATOS&#39;<br />\r\n&nbsp; &nbsp; &nbsp; ,ISNULL(RTRIM(CAD_EMAIL),&#39;&#39;) AS EMAIL<br />\r\n&nbsp; &nbsp; &nbsp; ,ISNULL(RTRIM(CAD_EMAIL2),&#39;&#39;) AS EMAIL2<br />\r\n&nbsp; &nbsp; &nbsp; ,ISNULL(RTRIM(CAD_EMAIL3),&#39;&#39;) AS EMAIL3<br />\r\n&nbsp;&nbsp; &nbsp; &nbsp;,CONVERT(CHAR(12),[COM_FECHADOEM],103) + CONVERT(CHAR(5),[COM_FECHADOEM],108) ENVIADO</p>\r\n\r\n<p>&nbsp; FROM [ASSECONT1].[DBO].[ASSEPONTOCLIENTES]<br />\r\n&nbsp; INNER JOIN [ASSEPONTOCLIENTESCOMERCIAL] ON CAD_IND = [COM_CLIENTE]<br />\r\n&nbsp; INNER JOIN [ASSEPONTOREVENDAS] ON [CAD_REVENDA] = [REV_IND]<br />\r\n&nbsp; LEFT JOIN [ASSEPONTOMANUTENCAO] ON CAD_IND = [MNT_CLIENTE]<br />\r\n&nbsp; WHERE (MNT_CLIENTE) IS NULL</p>\r\n\r\n<p>&nbsp; ORDER BY RTRIM(CAD_RAZAOSOCIAL)</p>\r\n','gabriel','2019-04-10 08:28:13'),(744,'relatorio intervalo maior que 1:00','RELATORIOS','<p>--GRUPOQUEBRA#1#<br />\r\n--GRUPONREGISTROS#0#<br />\r\n--COLUNAGRUPO#0#<br />\r\n--LARGURA#600,80,60,60,60,60,60,60,70#</p>\r\n\r\n<p>SELECT DISTINCT (RTRIM(FUNC_NOME) + &#39; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39; + RTRIM(EMP_NOME)) AS NOME, APO_DATA AS DATA,<br />\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO1) AS ENTRADA,<br />\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO2) AS &#39;INT-SA&Iacute;DA&#39;,<br />\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO3) AS &#39;INT-RETORNO&#39;,<br />\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO4) AS &#39;INT-SA&Iacute;DA 2&#39;,<br />\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO5) AS &#39;INT-RETORNO 2&#39;,<br />\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO6) AS SA&Iacute;DA,<br />\r\nCASE WHEN DBO.FN_SMALLDATETIMETOMINUTE(APO_MARCACAO3 - APO_MARCACAO2) &gt;= DBO.FN_SMALLDATETIMETOMINUTE(APO_MARCACAO5 - APO_MARCACAO4)<br />\r\nTHEN DBO.FN_GETTIMEFULL(APO_MARCACAO3 - APO_MARCACAO2)<br />\r\nWHEN DBO.FN_SMALLDATETIMETOMINUTE(APO_MARCACAO3 - APO_MARCACAO2) &lt; DBO.FN_SMALLDATETIMETOMINUTE(APO_MARCACAO5 - APO_MARCACAO4)<br />\r\nTHEN DBO.FN_GETTIMEFULL(APO_MARCACAO5 - APO_MARCACAO4) ELSE &#39;&#39; END INTERVALO</p>\r\n\r\n<p>FROM FUNCIONARIOS<br />\r\nINNER JOIN APONTA ON APO_FUNC = FUNC_IND<br />\r\nINNER JOIN EMPRESAS ON EMP_IND = FUNC_EMPRESA<br />\r\nWHERE APO_DATA &gt;= %DATAINICIAL% AND APO_DATA &lt;= %DATAFINAL% AND<br />\r\n(DBO.FN_SMALLDATETIMETOMINUTE(APO_MARCACAO3 - APO_MARCACAO2) &gt; 60<br />\r\nOR DBO.FN_SMALLDATETIMETOMINUTE(APO_MARCACAO5 - APO_MARCACAO4) &gt; 60)</p>\r\n\r\n<p>ORDER BY (RTRIM(FUNC_NOME) + &#39; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39; + RTRIM(EMP_NOME))</p>\r\n','gabriel','2019-04-10 10:07:26'),(745,'relatorio 4all totalizado','RELATORIOS','<p>--LARGURA# 200,150,70,70,70,70,70#<br />\r\ndeclare @inicio smalldatetime = &#39;21/11/2018&#39;<br />\r\ndeclare @fim smalldatetime = &#39;20/12/2018&#39;</p>\r\n\r\n<p>SELECT DISTINCT FUNC_NOME AS NOME, EMP_NOME AS EMPRESA,</p>\r\n\r\n<p>(SELECT &nbsp;DBO.FN_MINUTETOHOURLONG(SUM(case when DBO.FN_HOURLONGTOMINUTE(BCO_VALOR) &gt;= 120 then 120 else<br />\r\n&nbsp;DBO.FN_HOURLONGTOMINUTE(BCO_VALOR) end)) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />\r\nFROM BCOHORAS WHERE BCO_FUNC = FUNC_IND AND BCO_DATA &gt;= @inicio AND BCO_DATA &lt;= @fim AND BCO_STATUS IN (1,2) ) AS &#39;EXTRA 50%&#39;,</p>\r\n\r\n<p>(SELECT &nbsp;DBO.FN_MINUTETOHOURLONG(SUM(case when DBO.FN_HOURLONGTOMINUTE(BCO_VALOR) &gt; 120 then DBO.FN_HOURLONGTOMINUTE(BCO_VALOR) - 120 end))<br />\r\nFROM BCOHORAS WHERE BCO_FUNC = FUNC_IND AND BCO_DATA &gt;= @inicio AND BCO_DATA &lt;= @fim AND<br />\r\nDBO.FN_HOURLONGTOMINUTE(BCO_VALOR) &gt; 120 AND BCO_STATUS IN (1,2) ) AS &#39;EXTRA 75%&#39;,</p>\r\n\r\n<p>(SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_HOURLONGTOMINUTE(BCO_VALOR)/2)) FROM BCOHORAS WHERE BCO_FUNC = FUNC_IND AND<br />\r\nBCO_DATA &gt;= @inicio AND BCO_DATA &lt;= @fim AND BCO_STATUS IN (3,4) ) &nbsp;&#39;EXTRA 100%&#39;,</p>\r\n\r\n<p>REPLACE(DBO.FN_MINUTETOHOURLONG(((select sum(DBO.FN_SMALLDATETIMETOMINUTE(CAL_NOTURNO)) from calculo where FUNC_IND = CAL_FUNC and<br />\r\nCAL_DATA &gt;= @inicio AND CAL_DATA &lt;= @fim and CAL_NOTURNO &gt; 0) -<br />\r\n(isnull((select sum(DBO.FN_SMALLDATETIMETOMINUTE(CAST(BCO_VALOR AS smalldatetime))) from BCOHORAS where BCO_FUNC =<br />\r\nFUNC_IND AND BCO_DATA &gt;= @inicio AND BCO_DATA &lt;= @fim &nbsp;and BCO_STATUS = 2 and DBO.FN_SMALLDATETIMETOMINUTE(CAST(BCO_VALOR AS<br />\r\nsmalldatetime)) &gt; 0),&#39;&#39;) +<br />\r\nisnull((select sum(DBO.FN_SMALLDATETIMETOMINUTE(CAST(BCO_VALOR AS smalldatetime))/2) from BCOHORAS where BCO_FUNC = FUNC_IND AND<br />\r\nBCO_DATA &gt;= @inicio AND BCO_DATA &lt;= @fim &nbsp;and BCO_STATUS = 4 and DBO.FN_SMALLDATETIMETOMINUTE(CAST(BCO_VALOR AS smalldatetime)) &gt; 0),&#39;&#39;)<br />\r\n))),&#39;0:00&#39;,&#39;&#39;) &nbsp;AS &#39;60% NOTURNA&#39;,</p>\r\n\r\n<p>REPLACE(DBO.FN_MINUTETOHOURLONG(((isnull((select sum(DBO.FN_HOURLONGTOMINUTE(BCO_VALOR)) from BCOHORAS where BCO_FUNC =<br />\r\nFUNC_IND AND BCO_DATA &gt;= @inicio AND BCO_DATA &lt;= @fim &nbsp;and BCO_STATUS = 2),&#39; &#39;) + &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />\r\nisnull((select sum(DBO.FN_HOURLONGTOMINUTE(BCO_VALOR))/2 from BCOHORAS where BCO_FUNC = FUNC_IND AND<br />\r\nBCO_DATA &gt;= @inicio AND BCO_DATA &lt;= @fim &nbsp;and BCO_STATUS = 4),&#39; &#39;)))),&#39;0:00&#39;,&#39;&#39;) &nbsp;AS &#39;40% NOTURNA&#39;,</p>\r\n\r\n<p>REPLACE((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_HOURLONGTOMINUTE(BCO_VALOR))) FROM BCOHORAS<br />\r\nWHERE BCO_FUNC = FUNC_IND and BCO_DATA &gt;= @inicio AND BCO_DATA &lt;= @fim AND BCO_STATUS in (10,11) ),&#39;-&#39;,&#39;&#39;) AS DEBITO</p>\r\n\r\n<p>FROM CALCULO<br />\r\nINNER JOIN FUNCIONARIOS ON FUNC_IND = CAL_FUNC<br />\r\nINNER JOIN BCOHORAS ON BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA &nbsp; &nbsp;<br />\r\nINNER JOIN EMPRESAS ON &nbsp;FUNC_EMPRESA = EMP_IND</p>\r\n\r\n<p>WHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA, %DEPSELECIONADOIND%) =1<br />\r\nAND FUNC_DT_DEM IS NULL AND FUNC_MARCADO_EXCLUSAO = 0 AND CAL_DATA &gt;= @inicio AND CAL_DATA &lt;= @fim</p>\r\n\r\n<p>GROUP BY EMP_NOME, FUNC_IND,FUNC_NOME</p>\r\n\r\n<p>ORDER BY EMP_NOME, FUNC_NOME</p>\r\n','gabriel','2019-04-16 17:27:53'),(746,'Relatorio do saldo do banco definindo data','RELATORIOS','<p>--GRUPOQUEBRA#0#<br />\r\n--GRUPONREGISTROS#0#<br />\r\n--COLUNAGRUPO#0#<br />\r\n--LARGURA#200,220,80#</p>\r\n\r\n<p>declare @inicio smalldatetime = &#39;01/01/2019&#39;<br />\r\ndeclare @final smalldatetime = &#39;01/04/2019&#39;</p>\r\n\r\n<p>SELECT EMP_NOME EMPRESA, FUNC_NOME NOME,</p>\r\n\r\n<p>(SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_HOURLONGTOMINUTE(BCO_VALOR)))<br />\r\nFROM BCOHORAS WHERE BCO_FUNC = FUNC_IND AND BCO_DATA &gt;= @inicio and BCO_DATA &lt;= @final) AS &#39;SALDO&#39;</p>\r\n\r\n<p>FROM BCOHORAS<br />\r\nINNER JOIN FUNCIONARIOS ON FUNC_IND = BCO_FUNC<br />\r\nINNER JOIN EMPRESAS ON EMP_IND = FUNC_EMPRESA<br />\r\nWHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1<br />\r\nAND FUNC_DT_DEM IS NULL AND FUNC_MARCADO_EXCLUSAO = 0</p>\r\n\r\n<p>GROUP BY EMP_NOME ,FUNC_NOME, FUNC_IND<br />\r\nORDER BY EMP_NOME ,FUNC_NOME</p>\r\n','gabriel','2019-04-18 16:35:12'),(747,'ASSOCIAR NUMERAÃ‡ÃƒO DE CRACHÃ PARA TODOS OS FUNCIONÃRIOS','COMANDOS','<p><br />\r\nExecutar em Utilit&aacute;rios &gt; Suporte&nbsp;</p>\r\n\r\n<p><br />\r\n&nbsp;INSERT INTO Crachas (CRA_FUNC,CRA_NUMERO,CRA_DATAINICIAL,CRA_DATAFINAL)&nbsp;<br />\r\nSELECT FUNC_IND, FUNC_REG, &#39;27/7/2011&#39;, NULL FROM Funcionarios WHERE FUNC_DT_DEM IS NULL</p>\r\n','Camila Diniz','2019-04-22 20:40:27'),(748,'Relatorio de tipo de marcaÃ§oes para app','RELATORIOS','<p>--GRUPOQUEBRA#0#<br />\r\n--GRUPONREGISTROS#0#<br />\r\n--COLUNAGRUPO#0#<br />\r\n--LARGURA#200,200,80,75,50,120#<br />\r\nDECLARE @INICIO SMALLDATETIME = %DATAINICIAL%<br />\r\nDECLARE @FIM SMALLDATETIME = %DATAFINAL%</p>\r\n\r\n<p>SELECT EMP_NOME SETOR, FUNC_NOME NOME, CONVERT(NVARCHAR(30), MRC_DATAHORA, 103) AS DATA, CONVERT(NVARCHAR(5), MRC_DATAHORA, 108) AS HORA,<br />\r\ncase when mrc_origem = 0 then &#39;Indefinido&#39; when mrc_origem = 1 then &#39;Relogio&#39; when mrc_origem = 2 then &#39;Inclus&atilde;o&#39; when mrc_origem = 3<br />\r\nthen &#39;APP&#39; when mrc_origem = 4 then &#39;Web&#39; when mrc_origem = 5 then &#39;Afd&#39; when mrc_origem = 6 then &#39;Outros Arquivos&#39; end &nbsp;as TIPO &nbsp;&nbsp;</p>\r\n\r\n<p>FROM MARCACOES<br />\r\nINNER JOIN FUNCIONARIOS ON MRC_FUNC = FUNC_IND<br />\r\nINNER JOIN EMPRESAS ON EMP_IND = FUNC_EMPRESA<br />\r\nWHERE &nbsp;DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1 AND<br />\r\nMRC_DATAAP &gt;= @INICIO AND MRC_DATAAP &lt;= @FIM AND FUNC_MARCADO_EXCLUSAO = 0<br />\r\nORDER BY EMP_NOME, FUNC_NOME, MRC_DATAAP</p>\r\n','gabriel','2019-04-23 22:03:18'),(749,'RelatÃ³rio extra 100% dia selecionado','RELATORIOS','<p>--LARGURA#250,120,120,100#<br />\r\nSELECT FUNC_NOME AS NOME,</p>\r\n\r\n<p>ISNULL(DBO.FN_HOURLONGNULLZERO(DBO.FN_MINUTETOHOURLONG(SUM<br />\r\n(DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRAF +<br />\r\nCAL_EXTRANF)))), &#39;&#39;) AS &#39;TOTAL EXTRA 100%&#39; &nbsp; &nbsp;&nbsp;<br />\r\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />\r\nFROM FUNCIONARIOS<br />\r\nINNER JOIN CALCULO ON FUNC_IND = CAL_FUNC<br />\r\nWHERE CAL_DATA = %DATASELECIONADA% AND CAL_EXTRAF + CAL_EXTRANF &gt; 0 and<br />\r\nFUNC_DT_DEM IS NULL AND FUNC_MARCADO_EXCLUSAO = 0<br />\r\nGROUP BY FUNC_NOME</p>\r\n','Camila Diniz','2019-04-25 18:09:42'),(750,'RELATORIO WFD','RELATORIOS','<p>--LARGURA#70,50,80,150,50,45,50,45,60,65,50,80,120#</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>declare @inicio smalldatetime = &#39;13/04/2019&#39;</p>\r\n\r\n<p>declare @final smalldatetime = &#39;19/04/2019&#39;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>SELECT DBO.FN_GETDATE(CAL_DATA) AS &#39;Date&#39;,FUNC_reg &#39;Employee ID&#39;, SUBSTRING(FUNC_NOME, 1, CHARINDEX(&#39; &#39;, FUNC_NOME, 1) - 1) &#39;First Name&#39;,</p>\r\n\r\n<p>CASE WHEN CHARINDEX(&#39; &#39;,LTRIM(RTRIM(FUNC_NOME))) &gt; 0&nbsp; THEN LTRIM(RTRIM(SUBSTRING(FUNC_NOME, CHARINDEX(&#39; &#39;,LTRIM(RTRIM(FUNC_NOME))),</p>\r\n\r\n<p>(LEN(LTRIM(RTRIM(FUNC_NOME)))+1 - CHARINDEX(&#39; &#39;,LTRIM(RTRIM(FUNC_NOME))) )) )) ELSE &#39;&#39; END AS &#39;Last Name&#39;,</p>\r\n\r\n<p>&#39;&#39; as &#39;Site Name&#39;, &#39;&#39; as &#39;Work Area&#39;,</p>\r\n\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>\r\n\r\n<p>(CONVERT(int,(DBO.FN_SMALLDATETIMETOMINUTE(CAL_TRAB)*100))/60)/CONVERT(decimal(6,2), 100) AS &#39;Regular Operation Time (hours)&#39;,</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>(CONVERT(int,(DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRA + CAL_EXTRAN + CAL_EXTRAF + CAL_EXTRANF)*100))/60)/CONVERT(decimal(6,2), 100)&nbsp;&nbsp;&nbsp;</p>\r\n\r\n<p>AS &#39;Overtimr hourd&#39;,</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>(CONVERT(int,(DBO.FN_SMALLDATETIMETOMINUTE(CAL_ABONO)*100))/60)/CONVERT(decimal(6,2), 100) AS &#39;Paid leave&#39;,</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>(CONVERT(int,(DBO.FN_SMALLDATETIMETOMINUTE(CAL_DESCONTO)+ DBO.FN_SMALLDATETIMETOMINUTE(CAL_ABONO))*100)/ 60)/CONVERT(decimal(6,2), 100)</p>\r\n\r\n<p>as &#39;Umpaid leave&#39;,</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>case when (DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRA) + DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRAN)) &gt; 0 then &#39;1,5&#39;</p>\r\n\r\n<p>when (DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRAF) + DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRANF)) &gt; 0 then &#39;2,0&#39;</p>\r\n\r\n<p>else &#39;&#39; end &#39;Ratio&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>\r\n\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>\r\n\r\n<p>FROM FUNCIONARIOS</p>\r\n\r\n<p>INNER JOIN CALCULO ON FUNC_IND = CAL_FUNC</p>\r\n\r\n<p>WHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1</p>\r\n\r\n<p>AND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL AND CAL_DATA &gt;= @inicio AND CAL_DATA &lt;= @final &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>\r\n\r\n<p>GROUP BY FUNC_NOME, CAL_DATA, CAL_TRAB,CAL_ATRB,FUNC_IND,CAL_ABONO,CAL_DESCONTO,FUNC_reg,CAL_EXTRA, CAL_EXTRAN, CAL_EXTRAF, CAL_EXTRANF</p>\r\n\r\n<p>ORDER BY FUNC_NOME, CAL_DATA</p>\r\n','Steffany','2019-04-25 21:02:33'),(751,'Canal do youtube assecont','UTILIDADES','<p><a href=\"https://www.youtube.com/channel/UCmSpbp-W81jtNHbrpVTfatw/videos\">https://www.youtube.com/channel/UCmSpbp-W81jtNHbrpVTfatw/videos</a></p>\r\n','gabriel','2019-05-03 01:55:31'),(753,'RELATORIO DE MARCAÃ‡OES PELO APP - COM COORDENADAS - GEOLOCALIZACAO','RELATORIOS','--GRUPOQUEBRA#0#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#1#\r\n--LARGURA#200,200,80,75,220#\r\n\r\nDECLARE @INICIO SMALLDATETIME = %DATAINICIAL%                 \r\nDECLARE @FIM SMALLDATETIME = %DATAFINAL%            \r\n\r\nSELECT EMP_NOME SETOR, FUNC_NOME NOME, \r\nCONVERT(NVARCHAR(30), MRC_DATAHORA, 103)  + \'  \' + \r\nCONVERT(NVARCHAR(5), MRC_DATAHORA, 108) AS HORA,\r\n\r\nREPLACE(CONVERT(NUMERIC(10,7), MRC_LATITUDE) ,\',\',\'.\') + \' \' +\r\nREPLACE(CONVERT(NUMERIC(10,7), MRC_LONGITUDE),\',\',\'.\') COORDENADAS\r\n\r\n\r\nFROM MARCACOES                                    \r\nINNER JOIN FUNCIONARIOS ON MRC_FUNC = FUNC_IND\r\nINNER JOIN EMPRESAS ON EMP_IND = FUNC_EMPRESA\r\nWHERE  DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1 AND\r\nMRC_DATAAP >= @INICIO AND MRC_DATAAP <= @FIM AND FUNC_MARCADO_EXCLUSAO = 0\r\nAND MRC_LATITUDE IS NOT NULL \r\n\r\nORDER BY EMP_NOME, FUNC_NOME, MRC_DATAAP','gabriel','2019-05-08 13:44:42'),(754,'Importar marcaÃ§Ã£o via pendrive','ROTINAS DE TRATAMENTO','Para importar as marcaÃ§Ãµes vocÃª vai em Apontamento, ImportaÃ§Ã£o de marcaÃ§Ã£o, seleciona o arquivo AFD, marca a opÃ§Ã£o \"este arquivo Ã© um AFD\" e avanÃ§a atÃ© concluir.','Camila Diniz','2019-05-08 18:51:57'),(755,'Desconsiderar banco de horas em um dia','RELOGIO','VocÃª vai selecionar o dia, BOTÃƒO direito, banco de horas, desconsiderar banco de horas AUTOMÃTICO.','','2019-05-09 15:57:13'),(756,'LANÃ‡AMENTO AVULSO NO BANCO - ASSEPONTOWEB','ROTINAS DE TRATAMENTO','Seleciona o apontamento do funcionario, clica nos tres pontinhos, banco de horas, clica nos tres pontinhos novamente, realizar lanÃ§amento, digite o valor desejado, coloque a data, descriÃ§Ã£o e de OK','Camila Diniz','2019-05-09 15:59:24'),(757,'','RELOGIO','precionar f4 ate aparecer para digitar senha ou acessar menu do relogio >> aberta f2 e ir ate a opÃ§ao ConfiguraÃ§Ã£o de TCP/IP >> ConfiguraÃ§Ã£o de EndereÃ§o IP >> digita o ip e confirma com enter\r\npara alterar as outras configuraÃ§oes de rede so seguir o mesmo procedimento e ir na opÃ§aoes \r\nConfiguraÃ§Ã£o de mÃ¡scara IP\r\nConfiguraÃ§Ã£o de Gateway (roteador)\r\nConfiguraÃ§Ã£o de Porta Local\r\n','','2019-05-09 19:36:16'),(758,'star rep athos - configurar ip','RELOGIO','precionar f4 ate aparecer para digitar senha ou acessar menu do relogio >> aberta f2 e ir ate a opÃ§ao ConfiguraÃ§Ã£o de TCP/IP >> ConfiguraÃ§Ã£o de EndereÃ§o IP >> digita o ip e confirma com enter\r\npara alterar as outras configuraÃ§oes de rede so seguir o mesmo procedimento e ir na opÃ§aoes \r\nConfiguraÃ§Ã£o de mÃ¡scara IP\r\nConfiguraÃ§Ã£o de Gateway (roteador)\r\nConfiguraÃ§Ã£o de Porta Local\r\n','gabriel','2019-05-09 19:36:41'),(759,'relatorio  de atrasos na entrada e no intervalo ','RELATORIOS','--LARGURA#200,200,80,80,80,120#\r\nSELECT EMP_NOME AS EMPRESA, FUNC_NOME AS NOME, PAPO_DATA DATA,\r\n\r\nISNULL((DBO.FN_HOURLONGNULLZERO(DBO.FN_MINUTETOHOURLONG(SUM\r\n(DBO.FN_SMALLDATETIMETOMINUTE(PAPO_ATRASO1_FIM - PAPO_ATRASO1_INICIO)) ))), \'\') AS \'ENTRADA\',\r\n\r\nISNULL(DBO.FN_HOURLONGNULLZERO(DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(\r\nPAPO_ATRASO2_FIM - PAPO_ATRASO2_INICIO) + DBO.FN_SMALLDATETIMETOMINUTE(PAPO_INTERVALO_ATRASO) +\r\nDBO.FN_SMALLDATETIMETOMINUTE(PAPO_ATRASO3_FIM - PAPO_ATRASO3_INICIO)))), \'\') \r\nAS \'INTERVALO\'\r\n\r\n\r\nFROM FUNCIONARIOS       \r\ninner join PREAPONTA on PAPO_FUNC = FUNC_IND\r\nINNER JOIN EMPRESAS ON  FUNC_EMPRESA = EMP_IND\r\nWHERE FUNC_DT_DEM IS NULL AND DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA,%DEPSELECIONADOIND%) = 1\r\nand PAPO_DATA >= %DATAINICIAL% AND PAPO_DATA <= %DATAFINAL% and ( PAPO_ATRASO3_FIM IS NOT NULL\r\nor PAPO_ATRASO2_FIM IS NOT NULL or PAPO_ATRASO1_FIM IS NOT NULL or PAPO_INTERVALO_ATRASO is not null)\r\ngroup by FUNC_NOME,PAPO_DATA, PAPO_ATRASO1_FIM, PAPO_ATRASO3_FIM, PAPO_ATRASO2_FIM ,FUNC_IND,PAPO_INTERVALO_ATRASO,EMP_NOME\r\nORDER BY EMP_NOME,FUNC_NOME','gabriel','2019-05-09 21:07:49'),(760,'relatorio  de atrasos na entrada e no intervalo totalizado','RELATORIOS','--LARGURA#200,200,80,80,80,80#\r\nSELECT EMP_NOME AS EMPRESA, FUNC_NOME AS NOME,\r\n\r\nISNULL((SELECT DBO.FN_HOURLONGNULLZERO(DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE\r\n(PAPO_ATRASO1_FIM - PAPO_ATRASO1_INICIO)) )) FROM PREAPONTA WHERE PAPO_FUNC = FUNC_IND AND\r\nPAPO_ATRASO1_FIM IS NOT NULL AND  PAPO_DATA >= %DATAINICIAL% AND PAPO_DATA <= %DATAFINAL%), \'\') AS \'ENTRADA\',\r\n \r\nISNULL((SELECT ISNULL(DBO.FN_HOURLONGNULLZERO(DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(\r\nPAPO_ATRASO2_FIM - PAPO_ATRASO2_INICIO) + DBO.FN_SMALLDATETIMETOMINUTE(PAPO_INTERVALO_ATRASO) +\r\nDBO.FN_SMALLDATETIMETOMINUTE(PAPO_ATRASO3_FIM - PAPO_ATRASO3_INICIO)))), \'\')  FROM\r\nPREAPONTA WHERE PAPO_FUNC = FUNC_IND AND PAPO_DATA >= %DATAINICIAL% AND PAPO_DATA <= %DATAFINAL%), \'\') AS \'INTERVALO\'\r\n\r\n\r\nFROM FUNCIONARIOS\r\nINNER JOIN EMPRESAS ON  FUNC_EMPRESA = EMP_IND\r\nWHERE FUNC_DT_DEM IS NULL AND DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA,%DEPSELECIONADOIND%) = 1\r\nORDER BY EMP_NOME, FUNC_NOME','gabriel','2019-05-09 21:08:08'),(761,'RELATORIO DE ATRASOS NA ENTRADA E NO INTERVALO ','RELATORIOS','--LARGURA#200,200,80,80,80,120#\r\nSELECT EMP_NOME AS EMPRESA, FUNC_NOME AS NOME, PAPO_DATA DATA,\r\n\r\nISNULL((DBO.FN_HOURLONGNULLZERO(DBO.FN_MINUTETOHOURLONG(SUM\r\n(DBO.FN_SMALLDATETIMETOMINUTE(PAPO_ATRASO1_FIM - PAPO_ATRASO1_INICIO)) ))), \'\') AS \'ENTRADA\',\r\n\r\nISNULL(DBO.FN_HOURLONGNULLZERO(DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(\r\nPAPO_ATRASO2_FIM - PAPO_ATRASO2_INICIO) + DBO.FN_SMALLDATETIMETOMINUTE(PAPO_INTERVALO_ATRASO) +\r\nDBO.FN_SMALLDATETIMETOMINUTE(PAPO_ATRASO3_FIM - PAPO_ATRASO3_INICIO)))), \'\') \r\nAS \'INTERVALO\'\r\n\r\n\r\nFROM FUNCIONARIOS       \r\ninner join PREAPONTA on PAPO_FUNC = FUNC_IND\r\nINNER JOIN EMPRESAS ON  FUNC_EMPRESA = EMP_IND\r\nWHERE FUNC_DT_DEM IS NULL AND DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA,%DEPSELECIONADOIND%) = 1\r\nand PAPO_DATA >= %DATAINICIAL% AND PAPO_DATA <= %DATAFINAL% and\r\n(DBO.FN_SMALLDATETIMETOMINUTE(PAPO_ATRASO1_FIM - PAPO_ATRASO1_INICIO) > 0 or DBO.FN_SMALLDATETIMETOMINUTE(\r\nPAPO_ATRASO2_FIM - PAPO_ATRASO2_INICIO) + DBO.FN_SMALLDATETIMETOMINUTE(PAPO_INTERVALO_ATRASO) +\r\nDBO.FN_SMALLDATETIMETOMINUTE(PAPO_ATRASO3_FIM - PAPO_ATRASO3_INICIO) > 0)        \r\ngroup by FUNC_NOME,PAPO_DATA, PAPO_ATRASO1_FIM, PAPO_ATRASO3_FIM, PAPO_ATRASO2_FIM ,FUNC_IND,PAPO_INTERVALO_ATRASO,EMP_NOME\r\nORDER BY EMP_NOME,FUNC_NOME','gabriel','2019-05-09 21:25:38'),(762,'Relatorio de atraso por marcaÃ§oes','RELATORIOS','--LARGURA#200,200,70,60,60,60,60#\r\nSELECT FUNC_NOME AS NOME , EMP_NOME AS SETOR , APO_DATA AS DATA,\r\n                                                           \r\ncase when DBO.FN_GETTIMEFULL(APO_MARCACAO1) > DBO.FN_GETTIMEFULL(APO_H1)  \r\nthen DBO.FN_GETTIMEFULL(APO_MARCACAO1-APO_H1) else \'\' end AS ENTRADA,\r\n\r\ncase when DBO.FN_GETTIMEFULL(APO_MARCACAO2) < DBO.FN_GETTIMEFULL(APO_H2)  \r\nthen DBO.FN_GETTIMEFULL(APO_H2-APO_MARCACAO2) else \'\' end AS \'INTERVALO 1\',\r\n\r\ncase when DBO.FN_GETTIMEFULL(APO_MARCACAO3) > DBO.FN_GETTIMEFULL(APO_H3)  \r\nthen DBO.FN_GETTIMEFULL(APO_MARCACAO3-APO_H3) else \'\' end AS \'INTERVALO 2\',\r\n\r\ncase when DBO.FN_GETTIMEFULL(APO_MARCACAO4) < DBO.FN_GETTIMEFULL(APO_H4)  \r\nthen DBO.FN_GETTIMEFULL(APO_H4-APO_MARCACAO4) else \'\' end AS SAÃDA\r\n\r\nFROM FUNCIONARIOS                      \r\nINNER JOIN APONTA ON APO_FUNC = FUNC_IND\r\nINNER JOIN EMPRESAS ON EMP_IND = FUNC_EMPRESA                                                 \r\nWHERE APO_DATA >= %DATAINICIAL% AND APO_DATA <= %DATAFINAL% AND (APO_MARCACAO1 IS NOT NULL OR\r\nAPO_MARCACAO2 IS NOT NULL OR APO_MARCACAO3 IS NOT NULL OR APO_MARCACAO4 IS NOT NULL)\r\nand (APO_H1 IS NOT NULL OR APO_H2 IS NOT NULL OR APO_H3 IS NOT NULL OR APO_H4 IS NOT NULL) AND\r\n(DBO.FN_GETTIMEFULL(APO_MARCACAO1) > DBO.FN_GETTIMEFULL(APO_H1) OR\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO2) < DBO.FN_GETTIMEFULL(APO_H2) OR\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO3) > DBO.FN_GETTIMEFULL(APO_H3) OR\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO4) < DBO.FN_GETTIMEFULL(APO_H4) )\r\nORDER BY FUNC_NOME','gabriel','2019-05-09 22:11:58'),(763,'Horas Extras em expediente comeÃ§ado em dia comum e terminado em dia de Folga/Feriado','UTILIDADES','Segue instruÃ§Ãµes referente Ã¡ um caso que gera bastante dÃºvida  por parte dos clientes:  Se um funcionÃ¡rio inicia o expediente em Dia Comum e o termina em Dia de Feriado, deve o mesmo receber horas Extras apÃ³s a Meia-Noite ?\r\n\r\nExemplo: Seu expediente Ã© das 14h Ã¡s 22h. PorÃ©m, ele entrou Ã¡s 14:00 do dia 19/11 e teve de ficar atÃ© Ã¡s 03:00+ do dia 20/11, sendo que dia 20/11 Ã© Feriado (ou Folga).\r\nDeve o mesmo receber Extras normais das 22:00 Ã¡s 23:59 e Extra 100% das 00:00 Ã¡s 03:00 ?\r\nA resposta Ã© NÃ£o (Lembrando sempre que SE MESMO ASSIM, o cliente desejar, ele pode pagar como Extra apÃ³s a meia-noite. Podem me procurar caso tenham dÃºvida de como fazer no sistema).\r\n\r\nEntendimento JurÃ­dico:\r\nNÃ£o hÃ¡ uma lei que trate especificamente deste caso, mas esse entendimento foi baseado no art. 73, Â§ 2Âº da CLT que diz que a jornada noturna entre as 22 horas de um dia e as 5 horas do dia seguinte. Dessa forma, entende-se que o dia de inÃ­cio da jornada Ã© que define as bases para CÃ¡lculo das variÃ¡veis. E com base nisso, uma solicitaÃ§Ã£o Judicial de pagamento de Extra apÃ³s a meia noite foi negada pela JuÃ­za Vanda Krindges Marques, em 15/12/2004.\r\n\r\nQuando nÃ£o hÃ¡ uma lei que trata especificamente de uma questÃ£o e Ã© dada uma SentenÃ§a Judicial sobre o assunto, esta SentenÃ§a â€œAssume o lugar desta lei que ainda nÃ£o existeâ€, atÃ© que seja contrariada por outro JuÃ­z ou seja criada uma lei especifica para o assunto. Isso se chama JURISPRUDÃŠNCIA e tem o mesmo efeito que uma lei criada pelo Legislativo.\r\n\r\n\r\n- Em resumo, o que temos de falar ao cliente:\r\nNÃ£o hÃ¡ uma lei que especifique se tem de ser pagas Extras 100% apÃ³s a meia-noite para expedientes que iniciam em dia Comum e terminam em dia de Folga/Feriado. PorÃ©m, hÃ¡ um entendimento por JurisprudÃªncia, tomado pelo Tribunal Regional do Trabalho da 4Âª RegiÃ£o, em Dez/2014 que determinou que estas horas devem ser pagas como Extras Normais, pois a referÃªncia para um Expediente de Trabalho sempre serÃ¡ o dia em que o funcionÃ¡rio iniciou a Jornada.\r\n\r\nPodem enviar o Link fonte da informaÃ§Ã£o para ele pelo Chat do BA ou e-mail:\r\nhttp://forum.dape.com.br/NonCGI/Forum4/HTML/004075.html\r\n\r\n\r\nJÃ¡ para situaÃ§Ãµes em que o expediente se inicia em dia de Folga/Feriado e termina em dia comum:\r\nSeguindo o mesmo entendimento, nesse caso as horas serÃ£o pagas integralmente como 100%. Pois a Jornada se iniciou em dia de Feriado.\r\n','gabriel','2019-05-13 05:54:15'),(764,'relatorio de variaveis','RELATORIOS','--LARGURA#200,120,80,80,80,80,80,80#\r\n--GRUPONREGISTROS#0#\r\n\r\nCREATE TABLE #DBTVARIAVEIS (\r\n           [VAR_FUNC] [INT] NOT NULL ,\r\n           [VAR_EVENTO] [INT] NULL ,\r\n           [VAR_VALOR] [MONEY],\r\n           [VAR_HORAS] [CHAR] (10),\r\n                [VAR_DIAS] [INT],\r\n           [VAR_EMPCODFOLHA] [CHAR] (10),\r\n           [VAR_FALTADATA] SMALLDATETIME DEFAULT 0,\r\n                [VAR_ORDEM] [TINYINT] DEFAULT 0\r\n           ) ON [PRIMARY]\r\n\r\nEXEC RST_VARIAVEIS @P_DATAINICIAL = %DATAINICIAL%, @P_DATAFINAL = %DATAFINAL%, @P_DEPTO = 1, @P_CRIARTMP = 0\r\n\r\nSELECT DISTINCT FUNC_NOME \'NOME\',EVE_DESCRICAO \'EVENTO\',                       \r\n\r\nisnull((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_HOURLONGTOMINUTE(VAR_HORAS)))\r\nFROM #DBTVARIAVEIS WHERE VAR_EVENTO = EVE_IND AND DBO.FN_HOURLONGTOMINUTE(VAR_HORAS) > 0),\r\n(SELECT SUM(VAR_DIAS) FROM #DBTVARIAVEIS WHERE VAR_EVENTO = EVE_IND)) AS \'VALOR\'\r\n\r\nFROM EVENTOS    \r\nINNER JOIN #DBTVARIAVEIS ON VAR_EVENTO = EVE_IND\r\nINNER JOIN FUNCIONARIOS ON VAR_FUNC = FUNC_IND  \r\n\r\nGROUP BY FUNC_IND,FUNC_NOME,EVE_IND,EVE_DESCRICAO\r\nORDER BY FUNC_NOME\r\n\r\nDROP TABLE #DBTVARIAVEIS','gabriel','2019-05-13 09:47:27'),(765,'RELATORIO DE VARIAVEIS, NOTURNO, TRAB, FALTAS E DESCONTOS','RELATORIOS','--GRUPOQUEBRA#0#\r\n--COLUNAGRUPO#1#\r\n--LARGURA#200,120,80,80,80,80,80,80#\r\n--GRUPONREGISTROS#0#\r\n\r\nDECLARE @DATAINICIAL SMALLDATETIME = %DATAINICIAL%\r\nDECLARE @DATAFINAL SMALLDATETIME =  %DATAFINAL%\r\n\r\nCREATE TABLE #DBTVARIAVEIS (\r\n           [VAR_FUNC] [INT] NOT NULL ,\r\n           [VAR_EVENTO] [INT] NULL ,\r\n           [VAR_VALOR] [MONEY],\r\n           [VAR_HORAS] [CHAR] (10),\r\n                [VAR_DIAS] [INT],\r\n           [VAR_EMPCODFOLHA] [CHAR] (10),\r\n           [VAR_FALTADATA] SMALLDATETIME DEFAULT 0,\r\n                [VAR_ORDEM] [TINYINT] DEFAULT 0\r\n           ) ON [PRIMARY]\r\n\r\nEXEC RST_VARIAVEIS @P_DATAINICIAL = @DATAINICIAL, @P_DATAFINAL = @DATAFINAL, @P_DEPTO = 1, @P_CRIARTMP = 0\r\n\r\nSELECT DISTINCT  FUNC_NOME \'NOME\', EMP_NOME EMPRESA,\r\n(SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_HOURLONGTOMINUTE(VAR_HORAS))) FROM #DBTVARIAVEIS WHERE VAR_EVENTO = 22 AND VAR_FUNC = FUNC_IND)\r\nAS \'EXTRAS 60%\',                                                                                                      \r\n(SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_HOURLONGTOMINUTE(VAR_HORAS))) FROM #DBTVARIAVEIS WHERE VAR_EVENTO = 8 AND VAR_FUNC = FUNC_IND) \r\nAS \'EXTRA 100%\',\r\n(SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_HOURLONGTOMINUTE(VAR_HORAS))) FROM #DBTVARIAVEIS WHERE VAR_EVENTO = 6 AND VAR_FUNC = FUNC_IND) \r\n AS \'SALARIO NORMAL\',\r\n\r\nISNULL(DBO.FN_HOURLONGNULLZERO(DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_TRAB)))), \'\') AS TRABALHADAS,\r\n\r\nSUM(CASE WHEN CAL_FALTAHORA > 0 THEN 1 END) AS FALTAS,\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_NOTURNO))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= @DATAINICIAL AND CAL_DATA <= @DATAFINAL AND CAL_NOTURNO > 0 ),\'\')  AS NOTURNO,\r\n                                                             \r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_DESCONTO - CAL_FALTAHORA))) FROM CALCULO\r\nWHERE FUNC_IND = CAL_FUNC AND CAL_DATA >= @DATAINICIAL AND CAL_DATA <= @DATAFINAL AND CAL_DESCONTO - CAL_FALTAHORA > 0 ),\'\') AS ATRASOS \r\n\r\nFROM FUNCIONARIOS\r\nINNER JOIN CALCULO ON FUNC_IND = CAL_FUNC\r\nINNER JOIN EMPRESAS ON EMP_IND = FUNC_EMPRESA\r\nINNER JOIN #DBTVARIAVEIS ON VAR_FUNC = FUNC_IND\r\n\r\nWHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL\r\nAND CAL_DATA >= @DATAINICIAL AND CAL_DATA <= @DATAFINAL           \r\n\r\nGROUP BY FUNC_NOME,EMP_NOME,FUNC_IND                                              \r\n                                                                            \r\nORDER BY EMP_NOME, FUNC_NOME   \r\n\r\nDROP TABLE #DBTVARIAVEIS','gabriel','2019-05-13 10:17:33'),(766,'APAGAR FUNCIONARIOS EXCLUIDOS DO DEPARTAMENTO SELECIONADO','COMANDOS','DELETE FROM APONTA WHERE APO_FUNC IN (SELECT FUNC_IND FROM FUNCIONARIOS WHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1 AND FUNC_MARCADO_EXCLUSAO = 1)\r\nDELETE FROM ACIDENTES WHERE ACI_FUNC IN (SELECT FUNC_IND FROM FUNCIONARIOS WHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1 AND FUNC_MARCADO_EXCLUSAO = 1)\r\nDELETE FROM AFASTAMENTOS WHERE AFA_FUNC IN (SELECT FUNC_IND FROM FUNCIONARIOS WHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1 AND FUNC_MARCADO_EXCLUSAO = 1)\r\nDELETE FROM ALTERACOES WHERE ALT_FUNC IN (SELECT FUNC_IND FROM FUNCIONARIOS WHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1 AND FUNC_MARCADO_EXCLUSAO = 1)\r\nDELETE FROM BCOHORAS WHERE BCO_FUNC IN (SELECT FUNC_IND FROM FUNCIONARIOS WHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1 AND FUNC_MARCADO_EXCLUSAO = 1)\r\nDELETE FROM BCOHORASDESCONSIDERADOS WHERE BCOD_FUNC IN (SELECT FUNC_IND FROM FUNCIONARIOS WHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1 AND FUNC_MARCADO_EXCLUSAO = 1)\r\nDELETE FROM CALCULO WHERE CAL_FUNC IN (SELECT FUNC_IND FROM FUNCIONARIOS WHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1 AND FUNC_MARCADO_EXCLUSAO = 1)\r\nDELETE FROM JUSTIFICATIVAS WHERE JUS_FUNC IN (SELECT FUNC_IND FROM FUNCIONARIOS WHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1 AND FUNC_MARCADO_EXCLUSAO = 1)\r\nDELETE FROM JUSTIFICATIVASPEDIDOS WHERE JUSPED_FUNC IN (SELECT FUNC_IND FROM FUNCIONARIOS WHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1 AND FUNC_MARCADO_EXCLUSAO = 1)\r\nDELETE FROM MARCACOES WHERE MRC_FUNC IN (SELECT FUNC_IND FROM FUNCIONARIOS WHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1 AND FUNC_MARCADO_EXCLUSAO = 1)\r\nDELETE FROM PREAPONTA WHERE PAPO_FUNC IN (SELECT FUNC_IND FROM FUNCIONARIOS WHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1 AND FUNC_MARCADO_EXCLUSAO = 1)\r\nDELETE FROM REGISTRO WHERE REG_FUNC IN (SELECT FUNC_IND FROM FUNCIONARIOS WHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1 AND FUNC_MARCADO_EXCLUSAO = 1)\r\nDELETE FROM VARIAVEIS WHERE VAR_FUNC IN (SELECT FUNC_IND FROM FUNCIONARIOS WHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1 AND FUNC_MARCADO_EXCLUSAO = 1)\r\nDELETE FROM HORA WHERE HR_FUNC IN (SELECT FUNC_IND FROM FUNCIONARIOS WHERE FUNC_DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1 AND MARCADO_EXCLUSAO = 0)\r\nDELETE FROM HMOVEL WHERE HRM_FUNC IN (SELECT FUNC_IND FROM FUNCIONARIOS WHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1 AND FUNC_MARCADO_EXCLUSAO = 1)\r\n\r\nDELETE FROM FUNCIONARIOS WHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA, %DEPSELECIONADOIND%) = 1 AND FUNC_MARCADO_EXCLUSAO = 1','GABRIEL','2019-05-14 15:12:25'),(767,'afd app','RELATORIOS','--TITULO#AFD DO APP#\r\n--LARGURA#300,300#\r\nDECLARE @NSR VARCHAR(10) = \'0000000003\'\r\nSELECT (@NSR + REPLACE(CONVERT(CHAR(10),MRC_DATAHORA,103),\'/\',\'\') +  REPLACE(CONVERT(CHAR(5),MRC_DATAHORA,114),\':\',\'\') + \'0\'\r\n+ ISNULL(MRC_PIS,FUNC_PIS)) AFD\r\nFROM MARCACOES\r\nLEFT JOIN FUNCIONARIOS ON MRC_FUNC = FUNC_IND or MRC_PIS = FUNC_PIS\r\nWHERE MRC_DATAAP  >= %DATAINICIAL% AND MRC_DATAAP  <= %DATAFINAL%\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND MRC_ORIGEM in (3,4)\r\nORDER BY MRC_DATAHORA','gabriel','2019-05-20 21:36:07'),(768,'RELATÃ“RIO credito, debito e saldo BANCO DE HORAS POR SETOR','RELATORIOS','--LARGURA#250,80,80,80,80,80,80#\r\n\r\nDECLARE @DATAINICIAL SMALLDATETIME = \'15/04/2019\'\r\nDECLARE @DATAFINAL SMALLDATETIME = \'17/05/2019\'\r\n\r\n\r\nSELECT DISTINCT EMP_NOME \'NOME\',\r\n\r\nDBO.FN_MINUTETOHOURLONG(SUM(case when BCO_DATA >= @DATAINICIAL AND BCO_DATA <= @DATAFINAL and SUBSTRING(BCO_VALOR, 1, 1) <> \'-\'\r\nthen DBO.FN_HOURLONGTOMINUTE(BCO_VALOR) end)) AS CREDITO,\r\n\r\nDBO.FN_MINUTETOHOURLONG(SUM(case when BCO_DATA >= @DATAINICIAL AND BCO_DATA <= @DATAFINAL and SUBSTRING(BCO_VALOR, 1, 1) = \'-\'\r\nthen DBO.FN_HOURLONGTOMINUTE(BCO_VALOR) end)) AS DEBITO,\r\n\r\nDBO.FN_MINUTETOHOURLONG(SUM(case when BCO_DATA >= @DATAINICIAL AND BCO_DATA <= @DATAFINAL then DBO.FN_HOURLONGTOMINUTE(BCO_VALOR) end))\r\nAS \'SALDO PERIODO\',\r\n\r\nDBO.FN_MINUTETOHOURLONG(SUM(case when BCO_DATA <= @DATAFINAL then DBO.FN_HOURLONGTOMINUTE(BCO_VALOR) end)) AS \'SALDO TOTAL\'\r\n                                                                  \r\nFROM FUNCIONARIOS\r\nINNER JOIN EMPRESAS ON EMP_IND = FUNC_EMPRESA\r\nINNER JOIN BCOHORAS ON  BCO_FUNC = FUNC_IND                                                                     \r\n           \r\nWHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL                                                           \r\n\r\nGROUP BY EMP_NOME,EMP_IND,FUNC_EMPRESA\r\n                                                                            \r\nORDER BY EMP_NOME','gabriel','2019-05-20 22:58:25'),(769,'Apagar ADMinistrador id class (correto)','RELOGIO','REMOVER ADMINISTRADOR PELO TECLADO RELOGIO\r\nCLIQUE NO menu, DIGITE\r\n182377 DEPOIS CONFIRMAR\r\nDEPOIS SENHA \r\n001818\r\nCONFIRMAR \r\n\r\nDEPOIS ACESSAR > CONFIGURAÃ‡Ã•ES\r\nAPAGAR ADMINISTRADORES','Alessandro Sena','2019-05-21 21:12:50'),(770,'Relatorio AFD APP','RELATORIOS','--TITULO#AFD DO APP#  \r\n--LARGURA#600#\r\nDECLARE @NSR VARCHAR(1) = \'3\'       \r\nSELECT (REPLICATE(\'0\',(9 - len(MRC_ind))) + cast(MRC_ind as varchar(9)) + RTRIM(@NSR) + REPLACE(CONVERT(CHAR(10),MRC_DATAHORA,103),\'/\',\'\') \r\n+  REPLACE(CONVERT(CHAR(5),MRC_DATAHORA,114),\':\',\'\') + \'0\' + ISNULL(MRC_PIS,FUNC_PIS))\r\n\'0000000001100446820000101000000000000SUAPE REFEICOES LTDA\'\r\n\r\nFROM MARCACOES\r\nLEFT JOIN FUNCIONARIOS ON MRC_FUNC = FUNC_IND OR MRC_PIS = FUNC_PIS\r\nWHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1 and\r\nMRC_DATAAP  >= %DATAINICIAL% AND MRC_DATAAP  <= %DATAFINAL%\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND MRC_ORIGEM IN (3,4)\r\nORDER BY MRC_DATAAP','gabriel','2019-05-21 23:45:22'),(771,'configuracao firewall joime','TREINAMENTO','https://help.join.me/joinmehelp/s/article/joinme-jm-faq-firewalls?language=en_US\r\n\r\nhttps://help.join.me/joinmehelp/s/article/joinme-jm-faq-video-firewall?language=en_US','gabriel','2019-05-22 23:46:17'),(772,'Relatorio afp app','RELATORIOS','--TITULO#AFD DO APP#\r\n--LARGURA#600#\r\nDECLARE @NSR VARCHAR(1) = \'3\'\r\nSELECT (REPLICATE(\'0\',(9 - LEN(MRC_IND))) + CAST(MRC_IND AS VARCHAR(9)) + RTRIM(@NSR) + REPLACE(CONVERT(CHAR(10),MRC_DATAHORA,103),\'/\',\'\') \r\n+  REPLACE(CONVERT(CHAR(5),MRC_DATAHORA,114),\':\',\'\') + \'0\' + ISNULL(MRC_PIS,FUNC_PIS))\r\n\'0000000001100446820000101000000000000SUAPE REFEICOES LTDA\'\r\nFROM MARCACOES\r\nLEFT JOIN FUNCIONARIOS ON MRC_FUNC = FUNC_IND OR MRC_PIS = FUNC_PIS\r\nWHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1 AND\r\nMRC_DATAAP  >= %DATAINICIAL% AND MRC_DATAAP  <=  %DATAFINAL%                          \r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND MRC_ORIGEM IN (3,4)\r\nUNION ALL\r\nSELECT \'999999999000000000\' + (REPLICATE(\'0\',(9 - LEN(CONVERT(VARCHAR(MAX),COUNT(MRC_ind))))) +\r\nCAST(CONVERT(VARCHAR(MAX),COUNT(MRC_ind)) AS VARCHAR(9))) + \'0000000000000000009\'\r\nFROM MARCACOES\r\nLEFT JOIN FUNCIONARIOS ON MRC_FUNC = FUNC_IND OR MRC_PIS = FUNC_PIS\r\nWHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1 AND\r\nMRC_DATAAP  >= %DATAINICIAL% AND MRC_DATAAP  <= %DATAFINAL%\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND MRC_ORIGEM IN (3,4)','gabriel','2019-05-23 19:40:26'),(773,'Relatorio AFD COMPLETO','RELATORIOS','--LARGURA#3000#\r\nDECLARE @NSR VARCHAR(1) = \'3\'\r\nselect top 1 \'00000000011\' +  CAST(emp_cnpj AS char(14)) + \'000000000000\' + CAST(emp_nome AS char(150)) + \'00005003110002624\' +\r\nREPLACE(%DATAINICIAL%,\'/\',\'\')  +  REPLACE(%DATAFINAL%,\'/\',\'\') + REPLACE(CONVERT(CHAR(10),GETDATE(),103),\'/\',\'\') +\r\nREPLACE(CONVERT(CHAR(5),GETDATE(),114),\':\',\'\') as \' \'  from empresas where DBO.FN_DEPARTAMENTOPERTENCENTE(emp_ind,%DEPSELECIONADOIND%) \r\n=1 \r\nUNION ALL\r\nSELECT (REPLICATE(\'0\',(9 - LEN(MRC_IND))) + CAST(MRC_IND AS VARCHAR(9)) + RTRIM(@NSR) + REPLACE(CONVERT(CHAR(10),MRC_DATAHORA,103),\'/\',\'\')\r\n+  REPLACE(CONVERT(CHAR(5),MRC_DATAHORA,114),\':\',\'\') + \'0\' + ISNULL(MRC_PIS,FUNC_PIS))\r\n\' \'\r\nFROM MARCACOES\r\nLEFT JOIN FUNCIONARIOS ON MRC_FUNC = FUNC_IND OR MRC_PIS = FUNC_PIS\r\nWHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1 AND\r\nMRC_DATAAP  >= %DATAINICIAL% AND MRC_DATAAP  <=  %DATAFINAL%                          \r\nAND FUNC_MARCADO_EXCLUSAO = 0 \r\nUNION ALL  \r\nSELECT \'999999999000000000\' + (REPLICATE(\'0\',(9 - LEN(CONVERT(VARCHAR(MAX),COUNT(MRC_ind))))) +\r\nCAST(CONVERT(VARCHAR(MAX),COUNT(MRC_ind)) AS VARCHAR(9))) + \'0000000000000000009\'\r\nFROM MARCACOES\r\nLEFT JOIN FUNCIONARIOS ON MRC_FUNC = FUNC_IND OR MRC_PIS = FUNC_PIS\r\nWHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1 AND\r\nMRC_DATAAP  >= %DATAINICIAL% AND MRC_DATAAP  <= %DATAFINAL%\r\nAND FUNC_MARCADO_EXCLUSAO = 0','gabriel','2019-05-24 17:16:19'),(774,'clientes sem manutencao mais de 60 dias','RELATORIOS','SET DATEFORMAT DMY\r\nsELECT DISTINCT CAD_RAZAOSOCIAL EMPRESA\r\n\r\n      ,RTRIM([REV_RAZAOSOCIAL]) REVENDA\r\n\r\n      ,CASE WHEN [CAD_CNPJ] IS NOT NULL THEN RTRIM([CAD_CNPJ]) WHEN [CAD_CPF] IS NOT NULL THEN RTRIM([CAD_CPF]) ELSE \'\' END CNPJ\r\n\r\n	--  ,DATEDIFF(dd, [NSE_DATA], GETDATE() )  \'DIAS CORRIDOS\'\r\n\r\n      ,RTRIM(CAD_CONTATO) AS CONTATO\r\n\r\n      ,RTRIM(CAD_UF) ESTADO\r\n\r\n      ,ISNULL(RTRIM(CAD_TELEFONE1_DDD) + \' \' +  RTRIM(CAD_TELEFONE1),\'\') AS TELEFONE\r\n\r\n      ,ISNULL(RTRIM(CAD_TELEFONE2_DDD) + \' \' +  RTRIM(CAD_TELEFONE2),\'\') AS TELEFONE2\r\n\r\n      ,ISNULL(RTRIM(CAD_TELEFONE3_DDD) + \' \' +  RTRIM(CAD_TELEFONE3),\'\') AS TELEFONE3\r\n\r\n      ,ISNULL(RTRIM(CAD_CELULAR_DDD) + \' \' +  RTRIM(CAD_CELULAR),\'\') AS CELULAR\r\n\r\n      ,CASE WHEN _CAD_ENT_TELEFONE1 IS NOT NULL THEN ISNULL(RTRIM(_CAD_ENT_TELEFONE1),\'\') ELSE ISNULL(RTRIM(_CAD_ENT_TELEFONE2),\'\') END \'OUTROS CONTATOS\'\r\n\r\n      ,ISNULL(RTRIM(CAD_EMAIL),\'\') AS EMAIL\r\n\r\n      ,ISNULL(RTRIM(CAD_EMAIL2),\'\') AS EMAIL2\r\n\r\n      ,ISNULL(RTRIM(CAD_EMAIL3),\'\') AS EMAIL3\r\n\r\n  FROM [ASSECONT1].[DBO].[ASSEPONTOCLIENTES]\r\n\r\n  INNER JOIN [ASSEPONTOREVENDAS] ON [CAD_REVENDA] = [REV_IND]\r\n\r\n  INNER JOIN [ASSEPONTONSERIES] ON [NSE_CLIENTE] = CAD_IND\r\n\r\n  LEFT JOIN [ASSEPONTOMANUTENCAO] ON CAD_IND = [MNT_CLIENTE]\r\n\r\n  WHERE (MNT_CLIENTE) IS NULL AND  \r\n  (select top 1 [NSE_DATA] from [ASSEPONTONSERIES] where [NSE_CLIENTE] = CAD_IND) >= \'01/01/2019\' and \r\n  (select top 1 [NSE_DATA] from [ASSEPONTONSERIES] where [NSE_CLIENTE] = CAD_IND) <= (CAST(GETDATE() - 60 AS DATE))\r\n\r\n\r\n  ORDER BY CAD_RAZAOSOCIAL','gabriel','2019-05-27 16:33:15'),(775,'bloqueio firewall joinme (correto)','TREINAMENTO','https://help.join.me/joinmehelp/s/article/joinme-jm-faq-firewalls','Alessandro Sena','2019-05-28 20:25:09'),(776,'RelatÃ³rio nome e pis','RELATORIOS','--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\n--LARGURA#250,220,120,120,80#                            \r\n\r\nSELECT EMP_NOME AS DEP, FUNC_NOME AS NOME, FUNC_PIS AS PIS\r\nFROM FUNCIONARIOS\r\nINNER JOIN EMPRESAS ON EMP_IND = FUNC_EMPRESA\r\nLEFT JOIN REGISTRO ON REG_FUNC = FUNC_IND\r\nORDER BY EMP_NOME, FUNC_NOME','Camila Diniz','2019-05-28 22:43:43'),(777,'ERRO XML','ERRO SQL','Cancele a instalaÃ§Ã£o do SQL.\r\nClique windows + R, digite regedit e de enter.\r\nProcure por HKEY_CURRENT_USER\r\nSiga esse caminho:\r\n\r\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\r\n\r\nProcure por uma chave chamada AppData. DÃª dois cliques nela, e preencha Dados do Valor com o seguinte: %USERPROFILE%\\Application Data.\r\n\r\nDe OK, reinicie a maquina do cliente e tente instalar novamente.\r\n\r\nCaso a chave App Data nao exista, terÃ¡ que criar. Para criar clique com botao direito Novo, e entÃ£o Valor da Cadeia de Caracteres. Depois da chave criada, de dois cliques e preencha Dados do valor com: %USERPROFILE%\\Application Data \r\n\r\nEm seguida de OK, reinicie a maquina do cliente e inicie a instalaÃ§Ã£o.','Camila Diniz','2019-05-29 18:24:31'),(778,'Relatorio MarcaÃ§oes, descontos (debito), faltas (falta automatica), abonos e motivo (justificativa)','RELATORIOS','--ORIENTACAO#paisagem#\r\n--LARGURA#200,200,150,70,130,70,60,60,50,300#\r\nSELECT FUNC_NOME AS NOME, EMP_NOME AS EMPRESA, CAR_DESCRICAO AS CARGO,FUNC_DT_ADM ADMISSAO,\r\nisnull(DBO.FN_GETTIMEFULL(APO_MARCACAO1),\'\') + \' \' +   \r\nisnull(DBO.FN_GETTIMEFULL(APO_MARCACAO2),\'\') + \' \' +   \r\nisnull(DBO.FN_GETTIMEFULL(APO_MARCACAO3),\'\') + \' \' +                               \r\nisnull(DBO.FN_GETTIMEFULL(APO_MARCACAO4),\'\') AS \'MARCACOES\',   CAL_DATA AS DATA,\r\n\r\nCASE WHEN CAL_DESCONTO > 0 THEN DBO.FN_GETTIME5NULLZERO(CAL_DESCONTO) WHEN\r\nSUBSTRING(BCO_VALOR, 1, 1) = \'-\' THEN REPLACE(DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_HOURLONGTOMINUTE(BCO_VALOR))),\'-\',0)\r\nELSE \'\' END DESCONTO,\r\n\r\nCASE WHEN CAL_FALTAHORA > 0 THEN \'FALTA\' WHEN BCO_STATUS = 10 THEN \'FALTA AUTOMATICA\' ELSE \'\' END AS FALTAS,\r\n\r\nDBO.FN_GETTIME5NULLZERO(CAL_ABONO) AS ABONO,                      \r\n\r\nCASE WHEN JUS_DESCRICAO <> \'\' THEN JUS_DESCRICAO ELSE MOT_DESCRICAO END  AS MOTIVO\r\n\r\n\r\nFROM FUNCIONARIOS\r\nINNER JOIN EMPRESAS ON  FUNC_EMPRESA = EMP_IND\r\nINNER JOIN CALCULO ON CAL_FUNC = FUNC_IND\r\nLEFT JOIN JUSTIFICATIVAS ON CAL_FUNC = JUS_FUNC AND CAL_DATA = JUS_DATA\r\nLEFT JOIN APONTA ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\nLEFT JOIN BCOHORAS ON BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA\r\nLEFT JOIN MOTIVOS ON JUS_MOTIVO =  MOT_IND\r\nLEFT JOIN CARGOS ON CAR_IND = FUNC_CARGO\r\nWHERE CAL_DATA >= %DATAINICIAL% AND CAL_DATA <= %DATAFINAL% \r\nAND DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA,%DEPSELECIONADOIND%) = 1 AND\r\n(CAL_ABONO > 0 OR  CAL_FALTAHORA > 0 OR BCO_STATUS = 10 OR CAL_DESCONTO > 0 OR SUBSTRING(BCO_VALOR, 1, 1) = \'-\')\r\ngroup by FUNC_NOME, EMP_NOME, CAR_DESCRICAO, FUNC_DT_ADM, APO_MARCACAO1, APO_MARCACAO2, APO_MARCACAO3, APO_MARCACAO4,CAL_DATA,\r\nCAL_ABONO, CAL_FALTAHORA, BCO_STATUS, CAL_DESCONTO, BCO_VALOR, JUS_DESCRICAO, MOT_DESCRICAO \r\nORDER BY FUNC_NOME','gabriel','2019-05-29 21:27:07'),(779,'RELAToRIO de credito separado por tipo de lanÃ§amento, debitos e saldo','RELATORIOS','--LARGURA# 200,150,70,70,70,70,70,70#\r\n\r\nDECLARE @INICIO SMALLDATETIME = %DATAINICIAL%              \r\nDECLARE @FIM SMALLDATETIME = %DATAFINAL%\r\n                                        \r\nSELECT DISTINCT FUNC_NOME AS NOME, EMP_NOME AS EMPRESA,\r\n\r\n(SELECT DBO.FN_MINUTETOHOURLONG(SUM(CASE WHEN DBO.FN_HOURLONGTOMINUTE(BCO_VALOR) >= 120 and BCO_STATUS IN (0,1,2,71,72,100) THEN 120 when\r\nBCO_STATUS IN (0,1,2,71,72,100) then DBO.FN_HOURLONGTOMINUTE(BCO_VALOR) END))\r\nFROM BCOHORAS WHERE BCO_FUNC = FUNC_IND AND BCO_DATA >= @INICIO AND BCO_DATA <= @FIM ) AS \'EXTRA 70%\',\r\n\r\n\r\nDBO.FN_MINUTETOHOURLONG( isnull((SELECT SUM(DBO.FN_HOURLONGTOMINUTE(BCO_VALOR)) FROM BCOHORAS WHERE BCO_FUNC = FUNC_IND AND\r\nBCO_DATA >= @INICIO AND BCO_DATA <= @FIM AND BCO_STATUS IN (3,4)),0) + \r\nisnull((SELECT SUM(DBO.FN_HOURLONGTOMINUTE(BCO_VALOR)) FROM BCOHORAS WHERE BCO_FUNC = FUNC_IND AND\r\nBCO_DATA >= @INICIO AND BCO_DATA <= @FIM AND BCO_STATUS IN (73,74)),0) ) \'EXTRA 100%\',\r\n\r\nREPLACE((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_HOURLONGTOMINUTE(BCO_VALOR))) FROM BCOHORAS\r\nWHERE BCO_FUNC = FUNC_IND AND BCO_DATA >= @INICIO AND BCO_DATA <= @FIM\r\nAND BCO_STATUS IN (10,11,80,81,101) ),\'-\',\'\') AS DEBITO,\r\n\r\nISNULL((SELECT DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_HOURLONGTOMINUTE(BCO_VALOR)))\r\nFROM BCOHORAS WHERE BCO_FUNC = FUNC_IND  AND BCO_DATA >= @INICIO AND BCO_DATA <= @FIM ), \'\') AS \'SALDO\'\r\n\r\n\r\nFROM CALCULO\r\n\r\nINNER JOIN FUNCIONARIOS ON FUNC_IND = CAL_FUNC\r\nINNER JOIN BCOHORAS ON BCO_FUNC = FUNC_IND AND BCO_DATA = CAL_DATA\r\nINNER JOIN EMPRESAS ON  FUNC_EMPRESA = EMP_IND\r\nWHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA, %DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND CAL_DATA >= @INICIO AND CAL_DATA <= @FIM\r\nGROUP BY EMP_NOME, FUNC_IND,FUNC_NOME\r\n\r\nORDER BY EMP_NOME, FUNC_NOME','gabriel','2019-05-29 21:49:41'),(780,'Relatorio de marcoes, extras, descontos e saldo do dia','RELATORIOS','--GRUPOQUEBRA#0#\r\n--GRUPONREGISTROS#0#\r\n--LARGURA# 200,150,70,60,60,60,60,60,60,60,60,60,70,70,70,70,70#\r\n--COLUNAGRUPO#0#\r\n\r\nSELECT DISTINCT FUNC_NOME AS NOME, EMP_NOME AS EMPRESA, CAL_DATA AS \'DATA\',\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO1) AS \'ENTRADA\',\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO2) AS \'SAIDA\',\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO3) AS \'ENTRADA2\',\r\nDBO.FN_GETTIMEFULL(APO_MARCACAO4) AS \'SAIDA2\',\r\nDBO.FN_GETTIME5NULLZERO(CAL_EXTRA + CAL_EXTRAN + CAL_EXTRAF + CAL_EXTRANF) AS \'EXTRA\',\r\nDBO.FN_GETTIME5NULLZERO(cal_desconto) AS \'DESCONTO\',\r\nDBO.FN_HOURLONGNULLZERO(DBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_SMALLDATETIMETOMINUTE(CAL_EXTRA + CAL_EXTRAN + CAL_EXTRAF + CAL_EXTRANF) -\r\nDBO.FN_SMALLDATETIMETOMINUTE(cal_desconto)))) SALDO\r\n\r\nFROM CALCULO\r\nINNER JOIN FUNCIONARIOS ON FUNC_IND = CAL_FUNC\r\nINNER JOIN EMPRESAS ON  FUNC_EMPRESA = EMP_IND\r\nLEFT JOIN APONTA ON APO_FUNC = FUNC_IND AND APO_DATA = CAL_DATA\r\n\r\nWHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA, %DEPSELECIONADOIND%) =1\r\nAND FUNC_DT_DEM IS NULL AND FUNC_MARCADO_EXCLUSAO = 0 AND CAL_DATA >= %DATAINICIAL%\r\nAND CAL_DATA <= %DATAFINAL% AND (APO_MARCACAO1 IS NOT NULL OR APO_MARCACAO2 IS NOT NULL Or\r\nAPO_MARCACAO3 IS NOT NULL OR APO_MARCACAO4 IS NOT NULL or cal_desconto > 0 or (CAL_EXTRA + CAL_EXTRAN + CAL_EXTRAF + CAL_EXTRANF) > 0)\r\n\r\nGROUP BY EMP_NOME, FUNC_NOME, CAL_DATA, FUNC_IND, APO_MARCACAO1, APO_MARCACAO2, APO_MARCACAO3, APO_MARCACAO4,cal_desconto,\r\nCAL_EXTRA,CAL_EXTRAN, CAL_EXTRAF, CAL_EXTRANF\r\nORDER BY EMP_NOME, FUNC_NOME, CAL_DATA','gabriel','2019-05-29 22:12:10'),(781,'ERRO XML','ERRO SQL','PROCEDIMENTO 1\r\n\r\nCANCELE A INSTALAÃ‡ÃƒO DO SQL.\r\nCLIQUE WINDOWS + R, DIGITE REGEDIT E DE ENTER.\r\nPROCURE POR HKEY_CURRENT_USER\r\nSIGA ESSE CAMINHO:\r\n\r\nHKEY_CURRENT_USER\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\EXPLORER\\USER SHELL FOLDERS\r\n\r\nPROCURE POR UMA CHAVE CHAMADA APPDATA. DÃŠ DOIS CLIQUES NELA, E PREENCHA DADOS DO VALOR COM O SEGUINTE: %USERPROFILE%\\APPLICATION DATA.\r\n\r\nDE OK, REINICIE A MAQUINA DO CLIENTE E TENTE INSTALAR NOVAMENTE.\r\n\r\nCASO A CHAVE APP DATA NAO EXISTA, TERÃ QUE CRIAR. PARA CRIAR CLIQUE COM BOTAO DIREITO NOVO, E ENTÃƒO VALOR DA CADEIA DE CARACTERES. DEPOIS DA CHAVE CRIADA, DE DOIS CLIQUES E PREENCHA DADOS DO VALOR COM: %USERPROFILE%\\APPLICATION DATA \r\n\r\nEM SEGUIDA DE OK, REINICIE A MAQUINA DO CLIENTE E INICIE A INSTALAÃ‡ÃƒO.\r\n\r\n\r\nPROCEDIMENTO 2\r\n\r\nO CLIENTE PRECISA ESTAR LOGADO NO USUÃRIO ADMINISTRADOR.\r\nCLIQUE WINDOWS + X, VÃ NA OPÃ‡ÃƒO \"GERENCIAMENTO DO COMPUTADOR\".\r\nCLIQUE EM \"USUÃRIOS E GRUPOS LOCAIS\". SELECIONA A PASTA \"USUÃRIO\", BOTAO DIREITO, \"NOVO USUÃRIO\"\r\nCRIE O NOVO USUARIO\r\n\r\nNOME DE USUARIO: MSSQL\r\nDESCRIÃ‡ÃƒO: SQL SERVER LOCAL ACCOUNT\r\nSENHA: Assecont1973\r\n\r\nDESMARQUE A OPÃ‡ÃƒO \"O USUARIO DEVE ALTERAR A SENHA NO PROXIMO LOGON\". CLIQUE EM CRIAR E FECHAR.\r\nAGORA CLIQUE EM GRUPO, PROCURE POR \"ADMINISTRADOR\" E DE DOIS CLIQUES. CLIQUE EM \"ADICIONAR\" E SELECIONE O NOVO USUARIO CRIADO \"MSSQL\". APLICAR, OK.\r\n\r\nPEÃ‡A PRO CLIENTE FAZER LOGOFF DESTE USUARIO ADMINISTRADOR, E LOGAR COM O USUARIO MSSQL.\r\n(INFORME NOME DO USUARIO E SENHA). \r\nAPOS O CLIENTE ACESSAR PELO USUARIO MSSQL, INICIE NOVAMENTE A INSTALAÃ‡ÃƒO.','cAMILA dINIZ','2019-05-29 23:34:18'),(782,'relatorio credito, debitos e saldo de todos meses do ano','RELATORIOS','--LARGURA#200,80,80,80,80,80,80#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#                                               \r\nSELECT FUNC_NOME \'NOME\', DATENAME(month,BCO_DATA) MES,\r\n\r\nDBO.FN_MINUTETOHOURLONG(SUM(case when SUBSTRING(BCO_VALOR, 1, 1) <> \'-\'                          \r\nthen DBO.FN_HOURLONGTOMINUTE(BCO_VALOR) end)) AS CREDITO,\r\n\r\nDBO.FN_MINUTETOHOURLONG(SUM(case when SUBSTRING(BCO_VALOR, 1, 1) = \'-\'                                             \r\nthen DBO.FN_HOURLONGTOMINUTE(BCO_VALOR) end)) AS DEBITO,\r\n\r\nDBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_HOURLONGTOMINUTE(BCO_VALOR))) AS \'SALDO\',\r\n\r\ncase when MONTH(BCO_DATA) in (2,3,4,5,6,7,8) then \'Agosto\' else \'Janeiro\' end  VENCIMENTO\r\n\r\nFROM FUNCIONARIOS                                                    \r\nINNER JOIN BCOHORAS ON BCO_FUNC = FUNC_IND\r\n                                                          \r\nWHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL  and BCO_DATA >= (RTRIM(\'01/01/\') + RTRIM(YEAR(%DATAINICIAL%))) and\r\nBCO_DATA <= (RTRIM(\'31/12/\') + RTRIM(YEAR(%DATAINICIAL%)))\r\n\r\nGROUP BY FUNC_NOME, FUNC_IND, DATENAME(month,BCO_DATA),MONTH(BCO_DATA)   \r\nORDER BY FUNC_NOME, MONTH(BCO_DATA)','gabriel','2019-05-30 21:39:50'),(783,'relatorio de clientes sem manutencao com quantidade de funcionarios','RELATORIOS','SET DATEFORMAT DMY\r\nSELECT DISTINCT CAD_RAZAOSOCIAL EMPRESA\r\n\r\n      ,RTRIM([REV_RAZAOSOCIAL]) REVENDA\r\n\r\n      ,CASE WHEN [CAD_CNPJ] IS NOT NULL THEN RTRIM([CAD_CNPJ]) WHEN [CAD_CPF] IS NOT NULL THEN RTRIM([CAD_CPF]) ELSE \'\' END CNPJ\r\n\r\n	  ,[CAD_QTD_FUNCIONARIO]  \'Qnt Funcionarios\'\r\n\r\n      ,RTRIM(CAD_CONTATO) AS CONTATO\r\n\r\n      ,RTRIM(CAD_UF) ESTADO\r\n\r\n      ,ISNULL(RTRIM(CAD_TELEFONE1_DDD) + \' \' +  RTRIM(CAD_TELEFONE1),\'\') AS TELEFONE\r\n\r\n      ,ISNULL(RTRIM(CAD_TELEFONE2_DDD) + \' \' +  RTRIM(CAD_TELEFONE2),\'\') AS TELEFONE2\r\n\r\n      ,ISNULL(RTRIM(CAD_TELEFONE3_DDD) + \' \' +  RTRIM(CAD_TELEFONE3),\'\') AS TELEFONE3\r\n\r\n      ,ISNULL(RTRIM(CAD_CELULAR_DDD) + \' \' +  RTRIM(CAD_CELULAR),\'\') AS CELULAR\r\n\r\n      ,CASE WHEN _CAD_ENT_TELEFONE1 IS NOT NULL THEN ISNULL(RTRIM(_CAD_ENT_TELEFONE1),\'\') ELSE ISNULL(RTRIM(_CAD_ENT_TELEFONE2),\'\') END \'OUTROS CONTATOS\'\r\n\r\n      ,ISNULL(RTRIM(CAD_EMAIL),\'\') AS EMAIL\r\n\r\n      ,ISNULL(RTRIM(CAD_EMAIL2),\'\') AS EMAIL2\r\n\r\n      ,ISNULL(RTRIM(CAD_EMAIL3),\'\') AS EMAIL3\r\n\r\n  FROM [ASSECONT1].[DBO].[ASSEPONTOCLIENTES]\r\n\r\n  INNER JOIN [ASSEPONTOREVENDAS] ON [CAD_REVENDA] = [REV_IND]\r\n\r\n  INNER JOIN [ASSEPONTONSERIES] ON [NSE_CLIENTE] = CAD_IND\r\n\r\n  LEFT JOIN [ASSEPONTOMANUTENCAO] ON CAD_IND = [MNT_CLIENTE]\r\n\r\n  WHERE (MNT_CLIENTE) IS NULL AND  \r\n  (SELECT TOP 1 [NSE_DATA] FROM [ASSEPONTONSERIES] WHERE [NSE_CLIENTE] = CAD_IND) >= \'01/01/2017\' AND \r\n  (SELECT TOP 1 [NSE_DATA] FROM [ASSEPONTONSERIES] WHERE [NSE_CLIENTE] = CAD_IND) <= \'31/12/2018\' and [CAD_QTD_FUNCIONARIO] > 0\r\n\r\n\r\n  ORDER BY [CAD_QTD_FUNCIONARIO] desc, CAD_RAZAOSOCIAL','gabriel','2019-05-30 22:27:04'),(784,'Relatorio Treinamento ','RELATORIOS','set dateformat dmy;\r\nSELECT sup_Nome Tecnico, sum(case when [QUEST_TREI_2] = 0 then 1 else 0 end) as \'Pessimo\'\r\n, sum(case when [QUEST_TREI_2] = 1 then 1 else 0 end) as \'Ruim\'\r\n, sum(case when [QUEST_TREI_2] = 2 then 1 else 0 end) as \'Regular\'\r\n, sum(case when [QUEST_TREI_2] = 3 then 1 else 0 end) as \'medio\'\r\n, sum(case when [QUEST_TREI_2] = 4 then 1 else 0 end) as \'Bom\'\r\n  FROM [assecont1].[dbo].[AssepontoQuestTreinamento]\r\n  inner join AssepontoSuporte on [QUEST_TREI_TECNICO] = sup_ind\r\n  inner join AssepontoClientes on [QUEST_TREI_CLIENTE] = [CAD_IND]\r\n  where [QUEST_TREI_2] is not null and \r\n(([QUEST_TREI_DATA] >= \'01/05/2019\' and [QUEST_TREI_DATA] <= \'31/05/2019\') or \r\n([QUEST_TREI_ATUALIZACAO] >= \'01/05/2019\' and [QUEST_TREI_ATUALIZACAO] <= \'31/05/2019\'))\r\ngroup by sup_Nome','gabriel','2019-06-03 16:36:55'),(785,'Banco de horas por Empresa Diario','RELATORIOS','--LARGURA#250,80,80,80,80,80,80,80#\r\nDECLARE @DATAINICIAL SMALLDATETIME = \'01/05/2019\'\r\nDECLARE @DATAFINAL SMALLDATETIME = \'30/05/2019\'             \r\n\r\nSELECT DISTINCT EMP_NOME \'NOME\', BCO_DATA DATA,\r\n\r\nDBO.FN_MINUTETOHOURLONG(SUM(CASE WHEN SUBSTRING(BCO_VALOR, 1, 1) <> \'-\'\r\nTHEN DBO.FN_HOURLONGTOMINUTE(BCO_VALOR) END)) AS CREDITO,\r\n\r\nDBO.FN_MINUTETOHOURLONG(SUM(CASE WHEN SUBSTRING(BCO_VALOR, 1, 1) = \'-\'                      \r\nTHEN DBO.FN_HOURLONGTOMINUTE(BCO_VALOR) END)) AS DEBITO,\r\n\r\nDBO.FN_MINUTETOHOURLONG(SUM(DBO.FN_HOURLONGTOMINUTE(BCO_VALOR))) AS \'SALDO\'\r\n\r\nFROM FUNCIONARIOS\r\nINNER JOIN EMPRESAS ON EMP_IND = FUNC_EMPRESA\r\nINNER JOIN BCOHORAS ON  BCO_FUNC = FUNC_IND                                                                     \r\n           \r\nWHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1\r\nAND FUNC_MARCADO_EXCLUSAO = 0 AND FUNC_DT_DEM IS NULL and BCO_DATA >= @DATAINICIAL and BCO_DATA <= @DATAFINAL                               \r\n                            \r\n\r\nGROUP BY EMP_NOME,EMP_IND,FUNC_EMPRESA,BCO_DATA\r\n                                                                            \r\nORDER BY EMP_NOME,BCO_DATA','gabriel','2019-06-05 16:05:27'),(786,'CORRIGIR PROBLEMA DA imprimir DANFE','ASSEFIN','PARA RESOLVER ESSA QUESTAO Ã‰ PRECISO ALTERAR AS INFORMAÃ‡OES DO XML NA TABELA: NOTAS, COLUNA: [NOT_XML]\r\nPEGUE O XML NA PASTA DO MONITOR E COPÃE O CONTEUDO, DEPOIS EXECUTE O COMANDO NO SQL STUDIO\r\n\r\nUPDATE [NOTAS]\r\n   SET NOT_XML = \'INFORMAÃ‡OES DENTRO DO XML\'\r\n  ,NOT_CHAVE = \'numero da chave correta da nota\'\r\n\r\n WHERE NOT_NUMERO  = \'NUMERO DA NOTA\'\r\nGO\r\n','gabriel','2019-06-05 16:20:34'),(787,'Relatorio dos clientes assepontoweb','RELATORIOS','SELECT [CLI_NOME] EMPRESA\r\n      ,[CLI_CNPJ] CNPJ\r\n      ,[USER_NOME] USUARIO\r\n	  ,[USER_EMAIL] EMAIL\r\n\r\n  FROM [databasecontrol].[dbo].[Users]\r\n  inner join [databasecontrol].[dbo].Clientes on [USER_CLIENTE] = [CLI_IND]\r\n  inner join [databasecontrol].[dbo].Databases on [USER_DATABASE] = [DAT_IND]\r\n  inner join [databasecontrol].[dbo].Produtos on [DAT_SISTEMA] = [PRO_IND]\r\n  where [PRO_IND] = 10 and [USER_TIPO] = 1 and [USER_EMAIL] not like \'%assecont.com.br%\' \r\n  order by [CLI_NOME]','gabriel','2019-06-05 21:47:50'),(788,'RELATORIO registro , nome , cargo , dt admissÃ£o , dt demissÃ£o e horas trabalhadas','RELATORIOS','--LARGURA#200,50,150,150,80,80,80#\r\ndeclare @incio smalldatetime = \'01/01/2019\'\r\ndeclare @final smalldatetime = \'31/03/2019\' \r\n                                                                            \r\nSELECT DISTINCT FUNC_NOME AS NOME, FUNC_REG AS REGISTRO, car_descricao AS CARGO, EMP_NOME AS EMPRESA,\r\nFUNC_DT_ADM AS ADMISSAO, FUNC_DT_DEM AS DEMISSAO,\r\nISNULL(DBO.FN_HOURLONGNULLZERO(DBO.FN_MINUTETOHOURLONG(SUM\r\n(DBO.FN_SMALLDATETIMETOMINUTE(CAL_TRAB)))), \'\') AS \'TRABALHADO\'\r\n\r\nFROM FUNCIONARIOS\r\nINNER JOIN EMPRESAS ON  FUNC_EMPRESA = EMP_IND\r\ninner join calculo on cal_func = Func_ind \r\nleft JOIN CARGOS ON CAR_IND = FUNC_CARGO\r\nWHERE DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA,%DEPSELECIONADOIND%) = 1  and\r\nCAL_DATA >= @incio AND CAL_DATA <= @final\r\nGROUP BY FUNC_NOME,FUNC_REG,car_descricao ,EMP_NOME,FUNC_DT_ADM,FUNC_DT_DEM\r\nORDER BY FUNC_NOME','gabriel','2019-06-06 17:20:34'),(789,'BANCO DE HORAS - o que Ã© o banco de horas ?','CLT','O Banco de Horas Ã© um acordo de compensaÃ§Ã£o em que as horas excedentes trabalhadas em um dia sÃ£o compensadas com a correspondente diminuiÃ§Ã£o da jornada em outro momento. Ou seja, as horas Extras podem ser compensadas com atrasos/faltas dos funcionÃ¡rios.\r\nO banco de horas estÃ¡ previsto na ConsolidaÃ§Ã£o das Leis do Trabalho (CLT), no parÃ¡grafo 2Âº do artigo 59.','MARCELO','2019-06-06 22:48:48'),(790,'banco de horas - como funciona o acordo para utilizaÃ§Ã£o ?','CLT','Antes da reforma trabalhista, as empresas sÃ³ podiam utilizar o banco de horas se houvesse um acordo coletivo, mediante a participaÃ§Ã£o do Sindicato da categoria formalizando a possibilidade. Com a nova reforma trabalhista, as empresas nÃ£o precisam mais do aval dos sindicatos para utilizarem o banco de horas. Sendo necessÃ¡rio apenas o acordo individual entre a empresa e o empregado. Temos, com isso, as seguintes modalidades de acordo:\r\n\r\nACORDO INDIVIDUAL, POR ESCRITO: A compensaÃ§Ã£o pode ser feita em um prazo de atÃ© 6 meses e ao final deste semestre, se houver saldo positivo, essas horas devem ser pagas com o acrÃ©scimo de pelo menos 50%.\r\n\r\nACORDO INDIVIDUAL TÃCITO (VERBAL):  O acordo verbal Ã© autorizado pela CLT, desde que seja estas horas sejam compensadas dentro da dentro do mÃªs.\r\n\r\nACORDO COLETIVO, PELO SINDICATO OU CONVENÃ‡ÃƒO COLETIVA: No acordo via ConvenÃ§Ã£o Coletiva ou Sindicato, a compensaÃ§Ã£o pode ser feita com o prazo de um ano.\r\n\r\nFonte: Art. 59 da CLT','MARCELO','2019-06-06 23:21:31'),(791,'banco de horas - modelo de acordo individual (Colar no WORD)','CLT','ACORDO INDIVIDUAL DE BANCO DE HORAS\r\n\r\nPelo presente acordo individual de banco de horas para compensaÃ§Ã£o de jornada de trabalho, firmado entre a empresa (nome da empresa), inscrita no CNPJ sob o nÂº (informar) e seu(ua) empregado(a) (nome), inscrito(a) no CPF sob o nÂº (informar) e portador da CTPS nÂº (informar) SÃ©rie (informar), fica convencionado que o horÃ¡rio normal de trabalho serÃ¡ de 8 horas diÃ¡rias e 44 horas semanais.\r\n\r\nAs partes acordam que o nÃºmero de horas trabalhadas poderÃ¡ ser acrescido de atÃ© duas horas em um dia, com a correspondente diminuiÃ§Ã£o de horas em outro dia no prazo mÃ¡ximo de seis meses, sem o acrÃ©scimo de salÃ¡rio previsto no parÃ¡grafo 1Âº do artigo 59 da CLT e inciso XVI do artigo 7Âº da ConstituiÃ§Ã£o Federal, na forma prevista pelos parÃ¡grafos 2Âº e 5Âº do jÃ¡ mencionado artigo 59 da CLT.\r\n\r\nE, por estarem em pleno acordo, as partes contratantes assinam o presente em 2 (duas) vias, o qual vigorarÃ¡ por prazo indeterminado.\r\n\r\n(municÃ­pio) - (UF), (dia) de (mÃªs) de (ano).\r\n\r\n________________________________________\r\n(assinatura)\r\n(nome do responsÃ¡vel pela empresa)\r\n(cargo)\r\n(nome da empresa)\r\n\r\n________________________________________\r\n(assinatura)\r\n(nome do empregado)','MARCELO','2019-06-06 23:28:14'),(792,'adicional noturno - como funciona?','CLT','Considera-se noturno, o trabalho realizado entre as 22:00 horas de um dia Ã s 5:00 horas do dia seguinte. A hora normal tem a duraÃ§Ã£o de 60 (sessenta) minutos, jÃ¡ a hora noturna, por disposiÃ§Ã£o legal, Ã© computada como sendo de 52 minutos e 30 segundos. Ou seja, a cada 1:00 trabalhada, serÃ£o gerados 1:08 de Adicional Noturno.\r\n\r\nO pagamento do Adicional deve ser feito independente de as horas serem horas normais ou horas extras. Sendo assim, quando houver hora extra no perÃ­odo noturno, a empresa deve, por obrigaÃ§Ã£o legal, efetuar o pagamento das Extras Noturnas e do Adicional Noturno.\r\n\r\nExemplos de ConversÃ£o de Adicional Noturno:\r\n\r\n1 - Trabalhado 22:00 - 23:00 = 01:08 de Adicional Noturno, sendo:\r\n22:00-22:52 = Convertido em 01:00 de Adc Not\r\n22:52-23:00 = Somando 00:08min de Adc Not\r\n\r\n2 - Trabalhado 22:00 - 22:30 = 00:34min de Adicional Noturno, sendo:\r\n22:00-22:30 = ConversÃ£o proporcional, 00:30min em 00:34min.\r\n','MARCELO','2019-06-07 00:13:00'),(793,'adicional noturno - QUAL A DIFERENÃ‡A ENTRE ADICIONAL NOTURNO E EXTRA NOTURNA ?','CLT','O Adicional Noturno Ã© uma bonificaÃ§Ã£o que o funcionÃ¡rio deve receber quando trabalhar das 22:00-05:00. O pagamento destas horas deve ocorrer INDEPENDENTEMENTE de serem Extras Normais ou Horas Extras. Ou seja, se o funcionÃ¡rio fizer Hora Extra e estas horas forem em perÃ­odo noturno, o mesmo receberÃ¡ as o Adicional Noturno e as Extras Noturnas. Ã‰ importante saber-mos que ambas horas sofrem a conversÃ£o de 52min para 01:00h.\r\n\r\nExemplo: \r\n\r\nExpediente 14:00-17:00-18:00-22:00\r\nMarcaÃ§Ãµes 14:02-17:15-18:15-23:00\r\n\r\nVariÃ¡veis geradas:\r\n- 01:08 Adicional Noturno\r\n- 01:08 Hora Extra 50%\r\n','MARCELO','2019-06-07 22:14:32'),(794,'RELÃ“GIO NÃƒO BLOQUEAR MARCAÃ‡ÃƒO - PORTARIA 1510','CLT','Art. 10. O REP deverÃ¡ atender aos seguintes requisitos:\r\n\r\nI - nÃ£o permitir alteraÃ§Ãµes ou apagamento dos dados armazenados na MemÃ³ria de Registro de Ponto;\r\n\r\nII - ser inviolÃ¡vel de forma a atender aos requisitos do art. 2Âº;\r\n\r\nIII - nÃ£o possuir funcionalidades que permitam restringir as marcaÃ§Ãµes de ponto;\r\n\r\nIV - nÃ£o possuir funcionalidades que permitam registros automÃ¡ticos de ponto; e\r\n\r\nV - possuir identificaÃ§Ã£o do REP gravada de forma indelÃ©vel na sua estrutura externa, contendo CNPJ e nome do fabricante, marca, modelo e nÃºmero de fabricaÃ§Ã£o do REP.\r\n\r\nParÃ¡grafo Ãºnico. O nÃºmero de fabricaÃ§Ã£o do REP Ã© o nÃºmero exclusivo de cada equipamento e consistirÃ¡ na junÃ§Ã£o seqÃ¼encial do nÃºmero de cadastro do fabricante no MTE, nÃºmero de registro do modelo no MTE e nÃºmero sÃ©rie Ãºnico do equipamento.\r\n','ANDERSON OLIVEIRA','2019-06-10 22:28:14'),(795,'ERRO DE TIMEOUT AO IMPORTAR','RELOGIO','Verificar NSR\r\n\r\n\r\nVerificar antivirus.','Alessander','2019-06-18 17:58:37'),(796,'ConexÃ£o direta rep > computador','RELOGIO','Para configurar relÃ³gio direto no computador:\r\n\r\nNo Windows 7:\r\n\r\nClicar no Ã­cone de rede na barra de ferramentas, no canto inferior direito> Central de Rede e Compartilhamento> ConfiguraÃ§Ãµes do Adaptador> Identificar o adaptador em que o relÃ³gio estÃ¡ conectado (solictar ao cliente que desconecte o cabo, o adaptador irÃ¡ ficar com um X vermelho)> BotÃ£o direito> Propriedades> Localizar Protocolo Ip VersÃ£o 4 (TCP/IPv4)> configurar ip 10.0.0.2> MÃ¡scara 255.255.255.0> Gateway> 10.0.0.1> OK> Passar para o Cliente o IP: 10.0.0.4 ou superior> testar comunicaÃ§Ã£o.\r\n\r\nWindows 10: \r\n\r\nClicar no Ã­cone de rede na barra de ferramentas, no canto inferior direito> ConfiguraÃ§Ãµes de Rede e Internet> Alterar OpÃ§Ãµes de Adaptador> Identificar o adaptador em que o relÃ³gio estÃ¡ conectado (solictar ao cliente que desconecte o cabo, o adaptador irÃ¡ ficar com um X vermelho)> BotÃ£o direito> Propriedades> Localizar Protocolo Ip VersÃ£o 4 (TCP/IPv4)> configurar ip 10.0.0.2> MÃ¡scara 255.255.255.0> Gateway> 10.0.0.1> OK> Passar para o Cliente o IP: 10.0.0.4 ou superior> testar comunicaÃ§Ã£o. \r\n','Alessandro Sena','2019-06-19 17:34:50'),(797,'ConexÃ£o direta rep > computador','RELOGIO','Para configurar relÃ³gio direto no computador:\r\n\r\nNo Windows 7:\r\n\r\nClicar no Ã­cone de rede na barra de ferramentas, no canto inferior direito> Central de Rede e Compartilhamento> ConfiguraÃ§Ãµes do Adaptador> Identificar o adaptador em que o relÃ³gio estÃ¡ conectado (solictar ao cliente que desconecte o cabo, o adaptador irÃ¡ ficar com um X vermelho)> BotÃ£o direito> Propriedades> Localizar Protocolo Ip VersÃ£o 4 (TCP/IPv4)> configurar ip 10.0.0.2> MÃ¡scara 255.255.255.0> Gateway> 10.0.0.1> OK> Passar para o Cliente o IP: 10.0.0.4 ou superior> testar comunicaÃ§Ã£o.\r\n\r\nWindows 10: \r\n\r\nClicar no Ã­cone de rede na barra de ferramentas, no canto inferior direito> ConfiguraÃ§Ãµes de Rede e Internet> Alterar OpÃ§Ãµes de Adaptador> Identificar o adaptador em que o relÃ³gio estÃ¡ conectado (solictar ao cliente que desconecte o cabo, o adaptador irÃ¡ ficar com um X vermelho)> BotÃ£o direito> Propriedades> Localizar Protocolo Ip VersÃ£o 4 (TCP/IPv4)> configurar ip 10.0.0.2> MÃ¡scara 255.255.255.0> Gateway> 10.0.0.1> OK> Passar para o Cliente o IP: 10.0.0.4 ou superior> testar comunicaÃ§Ã£o. \r\n','Alessandro Sena','2019-06-19 17:39:31'),(798,'Criar expediente fixo ponto4','CADASTRO DE FUNCIONARIO','Menu tabelas >> expediente >> novo horÃ¡rio fixo\r\nEm descriÃ§Ã£o digitar o horÃ¡rio que vai ser criado por exemplo \"9:00 01:00 02:00 3:07\"\r\nNa guia 1Âº PerÃ­odo: no campo de entrada, digitar horÃ¡rio de entrada na empresa\r\nNo campo de saÃ­da, digitar horÃ¡rio de saÃ­da para almoÃ§o\r\nEm definir faixas automÃ¡ticas definir \"3:00\" e clica em definir faixas automÃ¡ticas\r\nDesta forma as faixas permitidas sÃ£o definidas automaticamente\r\nAs faixas permitidas Ã© o perÃ­odo para aceitar marcaÃ§Ãµes no ponto por exemplo podemos definir uma faixa para entrada do funcionÃ¡rio de \"6:00\" atÃ© as \"12:00\"\r\nDesta forma se o funcionÃ¡rio marca o ponto nesse perÃ­odo nÃ£o vai ficar ignorada\r\nApÃ³s definir as faixas Ã© preciso definir as tolerÃ¢ncias em min\r\nGeralmente sÃ£o de \"0:05\" min atÃ© \"0:10\" min \r\n\r\nApÃ³s feminino do 1Âº perÃ­odo, clique em 2Âº perÃ­odo\r\nNa guia 2Âº PerÃ­odo: no campo de entrada, digitar horÃ¡rio de retorno do almoÃ§o\r\nNo campo de saÃ­da, digitar horÃ¡rio de saÃ­da da empresa\r\nEm definir faixas automÃ¡ticas definir \"3:00\" e clica em definir faixas automÃ¡ticas\r\nDefinir as tolerÃ¢ncias\r\n\r\nCaso algum horÃ¡rio passar das \"23:59\" Ã© preciso marca a opÃ§Ã£o do \"+\", em todos inclusive nas faixas\r\n\r\nApÃ³s esse procedimento clica em guia opÃ§Ãµes\r\nNessa clica preciso marca a opÃ§Ã£o compensar intervalo caso o funcionÃ¡rio for realizar as marcaÃ§Ãµes no relÃ³gio de ponto\r\nSe os funcionÃ¡rios nÃ£o for fazer as marcaÃ§Ãµes de intervalo Ã© preciso marca intervalo pre-assinalado.\r\n\r\nApÃ³s esses procedimentos pode clicar em ok e definir o horÃ¡rio para o funcionÃ¡rio\r\n\r\n','gabriel','2019-07-02 17:23:14'),(799,'clientes asseponto4 com manutencao','RELATORIOS','	  ,[MNT_VERSAO_ASSEPONTO]\r\n\r\n      ,CASE WHEN [CAD_CNPJ] IS NOT NULL THEN RTRIM([CAD_CNPJ]) WHEN [CAD_CPF] IS NOT NULL THEN RTRIM([CAD_CPF]) ELSE \'\' END CNPJ\r\n\r\n	  ,[CAD_QTD_FUNCIONARIO]  \'Qnt Funcionarios\'\r\n\r\n      ,RTRIM(CAD_CONTATO) AS CONTATO\r\n\r\n      ,RTRIM(CAD_UF) ESTADO\r\n\r\n      ,ISNULL(RTRIM(CAD_TELEFONE1_DDD) + \' \' +  RTRIM(CAD_TELEFONE1),\'\') AS TELEFONE\r\n\r\n      ,ISNULL(RTRIM(CAD_TELEFONE2_DDD) + \' \' +  RTRIM(CAD_TELEFONE2),\'\') AS TELEFONE2\r\n\r\n      ,ISNULL(RTRIM(CAD_TELEFONE3_DDD) + \' \' +  RTRIM(CAD_TELEFONE3),\'\') AS TELEFONE3\r\n\r\n      ,ISNULL(RTRIM(CAD_CELULAR_DDD) + \' \' +  RTRIM(CAD_CELULAR),\'\') AS CELULAR\r\n\r\n      ,CASE WHEN _CAD_ENT_TELEFONE1 IS NOT NULL THEN ISNULL(RTRIM(_CAD_ENT_TELEFONE1),\'\') ELSE ISNULL(RTRIM(_CAD_ENT_TELEFONE2),\'\') END \'OUTROS CONTATOS\'\r\n\r\n      ,ISNULL(RTRIM(CAD_EMAIL),\'\') AS EMAIL\r\n\r\n      ,ISNULL(RTRIM(CAD_EMAIL2),\'\') AS EMAIL2\r\n\r\n      ,ISNULL(RTRIM(CAD_EMAIL3),\'\') AS EMAIL3\r\n\r\n  FROM [ASSECONT1].[DBO].[ASSEPONTOCLIENTES]\r\n\r\n  INNER JOIN [ASSEPONTOREVENDAS] ON [CAD_REVENDA] = [REV_IND]\r\n  INNER JOIN [ASSEPONTOMANUTENCAO] ON CAD_IND = [MNT_CLIENTE]\r\n\r\n\r\n  WHERE (select sum([MNT_CANCELADO]) from [ASSEPONTOMANUTENCAO] where CAD_IND = [MNT_CLIENTE] group by [MNT_CLIENTE]) = 0  and \r\n  [MNT_VERSAO_ASSEPONTO] < 50 \r\n  \r\n\r\n  ORDER BY CAD_RAZAOSOCIAL','gabriel','2019-07-02 22:42:02'),(800,'clientes assepontoweb com manutencao','RELATORIOS','	  ,[MNT_VERSAO_ASSEPONTO]\r\n\r\n      ,CASE WHEN [CAD_CNPJ] IS NOT NULL THEN RTRIM([CAD_CNPJ]) WHEN [CAD_CPF] IS NOT NULL THEN RTRIM([CAD_CPF]) ELSE \'\' END CNPJ\r\n\r\n	  ,[CAD_QTD_FUNCIONARIO]  \'Qnt Funcionarios\'\r\n\r\n      ,RTRIM(CAD_CONTATO) AS CONTATO\r\n\r\n      ,RTRIM(CAD_UF) ESTADO\r\n\r\n      ,ISNULL(RTRIM(CAD_TELEFONE1_DDD) + \' \' +  RTRIM(CAD_TELEFONE1),\'\') AS TELEFONE\r\n\r\n      ,ISNULL(RTRIM(CAD_TELEFONE2_DDD) + \' \' +  RTRIM(CAD_TELEFONE2),\'\') AS TELEFONE2\r\n\r\n      ,ISNULL(RTRIM(CAD_TELEFONE3_DDD) + \' \' +  RTRIM(CAD_TELEFONE3),\'\') AS TELEFONE3\r\n\r\n      ,ISNULL(RTRIM(CAD_CELULAR_DDD) + \' \' +  RTRIM(CAD_CELULAR),\'\') AS CELULAR\r\n\r\n      ,CASE WHEN _CAD_ENT_TELEFONE1 IS NOT NULL THEN ISNULL(RTRIM(_CAD_ENT_TELEFONE1),\'\') ELSE ISNULL(RTRIM(_CAD_ENT_TELEFONE2),\'\') END \'OUTROS CONTATOS\'\r\n\r\n      ,ISNULL(RTRIM(CAD_EMAIL),\'\') AS EMAIL\r\n\r\n      ,ISNULL(RTRIM(CAD_EMAIL2),\'\') AS EMAIL2\r\n\r\n      ,ISNULL(RTRIM(CAD_EMAIL3),\'\') AS EMAIL3\r\n\r\n  FROM [ASSECONT1].[DBO].[ASSEPONTOCLIENTES]\r\n\r\n  INNER JOIN [ASSEPONTOREVENDAS] ON [CAD_REVENDA] = [REV_IND]\r\n  INNER JOIN [ASSEPONTOMANUTENCAO] ON CAD_IND = [MNT_CLIENTE]\r\n\r\n\r\n  WHERE (select sum([MNT_CANCELADO]) from [ASSEPONTOMANUTENCAO] where CAD_IND = [MNT_CLIENTE] group by [MNT_CLIENTE]) = 0  and \r\n  [MNT_VERSAO_ASSEPONTO] = 50 \r\n  \r\n\r\n  ORDER BY CAD_RAZAOSOCIAL','gabriel','2019-07-02 22:42:15'),(801,'clientes com manutencao cancelada ','RELATORIOS','	  ,[MNT_VERSAO_ASSEPONTO]\r\n\r\n      ,CASE WHEN [CAD_CNPJ] IS NOT NULL THEN RTRIM([CAD_CNPJ]) WHEN [CAD_CPF] IS NOT NULL THEN RTRIM([CAD_CPF]) ELSE \'\' END CNPJ\r\n\r\n	  ,[CAD_QTD_FUNCIONARIO]  \'Qnt Funcionarios\'\r\n\r\n      ,RTRIM(CAD_CONTATO) AS CONTATO\r\n\r\n      ,RTRIM(CAD_UF) ESTADO\r\n\r\n      ,ISNULL(RTRIM(CAD_TELEFONE1_DDD) + \' \' +  RTRIM(CAD_TELEFONE1),\'\') AS TELEFONE\r\n\r\n      ,ISNULL(RTRIM(CAD_TELEFONE2_DDD) + \' \' +  RTRIM(CAD_TELEFONE2),\'\') AS TELEFONE2\r\n\r\n      ,ISNULL(RTRIM(CAD_TELEFONE3_DDD) + \' \' +  RTRIM(CAD_TELEFONE3),\'\') AS TELEFONE3\r\n\r\n      ,ISNULL(RTRIM(CAD_CELULAR_DDD) + \' \' +  RTRIM(CAD_CELULAR),\'\') AS CELULAR\r\n\r\n      ,CASE WHEN _CAD_ENT_TELEFONE1 IS NOT NULL THEN ISNULL(RTRIM(_CAD_ENT_TELEFONE1),\'\') ELSE ISNULL(RTRIM(_CAD_ENT_TELEFONE2),\'\') END \'OUTROS CONTATOS\'\r\n\r\n      ,ISNULL(RTRIM(CAD_EMAIL),\'\') AS EMAIL\r\n\r\n      ,ISNULL(RTRIM(CAD_EMAIL2),\'\') AS EMAIL2\r\n\r\n      ,ISNULL(RTRIM(CAD_EMAIL3),\'\') AS EMAIL3\r\n\r\n  FROM [ASSECONT1].[DBO].[ASSEPONTOCLIENTES]\r\n\r\n  INNER JOIN [ASSEPONTOREVENDAS] ON [CAD_REVENDA] = [REV_IND]\r\n  INNER JOIN [ASSEPONTOMANUTENCAO] ON CAD_IND = [MNT_CLIENTE]\r\n\r\n\r\n  WHERE (select sum([MNT_CANCELADO]) from [ASSEPONTOMANUTENCAO] where CAD_IND = [MNT_CLIENTE] group by [MNT_CLIENTE]) = 1  \r\n  \r\n\r\n  ORDER BY CAD_RAZAOSOCIAL','gabriel','2019-07-02 22:42:52'),(802,'CLIENTES ASSEPONTO4 COM MANUTENCAO','RELATORIOS','SET DATEFORMAT DMY\r\nSELECT DISTINCT CAD_RAZAOSOCIAL EMPRESA\r\n\r\n      ,RTRIM([REV_RAZAOSOCIAL]) REVENDA\r\n\r\n      ,CASE WHEN [CAD_CNPJ] IS NOT NULL THEN RTRIM([CAD_CNPJ]) WHEN [CAD_CPF] IS NOT NULL THEN RTRIM([CAD_CPF]) ELSE \'\' END CNPJ\r\n\r\n	  ,[CAD_QTD_FUNCIONARIO]  \'Qnt Funcionarios\'\r\n\r\n      ,RTRIM(CAD_CONTATO) AS CONTATO\r\n\r\n      ,RTRIM(CAD_UF) ESTADO\r\n\r\n      ,ISNULL(RTRIM(CAD_TELEFONE1_DDD) + \' \' +  RTRIM(CAD_TELEFONE1),\'\') AS TELEFONE\r\n\r\n      ,ISNULL(RTRIM(CAD_TELEFONE2_DDD) + \' \' +  RTRIM(CAD_TELEFONE2),\'\') AS TELEFONE2\r\n\r\n      ,ISNULL(RTRIM(CAD_TELEFONE3_DDD) + \' \' +  RTRIM(CAD_TELEFONE3),\'\') AS TELEFONE3\r\n\r\n      ,ISNULL(RTRIM(CAD_CELULAR_DDD) + \' \' +  RTRIM(CAD_CELULAR),\'\') AS CELULAR\r\n\r\n      ,CASE WHEN _CAD_ENT_TELEFONE1 IS NOT NULL THEN ISNULL(RTRIM(_CAD_ENT_TELEFONE1),\'\') ELSE ISNULL(RTRIM(_CAD_ENT_TELEFONE2),\'\') END \'OUTROS CONTATOS\'\r\n\r\n      ,ISNULL(RTRIM(CAD_EMAIL),\'\') AS EMAIL\r\n\r\n      ,ISNULL(RTRIM(CAD_EMAIL2),\'\') AS EMAIL2\r\n\r\n      ,ISNULL(RTRIM(CAD_EMAIL3),\'\') AS EMAIL3\r\n\r\n  FROM [ASSECONT1].[DBO].[ASSEPONTOCLIENTES]\r\n\r\n  INNER JOIN [ASSEPONTOREVENDAS] ON [CAD_REVENDA] = [REV_IND]\r\n  INNER JOIN [ASSEPONTOMANUTENCAO] ON CAD_IND = [MNT_CLIENTE]\r\n\r\n\r\n  WHERE (select sum([MNT_CANCELADO]) from [ASSEPONTOMANUTENCAO] where CAD_IND = [MNT_CLIENTE] group by [MNT_CLIENTE]) = 0  and \r\n  [MNT_VERSAO_ASSEPONTO] < 50 \r\n  \r\n\r\n  ORDER BY CAD_RAZAOSOCIAL','gabriel','2019-07-02 22:56:37'),(803,'CLIENTES ASSEPONTOWEB COM MANUTENCAO','RELATORIOS','SET DATEFORMAT DMY\r\nSELECT DISTINCT CAD_RAZAOSOCIAL EMPRESA\r\n\r\n      ,RTRIM([REV_RAZAOSOCIAL]) REVENDA\r\n\r\n      ,CASE WHEN [CAD_CNPJ] IS NOT NULL THEN RTRIM([CAD_CNPJ]) WHEN [CAD_CPF] IS NOT NULL THEN RTRIM([CAD_CPF]) ELSE \'\' END CNPJ\r\n\r\n	  ,[CAD_QTD_FUNCIONARIO]  \'Qnt Funcionarios\'\r\n\r\n      ,RTRIM(CAD_CONTATO) AS CONTATO\r\n\r\n      ,RTRIM(CAD_UF) ESTADO\r\n\r\n      ,ISNULL(RTRIM(CAD_TELEFONE1_DDD) + \' \' +  RTRIM(CAD_TELEFONE1),\'\') AS TELEFONE\r\n\r\n      ,ISNULL(RTRIM(CAD_TELEFONE2_DDD) + \' \' +  RTRIM(CAD_TELEFONE2),\'\') AS TELEFONE2\r\n\r\n      ,ISNULL(RTRIM(CAD_TELEFONE3_DDD) + \' \' +  RTRIM(CAD_TELEFONE3),\'\') AS TELEFONE3\r\n\r\n      ,ISNULL(RTRIM(CAD_CELULAR_DDD) + \' \' +  RTRIM(CAD_CELULAR),\'\') AS CELULAR\r\n\r\n      ,CASE WHEN _CAD_ENT_TELEFONE1 IS NOT NULL THEN ISNULL(RTRIM(_CAD_ENT_TELEFONE1),\'\') ELSE ISNULL(RTRIM(_CAD_ENT_TELEFONE2),\'\') END \'OUTROS CONTATOS\'\r\n\r\n      ,ISNULL(RTRIM(CAD_EMAIL),\'\') AS EMAIL\r\n\r\n      ,ISNULL(RTRIM(CAD_EMAIL2),\'\') AS EMAIL2\r\n\r\n      ,ISNULL(RTRIM(CAD_EMAIL3),\'\') AS EMAIL3\r\n\r\n  FROM [ASSECONT1].[DBO].[ASSEPONTOCLIENTES]\r\n\r\n  INNER JOIN [ASSEPONTOREVENDAS] ON [CAD_REVENDA] = [REV_IND]\r\n  INNER JOIN [ASSEPONTOMANUTENCAO] ON CAD_IND = [MNT_CLIENTE]\r\n\r\n\r\n  WHERE (select sum([MNT_CANCELADO]) from [ASSEPONTOMANUTENCAO] where CAD_IND = [MNT_CLIENTE] group by [MNT_CLIENTE]) = 0  and \r\n  [MNT_VERSAO_ASSEPONTO] = 50 \r\n  \r\n\r\n  ORDER BY CAD_RAZAOSOCIAL','gabriel','2019-07-02 22:56:52'),(804,'CLIENTES COM MANUTENCAO CANCELADA ','RELATORIOS','SET DATEFORMAT DMY\r\nSELECT DISTINCT CAD_RAZAOSOCIAL EMPRESA\r\n\r\n      ,RTRIM([REV_RAZAOSOCIAL]) REVENDA\r\n\r\n      ,CASE WHEN [CAD_CNPJ] IS NOT NULL THEN RTRIM([CAD_CNPJ]) WHEN [CAD_CPF] IS NOT NULL THEN RTRIM([CAD_CPF]) ELSE \'\' END CNPJ\r\n\r\n	  ,[CAD_QTD_FUNCIONARIO]  \'Qnt Funcionarios\'\r\n\r\n      ,RTRIM(CAD_CONTATO) AS CONTATO\r\n\r\n      ,RTRIM(CAD_UF) ESTADO\r\n\r\n      ,ISNULL(RTRIM(CAD_TELEFONE1_DDD) + \' \' +  RTRIM(CAD_TELEFONE1),\'\') AS TELEFONE\r\n\r\n      ,ISNULL(RTRIM(CAD_TELEFONE2_DDD) + \' \' +  RTRIM(CAD_TELEFONE2),\'\') AS TELEFONE2\r\n\r\n      ,ISNULL(RTRIM(CAD_TELEFONE3_DDD) + \' \' +  RTRIM(CAD_TELEFONE3),\'\') AS TELEFONE3\r\n\r\n      ,ISNULL(RTRIM(CAD_CELULAR_DDD) + \' \' +  RTRIM(CAD_CELULAR),\'\') AS CELULAR\r\n\r\n      ,CASE WHEN _CAD_ENT_TELEFONE1 IS NOT NULL THEN ISNULL(RTRIM(_CAD_ENT_TELEFONE1),\'\') ELSE ISNULL(RTRIM(_CAD_ENT_TELEFONE2),\'\') END \'OUTROS CONTATOS\'\r\n\r\n      ,ISNULL(RTRIM(CAD_EMAIL),\'\') AS EMAIL\r\n\r\n      ,ISNULL(RTRIM(CAD_EMAIL2),\'\') AS EMAIL2\r\n\r\n      ,ISNULL(RTRIM(CAD_EMAIL3),\'\') AS EMAIL3\r\n\r\n  FROM [ASSECONT1].[DBO].[ASSEPONTOCLIENTES]\r\n\r\n  INNER JOIN [ASSEPONTOREVENDAS] ON [CAD_REVENDA] = [REV_IND]\r\n  INNER JOIN [ASSEPONTOMANUTENCAO] ON CAD_IND = [MNT_CLIENTE]\r\n\r\n\r\n  WHERE (select sum([MNT_CANCELADO]) from [ASSEPONTOMANUTENCAO] where CAD_IND = [MNT_CLIENTE] group by [MNT_CLIENTE]) = 1\r\n\r\n  \r\n  ORDER BY CAD_RAZAOSOCIAL','gabriel','2019-07-02 22:57:22'),(805,'CLIENTES COM MANUTENCAO 4 qtdade funcionario','RELATORIOS','SET DATEFORMAT DMY\r\nSELECT DISTINCT CAD_RAZAOSOCIAL EMPRESA\r\n\r\n      ,RTRIM([REV_RAZAOSOCIAL]) REVENDA\r\n\r\n      ,CASE WHEN [CAD_CNPJ] IS NOT NULL THEN RTRIM([CAD_CNPJ]) WHEN [CAD_CPF] IS NOT NULL THEN RTRIM([CAD_CPF]) ELSE \'\' END CNPJ\r\n\r\n	  ,[CAD_QTD_FUNCIONARIO]  \'Qnt Funcionarios\'\r\n\r\n      ,RTRIM(CAD_CONTATO) AS CONTATO\r\n\r\n      ,RTRIM(CAD_UF) ESTADO\r\n\r\n      ,ISNULL(RTRIM(CAD_TELEFONE1_DDD) + \' \' +  RTRIM(CAD_TELEFONE1),\'\') AS TELEFONE\r\n\r\n      ,ISNULL(RTRIM(CAD_TELEFONE2_DDD) + \' \' +  RTRIM(CAD_TELEFONE2),\'\') AS TELEFONE2\r\n\r\n      ,ISNULL(RTRIM(CAD_TELEFONE3_DDD) + \' \' +  RTRIM(CAD_TELEFONE3),\'\') AS TELEFONE3\r\n\r\n      ,ISNULL(RTRIM(CAD_CELULAR_DDD) + \' \' +  RTRIM(CAD_CELULAR),\'\') AS CELULAR\r\n\r\n      ,CASE WHEN _CAD_ENT_TELEFONE1 IS NOT NULL THEN ISNULL(RTRIM(_CAD_ENT_TELEFONE1),\'\') ELSE ISNULL(RTRIM(_CAD_ENT_TELEFONE2),\'\') END \'OUTROS CONTATOS\'\r\n\r\n      ,ISNULL(RTRIM(CAD_EMAIL),\'\') AS EMAIL\r\n\r\n      ,ISNULL(RTRIM(CAD_EMAIL2),\'\') AS EMAIL2\r\n\r\n      ,ISNULL(RTRIM(CAD_EMAIL3),\'\') AS EMAIL3\r\n\r\n  FROM [ASSECONT1].[DBO].[ASSEPONTOCLIENTES]\r\n\r\n  INNER JOIN [ASSEPONTOREVENDAS] ON [CAD_REVENDA] = [REV_IND]\r\n  INNER JOIN [ASSEPONTOMANUTENCAO] ON CAD_IND = [MNT_CLIENTE]\r\n\r\n\r\n  WHERE (select sum([MNT_CANCELADO]) from [ASSEPONTOMANUTENCAO] where CAD_IND = [MNT_CLIENTE] group by [MNT_CLIENTE]) = 0  and \r\n  [MNT_VERSAO_ASSEPONTO] < 50 and [CAD_QTD_FUNCIONARIO] <= 5000 and [CAD_QTD_FUNCIONARIO] > 500\r\n  \r\n\r\n  ORDER BY CAD_RAZAOSOCIAL\r\n\r\n','gabriel','2019-07-02 23:05:46'),(806,'G3 - SALVAR IP','RELOGIO','Aperte Enter para salvar, aperte anula atÃ© voltar para o Menu, chegando no menu va ate Salvar','Camila DINIZ','2019-07-04 18:29:00'),(807,'Relatorio de marcaÃ§oes solicitadas pelo memorano','RELATORIOS','--GRUPOQUEBRA#0#\r\n--GRUPONREGISTROS#0#\r\n--COLUNAGRUPO#0#\r\n--LARGURA#200,200,80,75,120#\r\n\r\nDECLARE @INICIO SMALLDATETIME = %DATAINICIAL%\r\nDECLARE @FIM SMALLDATETIME = %DATAFINAL%\r\n\r\nSELECT DISTINCT EMP_NOME SETOR, FUNC_NOME NOME, CONVERT(NVARCHAR(30), MRC_DATAAP, 103) AS DATA,\r\n\r\nCONVERT(NVARCHAR(5), MRC_DATAHORA, 108) AS MARCACAO,     \r\n\r\nCASE WHEN MRCM_DATAHORA IS NOT NULL THEN \'MEMORANO\' ELSE \'INCLUSAS\' END as TIPO                      \r\n\r\n\r\nFROM MARCACOES\r\nINNER JOIN FUNCIONARIOS ON MRC_FUNC = FUNC_IND or FUNC_pis = MRC_pis\r\nINNER JOIN EMPRESAS ON EMP_IND = FUNC_EMPRESA\r\nleft join [Memorandos] on [MEMO_FUNC] = FUNC_IND and [MEMO_DATA] = MRC_DATAAP \r\nleft join [MarcacoesMemorando] on [MEMO_IND] = [MRCM_MEMORANDO] \r\n\r\nWHERE  DBO.FN_DEPARTAMENTOPERTENCENTE(FUNC_EMPRESA,%DEPSELECIONADOIND%) =1 AND\r\nMRC_DATAAP >= @INICIO AND MRC_DATAAP <= @FIM AND FUNC_MARCADO_EXCLUSAO = 0 AND [MRC_OBS_USUARIO] IS NOT NULL      \r\n\r\nORDER BY EMP_NOME, FUNC_NOME','gabriel','2019-07-04 23:29:27'),(808,'ERRO AO ABRIR  GERENCIADOR G3','RELOGIO','https://www.microsoft.com/pt-br/download/details.aspx?id=5783 ','STEFFANY','2019-07-11 15:59:45');
/*!40000 ALTER TABLE `chamados` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `usuarios`
--

DROP TABLE IF EXISTS `usuarios`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `usuarios` (
  `id` int(5) NOT NULL AUTO_INCREMENT,
  `nome` varchar(20) NOT NULL,
  `usuario` varchar(30) NOT NULL,
  `senha` varchar(30) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=2 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `usuarios`
--

LOCK TABLES `usuarios` WRITE;
/*!40000 ALTER TABLE `usuarios` DISABLE KEYS */;
INSERT INTO `usuarios` VALUES (1,'Gabriel','gabriel','1234');
/*!40000 ALTER TABLE `usuarios` ENABLE KEYS */;
UNLOCK TABLES;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2019-07-12 15:04:03
